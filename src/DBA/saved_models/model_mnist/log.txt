current path: saved_models/model_mnist_Jan.30_22.14.11
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 23
create model done
Poisoned following participants: [41, 73, 51, 74, 3, 18, 29, 62, 33, 88]
We use following environment for graphs:  mnist_shard_hetero_mean_attack
Server Epoch:23 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 25, 81, 68, 12, 98, 80, 47, 50, 42, 23, 93, 39, 96, 66, 69, 31, 72, 24, 65, 46, 60, 61, 97, 20, 89, 79, 56, 15, 75, 52, 53, 43, 7, 55, 85, 91, 95, 59, 34, 26, 36, 8, 76, 13, 4, 2, 94, 21, 14, 84, 49, 22, 37, 5, 67, 78, 32, 35, 16, 44, 27, 28, 6, 1, 70, 86, 63, 71, 82, 57, 99, 45, 92, 54, 90, 40, 9, 83, 77, 38, 10, 48, 19, 0, 17, 87, 64, 30, 11, 58].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   1,  Average loss: 0.0228, Accuracy: 281/569 (49.3849%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   2,  Average loss: 0.0143, Accuracy: 276/569 (48.5062%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   3,  Average loss: 0.0128, Accuracy: 291/569 (51.1424%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   4,  Average loss: 0.0122, Accuracy: 274/569 (48.1547%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   5,  Average loss: 0.0119, Accuracy: 300/569 (52.7241%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   6,  Average loss: 0.0115, Accuracy: 292/569 (51.3181%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   7,  Average loss: 0.0113, Accuracy: 304/569 (53.4271%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   8,  Average loss: 0.0114, Accuracy: 299/569 (52.5483%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch   9,  Average loss: 0.0115, Accuracy: 301/569 (52.8998%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 41, internal_epoch  10,  Average loss: 0.0117, Accuracy: 269/569 (47.2759%), train_poison_data_count: 288
Global model norm: 15.378044013166903.
Norm before scaling: 15.464149114546007. Distance: 2.8417831158386844
Total norm for 10 adversaries is: 15.464149114546007. distance: 2.8417831158386844
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.4758, Accuracy: 7469/8968 (83.2850%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   1,  Average loss: 0.0143, Accuracy: 353/522 (67.6245%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   2,  Average loss: 0.0083, Accuracy: 376/522 (72.0307%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   3,  Average loss: 0.0079, Accuracy: 375/522 (71.8391%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   4,  Average loss: 0.0085, Accuracy: 357/522 (68.3908%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   5,  Average loss: 0.0081, Accuracy: 371/522 (71.0728%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   6,  Average loss: 0.0075, Accuracy: 360/522 (68.9655%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   7,  Average loss: 0.0076, Accuracy: 373/522 (71.4559%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   8,  Average loss: 0.0077, Accuracy: 371/522 (71.0728%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch   9,  Average loss: 0.0078, Accuracy: 360/522 (68.9655%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 73, internal_epoch  10,  Average loss: 0.0073, Accuracy: 364/522 (69.7318%), train_poison_data_count: 266
Global model norm: 15.378044013166903.
Norm before scaling: 15.420505574964135. Distance: 2.5889873671004295
Total norm for 10 adversaries is: 15.420505574964135. distance: 2.5889873671004295
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.1334, Accuracy: 8956/8968 (99.8662%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   1,  Average loss: 0.0241, Accuracy: 188/385 (48.8312%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   2,  Average loss: 0.0164, Accuracy: 191/385 (49.6104%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   3,  Average loss: 0.0135, Accuracy: 193/385 (50.1299%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   4,  Average loss: 0.0122, Accuracy: 211/385 (54.8052%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   5,  Average loss: 0.0102, Accuracy: 274/385 (71.1688%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   6,  Average loss: 0.0097, Accuracy: 291/385 (75.5844%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   7,  Average loss: 0.0083, Accuracy: 312/385 (81.0390%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   8,  Average loss: 0.0078, Accuracy: 322/385 (83.6364%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch   9,  Average loss: 0.0068, Accuracy: 339/385 (88.0519%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 51, internal_epoch  10,  Average loss: 0.0063, Accuracy: 353/385 (91.6883%), train_poison_data_count: 193
Global model norm: 15.378044013166903.
Norm before scaling: 15.502464344640046. Distance: 3.0482437580588795
Total norm for 10 adversaries is: 15.502464344640046. distance: 3.0482437580588795
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.2459, Accuracy: 8551/8968 (95.3501%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   1,  Average loss: 0.0112, Accuracy: 447/627 (71.2919%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   2,  Average loss: 0.0033, Accuracy: 567/627 (90.4306%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   3,  Average loss: 0.0015, Accuracy: 606/627 (96.6507%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   4,  Average loss: 0.0013, Accuracy: 608/627 (96.9697%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   5,  Average loss: 0.0012, Accuracy: 611/627 (97.4482%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   6,  Average loss: 0.0011, Accuracy: 613/627 (97.7671%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   7,  Average loss: 0.0011, Accuracy: 616/627 (98.2456%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   8,  Average loss: 0.0007, Accuracy: 620/627 (98.8836%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch   9,  Average loss: 0.0007, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 74, internal_epoch  10,  Average loss: 0.0006, Accuracy: 621/627 (99.0431%), train_poison_data_count: 320
Global model norm: 15.378044013166903.
Norm before scaling: 15.643854834784069. Distance: 3.5367697727035985
Total norm for 10 adversaries is: 15.643854834784069. distance: 3.5367697727035985
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0099, Accuracy: 8933/8968 (99.6097%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 3, internal_epoch   1,  Average loss: 0.0236, Accuracy: 248/516 (48.0620%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 3, internal_epoch   2,  Average loss: 0.0203, Accuracy: 256/516 (49.6124%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 3, internal_epoch   3,  Average loss: 0.0157, Accuracy: 247/516 (47.8682%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 3, internal_epoch   4,  Average loss: 0.0142, Accuracy: 270/516 (52.3256%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 3, internal_epoch   5,  Average loss: 0.0136, Accuracy: 265/516 (51.3566%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 3, internal_epoch   6,  Average loss: 0.0135, Accuracy: 249/516 (48.2558%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 3, internal_epoch   7,  Average loss: 0.0132, Accuracy: 264/516 (51.1628%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 3, internal_epoch   8,  Average loss: 0.0128, Accuracy: 275/516 (53.2946%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 3, internal_epoch   9,  Average loss: 0.0124, Accuracy: 270/516 (52.3256%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 3, internal_epoch  10,  Average loss: 0.0127, Accuracy: 270/516 (52.3256%), train_poison_data_count: 260
Global model norm: 15.378044013166903.
Norm before scaling: 15.55964603835406. Distance: 4.143970678100538
Total norm for 10 adversaries is: 15.55964603835406. distance: 4.143970678100538
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.5531, Accuracy: 8375/8968 (93.3876%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 18, internal_epoch   1,  Average loss: 0.0215, Accuracy: 391/759 (51.5152%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 18, internal_epoch   2,  Average loss: 0.0134, Accuracy: 376/759 (49.5389%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 18, internal_epoch   3,  Average loss: 0.0121, Accuracy: 387/759 (50.9881%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 18, internal_epoch   4,  Average loss: 0.0114, Accuracy: 417/759 (54.9407%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 18, internal_epoch   5,  Average loss: 0.0114, Accuracy: 410/759 (54.0184%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 18, internal_epoch   6,  Average loss: 0.0114, Accuracy: 413/759 (54.4137%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 18, internal_epoch   7,  Average loss: 0.0114, Accuracy: 401/759 (52.8327%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 18, internal_epoch   8,  Average loss: 0.0113, Accuracy: 416/759 (54.8090%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 18, internal_epoch   9,  Average loss: 0.0111, Accuracy: 408/759 (53.7549%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 18, internal_epoch  10,  Average loss: 0.0113, Accuracy: 394/759 (51.9104%), train_poison_data_count: 384
Global model norm: 15.378044013166903.
Norm before scaling: 15.550877409587146. Distance: 3.487754517158633
Total norm for 10 adversaries is: 15.550877409587146. distance: 3.487754517158633
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.4630, Accuracy: 7780/8968 (86.7529%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 29, internal_epoch   1,  Average loss: 0.0236, Accuracy: 254/506 (50.1976%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 29, internal_epoch   2,  Average loss: 0.0141, Accuracy: 280/506 (55.3360%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 29, internal_epoch   3,  Average loss: 0.0101, Accuracy: 336/506 (66.4032%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 29, internal_epoch   4,  Average loss: 0.0096, Accuracy: 361/506 (71.3439%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 29, internal_epoch   5,  Average loss: 0.0082, Accuracy: 407/506 (80.4348%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 29, internal_epoch   6,  Average loss: 0.0063, Accuracy: 456/506 (90.1186%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 29, internal_epoch   7,  Average loss: 0.0050, Accuracy: 475/506 (93.8735%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 29, internal_epoch   8,  Average loss: 0.0037, Accuracy: 489/506 (96.6403%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 29, internal_epoch   9,  Average loss: 0.0030, Accuracy: 493/506 (97.4308%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 29, internal_epoch  10,  Average loss: 0.0026, Accuracy: 495/506 (97.8261%), train_poison_data_count: 256
Global model norm: 15.378044013166903.
Norm before scaling: 15.590634571836357. Distance: 3.334598746117353
Total norm for 10 adversaries is: 15.590634571836357. distance: 3.334598746117353
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.3002, Accuracy: 7899/8968 (88.0798%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 62, internal_epoch   1,  Average loss: 0.0117, Accuracy: 398/580 (68.6207%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 62, internal_epoch   2,  Average loss: 0.0060, Accuracy: 485/580 (83.6207%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 62, internal_epoch   3,  Average loss: 0.0029, Accuracy: 537/580 (92.5862%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 62, internal_epoch   4,  Average loss: 0.0025, Accuracy: 551/580 (95.0000%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 62, internal_epoch   5,  Average loss: 0.0015, Accuracy: 566/580 (97.5862%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 62, internal_epoch   6,  Average loss: 0.0012, Accuracy: 569/580 (98.1034%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 62, internal_epoch   7,  Average loss: 0.0013, Accuracy: 564/580 (97.2414%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 62, internal_epoch   8,  Average loss: 0.0011, Accuracy: 569/580 (98.1034%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 62, internal_epoch   9,  Average loss: 0.0013, Accuracy: 565/580 (97.4138%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 62, internal_epoch  10,  Average loss: 0.0011, Accuracy: 566/580 (97.5862%), train_poison_data_count: 292
Global model norm: 15.378044013166903.
Norm before scaling: 15.681341292175222. Distance: 3.287763978056033
Total norm for 10 adversaries is: 15.681341292175222. distance: 3.287763978056033
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0315, Accuracy: 8849/8968 (98.6731%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 33, internal_epoch   1,  Average loss: 0.0225, Accuracy: 271/587 (46.1670%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 33, internal_epoch   2,  Average loss: 0.0153, Accuracy: 295/587 (50.2555%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 33, internal_epoch   3,  Average loss: 0.0147, Accuracy: 293/587 (49.9148%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 33, internal_epoch   4,  Average loss: 0.0131, Accuracy: 298/587 (50.7666%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 33, internal_epoch   5,  Average loss: 0.0129, Accuracy: 300/587 (51.1073%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 33, internal_epoch   6,  Average loss: 0.0131, Accuracy: 291/587 (49.5741%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 33, internal_epoch   7,  Average loss: 0.0127, Accuracy: 288/587 (49.0630%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 33, internal_epoch   8,  Average loss: 0.0128, Accuracy: 303/587 (51.6184%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 33, internal_epoch   9,  Average loss: 0.0126, Accuracy: 300/587 (51.1073%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 33, internal_epoch  10,  Average loss: 0.0126, Accuracy: 298/587 (50.7666%), train_poison_data_count: 299
Global model norm: 15.378044013166903.
Norm before scaling: 15.508915459832592. Distance: 3.274581964035191
Total norm for 10 adversaries is: 15.508915459832592. distance: 3.274581964035191
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.5259, Accuracy: 7955/8968 (88.7043%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 88, internal_epoch   1,  Average loss: 0.0151, Accuracy: 430/734 (58.5831%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 88, internal_epoch   2,  Average loss: 0.0124, Accuracy: 475/734 (64.7139%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 88, internal_epoch   3,  Average loss: 0.0098, Accuracy: 466/734 (63.4877%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 88, internal_epoch   4,  Average loss: 0.0089, Accuracy: 489/734 (66.6213%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 88, internal_epoch   5,  Average loss: 0.0089, Accuracy: 483/734 (65.8038%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 88, internal_epoch   6,  Average loss: 0.0090, Accuracy: 481/734 (65.5313%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 88, internal_epoch   7,  Average loss: 0.0084, Accuracy: 512/734 (69.7548%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 88, internal_epoch   8,  Average loss: 0.0088, Accuracy: 495/734 (67.4387%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 88, internal_epoch   9,  Average loss: 0.0085, Accuracy: 486/734 (66.2125%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 88, internal_epoch  10,  Average loss: 0.0086, Accuracy: 501/734 (68.2561%), train_poison_data_count: 382
Global model norm: 15.378044013166903.
Norm before scaling: 15.533562041032868. Distance: 3.31165490076528
Total norm for 10 adversaries is: 15.533562041032868. distance: 3.31165490076528
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.2148, Accuracy: 8718/8968 (97.2123%)
___Train Local_Simple,  epoch  23, local model 25, internal_epoch   1,  Average loss: 0.0020, Accuracy: 569/592 (96.1149%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 2.6180, Accuracy: 5547/10000 (55.4700%)
___Train Local_Simple,  epoch  23, local model 81, internal_epoch   1,  Average loss: 0.0020, Accuracy: 608/636 (95.5975%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 4.7753, Accuracy: 2948/10000 (29.4800%)
___Train Local_Simple,  epoch  23, local model 68, internal_epoch   1,  Average loss: 0.0029, Accuracy: 517/549 (94.1712%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 5.6483, Accuracy: 3181/10000 (31.8100%)
___Train Local_Simple,  epoch  23, local model 12, internal_epoch   1,  Average loss: 0.0015, Accuracy: 714/725 (98.4828%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 2.7155, Accuracy: 5076/10000 (50.7600%)
___Train Local_Simple,  epoch  23, local model 98, internal_epoch   1,  Average loss: 0.0016, Accuracy: 532/548 (97.0803%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 3.9884, Accuracy: 4641/10000 (46.4100%)
___Train Local_Simple,  epoch  23, local model 80, internal_epoch   1,  Average loss: 0.0050, Accuracy: 476/532 (89.4737%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 6.1928, Accuracy: 2897/10000 (28.9700%)
___Train Local_Simple,  epoch  23, local model 47, internal_epoch   1,  Average loss: 0.0014, Accuracy: 528/534 (98.8764%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 2.5534, Accuracy: 5104/10000 (51.0400%)
___Train Local_Simple,  epoch  23, local model 50, internal_epoch   1,  Average loss: 0.0026, Accuracy: 457/477 (95.8071%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 7.4593, Accuracy: 3039/10000 (30.3900%)
___Train Local_Simple,  epoch  23, local model 42, internal_epoch   1,  Average loss: 0.0008, Accuracy: 467/473 (98.7315%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.8205, Accuracy: 5246/10000 (52.4600%)
___Train Local_Simple,  epoch  23, local model 23, internal_epoch   1,  Average loss: 0.0033, Accuracy: 503/542 (92.8044%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 7.2976, Accuracy: 2934/10000 (29.3400%)
___Train Local_Simple,  epoch  23, local model 93, internal_epoch   1,  Average loss: 0.0030, Accuracy: 594/630 (94.2857%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 9.2359, Accuracy: 2888/10000 (28.8800%)
___Train Local_Simple,  epoch  23, local model 39, internal_epoch   1,  Average loss: 0.0015, Accuracy: 475/493 (96.3489%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 2.9558, Accuracy: 5762/10000 (57.6200%)
___Train Local_Simple,  epoch  23, local model 96, internal_epoch   1,  Average loss: 0.0015, Accuracy: 513/531 (96.6102%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 4.0232, Accuracy: 4162/10000 (41.6200%)
___Train Local_Simple,  epoch  23, local model 66, internal_epoch   1,  Average loss: 0.0034, Accuracy: 685/733 (93.4516%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 6.8068, Accuracy: 2897/10000 (28.9700%)
___Train Local_Simple,  epoch  23, local model 69, internal_epoch   1,  Average loss: 0.0043, Accuracy: 614/671 (91.5052%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 7.3460, Accuracy: 2900/10000 (29.0000%)
___Train Local_Simple,  epoch  23, local model 31, internal_epoch   1,  Average loss: 0.0010, Accuracy: 582/596 (97.6510%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 4.5988, Accuracy: 3672/10000 (36.7200%)
___Train Local_Simple,  epoch  23, local model 72, internal_epoch   1,  Average loss: 0.0039, Accuracy: 390/423 (92.1986%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 6.1443, Accuracy: 2871/10000 (28.7100%)
___Train Local_Simple,  epoch  23, local model 24, internal_epoch   1,  Average loss: 0.0042, Accuracy: 434/477 (90.9853%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 4.9754, Accuracy: 2992/10000 (29.9200%)
___Train Local_Simple,  epoch  23, local model 65, internal_epoch   1,  Average loss: 0.0029, Accuracy: 584/621 (94.0419%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 2.7928, Accuracy: 3173/10000 (31.7300%)
___Train Local_Simple,  epoch  23, local model 46, internal_epoch   1,  Average loss: 0.0012, Accuracy: 636/650 (97.8462%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 5.3432, Accuracy: 3487/10000 (34.8700%)
___Train Local_Simple,  epoch  23, local model 60, internal_epoch   1,  Average loss: 0.0024, Accuracy: 544/571 (95.2715%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 11.1107, Accuracy: 2829/10000 (28.2900%)
___Train Local_Simple,  epoch  23, local model 61, internal_epoch   1,  Average loss: 0.0019, Accuracy: 276/287 (96.1672%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.5432, Accuracy: 6284/10000 (62.8400%)
___Train Local_Simple,  epoch  23, local model 97, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1092/1112 (98.2014%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 8.8133, Accuracy: 2932/10000 (29.3200%)
___Train Local_Simple,  epoch  23, local model 20, internal_epoch   1,  Average loss: 0.0017, Accuracy: 584/602 (97.0100%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 3.3989, Accuracy: 4109/10000 (41.0900%)
___Train Local_Simple,  epoch  23, local model 89, internal_epoch   1,  Average loss: 0.0020, Accuracy: 659/683 (96.4861%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 2.6585, Accuracy: 5288/10000 (52.8800%)
___Train Local_Simple,  epoch  23, local model 79, internal_epoch   1,  Average loss: 0.0027, Accuracy: 626/661 (94.7050%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 8.0809, Accuracy: 2927/10000 (29.2700%)
___Train Local_Simple,  epoch  23, local model 56, internal_epoch   1,  Average loss: 0.0012, Accuracy: 699/715 (97.7622%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 5.0180, Accuracy: 3197/10000 (31.9700%)
___Train Local_Simple,  epoch  23, local model 15, internal_epoch   1,  Average loss: 0.0028, Accuracy: 265/282 (93.9716%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 2.4479, Accuracy: 5030/10000 (50.3000%)
___Train Local_Simple,  epoch  23, local model 75, internal_epoch   1,  Average loss: 0.0063, Accuracy: 684/763 (89.6461%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 6.2322, Accuracy: 2455/10000 (24.5500%)
___Train Local_Simple,  epoch  23, local model 52, internal_epoch   1,  Average loss: 0.0029, Accuracy: 737/789 (93.4094%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 5.9038, Accuracy: 3518/10000 (35.1800%)
___Train Local_Simple,  epoch  23, local model 53, internal_epoch   1,  Average loss: 0.0029, Accuracy: 526/561 (93.7611%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 2.3583, Accuracy: 6190/10000 (61.9000%)
___Train Local_Simple,  epoch  23, local model 43, internal_epoch   1,  Average loss: 0.0013, Accuracy: 424/431 (98.3759%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 2.4022, Accuracy: 5106/10000 (51.0600%)
___Train Local_Simple,  epoch  23, local model 7, internal_epoch   1,  Average loss: 0.0006, Accuracy: 791/802 (98.6284%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 3.2815, Accuracy: 4276/10000 (42.7600%)
___Train Local_Simple,  epoch  23, local model 55, internal_epoch   1,  Average loss: 0.0044, Accuracy: 342/375 (91.2000%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 5.0562, Accuracy: 3908/10000 (39.0800%)
___Train Local_Simple,  epoch  23, local model 85, internal_epoch   1,  Average loss: 0.0025, Accuracy: 761/807 (94.2999%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 5.6044, Accuracy: 3292/10000 (32.9200%)
___Train Local_Simple,  epoch  23, local model 91, internal_epoch   1,  Average loss: 0.0007, Accuracy: 811/819 (99.0232%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 4.3345, Accuracy: 3194/10000 (31.9400%)
___Train Local_Simple,  epoch  23, local model 95, internal_epoch   1,  Average loss: 0.0022, Accuracy: 579/600 (96.5000%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 4.1935, Accuracy: 4703/10000 (47.0300%)
___Train Local_Simple,  epoch  23, local model 59, internal_epoch   1,  Average loss: 0.0021, Accuracy: 615/644 (95.4969%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 13.6631, Accuracy: 3003/10000 (30.0300%)
___Train Local_Simple,  epoch  23, local model 34, internal_epoch   1,  Average loss: 0.0041, Accuracy: 797/871 (91.5040%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 3.4457, Accuracy: 3891/10000 (38.9100%)
___Train Local_Simple,  epoch  23, local model 26, internal_epoch   1,  Average loss: 0.0018, Accuracy: 510/519 (98.2659%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 5.3304, Accuracy: 3398/10000 (33.9800%)
___Train Local_Simple,  epoch  23, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 308/315 (97.7778%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.7364, Accuracy: 7672/10000 (76.7200%)
___Train Local_Simple,  epoch  23, local model 8, internal_epoch   1,  Average loss: 0.0009, Accuracy: 696/706 (98.5836%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 4.6237, Accuracy: 4559/10000 (45.5900%)
___Train Local_Simple,  epoch  23, local model 76, internal_epoch   1,  Average loss: 0.0028, Accuracy: 433/459 (94.3355%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 3.0854, Accuracy: 4766/10000 (47.6600%)
___Train Local_Simple,  epoch  23, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 669/713 (93.8289%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 3.5250, Accuracy: 4053/10000 (40.5300%)
___Train Local_Simple,  epoch  23, local model 4, internal_epoch   1,  Average loss: 0.0018, Accuracy: 722/748 (96.5241%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 3.5977, Accuracy: 3576/10000 (35.7600%)
___Train Local_Simple,  epoch  23, local model 2, internal_epoch   1,  Average loss: 0.0027, Accuracy: 533/564 (94.5035%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 7.6881, Accuracy: 3042/10000 (30.4200%)
___Train Local_Simple,  epoch  23, local model 94, internal_epoch   1,  Average loss: 0.0015, Accuracy: 646/671 (96.2742%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 4.9199, Accuracy: 4032/10000 (40.3200%)
___Train Local_Simple,  epoch  23, local model 21, internal_epoch   1,  Average loss: 0.0011, Accuracy: 667/687 (97.0888%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 7.3570, Accuracy: 2855/10000 (28.5500%)
___Train Local_Simple,  epoch  23, local model 14, internal_epoch   1,  Average loss: 0.0024, Accuracy: 655/692 (94.6532%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 2.7704, Accuracy: 5166/10000 (51.6600%)
___Train Local_Simple,  epoch  23, local model 84, internal_epoch   1,  Average loss: 0.0014, Accuracy: 406/420 (96.6667%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 2.2769, Accuracy: 6039/10000 (60.3900%)
___Train Local_Simple,  epoch  23, local model 49, internal_epoch   1,  Average loss: 0.0015, Accuracy: 346/355 (97.4648%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.8048, Accuracy: 5163/10000 (51.6300%)
___Train Local_Simple,  epoch  23, local model 22, internal_epoch   1,  Average loss: 0.0021, Accuracy: 250/262 (95.4198%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 2.7314, Accuracy: 6507/10000 (65.0700%)
___Train Local_Simple,  epoch  23, local model 37, internal_epoch   1,  Average loss: 0.0011, Accuracy: 450/456 (98.6842%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.7000, Accuracy: 5920/10000 (59.2000%)
___Train Local_Simple,  epoch  23, local model 5, internal_epoch   1,  Average loss: 0.0025, Accuracy: 542/578 (93.7716%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.4314, Accuracy: 6302/10000 (63.0200%)
___Train Local_Simple,  epoch  23, local model 67, internal_epoch   1,  Average loss: 0.0019, Accuracy: 427/441 (96.8254%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 3.4997, Accuracy: 4022/10000 (40.2200%)
___Train Local_Simple,  epoch  23, local model 78, internal_epoch   1,  Average loss: 0.0055, Accuracy: 540/587 (91.9932%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 8.3494, Accuracy: 2580/10000 (25.8000%)
___Train Local_Simple,  epoch  23, local model 32, internal_epoch   1,  Average loss: 0.0026, Accuracy: 569/590 (96.4407%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 4.8668, Accuracy: 4476/10000 (44.7600%)
___Train Local_Simple,  epoch  23, local model 35, internal_epoch   1,  Average loss: 0.0032, Accuracy: 592/630 (93.9683%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 8.3806, Accuracy: 3070/10000 (30.7000%)
___Train Local_Simple,  epoch  23, local model 16, internal_epoch   1,  Average loss: 0.0007, Accuracy: 809/817 (99.0208%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 3.9185, Accuracy: 4544/10000 (45.4400%)
___Train Local_Simple,  epoch  23, local model 44, internal_epoch   1,  Average loss: 0.0007, Accuracy: 554/561 (98.7522%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 3.5916, Accuracy: 4964/10000 (49.6400%)
___Train Local_Simple,  epoch  23, local model 27, internal_epoch   1,  Average loss: 0.0029, Accuracy: 705/745 (94.6309%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 10.0742, Accuracy: 2777/10000 (27.7700%)
___Train Local_Simple,  epoch  23, local model 28, internal_epoch   1,  Average loss: 0.0018, Accuracy: 586/611 (95.9083%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 4.2870, Accuracy: 4833/10000 (48.3300%)
___Train Local_Simple,  epoch  23, local model 6, internal_epoch   1,  Average loss: 0.0011, Accuracy: 426/435 (97.9310%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 2.7671, Accuracy: 5497/10000 (54.9700%)
___Train Local_Simple,  epoch  23, local model 1, internal_epoch   1,  Average loss: 0.0011, Accuracy: 523/536 (97.5746%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 2.6628, Accuracy: 6012/10000 (60.1200%)
___Train Local_Simple,  epoch  23, local model 70, internal_epoch   1,  Average loss: 0.0019, Accuracy: 554/568 (97.5352%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 4.5618, Accuracy: 4550/10000 (45.5000%)
___Train Local_Simple,  epoch  23, local model 86, internal_epoch   1,  Average loss: 0.0014, Accuracy: 679/692 (98.1214%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 5.4395, Accuracy: 3046/10000 (30.4600%)
___Train Local_Simple,  epoch  23, local model 63, internal_epoch   1,  Average loss: 0.0041, Accuracy: 278/303 (91.7492%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 3.0521, Accuracy: 4531/10000 (45.3100%)
___Train Local_Simple,  epoch  23, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 541/561 (96.4349%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 3.5369, Accuracy: 3905/10000 (39.0500%)
___Train Local_Simple,  epoch  23, local model 82, internal_epoch   1,  Average loss: 0.0016, Accuracy: 793/815 (97.3006%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 6.9762, Accuracy: 2940/10000 (29.4000%)
___Train Local_Simple,  epoch  23, local model 57, internal_epoch   1,  Average loss: 0.0010, Accuracy: 514/523 (98.2792%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 3.2659, Accuracy: 3573/10000 (35.7300%)
___Train Local_Simple,  epoch  23, local model 99, internal_epoch   1,  Average loss: 0.0042, Accuracy: 663/712 (93.1180%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 7.8543, Accuracy: 1890/10000 (18.9000%)
___Train Local_Simple,  epoch  23, local model 45, internal_epoch   1,  Average loss: 0.0012, Accuracy: 636/647 (98.2998%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 4.5598, Accuracy: 3753/10000 (37.5300%)
___Train Local_Simple,  epoch  23, local model 92, internal_epoch   1,  Average loss: 0.0065, Accuracy: 529/611 (86.5794%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 2.4037, Accuracy: 3873/10000 (38.7300%)
___Train Local_Simple,  epoch  23, local model 54, internal_epoch   1,  Average loss: 0.0013, Accuracy: 809/832 (97.2356%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 4.7610, Accuracy: 3422/10000 (34.2200%)
___Train Local_Simple,  epoch  23, local model 90, internal_epoch   1,  Average loss: 0.0028, Accuracy: 586/615 (95.2846%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 2.0113, Accuracy: 6086/10000 (60.8600%)
___Train Local_Simple,  epoch  23, local model 40, internal_epoch   1,  Average loss: 0.0005, Accuracy: 494/498 (99.1968%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 3.5511, Accuracy: 4546/10000 (45.4600%)
___Train Local_Simple,  epoch  23, local model 9, internal_epoch   1,  Average loss: 0.0011, Accuracy: 499/508 (98.2283%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.8235, Accuracy: 5312/10000 (53.1200%)
___Train Local_Simple,  epoch  23, local model 83, internal_epoch   1,  Average loss: 0.0024, Accuracy: 344/360 (95.5556%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.8257, Accuracy: 5560/10000 (55.6000%)
___Train Local_Simple,  epoch  23, local model 77, internal_epoch   1,  Average loss: 0.0022, Accuracy: 594/618 (96.1165%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 3.2181, Accuracy: 4924/10000 (49.2400%)
___Train Local_Simple,  epoch  23, local model 38, internal_epoch   1,  Average loss: 0.0015, Accuracy: 467/477 (97.9036%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 2.2510, Accuracy: 5592/10000 (55.9200%)
___Train Local_Simple,  epoch  23, local model 10, internal_epoch   1,  Average loss: 0.0024, Accuracy: 545/573 (95.1134%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 2.8517, Accuracy: 4644/10000 (46.4400%)
___Train Local_Simple,  epoch  23, local model 48, internal_epoch   1,  Average loss: 0.0064, Accuracy: 319/363 (87.8788%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.1352, Accuracy: 6918/10000 (69.1800%)
___Train Local_Simple,  epoch  23, local model 19, internal_epoch   1,  Average loss: 0.0020, Accuracy: 572/598 (95.6522%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 9.7121, Accuracy: 2900/10000 (29.0000%)
___Train Local_Simple,  epoch  23, local model 0, internal_epoch   1,  Average loss: 0.0012, Accuracy: 427/435 (98.1609%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.4532, Accuracy: 5994/10000 (59.9400%)
___Train Local_Simple,  epoch  23, local model 17, internal_epoch   1,  Average loss: 0.0013, Accuracy: 512/527 (97.1537%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 4.6207, Accuracy: 3522/10000 (35.2200%)
___Train Local_Simple,  epoch  23, local model 87, internal_epoch   1,  Average loss: 0.0018, Accuracy: 637/663 (96.0784%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 6.0329, Accuracy: 3623/10000 (36.2300%)
___Train Local_Simple,  epoch  23, local model 64, internal_epoch   1,  Average loss: 0.0028, Accuracy: 579/608 (95.2303%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 2.9916, Accuracy: 5087/10000 (50.8700%)
___Train Local_Simple,  epoch  23, local model 30, internal_epoch   1,  Average loss: 0.0018, Accuracy: 426/443 (96.1625%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.9562, Accuracy: 6063/10000 (60.6300%)
___Train Local_Simple,  epoch  23, local model 11, internal_epoch   1,  Average loss: 0.0011, Accuracy: 542/554 (97.8339%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 2.7704, Accuracy: 5340/10000 (53.4000%)
___Train Local_Simple,  epoch  23, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 753/772 (97.5389%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 9.4271, Accuracy: 2969/10000 (29.6900%)
time spent on training: 303.2846505641937
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 0.3774, Accuracy: 8741/10000 (87.4100%)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 3.6011, Accuracy: 408/8968 (4.5495%)
saving model
Done in 333.8679931163788 sec.
Server Epoch:24 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 15, 59, 63, 57, 99, 40, 7, 52, 42, 47, 19, 2, 71, 93, 43, 91, 49, 5, 26, 84, 58, 11, 12, 8, 95, 13, 27, 89, 68, 30, 37, 31, 60, 1, 87, 0, 77, 80, 67, 55, 14, 23, 78, 64, 24, 86, 81, 85, 28, 56, 34, 35, 46, 66, 17, 65, 6, 90, 20, 4, 50, 72, 70, 45, 38, 32, 94, 10, 79, 22, 16, 53, 98, 82, 36, 44, 97, 61, 92, 76, 39, 25, 96, 21, 9, 54, 83, 75, 69, 48].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   1,  Average loss: 0.0198, Accuracy: 267/569 (46.9244%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   2,  Average loss: 0.0139, Accuracy: 283/569 (49.7364%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   3,  Average loss: 0.0123, Accuracy: 289/569 (50.7909%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   4,  Average loss: 0.0120, Accuracy: 301/569 (52.8998%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   5,  Average loss: 0.0120, Accuracy: 281/569 (49.3849%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   6,  Average loss: 0.0114, Accuracy: 288/569 (50.6151%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   7,  Average loss: 0.0115, Accuracy: 291/569 (51.1424%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   8,  Average loss: 0.0115, Accuracy: 286/569 (50.2636%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch   9,  Average loss: 0.0113, Accuracy: 311/569 (54.6573%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 41, internal_epoch  10,  Average loss: 0.0115, Accuracy: 279/569 (49.0334%), train_poison_data_count: 288
Global model norm: 15.383906568190932.
Norm before scaling: 15.399507172860831. Distance: 2.465318443667374
Total norm for 10 adversaries is: 15.399507172860831. distance: 2.465318443667374
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.4943, Accuracy: 8167/8968 (91.0682%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   1,  Average loss: 0.0170, Accuracy: 362/522 (69.3487%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   2,  Average loss: 0.0108, Accuracy: 362/522 (69.3487%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   3,  Average loss: 0.0072, Accuracy: 374/522 (71.6475%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   4,  Average loss: 0.0079, Accuracy: 376/522 (72.0307%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   5,  Average loss: 0.0080, Accuracy: 359/522 (68.7739%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   6,  Average loss: 0.0082, Accuracy: 373/522 (71.4559%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   7,  Average loss: 0.0079, Accuracy: 365/522 (69.9234%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   8,  Average loss: 0.0077, Accuracy: 372/522 (71.2644%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch   9,  Average loss: 0.0071, Accuracy: 386/522 (73.9464%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 73, internal_epoch  10,  Average loss: 0.0074, Accuracy: 376/522 (72.0307%), train_poison_data_count: 266
Global model norm: 15.383906568190932.
Norm before scaling: 15.435649560149711. Distance: 2.8696549527834647
Total norm for 10 adversaries is: 15.435649560149711. distance: 2.8696549527834647
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.1495, Accuracy: 8714/8968 (97.1677%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   1,  Average loss: 0.0219, Accuracy: 202/385 (52.4675%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   2,  Average loss: 0.0130, Accuracy: 229/385 (59.4805%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   3,  Average loss: 0.0147, Accuracy: 213/385 (55.3247%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   4,  Average loss: 0.0118, Accuracy: 271/385 (70.3896%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   5,  Average loss: 0.0088, Accuracy: 314/385 (81.5584%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   6,  Average loss: 0.0084, Accuracy: 318/385 (82.5974%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   7,  Average loss: 0.0061, Accuracy: 341/385 (88.5714%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   8,  Average loss: 0.0063, Accuracy: 366/385 (95.0649%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch   9,  Average loss: 0.0039, Accuracy: 371/385 (96.3636%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 51, internal_epoch  10,  Average loss: 0.0039, Accuracy: 374/385 (97.1429%), train_poison_data_count: 193
Global model norm: 15.383906568190932.
Norm before scaling: 15.520078390651031. Distance: 2.7702079774746795
Total norm for 10 adversaries is: 15.520078390651031. distance: 2.7702079774746795
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.1107, Accuracy: 8814/8968 (98.2828%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   1,  Average loss: 0.0133, Accuracy: 428/627 (68.2616%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 559/627 (89.1547%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   3,  Average loss: 0.0020, Accuracy: 605/627 (96.4912%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   4,  Average loss: 0.0018, Accuracy: 602/627 (96.0128%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   5,  Average loss: 0.0014, Accuracy: 610/627 (97.2887%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   6,  Average loss: 0.0015, Accuracy: 605/627 (96.4912%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   7,  Average loss: 0.0012, Accuracy: 615/627 (98.0861%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   8,  Average loss: 0.0011, Accuracy: 615/627 (98.0861%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch   9,  Average loss: 0.0011, Accuracy: 613/627 (97.7671%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 74, internal_epoch  10,  Average loss: 0.0008, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Global model norm: 15.383906568190932.
Norm before scaling: 15.632854471145556. Distance: 2.8139225223343374
Total norm for 10 adversaries is: 15.632854471145556. distance: 2.8139225223343374
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0188, Accuracy: 8906/8968 (99.3087%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 3, internal_epoch   1,  Average loss: 0.0243, Accuracy: 258/516 (50.0000%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 3, internal_epoch   2,  Average loss: 0.0150, Accuracy: 259/516 (50.1938%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 3, internal_epoch   3,  Average loss: 0.0169, Accuracy: 260/516 (50.3876%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 3, internal_epoch   4,  Average loss: 0.0145, Accuracy: 251/516 (48.6434%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 3, internal_epoch   5,  Average loss: 0.0130, Accuracy: 274/516 (53.1008%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 3, internal_epoch   6,  Average loss: 0.0133, Accuracy: 263/516 (50.9690%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 3, internal_epoch   7,  Average loss: 0.0135, Accuracy: 249/516 (48.2558%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 3, internal_epoch   8,  Average loss: 0.0128, Accuracy: 256/516 (49.6124%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 3, internal_epoch   9,  Average loss: 0.0126, Accuracy: 272/516 (52.7132%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 3, internal_epoch  10,  Average loss: 0.0130, Accuracy: 264/516 (51.1628%), train_poison_data_count: 260
Global model norm: 15.383906568190932.
Norm before scaling: 15.484914021584343. Distance: 3.276265745681831
Total norm for 10 adversaries is: 15.484914021584343. distance: 3.276265745681831
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.5999, Accuracy: 8095/8968 (90.2654%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 18, internal_epoch   1,  Average loss: 0.0205, Accuracy: 368/759 (48.4848%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 18, internal_epoch   2,  Average loss: 0.0130, Accuracy: 379/759 (49.9341%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 18, internal_epoch   3,  Average loss: 0.0116, Accuracy: 418/759 (55.0725%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 18, internal_epoch   4,  Average loss: 0.0116, Accuracy: 414/759 (54.5455%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 18, internal_epoch   5,  Average loss: 0.0115, Accuracy: 427/759 (56.2582%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 18, internal_epoch   6,  Average loss: 0.0113, Accuracy: 437/759 (57.5758%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 18, internal_epoch   7,  Average loss: 0.0109, Accuracy: 476/759 (62.7141%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 18, internal_epoch   8,  Average loss: 0.0105, Accuracy: 504/759 (66.4032%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 18, internal_epoch   9,  Average loss: 0.0104, Accuracy: 533/759 (70.2240%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 18, internal_epoch  10,  Average loss: 0.0099, Accuracy: 552/759 (72.7273%), train_poison_data_count: 384
Global model norm: 15.383906568190932.
Norm before scaling: 15.601899427539914. Distance: 3.651697699378535
Total norm for 10 adversaries is: 15.601899427539914. distance: 3.651697699378535
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.2923, Accuracy: 8586/8968 (95.7404%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 29, internal_epoch   1,  Average loss: 0.0195, Accuracy: 257/506 (50.7905%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 29, internal_epoch   2,  Average loss: 0.0112, Accuracy: 330/506 (65.2174%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 29, internal_epoch   3,  Average loss: 0.0064, Accuracy: 439/506 (86.7589%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 29, internal_epoch   4,  Average loss: 0.0046, Accuracy: 464/506 (91.6996%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 29, internal_epoch   5,  Average loss: 0.0034, Accuracy: 485/506 (95.8498%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 29, internal_epoch   6,  Average loss: 0.0021, Accuracy: 498/506 (98.4190%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 29, internal_epoch   7,  Average loss: 0.0018, Accuracy: 498/506 (98.4190%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 29, internal_epoch   8,  Average loss: 0.0012, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 29, internal_epoch   9,  Average loss: 0.0009, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 29, internal_epoch  10,  Average loss: 0.0011, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Global model norm: 15.383906568190932.
Norm before scaling: 15.62617964297016. Distance: 3.1350549296992303
Total norm for 10 adversaries is: 15.62617964297016. distance: 3.1350549296992303
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.1947, Accuracy: 8307/8968 (92.6293%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 62, internal_epoch   1,  Average loss: 0.0123, Accuracy: 417/580 (71.8966%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 62, internal_epoch   2,  Average loss: 0.0048, Accuracy: 543/580 (93.6207%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 62, internal_epoch   3,  Average loss: 0.0026, Accuracy: 538/580 (92.7586%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 62, internal_epoch   4,  Average loss: 0.0016, Accuracy: 559/580 (96.3793%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 62, internal_epoch   5,  Average loss: 0.0015, Accuracy: 563/580 (97.0690%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 62, internal_epoch   6,  Average loss: 0.0013, Accuracy: 566/580 (97.5862%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 62, internal_epoch   7,  Average loss: 0.0010, Accuracy: 567/580 (97.7586%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 62, internal_epoch   8,  Average loss: 0.0015, Accuracy: 567/580 (97.7586%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 62, internal_epoch   9,  Average loss: 0.0009, Accuracy: 568/580 (97.9310%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 62, internal_epoch  10,  Average loss: 0.0010, Accuracy: 566/580 (97.5862%), train_poison_data_count: 292
Global model norm: 15.383906568190932.
Norm before scaling: 15.612730045624279. Distance: 2.54468371901055
Total norm for 10 adversaries is: 15.612730045624279. distance: 2.54468371901055
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0156, Accuracy: 8911/8968 (99.3644%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 33, internal_epoch   1,  Average loss: 0.0216, Accuracy: 282/587 (48.0409%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 33, internal_epoch   2,  Average loss: 0.0150, Accuracy: 296/587 (50.4259%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 33, internal_epoch   3,  Average loss: 0.0144, Accuracy: 297/587 (50.5963%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 33, internal_epoch   4,  Average loss: 0.0135, Accuracy: 294/587 (50.0852%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 33, internal_epoch   5,  Average loss: 0.0127, Accuracy: 303/587 (51.6184%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 33, internal_epoch   6,  Average loss: 0.0128, Accuracy: 301/587 (51.2777%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 33, internal_epoch   7,  Average loss: 0.0130, Accuracy: 286/587 (48.7223%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 33, internal_epoch   8,  Average loss: 0.0126, Accuracy: 311/587 (52.9813%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 33, internal_epoch   9,  Average loss: 0.0126, Accuracy: 289/587 (49.2334%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 33, internal_epoch  10,  Average loss: 0.0126, Accuracy: 287/587 (48.8927%), train_poison_data_count: 299
Global model norm: 15.383906568190932.
Norm before scaling: 15.479954216467997. Distance: 2.847710000617975
Total norm for 10 adversaries is: 15.479954216467997. distance: 2.847710000617975
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.4516, Accuracy: 8276/8968 (92.2837%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 88, internal_epoch   1,  Average loss: 0.0156, Accuracy: 469/734 (63.8965%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 88, internal_epoch   2,  Average loss: 0.0104, Accuracy: 473/734 (64.4414%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 88, internal_epoch   3,  Average loss: 0.0101, Accuracy: 457/734 (62.2616%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 88, internal_epoch   4,  Average loss: 0.0091, Accuracy: 484/734 (65.9401%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 88, internal_epoch   5,  Average loss: 0.0092, Accuracy: 466/734 (63.4877%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 88, internal_epoch   6,  Average loss: 0.0088, Accuracy: 479/734 (65.2589%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 88, internal_epoch   7,  Average loss: 0.0089, Accuracy: 465/734 (63.3515%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 88, internal_epoch   8,  Average loss: 0.0084, Accuracy: 517/734 (70.4360%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 88, internal_epoch   9,  Average loss: 0.0086, Accuracy: 502/734 (68.3924%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 88, internal_epoch  10,  Average loss: 0.0086, Accuracy: 499/734 (67.9837%), train_poison_data_count: 382
Global model norm: 15.383906568190932.
Norm before scaling: 15.519915676084501. Distance: 3.050668868218586
Total norm for 10 adversaries is: 15.519915676084501. distance: 3.050668868218586
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.2080, Accuracy: 8775/8968 (97.8479%)
___Train Local_Simple,  epoch  24, local model 15, internal_epoch   1,  Average loss: 0.0012, Accuracy: 276/282 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.9589, Accuracy: 6902/10000 (69.0200%)
___Train Local_Simple,  epoch  24, local model 59, internal_epoch   1,  Average loss: 0.0012, Accuracy: 632/644 (98.1366%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 7.0776, Accuracy: 3030/10000 (30.3000%)
___Train Local_Simple,  epoch  24, local model 63, internal_epoch   1,  Average loss: 0.0032, Accuracy: 289/303 (95.3795%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.5054, Accuracy: 5840/10000 (58.4000%)
___Train Local_Simple,  epoch  24, local model 57, internal_epoch   1,  Average loss: 0.0024, Accuracy: 501/523 (95.7935%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 6.6277, Accuracy: 3226/10000 (32.2600%)
___Train Local_Simple,  epoch  24, local model 99, internal_epoch   1,  Average loss: 0.0036, Accuracy: 674/712 (94.6629%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 3.4478, Accuracy: 4190/10000 (41.9000%)
___Train Local_Simple,  epoch  24, local model 40, internal_epoch   1,  Average loss: 0.0029, Accuracy: 465/498 (93.3735%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 14.6786, Accuracy: 2206/10000 (22.0600%)
___Train Local_Simple,  epoch  24, local model 7, internal_epoch   1,  Average loss: 0.0008, Accuracy: 792/802 (98.7531%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 5.1199, Accuracy: 4429/10000 (44.2900%)
___Train Local_Simple,  epoch  24, local model 52, internal_epoch   1,  Average loss: 0.0043, Accuracy: 710/789 (89.9873%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 5.6622, Accuracy: 3126/10000 (31.2600%)
___Train Local_Simple,  epoch  24, local model 42, internal_epoch   1,  Average loss: 0.0018, Accuracy: 454/473 (95.9831%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 4.5990, Accuracy: 4386/10000 (43.8600%)
___Train Local_Simple,  epoch  24, local model 47, internal_epoch   1,  Average loss: 0.0035, Accuracy: 500/534 (93.6330%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 7.1694, Accuracy: 3830/10000 (38.3000%)
___Train Local_Simple,  epoch  24, local model 19, internal_epoch   1,  Average loss: 0.0011, Accuracy: 581/598 (97.1572%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 5.0525, Accuracy: 2933/10000 (29.3300%)
___Train Local_Simple,  epoch  24, local model 2, internal_epoch   1,  Average loss: 0.0021, Accuracy: 541/564 (95.9220%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 3.9403, Accuracy: 3415/10000 (34.1500%)
___Train Local_Simple,  epoch  24, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 540/561 (96.2567%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.1677, Accuracy: 5005/10000 (50.0500%)
___Train Local_Simple,  epoch  24, local model 93, internal_epoch   1,  Average loss: 0.0025, Accuracy: 591/630 (93.8095%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 5.0195, Accuracy: 3025/10000 (30.2500%)
___Train Local_Simple,  epoch  24, local model 43, internal_epoch   1,  Average loss: 0.0014, Accuracy: 422/431 (97.9118%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.2369, Accuracy: 5603/10000 (56.0300%)
___Train Local_Simple,  epoch  24, local model 91, internal_epoch   1,  Average loss: 0.0023, Accuracy: 785/819 (95.8486%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 9.9183, Accuracy: 2934/10000 (29.3400%)
___Train Local_Simple,  epoch  24, local model 49, internal_epoch   1,  Average loss: 0.0028, Accuracy: 337/355 (94.9296%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.6948, Accuracy: 4495/10000 (44.9500%)
___Train Local_Simple,  epoch  24, local model 5, internal_epoch   1,  Average loss: 0.0026, Accuracy: 545/578 (94.2907%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 3.8006, Accuracy: 4318/10000 (43.1800%)
___Train Local_Simple,  epoch  24, local model 26, internal_epoch   1,  Average loss: 0.0039, Accuracy: 490/519 (94.4123%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 11.3303, Accuracy: 2080/10000 (20.8000%)
___Train Local_Simple,  epoch  24, local model 84, internal_epoch   1,  Average loss: 0.0028, Accuracy: 403/420 (95.9524%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.9954, Accuracy: 7335/10000 (73.3500%)
___Train Local_Simple,  epoch  24, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 739/772 (95.7254%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 4.4841, Accuracy: 3846/10000 (38.4600%)
___Train Local_Simple,  epoch  24, local model 11, internal_epoch   1,  Average loss: 0.0010, Accuracy: 545/554 (98.3755%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.9450, Accuracy: 6583/10000 (65.8300%)
___Train Local_Simple,  epoch  24, local model 12, internal_epoch   1,  Average loss: 0.0012, Accuracy: 709/725 (97.7931%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 3.2899, Accuracy: 5217/10000 (52.1700%)
___Train Local_Simple,  epoch  24, local model 8, internal_epoch   1,  Average loss: 0.0031, Accuracy: 656/706 (92.9178%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 8.7561, Accuracy: 2998/10000 (29.9800%)
___Train Local_Simple,  epoch  24, local model 95, internal_epoch   1,  Average loss: 0.0089, Accuracy: 527/600 (87.8333%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 4.2953, Accuracy: 3764/10000 (37.6400%)
___Train Local_Simple,  epoch  24, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 695/713 (97.4755%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 3.9316, Accuracy: 4015/10000 (40.1500%)
___Train Local_Simple,  epoch  24, local model 27, internal_epoch   1,  Average loss: 0.0018, Accuracy: 716/745 (96.1074%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 5.7337, Accuracy: 3122/10000 (31.2200%)
___Train Local_Simple,  epoch  24, local model 89, internal_epoch   1,  Average loss: 0.0060, Accuracy: 606/683 (88.7262%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 5.0141, Accuracy: 3413/10000 (34.1300%)
___Train Local_Simple,  epoch  24, local model 68, internal_epoch   1,  Average loss: 0.0022, Accuracy: 528/549 (96.1749%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.3548, Accuracy: 4487/10000 (44.8700%)
___Train Local_Simple,  epoch  24, local model 30, internal_epoch   1,  Average loss: 0.0017, Accuracy: 430/443 (97.0655%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.5787, Accuracy: 5711/10000 (57.1100%)
___Train Local_Simple,  epoch  24, local model 37, internal_epoch   1,  Average loss: 0.0042, Accuracy: 418/456 (91.6667%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 6.1596, Accuracy: 3989/10000 (39.8900%)
___Train Local_Simple,  epoch  24, local model 31, internal_epoch   1,  Average loss: 0.0012, Accuracy: 582/596 (97.6510%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.8203, Accuracy: 5012/10000 (50.1200%)
___Train Local_Simple,  epoch  24, local model 60, internal_epoch   1,  Average loss: 0.0018, Accuracy: 552/571 (96.6725%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 6.5427, Accuracy: 2963/10000 (29.6300%)
___Train Local_Simple,  epoch  24, local model 1, internal_epoch   1,  Average loss: 0.0007, Accuracy: 530/536 (98.8806%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.8811, Accuracy: 7571/10000 (75.7100%)
___Train Local_Simple,  epoch  24, local model 87, internal_epoch   1,  Average loss: 0.0038, Accuracy: 611/663 (92.1569%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 4.5342, Accuracy: 3441/10000 (34.4100%)
___Train Local_Simple,  epoch  24, local model 0, internal_epoch   1,  Average loss: 0.0048, Accuracy: 395/435 (90.8046%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 5.5070, Accuracy: 3418/10000 (34.1800%)
___Train Local_Simple,  epoch  24, local model 77, internal_epoch   1,  Average loss: 0.0034, Accuracy: 582/618 (94.1748%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 5.7336, Accuracy: 3224/10000 (32.2400%)
___Train Local_Simple,  epoch  24, local model 80, internal_epoch   1,  Average loss: 0.0026, Accuracy: 506/532 (95.1128%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 6.8702, Accuracy: 2440/10000 (24.4000%)
___Train Local_Simple,  epoch  24, local model 67, internal_epoch   1,  Average loss: 0.0030, Accuracy: 415/441 (94.1043%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 3.9261, Accuracy: 3383/10000 (33.8300%)
___Train Local_Simple,  epoch  24, local model 55, internal_epoch   1,  Average loss: 0.0022, Accuracy: 360/375 (96.0000%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.7274, Accuracy: 5773/10000 (57.7300%)
___Train Local_Simple,  epoch  24, local model 14, internal_epoch   1,  Average loss: 0.0037, Accuracy: 642/692 (92.7746%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 5.0656, Accuracy: 3652/10000 (36.5200%)
___Train Local_Simple,  epoch  24, local model 23, internal_epoch   1,  Average loss: 0.0018, Accuracy: 526/542 (97.0480%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.9813, Accuracy: 3806/10000 (38.0600%)
___Train Local_Simple,  epoch  24, local model 78, internal_epoch   1,  Average loss: 0.0038, Accuracy: 548/587 (93.3560%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 5.1274, Accuracy: 2806/10000 (28.0600%)
___Train Local_Simple,  epoch  24, local model 64, internal_epoch   1,  Average loss: 0.0012, Accuracy: 595/608 (97.8618%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 3.8483, Accuracy: 4244/10000 (42.4400%)
___Train Local_Simple,  epoch  24, local model 24, internal_epoch   1,  Average loss: 0.0020, Accuracy: 463/477 (97.0650%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 3.3546, Accuracy: 3345/10000 (33.4500%)
___Train Local_Simple,  epoch  24, local model 86, internal_epoch   1,  Average loss: 0.0032, Accuracy: 657/692 (94.9422%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 8.6320, Accuracy: 2075/10000 (20.7500%)
___Train Local_Simple,  epoch  24, local model 81, internal_epoch   1,  Average loss: 0.0018, Accuracy: 618/636 (97.1698%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 3.2694, Accuracy: 3677/10000 (36.7700%)
___Train Local_Simple,  epoch  24, local model 85, internal_epoch   1,  Average loss: 0.0026, Accuracy: 760/807 (94.1760%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 3.7975, Accuracy: 4176/10000 (41.7600%)
___Train Local_Simple,  epoch  24, local model 28, internal_epoch   1,  Average loss: 0.0032, Accuracy: 572/611 (93.6170%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 8.3263, Accuracy: 3286/10000 (32.8600%)
___Train Local_Simple,  epoch  24, local model 56, internal_epoch   1,  Average loss: 0.0020, Accuracy: 689/715 (96.3636%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 8.0026, Accuracy: 3163/10000 (31.6300%)
___Train Local_Simple,  epoch  24, local model 34, internal_epoch   1,  Average loss: 0.0023, Accuracy: 828/871 (95.0631%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 8.9242, Accuracy: 2754/10000 (27.5400%)
___Train Local_Simple,  epoch  24, local model 35, internal_epoch   1,  Average loss: 0.0012, Accuracy: 617/630 (97.9365%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 5.1225, Accuracy: 3459/10000 (34.5900%)
___Train Local_Simple,  epoch  24, local model 46, internal_epoch   1,  Average loss: 0.0012, Accuracy: 635/650 (97.6923%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 4.8723, Accuracy: 3213/10000 (32.1300%)
___Train Local_Simple,  epoch  24, local model 66, internal_epoch   1,  Average loss: 0.0032, Accuracy: 689/733 (93.9973%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 3.6367, Accuracy: 3695/10000 (36.9500%)
___Train Local_Simple,  epoch  24, local model 17, internal_epoch   1,  Average loss: 0.0012, Accuracy: 519/527 (98.4820%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 5.6231, Accuracy: 3071/10000 (30.7100%)
___Train Local_Simple,  epoch  24, local model 65, internal_epoch   1,  Average loss: 0.0021, Accuracy: 600/621 (96.6184%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.0097, Accuracy: 4721/10000 (47.2100%)
___Train Local_Simple,  epoch  24, local model 6, internal_epoch   1,  Average loss: 0.0012, Accuracy: 426/435 (97.9310%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.6211, Accuracy: 5675/10000 (56.7500%)
___Train Local_Simple,  epoch  24, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 587/615 (95.4472%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 4.3119, Accuracy: 4953/10000 (49.5300%)
___Train Local_Simple,  epoch  24, local model 20, internal_epoch   1,  Average loss: 0.0021, Accuracy: 580/602 (96.3455%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 5.0412, Accuracy: 3550/10000 (35.5000%)
___Train Local_Simple,  epoch  24, local model 4, internal_epoch   1,  Average loss: 0.0013, Accuracy: 735/748 (98.2620%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.4786, Accuracy: 5197/10000 (51.9700%)
___Train Local_Simple,  epoch  24, local model 50, internal_epoch   1,  Average loss: 0.0023, Accuracy: 458/477 (96.0168%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.4336, Accuracy: 4462/10000 (44.6200%)
___Train Local_Simple,  epoch  24, local model 72, internal_epoch   1,  Average loss: 0.0018, Accuracy: 407/423 (96.2175%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.9946, Accuracy: 3474/10000 (34.7400%)
___Train Local_Simple,  epoch  24, local model 70, internal_epoch   1,  Average loss: 0.0031, Accuracy: 532/568 (93.6620%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 8.5358, Accuracy: 2831/10000 (28.3100%)
___Train Local_Simple,  epoch  24, local model 45, internal_epoch   1,  Average loss: 0.0025, Accuracy: 618/647 (95.5178%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 7.1723, Accuracy: 3235/10000 (32.3500%)
___Train Local_Simple,  epoch  24, local model 38, internal_epoch   1,  Average loss: 0.0013, Accuracy: 469/477 (98.3229%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.7118, Accuracy: 5588/10000 (55.8800%)
___Train Local_Simple,  epoch  24, local model 32, internal_epoch   1,  Average loss: 0.0027, Accuracy: 565/590 (95.7627%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 5.0824, Accuracy: 4617/10000 (46.1700%)
___Train Local_Simple,  epoch  24, local model 94, internal_epoch   1,  Average loss: 0.0013, Accuracy: 655/671 (97.6155%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 6.3116, Accuracy: 3645/10000 (36.4500%)
___Train Local_Simple,  epoch  24, local model 10, internal_epoch   1,  Average loss: 0.0033, Accuracy: 539/573 (94.0663%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 3.1192, Accuracy: 4469/10000 (44.6900%)
___Train Local_Simple,  epoch  24, local model 79, internal_epoch   1,  Average loss: 0.0016, Accuracy: 643/661 (97.2769%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.0344, Accuracy: 4760/10000 (47.6000%)
___Train Local_Simple,  epoch  24, local model 22, internal_epoch   1,  Average loss: 0.0009, Accuracy: 257/262 (98.0916%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.7746, Accuracy: 7863/10000 (78.6300%)
___Train Local_Simple,  epoch  24, local model 16, internal_epoch   1,  Average loss: 0.0012, Accuracy: 802/817 (98.1640%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 6.9226, Accuracy: 3147/10000 (31.4700%)
___Train Local_Simple,  epoch  24, local model 53, internal_epoch   1,  Average loss: 0.0013, Accuracy: 549/561 (97.8610%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.8505, Accuracy: 4674/10000 (46.7400%)
___Train Local_Simple,  epoch  24, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 504/548 (91.9708%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 9.1292, Accuracy: 2545/10000 (25.4500%)
___Train Local_Simple,  epoch  24, local model 82, internal_epoch   1,  Average loss: 0.0023, Accuracy: 777/815 (95.3374%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 10.9060, Accuracy: 2933/10000 (29.3300%)
___Train Local_Simple,  epoch  24, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 309/315 (98.0952%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.9173, Accuracy: 7065/10000 (70.6500%)
___Train Local_Simple,  epoch  24, local model 44, internal_epoch   1,  Average loss: 0.0007, Accuracy: 555/561 (98.9305%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.9357, Accuracy: 5252/10000 (52.5200%)
___Train Local_Simple,  epoch  24, local model 97, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1087/1112 (97.7518%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 6.9468, Accuracy: 3277/10000 (32.7700%)
___Train Local_Simple,  epoch  24, local model 61, internal_epoch   1,  Average loss: 0.0019, Accuracy: 279/287 (97.2125%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.8753, Accuracy: 7271/10000 (72.7100%)
___Train Local_Simple,  epoch  24, local model 92, internal_epoch   1,  Average loss: 0.0036, Accuracy: 565/611 (92.4714%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 5.0601, Accuracy: 3664/10000 (36.6400%)
___Train Local_Simple,  epoch  24, local model 76, internal_epoch   1,  Average loss: 0.0024, Accuracy: 441/459 (96.0784%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.1452, Accuracy: 6408/10000 (64.0800%)
___Train Local_Simple,  epoch  24, local model 39, internal_epoch   1,  Average loss: 0.0016, Accuracy: 480/493 (97.3631%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.3046, Accuracy: 5362/10000 (53.6200%)
___Train Local_Simple,  epoch  24, local model 25, internal_epoch   1,  Average loss: 0.0006, Accuracy: 587/592 (99.1554%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 4.2290, Accuracy: 3839/10000 (38.3900%)
___Train Local_Simple,  epoch  24, local model 96, internal_epoch   1,  Average loss: 0.0015, Accuracy: 514/531 (96.7985%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 8.8041, Accuracy: 2893/10000 (28.9300%)
___Train Local_Simple,  epoch  24, local model 21, internal_epoch   1,  Average loss: 0.0010, Accuracy: 670/687 (97.5255%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 5.1627, Accuracy: 3401/10000 (34.0100%)
___Train Local_Simple,  epoch  24, local model 9, internal_epoch   1,  Average loss: 0.0035, Accuracy: 477/508 (93.8976%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 6.1318, Accuracy: 3949/10000 (39.4900%)
___Train Local_Simple,  epoch  24, local model 54, internal_epoch   1,  Average loss: 0.0019, Accuracy: 802/832 (96.3942%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 9.1366, Accuracy: 2981/10000 (29.8100%)
___Train Local_Simple,  epoch  24, local model 83, internal_epoch   1,  Average loss: 0.0015, Accuracy: 346/360 (96.1111%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.9647, Accuracy: 7113/10000 (71.1300%)
___Train Local_Simple,  epoch  24, local model 75, internal_epoch   1,  Average loss: 0.0068, Accuracy: 676/763 (88.5976%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.9762, Accuracy: 3436/10000 (34.3600%)
___Train Local_Simple,  epoch  24, local model 69, internal_epoch   1,  Average loss: 0.0018, Accuracy: 650/671 (96.8703%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 4.3369, Accuracy: 3298/10000 (32.9800%)
___Train Local_Simple,  epoch  24, local model 48, internal_epoch   1,  Average loss: 0.0037, Accuracy: 333/363 (91.7355%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.5348, Accuracy: 5966/10000 (59.6600%)
time spent on training: 363.053551197052
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 0.2638, Accuracy: 9206/10000 (92.0600%)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 4.7296, Accuracy: 74/8968 (0.8252%)
saving model
Done in 392.98413348197937 sec.
Server Epoch:25 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 12, 47, 37, 13, 16, 46, 22, 60, 58, 26, 43, 98, 36, 67, 9, 39, 30, 63, 19, 68, 81, 28, 40, 72, 70, 34, 27, 77, 75, 24, 65, 4, 66, 80, 84, 57, 11, 76, 23, 5, 42, 1, 21, 8, 17, 2, 95, 48, 35, 99, 54, 38, 44, 92, 96, 61, 20, 85, 82, 52, 0, 89, 83, 56, 87, 55, 7, 93, 31, 86, 15, 71, 59, 25, 69, 45, 50, 97, 14, 10, 78, 49, 90, 32, 91, 64, 6, 53, 79, 94].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   1,  Average loss: 0.0238, Accuracy: 284/569 (49.9121%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   2,  Average loss: 0.0146, Accuracy: 294/569 (51.6696%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   3,  Average loss: 0.0127, Accuracy: 284/569 (49.9121%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   4,  Average loss: 0.0116, Accuracy: 312/569 (54.8330%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   5,  Average loss: 0.0120, Accuracy: 290/569 (50.9666%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   6,  Average loss: 0.0117, Accuracy: 284/569 (49.9121%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   7,  Average loss: 0.0119, Accuracy: 278/569 (48.8576%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   8,  Average loss: 0.0115, Accuracy: 277/569 (48.6819%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch   9,  Average loss: 0.0119, Accuracy: 274/569 (48.1547%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 41, internal_epoch  10,  Average loss: 0.0115, Accuracy: 287/569 (50.4394%), train_poison_data_count: 288
Global model norm: 15.40231056219478.
Norm before scaling: 15.476564964821863. Distance: 2.9741261841838926
Total norm for 10 adversaries is: 15.476564964821863. distance: 2.9741261841838926
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.4504, Accuracy: 7815/8968 (87.1432%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   1,  Average loss: 0.0149, Accuracy: 353/522 (67.6245%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   2,  Average loss: 0.0095, Accuracy: 370/522 (70.8812%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   3,  Average loss: 0.0125, Accuracy: 362/522 (69.3487%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   4,  Average loss: 0.0082, Accuracy: 357/522 (68.3908%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   5,  Average loss: 0.0075, Accuracy: 374/522 (71.6475%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   6,  Average loss: 0.0078, Accuracy: 373/522 (71.4559%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   7,  Average loss: 0.0076, Accuracy: 377/522 (72.2222%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   8,  Average loss: 0.0076, Accuracy: 386/522 (73.9464%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   9,  Average loss: 0.0075, Accuracy: 384/522 (73.5632%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch  10,  Average loss: 0.0074, Accuracy: 374/522 (71.6475%), train_poison_data_count: 266
Global model norm: 15.40231056219478.
Norm before scaling: 15.44495190366874. Distance: 2.5843356146803806
Total norm for 10 adversaries is: 15.44495190366874. distance: 2.5843356146803806
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1719, Accuracy: 8667/8968 (96.6436%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   1,  Average loss: 0.0249, Accuracy: 188/385 (48.8312%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   2,  Average loss: 0.0155, Accuracy: 199/385 (51.6883%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   3,  Average loss: 0.0136, Accuracy: 221/385 (57.4026%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   4,  Average loss: 0.0115, Accuracy: 280/385 (72.7273%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   5,  Average loss: 0.0101, Accuracy: 287/385 (74.5455%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   6,  Average loss: 0.0078, Accuracy: 329/385 (85.4545%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   7,  Average loss: 0.0064, Accuracy: 326/385 (84.6753%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   8,  Average loss: 0.0046, Accuracy: 353/385 (91.6883%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch   9,  Average loss: 0.0036, Accuracy: 366/385 (95.0649%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 51, internal_epoch  10,  Average loss: 0.0037, Accuracy: 364/385 (94.5455%), train_poison_data_count: 193
Global model norm: 15.40231056219478.
Norm before scaling: 15.533657816061366. Distance: 2.9903101198256903
Total norm for 10 adversaries is: 15.533657816061366. distance: 2.9903101198256903
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1215, Accuracy: 8777/8968 (97.8702%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   1,  Average loss: 0.0109, Accuracy: 460/627 (73.3652%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   2,  Average loss: 0.0030, Accuracy: 580/627 (92.5040%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   3,  Average loss: 0.0016, Accuracy: 603/627 (96.1722%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   4,  Average loss: 0.0011, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   5,  Average loss: 0.0010, Accuracy: 613/627 (97.7671%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   6,  Average loss: 0.0011, Accuracy: 616/627 (98.2456%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   7,  Average loss: 0.0007, Accuracy: 616/627 (98.2456%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   8,  Average loss: 0.0007, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   9,  Average loss: 0.0007, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch  10,  Average loss: 0.0009, Accuracy: 614/627 (97.9266%), train_poison_data_count: 320
Global model norm: 15.40231056219478.
Norm before scaling: 15.635923915753068. Distance: 3.0536631552065967
Total norm for 10 adversaries is: 15.635923915753068. distance: 3.0536631552065967
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0128, Accuracy: 8923/8968 (99.4982%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   1,  Average loss: 0.0253, Accuracy: 239/516 (46.3178%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   2,  Average loss: 0.0212, Accuracy: 256/516 (49.6124%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   3,  Average loss: 0.0155, Accuracy: 264/516 (51.1628%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   4,  Average loss: 0.0148, Accuracy: 265/516 (51.3566%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   5,  Average loss: 0.0138, Accuracy: 264/516 (51.1628%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   6,  Average loss: 0.0131, Accuracy: 254/516 (49.2248%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   7,  Average loss: 0.0127, Accuracy: 261/516 (50.5814%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   8,  Average loss: 0.0128, Accuracy: 260/516 (50.3876%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   9,  Average loss: 0.0128, Accuracy: 271/516 (52.5194%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch  10,  Average loss: 0.0126, Accuracy: 264/516 (51.1628%), train_poison_data_count: 260
Global model norm: 15.40231056219478.
Norm before scaling: 15.627928924703552. Distance: 4.099913870674388
Total norm for 10 adversaries is: 15.627928924703552. distance: 4.099913870674388
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.6454, Accuracy: 7946/8968 (88.6039%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 18, internal_epoch   1,  Average loss: 0.0215, Accuracy: 385/759 (50.7246%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 18, internal_epoch   2,  Average loss: 0.0130, Accuracy: 384/759 (50.5929%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 18, internal_epoch   3,  Average loss: 0.0120, Accuracy: 408/759 (53.7549%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 18, internal_epoch   4,  Average loss: 0.0118, Accuracy: 387/759 (50.9881%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 18, internal_epoch   5,  Average loss: 0.0116, Accuracy: 407/759 (53.6232%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 18, internal_epoch   6,  Average loss: 0.0116, Accuracy: 408/759 (53.7549%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 18, internal_epoch   7,  Average loss: 0.0115, Accuracy: 379/759 (49.9341%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 18, internal_epoch   8,  Average loss: 0.0113, Accuracy: 401/759 (52.8327%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 18, internal_epoch   9,  Average loss: 0.0113, Accuracy: 432/759 (56.9170%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 18, internal_epoch  10,  Average loss: 0.0111, Accuracy: 426/759 (56.1265%), train_poison_data_count: 384
Global model norm: 15.40231056219478.
Norm before scaling: 15.566805692020601. Distance: 3.3834728274848924
Total norm for 10 adversaries is: 15.566805692020601. distance: 3.3834728274848924
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.4409, Accuracy: 7644/8968 (85.2364%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 29, internal_epoch   1,  Average loss: 0.0230, Accuracy: 254/506 (50.1976%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 29, internal_epoch   2,  Average loss: 0.0133, Accuracy: 312/506 (61.6601%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 29, internal_epoch   3,  Average loss: 0.0073, Accuracy: 434/506 (85.7708%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 29, internal_epoch   4,  Average loss: 0.0056, Accuracy: 463/506 (91.5020%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 29, internal_epoch   5,  Average loss: 0.0046, Accuracy: 478/506 (94.4664%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 29, internal_epoch   6,  Average loss: 0.0032, Accuracy: 489/506 (96.6403%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 29, internal_epoch   7,  Average loss: 0.0021, Accuracy: 498/506 (98.4190%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 29, internal_epoch   8,  Average loss: 0.0019, Accuracy: 494/506 (97.6285%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 29, internal_epoch   9,  Average loss: 0.0014, Accuracy: 499/506 (98.6166%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 29, internal_epoch  10,  Average loss: 0.0014, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Global model norm: 15.40231056219478.
Norm before scaling: 15.626369568883245. Distance: 3.2487699675230752
Total norm for 10 adversaries is: 15.626369568883245. distance: 3.2487699675230752
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.2046, Accuracy: 8213/8968 (91.5812%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 62, internal_epoch   1,  Average loss: 0.0112, Accuracy: 421/580 (72.5862%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 62, internal_epoch   2,  Average loss: 0.0036, Accuracy: 545/580 (93.9655%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 62, internal_epoch   3,  Average loss: 0.0018, Accuracy: 561/580 (96.7241%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 62, internal_epoch   4,  Average loss: 0.0017, Accuracy: 560/580 (96.5517%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 62, internal_epoch   5,  Average loss: 0.0012, Accuracy: 568/580 (97.9310%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 62, internal_epoch   6,  Average loss: 0.0012, Accuracy: 566/580 (97.5862%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 62, internal_epoch   7,  Average loss: 0.0017, Accuracy: 564/580 (97.2414%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 62, internal_epoch   8,  Average loss: 0.0011, Accuracy: 566/580 (97.5862%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 62, internal_epoch   9,  Average loss: 0.0011, Accuracy: 567/580 (97.7586%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 62, internal_epoch  10,  Average loss: 0.0013, Accuracy: 565/580 (97.4138%), train_poison_data_count: 292
Global model norm: 15.40231056219478.
Norm before scaling: 15.651144143106. Distance: 2.9210154855246495
Total norm for 10 adversaries is: 15.651144143106. distance: 2.9210154855246495
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0112, Accuracy: 8930/8968 (99.5763%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 33, internal_epoch   1,  Average loss: 0.0230, Accuracy: 292/587 (49.7445%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 33, internal_epoch   2,  Average loss: 0.0149, Accuracy: 291/587 (49.5741%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 33, internal_epoch   3,  Average loss: 0.0152, Accuracy: 288/587 (49.0630%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 33, internal_epoch   4,  Average loss: 0.0133, Accuracy: 303/587 (51.6184%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 33, internal_epoch   5,  Average loss: 0.0133, Accuracy: 302/587 (51.4480%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 33, internal_epoch   6,  Average loss: 0.0131, Accuracy: 307/587 (52.2998%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 33, internal_epoch   7,  Average loss: 0.0128, Accuracy: 298/587 (50.7666%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 33, internal_epoch   8,  Average loss: 0.0127, Accuracy: 294/587 (50.0852%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 33, internal_epoch   9,  Average loss: 0.0126, Accuracy: 306/587 (52.1295%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 33, internal_epoch  10,  Average loss: 0.0127, Accuracy: 300/587 (51.1073%), train_poison_data_count: 299
Global model norm: 15.40231056219478.
Norm before scaling: 15.494439388940119. Distance: 3.1726695601750783
Total norm for 10 adversaries is: 15.494439388940119. distance: 3.1726695601750783
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.4751, Accuracy: 7822/8968 (87.2212%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 88, internal_epoch   1,  Average loss: 0.0150, Accuracy: 457/734 (62.2616%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 88, internal_epoch   2,  Average loss: 0.0101, Accuracy: 464/734 (63.2153%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 88, internal_epoch   3,  Average loss: 0.0096, Accuracy: 469/734 (63.8965%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 88, internal_epoch   4,  Average loss: 0.0090, Accuracy: 479/734 (65.2589%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 88, internal_epoch   5,  Average loss: 0.0089, Accuracy: 478/734 (65.1226%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 88, internal_epoch   6,  Average loss: 0.0087, Accuracy: 483/734 (65.8038%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 88, internal_epoch   7,  Average loss: 0.0087, Accuracy: 498/734 (67.8474%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 88, internal_epoch   8,  Average loss: 0.0087, Accuracy: 494/734 (67.3025%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 88, internal_epoch   9,  Average loss: 0.0088, Accuracy: 475/734 (64.7139%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 88, internal_epoch  10,  Average loss: 0.0088, Accuracy: 490/734 (66.7575%), train_poison_data_count: 382
Global model norm: 15.40231056219478.
Norm before scaling: 15.515546815796215. Distance: 3.0335678205578045
Total norm for 10 adversaries is: 15.515546815796215. distance: 3.0335678205578045
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.2364, Accuracy: 8720/8968 (97.2346%)
___Train Local_Simple,  epoch  25, local model 12, internal_epoch   1,  Average loss: 0.0009, Accuracy: 711/725 (98.0690%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.7010, Accuracy: 4168/10000 (41.6800%)
___Train Local_Simple,  epoch  25, local model 47, internal_epoch   1,  Average loss: 0.0013, Accuracy: 524/534 (98.1273%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 2.8327, Accuracy: 5093/10000 (50.9300%)
___Train Local_Simple,  epoch  25, local model 37, internal_epoch   1,  Average loss: 0.0018, Accuracy: 450/456 (98.6842%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.3788, Accuracy: 6058/10000 (60.5800%)
___Train Local_Simple,  epoch  25, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 697/713 (97.7560%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 7.2541, Accuracy: 2969/10000 (29.6900%)
___Train Local_Simple,  epoch  25, local model 16, internal_epoch   1,  Average loss: 0.0010, Accuracy: 804/817 (98.4088%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.2783, Accuracy: 4485/10000 (44.8500%)
___Train Local_Simple,  epoch  25, local model 46, internal_epoch   1,  Average loss: 0.0013, Accuracy: 632/650 (97.2308%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 4.1122, Accuracy: 4435/10000 (44.3500%)
___Train Local_Simple,  epoch  25, local model 22, internal_epoch   1,  Average loss: 0.0014, Accuracy: 250/262 (95.4198%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 2.0083, Accuracy: 6709/10000 (67.0900%)
___Train Local_Simple,  epoch  25, local model 60, internal_epoch   1,  Average loss: 0.0025, Accuracy: 544/571 (95.2715%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 8.5186, Accuracy: 2956/10000 (29.5600%)
___Train Local_Simple,  epoch  25, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 730/772 (94.5596%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 14.1478, Accuracy: 1938/10000 (19.3800%)
___Train Local_Simple,  epoch  25, local model 26, internal_epoch   1,  Average loss: 0.0013, Accuracy: 507/519 (97.6879%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 2.7824, Accuracy: 5001/10000 (50.0100%)
___Train Local_Simple,  epoch  25, local model 43, internal_epoch   1,  Average loss: 0.0012, Accuracy: 423/431 (98.1439%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 2.0019, Accuracy: 5970/10000 (59.7000%)
___Train Local_Simple,  epoch  25, local model 98, internal_epoch   1,  Average loss: 0.0020, Accuracy: 528/548 (96.3504%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 4.5972, Accuracy: 3673/10000 (36.7300%)
___Train Local_Simple,  epoch  25, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 307/315 (97.4603%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.5589, Accuracy: 8057/10000 (80.5700%)
___Train Local_Simple,  epoch  25, local model 67, internal_epoch   1,  Average loss: 0.0025, Accuracy: 421/441 (95.4649%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.8521, Accuracy: 3714/10000 (37.1400%)
___Train Local_Simple,  epoch  25, local model 9, internal_epoch   1,  Average loss: 0.0012, Accuracy: 498/508 (98.0315%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.6210, Accuracy: 5654/10000 (56.5400%)
___Train Local_Simple,  epoch  25, local model 39, internal_epoch   1,  Average loss: 0.0013, Accuracy: 478/493 (96.9574%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.3919, Accuracy: 5219/10000 (52.1900%)
___Train Local_Simple,  epoch  25, local model 30, internal_epoch   1,  Average loss: 0.0011, Accuracy: 432/443 (97.5169%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 2.1754, Accuracy: 6252/10000 (62.5200%)
___Train Local_Simple,  epoch  25, local model 63, internal_epoch   1,  Average loss: 0.0036, Accuracy: 281/303 (92.7393%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 2.4823, Accuracy: 4791/10000 (47.9100%)
___Train Local_Simple,  epoch  25, local model 19, internal_epoch   1,  Average loss: 0.0015, Accuracy: 580/598 (96.9900%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 5.7665, Accuracy: 2956/10000 (29.5600%)
___Train Local_Simple,  epoch  25, local model 68, internal_epoch   1,  Average loss: 0.0032, Accuracy: 522/549 (95.0820%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 5.4208, Accuracy: 3458/10000 (34.5800%)
___Train Local_Simple,  epoch  25, local model 81, internal_epoch   1,  Average loss: 0.0023, Accuracy: 613/636 (96.3836%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 2.9445, Accuracy: 4245/10000 (42.4500%)
___Train Local_Simple,  epoch  25, local model 28, internal_epoch   1,  Average loss: 0.0017, Accuracy: 590/611 (96.5630%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.7935, Accuracy: 5023/10000 (50.2300%)
___Train Local_Simple,  epoch  25, local model 40, internal_epoch   1,  Average loss: 0.0005, Accuracy: 496/498 (99.5984%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.5916, Accuracy: 4585/10000 (45.8500%)
___Train Local_Simple,  epoch  25, local model 72, internal_epoch   1,  Average loss: 0.0037, Accuracy: 395/423 (93.3806%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 4.8281, Accuracy: 3501/10000 (35.0100%)
___Train Local_Simple,  epoch  25, local model 70, internal_epoch   1,  Average loss: 0.0024, Accuracy: 542/568 (95.4225%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 5.7702, Accuracy: 2934/10000 (29.3400%)
___Train Local_Simple,  epoch  25, local model 34, internal_epoch   1,  Average loss: 0.0024, Accuracy: 829/871 (95.1780%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 4.8873, Accuracy: 4105/10000 (41.0500%)
___Train Local_Simple,  epoch  25, local model 27, internal_epoch   1,  Average loss: 0.0026, Accuracy: 706/745 (94.7651%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 8.0648, Accuracy: 3079/10000 (30.7900%)
___Train Local_Simple,  epoch  25, local model 77, internal_epoch   1,  Average loss: 0.0030, Accuracy: 584/618 (94.4984%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 2.6424, Accuracy: 4830/10000 (48.3000%)
___Train Local_Simple,  epoch  25, local model 75, internal_epoch   1,  Average loss: 0.0022, Accuracy: 726/763 (95.1507%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 9.3305, Accuracy: 2750/10000 (27.5000%)
___Train Local_Simple,  epoch  25, local model 24, internal_epoch   1,  Average loss: 0.0026, Accuracy: 454/477 (95.1782%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.1138, Accuracy: 3827/10000 (38.2700%)
___Train Local_Simple,  epoch  25, local model 65, internal_epoch   1,  Average loss: 0.0020, Accuracy: 588/621 (94.6860%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.2145, Accuracy: 3809/10000 (38.0900%)
___Train Local_Simple,  epoch  25, local model 4, internal_epoch   1,  Average loss: 0.0013, Accuracy: 732/748 (97.8610%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.3638, Accuracy: 4042/10000 (40.4200%)
___Train Local_Simple,  epoch  25, local model 66, internal_epoch   1,  Average loss: 0.0036, Accuracy: 681/733 (92.9059%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 2.9358, Accuracy: 4202/10000 (42.0200%)
___Train Local_Simple,  epoch  25, local model 80, internal_epoch   1,  Average loss: 0.0119, Accuracy: 472/532 (88.7218%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.9242, Accuracy: 3000/10000 (30.0000%)
___Train Local_Simple,  epoch  25, local model 84, internal_epoch   1,  Average loss: 0.0016, Accuracy: 407/420 (96.9048%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.8556, Accuracy: 6582/10000 (65.8200%)
___Train Local_Simple,  epoch  25, local model 57, internal_epoch   1,  Average loss: 0.0010, Accuracy: 512/523 (97.8967%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 2.8865, Accuracy: 3801/10000 (38.0100%)
___Train Local_Simple,  epoch  25, local model 11, internal_epoch   1,  Average loss: 0.0012, Accuracy: 540/554 (97.4729%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 2.7166, Accuracy: 5985/10000 (59.8500%)
___Train Local_Simple,  epoch  25, local model 76, internal_epoch   1,  Average loss: 0.0026, Accuracy: 432/459 (94.1176%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.0530, Accuracy: 5035/10000 (50.3500%)
___Train Local_Simple,  epoch  25, local model 23, internal_epoch   1,  Average loss: 0.0026, Accuracy: 519/542 (95.7565%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 6.1269, Accuracy: 2920/10000 (29.2000%)
___Train Local_Simple,  epoch  25, local model 5, internal_epoch   1,  Average loss: 0.0022, Accuracy: 552/578 (95.5017%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 2.0437, Accuracy: 6008/10000 (60.0800%)
___Train Local_Simple,  epoch  25, local model 42, internal_epoch   1,  Average loss: 0.0006, Accuracy: 470/473 (99.3658%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.2150, Accuracy: 6410/10000 (64.1000%)
___Train Local_Simple,  epoch  25, local model 1, internal_epoch   1,  Average loss: 0.0009, Accuracy: 529/536 (98.6940%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.6253, Accuracy: 7222/10000 (72.2200%)
___Train Local_Simple,  epoch  25, local model 21, internal_epoch   1,  Average loss: 0.0011, Accuracy: 672/687 (97.8166%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 4.6854, Accuracy: 3640/10000 (36.4000%)
___Train Local_Simple,  epoch  25, local model 8, internal_epoch   1,  Average loss: 0.0010, Accuracy: 692/706 (98.0170%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.2373, Accuracy: 4731/10000 (47.3100%)
___Train Local_Simple,  epoch  25, local model 17, internal_epoch   1,  Average loss: 0.0010, Accuracy: 514/527 (97.5332%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.7408, Accuracy: 3988/10000 (39.8800%)
___Train Local_Simple,  epoch  25, local model 2, internal_epoch   1,  Average loss: 0.0019, Accuracy: 540/564 (95.7447%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 6.9737, Accuracy: 2897/10000 (28.9700%)
___Train Local_Simple,  epoch  25, local model 95, internal_epoch   1,  Average loss: 0.0027, Accuracy: 581/600 (96.8333%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 2.6771, Accuracy: 5098/10000 (50.9800%)
___Train Local_Simple,  epoch  25, local model 48, internal_epoch   1,  Average loss: 0.0023, Accuracy: 349/363 (96.1433%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.1381, Accuracy: 6779/10000 (67.7900%)
___Train Local_Simple,  epoch  25, local model 35, internal_epoch   1,  Average loss: 0.0018, Accuracy: 608/630 (96.5079%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 6.0482, Accuracy: 3454/10000 (34.5400%)
___Train Local_Simple,  epoch  25, local model 99, internal_epoch   1,  Average loss: 0.0038, Accuracy: 659/712 (92.5562%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 5.4013, Accuracy: 2801/10000 (28.0100%)
___Train Local_Simple,  epoch  25, local model 54, internal_epoch   1,  Average loss: 0.0011, Accuracy: 812/832 (97.5962%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 5.0360, Accuracy: 3305/10000 (33.0500%)
___Train Local_Simple,  epoch  25, local model 38, internal_epoch   1,  Average loss: 0.0015, Accuracy: 466/477 (97.6939%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.4291, Accuracy: 6450/10000 (64.5000%)
___Train Local_Simple,  epoch  25, local model 44, internal_epoch   1,  Average loss: 0.0005, Accuracy: 556/561 (99.1087%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 2.2556, Accuracy: 6338/10000 (63.3800%)
___Train Local_Simple,  epoch  25, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 557/611 (91.1620%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 6.5876, Accuracy: 2267/10000 (22.6700%)
___Train Local_Simple,  epoch  25, local model 96, internal_epoch   1,  Average loss: 0.0013, Accuracy: 517/531 (97.3635%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.2288, Accuracy: 4754/10000 (47.5400%)
___Train Local_Simple,  epoch  25, local model 61, internal_epoch   1,  Average loss: 0.0022, Accuracy: 270/287 (94.0767%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.4418, Accuracy: 6487/10000 (64.8700%)
___Train Local_Simple,  epoch  25, local model 20, internal_epoch   1,  Average loss: 0.0014, Accuracy: 587/602 (97.5083%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.1910, Accuracy: 4761/10000 (47.6100%)
___Train Local_Simple,  epoch  25, local model 85, internal_epoch   1,  Average loss: 0.0028, Accuracy: 761/807 (94.2999%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 4.0214, Accuracy: 4032/10000 (40.3200%)
___Train Local_Simple,  epoch  25, local model 82, internal_epoch   1,  Average loss: 0.0012, Accuracy: 796/815 (97.6687%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 10.6594, Accuracy: 2955/10000 (29.5500%)
___Train Local_Simple,  epoch  25, local model 52, internal_epoch   1,  Average loss: 0.0020, Accuracy: 753/789 (95.4373%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 4.4450, Accuracy: 3649/10000 (36.4900%)
___Train Local_Simple,  epoch  25, local model 0, internal_epoch   1,  Average loss: 0.0012, Accuracy: 426/435 (97.9310%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.7358, Accuracy: 5728/10000 (57.2800%)
___Train Local_Simple,  epoch  25, local model 89, internal_epoch   1,  Average loss: 0.0022, Accuracy: 660/683 (96.6325%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 2.9518, Accuracy: 5399/10000 (53.9900%)
___Train Local_Simple,  epoch  25, local model 83, internal_epoch   1,  Average loss: 0.0023, Accuracy: 341/360 (94.7222%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.5711, Accuracy: 6106/10000 (61.0600%)
___Train Local_Simple,  epoch  25, local model 56, internal_epoch   1,  Average loss: 0.0008, Accuracy: 706/715 (98.7413%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 2.9386, Accuracy: 4211/10000 (42.1100%)
___Train Local_Simple,  epoch  25, local model 87, internal_epoch   1,  Average loss: 0.0019, Accuracy: 643/663 (96.9834%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 5.0551, Accuracy: 3404/10000 (34.0400%)
___Train Local_Simple,  epoch  25, local model 55, internal_epoch   1,  Average loss: 0.0023, Accuracy: 359/375 (95.7333%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 4.1408, Accuracy: 4389/10000 (43.8900%)
___Train Local_Simple,  epoch  25, local model 7, internal_epoch   1,  Average loss: 0.0007, Accuracy: 794/802 (99.0025%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.4305, Accuracy: 4552/10000 (45.5200%)
___Train Local_Simple,  epoch  25, local model 93, internal_epoch   1,  Average loss: 0.0038, Accuracy: 579/630 (91.9048%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 4.9184, Accuracy: 3180/10000 (31.8000%)
___Train Local_Simple,  epoch  25, local model 31, internal_epoch   1,  Average loss: 0.0009, Accuracy: 586/596 (98.3221%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.2638, Accuracy: 5023/10000 (50.2300%)
___Train Local_Simple,  epoch  25, local model 86, internal_epoch   1,  Average loss: 0.0012, Accuracy: 674/692 (97.3988%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 6.6411, Accuracy: 2513/10000 (25.1300%)
___Train Local_Simple,  epoch  25, local model 15, internal_epoch   1,  Average loss: 0.0025, Accuracy: 268/282 (95.0355%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.5738, Accuracy: 6357/10000 (63.5700%)
___Train Local_Simple,  epoch  25, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 538/561 (95.9002%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.1094, Accuracy: 4146/10000 (41.4600%)
___Train Local_Simple,  epoch  25, local model 59, internal_epoch   1,  Average loss: 0.0022, Accuracy: 620/644 (96.2733%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 10.5327, Accuracy: 2414/10000 (24.1400%)
___Train Local_Simple,  epoch  25, local model 25, internal_epoch   1,  Average loss: 0.0008, Accuracy: 585/592 (98.8176%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 4.2712, Accuracy: 4517/10000 (45.1700%)
___Train Local_Simple,  epoch  25, local model 69, internal_epoch   1,  Average loss: 0.0029, Accuracy: 644/671 (95.9762%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 11.5022, Accuracy: 2940/10000 (29.4000%)
___Train Local_Simple,  epoch  25, local model 45, internal_epoch   1,  Average loss: 0.0010, Accuracy: 635/647 (98.1453%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 2.8597, Accuracy: 4154/10000 (41.5400%)
___Train Local_Simple,  epoch  25, local model 50, internal_epoch   1,  Average loss: 0.0018, Accuracy: 464/477 (97.2746%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 4.7144, Accuracy: 3687/10000 (36.8700%)
___Train Local_Simple,  epoch  25, local model 97, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1100/1112 (98.9209%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 7.8205, Accuracy: 2906/10000 (29.0600%)
___Train Local_Simple,  epoch  25, local model 14, internal_epoch   1,  Average loss: 0.0016, Accuracy: 672/692 (97.1098%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 2.2588, Accuracy: 5352/10000 (53.5200%)
___Train Local_Simple,  epoch  25, local model 10, internal_epoch   1,  Average loss: 0.0019, Accuracy: 549/573 (95.8115%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 2.7210, Accuracy: 4304/10000 (43.0400%)
___Train Local_Simple,  epoch  25, local model 78, internal_epoch   1,  Average loss: 0.0043, Accuracy: 539/587 (91.8228%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 5.1864, Accuracy: 3011/10000 (30.1100%)
___Train Local_Simple,  epoch  25, local model 49, internal_epoch   1,  Average loss: 0.0014, Accuracy: 348/355 (98.0282%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.6453, Accuracy: 5683/10000 (56.8300%)
___Train Local_Simple,  epoch  25, local model 90, internal_epoch   1,  Average loss: 0.0018, Accuracy: 590/615 (95.9350%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 4.8413, Accuracy: 3673/10000 (36.7300%)
___Train Local_Simple,  epoch  25, local model 32, internal_epoch   1,  Average loss: 0.0015, Accuracy: 575/590 (97.4576%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 5.3268, Accuracy: 4512/10000 (45.1200%)
___Train Local_Simple,  epoch  25, local model 91, internal_epoch   1,  Average loss: 0.0009, Accuracy: 807/819 (98.5348%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 4.2105, Accuracy: 3284/10000 (32.8400%)
___Train Local_Simple,  epoch  25, local model 64, internal_epoch   1,  Average loss: 0.0010, Accuracy: 599/608 (98.5197%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 4.9702, Accuracy: 4326/10000 (43.2600%)
___Train Local_Simple,  epoch  25, local model 6, internal_epoch   1,  Average loss: 0.0012, Accuracy: 425/435 (97.7011%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.6212, Accuracy: 4944/10000 (49.4400%)
___Train Local_Simple,  epoch  25, local model 53, internal_epoch   1,  Average loss: 0.0013, Accuracy: 544/561 (96.9697%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.8476, Accuracy: 4932/10000 (49.3200%)
___Train Local_Simple,  epoch  25, local model 79, internal_epoch   1,  Average loss: 0.0023, Accuracy: 639/661 (96.6717%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 5.7774, Accuracy: 3418/10000 (34.1800%)
___Train Local_Simple,  epoch  25, local model 94, internal_epoch   1,  Average loss: 0.0013, Accuracy: 655/671 (97.6155%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 4.2542, Accuracy: 4371/10000 (43.7100%)
time spent on training: 360.9742283821106
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 0.2394, Accuracy: 9312/10000 (93.1200%)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 3.7364, Accuracy: 373/8968 (4.1592%)
saving model
Saving model on epoch 25
Done in 390.7220194339752 sec.
Server Epoch:26 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 12, 26, 47, 5, 25, 27, 61, 79, 16, 76, 22, 86, 64, 23, 90, 15, 31, 24, 92, 42, 55, 46, 56, 67, 77, 97, 28, 98, 94, 20, 70, 44, 59, 57, 17, 13, 8, 0, 36, 78, 72, 2, 65, 93, 95, 81, 49, 53, 69, 39, 43, 14, 91, 52, 89, 54, 66, 38, 85, 80, 96, 82, 10, 87, 35, 21, 71, 45, 32, 99, 50, 68, 58, 9, 40, 19, 75, 30, 1, 6, 60, 48, 34, 37, 11, 4, 84, 63, 83, 7].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   1,  Average loss: 0.0200, Accuracy: 275/569 (48.3304%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   2,  Average loss: 0.0138, Accuracy: 294/569 (51.6696%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   3,  Average loss: 0.0123, Accuracy: 298/569 (52.3726%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   4,  Average loss: 0.0120, Accuracy: 274/569 (48.1547%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   5,  Average loss: 0.0123, Accuracy: 278/569 (48.8576%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   6,  Average loss: 0.0117, Accuracy: 281/569 (49.3849%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   7,  Average loss: 0.0119, Accuracy: 274/569 (48.1547%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   8,  Average loss: 0.0114, Accuracy: 298/569 (52.3726%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch   9,  Average loss: 0.0116, Accuracy: 296/569 (52.0211%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 41, internal_epoch  10,  Average loss: 0.0115, Accuracy: 288/569 (50.6151%), train_poison_data_count: 288
Global model norm: 15.41347546240231.
Norm before scaling: 15.430575033809447. Distance: 2.701333836177291
Total norm for 10 adversaries is: 15.430575033809447. distance: 2.701333836177291
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.5979, Accuracy: 6923/8968 (77.1967%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   1,  Average loss: 0.0155, Accuracy: 369/522 (70.6897%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   2,  Average loss: 0.0093, Accuracy: 373/522 (71.4559%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   3,  Average loss: 0.0101, Accuracy: 366/522 (70.1149%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   4,  Average loss: 0.0079, Accuracy: 369/522 (70.6897%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   5,  Average loss: 0.0076, Accuracy: 370/522 (70.8812%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   6,  Average loss: 0.0078, Accuracy: 372/522 (71.2644%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   7,  Average loss: 0.0072, Accuracy: 373/522 (71.4559%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   8,  Average loss: 0.0072, Accuracy: 378/522 (72.4138%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch   9,  Average loss: 0.0073, Accuracy: 368/522 (70.4981%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 73, internal_epoch  10,  Average loss: 0.0076, Accuracy: 372/522 (71.2644%), train_poison_data_count: 266
Global model norm: 15.41347546240231.
Norm before scaling: 15.458066761498014. Distance: 2.536195703548525
Total norm for 10 adversaries is: 15.458066761498014. distance: 2.536195703548525
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1423, Accuracy: 8883/8968 (99.0522%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   1,  Average loss: 0.0242, Accuracy: 193/385 (50.1299%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   2,  Average loss: 0.0143, Accuracy: 209/385 (54.2857%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   3,  Average loss: 0.0108, Accuracy: 266/385 (69.0909%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   4,  Average loss: 0.0097, Accuracy: 297/385 (77.1429%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   5,  Average loss: 0.0082, Accuracy: 259/385 (67.2727%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   6,  Average loss: 0.0062, Accuracy: 328/385 (85.1948%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   7,  Average loss: 0.0047, Accuracy: 353/385 (91.6883%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   8,  Average loss: 0.0036, Accuracy: 373/385 (96.8831%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch   9,  Average loss: 0.0028, Accuracy: 378/385 (98.1818%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 51, internal_epoch  10,  Average loss: 0.0029, Accuracy: 377/385 (97.9221%), train_poison_data_count: 193
Global model norm: 15.41347546240231.
Norm before scaling: 15.576145792493836. Distance: 2.8727335081482743
Total norm for 10 adversaries is: 15.576145792493836. distance: 2.8727335081482743
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1206, Accuracy: 8717/8968 (97.2012%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   1,  Average loss: 0.0120, Accuracy: 457/627 (72.8868%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   2,  Average loss: 0.0037, Accuracy: 572/627 (91.2281%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   3,  Average loss: 0.0014, Accuracy: 609/627 (97.1292%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   4,  Average loss: 0.0012, Accuracy: 613/627 (97.7671%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   5,  Average loss: 0.0009, Accuracy: 615/627 (98.0861%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   6,  Average loss: 0.0008, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   7,  Average loss: 0.0010, Accuracy: 616/627 (98.2456%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   8,  Average loss: 0.0010, Accuracy: 614/627 (97.9266%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch   9,  Average loss: 0.0006, Accuracy: 620/627 (98.8836%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 74, internal_epoch  10,  Average loss: 0.0009, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Global model norm: 15.41347546240231.
Norm before scaling: 15.613128302509558. Distance: 2.5689091431264024
Total norm for 10 adversaries is: 15.613128302509558. distance: 2.5689091431264024
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0113, Accuracy: 8923/8968 (99.4982%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   1,  Average loss: 0.0247, Accuracy: 258/516 (50.0000%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   2,  Average loss: 0.0151, Accuracy: 263/516 (50.9690%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   3,  Average loss: 0.0160, Accuracy: 254/516 (49.2248%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   4,  Average loss: 0.0138, Accuracy: 251/516 (48.6434%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   5,  Average loss: 0.0132, Accuracy: 257/516 (49.8062%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   6,  Average loss: 0.0134, Accuracy: 270/516 (52.3256%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   7,  Average loss: 0.0128, Accuracy: 270/516 (52.3256%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   8,  Average loss: 0.0129, Accuracy: 261/516 (50.5814%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   9,  Average loss: 0.0125, Accuracy: 266/516 (51.5504%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch  10,  Average loss: 0.0124, Accuracy: 279/516 (54.0698%), train_poison_data_count: 260
Global model norm: 15.41347546240231.
Norm before scaling: 15.487337416071808. Distance: 3.196211187181467
Total norm for 10 adversaries is: 15.487337416071808. distance: 3.196211187181467
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.5992, Accuracy: 8230/8968 (91.7707%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 18, internal_epoch   1,  Average loss: 0.0188, Accuracy: 381/759 (50.1976%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 18, internal_epoch   2,  Average loss: 0.0126, Accuracy: 372/759 (49.0119%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 18, internal_epoch   3,  Average loss: 0.0120, Accuracy: 380/759 (50.0659%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 18, internal_epoch   4,  Average loss: 0.0114, Accuracy: 392/759 (51.6469%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 18, internal_epoch   5,  Average loss: 0.0116, Accuracy: 384/759 (50.5929%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 18, internal_epoch   6,  Average loss: 0.0116, Accuracy: 361/759 (47.5626%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 18, internal_epoch   7,  Average loss: 0.0114, Accuracy: 398/759 (52.4374%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 18, internal_epoch   8,  Average loss: 0.0113, Accuracy: 405/759 (53.3597%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 18, internal_epoch   9,  Average loss: 0.0114, Accuracy: 392/759 (51.6469%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 18, internal_epoch  10,  Average loss: 0.0114, Accuracy: 372/759 (49.0119%), train_poison_data_count: 384
Global model norm: 15.41347546240231.
Norm before scaling: 15.51904259235725. Distance: 3.2274134809153963
Total norm for 10 adversaries is: 15.51904259235725. distance: 3.2274134809153963
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.5103, Accuracy: 7708/8968 (85.9500%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 29, internal_epoch   1,  Average loss: 0.0206, Accuracy: 266/506 (52.5692%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 29, internal_epoch   2,  Average loss: 0.0133, Accuracy: 284/506 (56.1265%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 29, internal_epoch   3,  Average loss: 0.0076, Accuracy: 422/506 (83.3992%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 29, internal_epoch   4,  Average loss: 0.0061, Accuracy: 444/506 (87.7470%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 29, internal_epoch   5,  Average loss: 0.0047, Accuracy: 468/506 (92.4901%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 29, internal_epoch   6,  Average loss: 0.0031, Accuracy: 488/506 (96.4427%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 29, internal_epoch   7,  Average loss: 0.0024, Accuracy: 490/506 (96.8379%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 29, internal_epoch   8,  Average loss: 0.0019, Accuracy: 492/506 (97.2332%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 29, internal_epoch   9,  Average loss: 0.0013, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 29, internal_epoch  10,  Average loss: 0.0014, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Global model norm: 15.41347546240231.
Norm before scaling: 15.629392937154801. Distance: 3.2494548927342493
Total norm for 10 adversaries is: 15.629392937154801. distance: 3.2494548927342493
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.2575, Accuracy: 8071/8968 (89.9978%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 62, internal_epoch   1,  Average loss: 0.0107, Accuracy: 437/580 (75.3448%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 62, internal_epoch   2,  Average loss: 0.0052, Accuracy: 511/580 (88.1034%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 62, internal_epoch   3,  Average loss: 0.0018, Accuracy: 557/580 (96.0345%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 62, internal_epoch   4,  Average loss: 0.0016, Accuracy: 563/580 (97.0690%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 62, internal_epoch   5,  Average loss: 0.0014, Accuracy: 564/580 (97.2414%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 62, internal_epoch   6,  Average loss: 0.0012, Accuracy: 563/580 (97.0690%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 62, internal_epoch   7,  Average loss: 0.0014, Accuracy: 566/580 (97.5862%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 62, internal_epoch   8,  Average loss: 0.0009, Accuracy: 571/580 (98.4483%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 62, internal_epoch   9,  Average loss: 0.0011, Accuracy: 565/580 (97.4138%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 62, internal_epoch  10,  Average loss: 0.0012, Accuracy: 566/580 (97.5862%), train_poison_data_count: 292
Global model norm: 15.41347546240231.
Norm before scaling: 15.723923667860236. Distance: 3.052342600220541
Total norm for 10 adversaries is: 15.723923667860236. distance: 3.052342600220541
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0199, Accuracy: 8895/8968 (99.1860%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 33, internal_epoch   1,  Average loss: 0.0217, Accuracy: 281/587 (47.8705%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 33, internal_epoch   2,  Average loss: 0.0140, Accuracy: 297/587 (50.5963%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 33, internal_epoch   3,  Average loss: 0.0173, Accuracy: 287/587 (48.8927%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 33, internal_epoch   4,  Average loss: 0.0132, Accuracy: 298/587 (50.7666%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 33, internal_epoch   5,  Average loss: 0.0129, Accuracy: 307/587 (52.2998%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 33, internal_epoch   6,  Average loss: 0.0131, Accuracy: 299/587 (50.9370%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 33, internal_epoch   7,  Average loss: 0.0126, Accuracy: 301/587 (51.2777%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 33, internal_epoch   8,  Average loss: 0.0128, Accuracy: 302/587 (51.4480%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 33, internal_epoch   9,  Average loss: 0.0122, Accuracy: 320/587 (54.5145%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 33, internal_epoch  10,  Average loss: 0.0123, Accuracy: 294/587 (50.0852%), train_poison_data_count: 299
Global model norm: 15.41347546240231.
Norm before scaling: 15.469090313491389. Distance: 2.8203769158697214
Total norm for 10 adversaries is: 15.469090313491389. distance: 2.8203769158697214
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.4953, Accuracy: 7487/8968 (83.4857%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 88, internal_epoch   1,  Average loss: 0.0135, Accuracy: 471/734 (64.1689%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 88, internal_epoch   2,  Average loss: 0.0113, Accuracy: 484/734 (65.9401%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 88, internal_epoch   3,  Average loss: 0.0118, Accuracy: 464/734 (63.2153%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 88, internal_epoch   4,  Average loss: 0.0096, Accuracy: 456/734 (62.1253%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 88, internal_epoch   5,  Average loss: 0.0091, Accuracy: 482/734 (65.6676%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 88, internal_epoch   6,  Average loss: 0.0091, Accuracy: 479/734 (65.2589%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 88, internal_epoch   7,  Average loss: 0.0089, Accuracy: 483/734 (65.8038%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 88, internal_epoch   8,  Average loss: 0.0083, Accuracy: 502/734 (68.3924%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 88, internal_epoch   9,  Average loss: 0.0084, Accuracy: 508/734 (69.2098%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 88, internal_epoch  10,  Average loss: 0.0086, Accuracy: 492/734 (67.0300%), train_poison_data_count: 382
Global model norm: 15.41347546240231.
Norm before scaling: 15.492314063558915. Distance: 2.5320443684756877
Total norm for 10 adversaries is: 15.492314063558915. distance: 2.5320443684756877
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.2071, Accuracy: 8657/8968 (96.5321%)
___Train Local_Simple,  epoch  26, local model 12, internal_epoch   1,  Average loss: 0.0010, Accuracy: 712/725 (98.2069%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 3.0486, Accuracy: 4700/10000 (47.0000%)
___Train Local_Simple,  epoch  26, local model 26, internal_epoch   1,  Average loss: 0.0026, Accuracy: 493/519 (94.9904%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 5.6182, Accuracy: 4162/10000 (41.6200%)
___Train Local_Simple,  epoch  26, local model 47, internal_epoch   1,  Average loss: 0.0021, Accuracy: 511/534 (95.6929%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 6.8538, Accuracy: 4283/10000 (42.8300%)
___Train Local_Simple,  epoch  26, local model 5, internal_epoch   1,  Average loss: 0.0014, Accuracy: 563/578 (97.4048%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 4.4243, Accuracy: 4103/10000 (41.0300%)
___Train Local_Simple,  epoch  26, local model 25, internal_epoch   1,  Average loss: 0.0004, Accuracy: 588/592 (99.3243%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 2.6135, Accuracy: 5308/10000 (53.0800%)
___Train Local_Simple,  epoch  26, local model 27, internal_epoch   1,  Average loss: 0.0012, Accuracy: 727/745 (97.5839%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 7.7725, Accuracy: 2452/10000 (24.5200%)
___Train Local_Simple,  epoch  26, local model 61, internal_epoch   1,  Average loss: 0.0014, Accuracy: 277/287 (96.5157%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.6147, Accuracy: 7931/10000 (79.3100%)
___Train Local_Simple,  epoch  26, local model 79, internal_epoch   1,  Average loss: 0.0014, Accuracy: 650/661 (98.3359%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.5087, Accuracy: 6145/10000 (61.4500%)
___Train Local_Simple,  epoch  26, local model 16, internal_epoch   1,  Average loss: 0.0006, Accuracy: 807/817 (98.7760%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 3.0568, Accuracy: 4662/10000 (46.6200%)
___Train Local_Simple,  epoch  26, local model 76, internal_epoch   1,  Average loss: 0.0016, Accuracy: 448/459 (97.6035%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.0995, Accuracy: 6579/10000 (65.7900%)
___Train Local_Simple,  epoch  26, local model 22, internal_epoch   1,  Average loss: 0.0008, Accuracy: 258/262 (98.4733%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.7183, Accuracy: 7846/10000 (78.4600%)
___Train Local_Simple,  epoch  26, local model 86, internal_epoch   1,  Average loss: 0.0013, Accuracy: 676/692 (97.6879%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 8.2289, Accuracy: 2067/10000 (20.6700%)
___Train Local_Simple,  epoch  26, local model 64, internal_epoch   1,  Average loss: 0.0007, Accuracy: 601/608 (98.8487%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 2.3986, Accuracy: 5335/10000 (53.3500%)
___Train Local_Simple,  epoch  26, local model 23, internal_epoch   1,  Average loss: 0.0018, Accuracy: 527/542 (97.2325%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 2.8449, Accuracy: 4212/10000 (42.1200%)
___Train Local_Simple,  epoch  26, local model 90, internal_epoch   1,  Average loss: 0.0027, Accuracy: 580/615 (94.3089%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 3.0256, Accuracy: 4406/10000 (44.0600%)
___Train Local_Simple,  epoch  26, local model 15, internal_epoch   1,  Average loss: 0.0012, Accuracy: 277/282 (98.2270%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.7861, Accuracy: 7315/10000 (73.1500%)
___Train Local_Simple,  epoch  26, local model 31, internal_epoch   1,  Average loss: 0.0009, Accuracy: 587/596 (98.4899%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 2.0941, Accuracy: 5773/10000 (57.7300%)
___Train Local_Simple,  epoch  26, local model 24, internal_epoch   1,  Average loss: 0.0022, Accuracy: 461/477 (96.6457%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.7216, Accuracy: 5088/10000 (50.8800%)
___Train Local_Simple,  epoch  26, local model 92, internal_epoch   1,  Average loss: 0.0049, Accuracy: 553/611 (90.5074%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 2.4956, Accuracy: 4531/10000 (45.3100%)
___Train Local_Simple,  epoch  26, local model 42, internal_epoch   1,  Average loss: 0.0011, Accuracy: 469/473 (99.1543%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 3.9345, Accuracy: 4548/10000 (45.4800%)
___Train Local_Simple,  epoch  26, local model 55, internal_epoch   1,  Average loss: 0.0020, Accuracy: 360/375 (96.0000%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.8216, Accuracy: 5913/10000 (59.1300%)
___Train Local_Simple,  epoch  26, local model 46, internal_epoch   1,  Average loss: 0.0010, Accuracy: 641/650 (98.6154%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 3.3265, Accuracy: 4366/10000 (43.6600%)
___Train Local_Simple,  epoch  26, local model 56, internal_epoch   1,  Average loss: 0.0009, Accuracy: 706/715 (98.7413%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 5.1760, Accuracy: 3799/10000 (37.9900%)
___Train Local_Simple,  epoch  26, local model 67, internal_epoch   1,  Average loss: 0.0024, Accuracy: 421/441 (95.4649%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 4.2720, Accuracy: 3278/10000 (32.7800%)
___Train Local_Simple,  epoch  26, local model 77, internal_epoch   1,  Average loss: 0.0027, Accuracy: 580/618 (93.8511%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 4.8216, Accuracy: 3273/10000 (32.7300%)
___Train Local_Simple,  epoch  26, local model 97, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1099/1112 (98.8309%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 8.7337, Accuracy: 2930/10000 (29.3000%)
___Train Local_Simple,  epoch  26, local model 28, internal_epoch   1,  Average loss: 0.0029, Accuracy: 576/611 (94.2717%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 7.0349, Accuracy: 4142/10000 (41.4200%)
___Train Local_Simple,  epoch  26, local model 98, internal_epoch   1,  Average loss: 0.0045, Accuracy: 515/548 (93.9781%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 6.7140, Accuracy: 2779/10000 (27.7900%)
___Train Local_Simple,  epoch  26, local model 94, internal_epoch   1,  Average loss: 0.0012, Accuracy: 656/671 (97.7645%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 3.8302, Accuracy: 4848/10000 (48.4800%)
___Train Local_Simple,  epoch  26, local model 20, internal_epoch   1,  Average loss: 0.0029, Accuracy: 578/602 (96.0133%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 2.2980, Accuracy: 5191/10000 (51.9100%)
___Train Local_Simple,  epoch  26, local model 70, internal_epoch   1,  Average loss: 0.0026, Accuracy: 542/568 (95.4225%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 4.5373, Accuracy: 3290/10000 (32.9000%)
___Train Local_Simple,  epoch  26, local model 44, internal_epoch   1,  Average loss: 0.0006, Accuracy: 556/561 (99.1087%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 2.8005, Accuracy: 5036/10000 (50.3600%)
___Train Local_Simple,  epoch  26, local model 59, internal_epoch   1,  Average loss: 0.0014, Accuracy: 626/644 (97.2050%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 3.1765, Accuracy: 4262/10000 (42.6200%)
___Train Local_Simple,  epoch  26, local model 57, internal_epoch   1,  Average loss: 0.0015, Accuracy: 509/523 (97.3231%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 5.8284, Accuracy: 3210/10000 (32.1000%)
___Train Local_Simple,  epoch  26, local model 17, internal_epoch   1,  Average loss: 0.0008, Accuracy: 518/527 (98.2922%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 3.4586, Accuracy: 3646/10000 (36.4600%)
___Train Local_Simple,  epoch  26, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 695/713 (97.4755%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 3.6911, Accuracy: 3765/10000 (37.6500%)
___Train Local_Simple,  epoch  26, local model 8, internal_epoch   1,  Average loss: 0.0034, Accuracy: 681/706 (96.4589%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 21.7641, Accuracy: 1522/10000 (15.2200%)
___Train Local_Simple,  epoch  26, local model 0, internal_epoch   1,  Average loss: 0.0020, Accuracy: 416/435 (95.6322%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 5.4675, Accuracy: 4287/10000 (42.8700%)
___Train Local_Simple,  epoch  26, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 303/315 (96.1905%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.7488, Accuracy: 7835/10000 (78.3500%)
___Train Local_Simple,  epoch  26, local model 78, internal_epoch   1,  Average loss: 0.0040, Accuracy: 545/587 (92.8450%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 3.1000, Accuracy: 4329/10000 (43.2900%)
___Train Local_Simple,  epoch  26, local model 72, internal_epoch   1,  Average loss: 0.0018, Accuracy: 411/423 (97.1631%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 2.3969, Accuracy: 3859/10000 (38.5900%)
___Train Local_Simple,  epoch  26, local model 2, internal_epoch   1,  Average loss: 0.0016, Accuracy: 544/564 (96.4539%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 3.0544, Accuracy: 3947/10000 (39.4700%)
___Train Local_Simple,  epoch  26, local model 65, internal_epoch   1,  Average loss: 0.0021, Accuracy: 600/621 (96.6184%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.5337, Accuracy: 5517/10000 (55.1700%)
___Train Local_Simple,  epoch  26, local model 93, internal_epoch   1,  Average loss: 0.0023, Accuracy: 599/630 (95.0794%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 5.0889, Accuracy: 2977/10000 (29.7700%)
___Train Local_Simple,  epoch  26, local model 95, internal_epoch   1,  Average loss: 0.0040, Accuracy: 562/600 (93.6667%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 7.9930, Accuracy: 2727/10000 (27.2700%)
___Train Local_Simple,  epoch  26, local model 81, internal_epoch   1,  Average loss: 0.0024, Accuracy: 604/636 (94.9686%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 2.2701, Accuracy: 5057/10000 (50.5700%)
___Train Local_Simple,  epoch  26, local model 49, internal_epoch   1,  Average loss: 0.0028, Accuracy: 338/355 (95.2113%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 4.3957, Accuracy: 3993/10000 (39.9300%)
___Train Local_Simple,  epoch  26, local model 53, internal_epoch   1,  Average loss: 0.0012, Accuracy: 548/561 (97.6827%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 2.9762, Accuracy: 4833/10000 (48.3300%)
___Train Local_Simple,  epoch  26, local model 69, internal_epoch   1,  Average loss: 0.0020, Accuracy: 650/671 (96.8703%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 3.2630, Accuracy: 3471/10000 (34.7100%)
___Train Local_Simple,  epoch  26, local model 39, internal_epoch   1,  Average loss: 0.0011, Accuracy: 484/493 (98.1744%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 2.3580, Accuracy: 5491/10000 (54.9100%)
___Train Local_Simple,  epoch  26, local model 43, internal_epoch   1,  Average loss: 0.0011, Accuracy: 424/431 (98.3759%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.6670, Accuracy: 6045/10000 (60.4500%)
___Train Local_Simple,  epoch  26, local model 14, internal_epoch   1,  Average loss: 0.0019, Accuracy: 664/692 (95.9538%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 4.5134, Accuracy: 3629/10000 (36.2900%)
___Train Local_Simple,  epoch  26, local model 91, internal_epoch   1,  Average loss: 0.0014, Accuracy: 799/819 (97.5580%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 10.1702, Accuracy: 2765/10000 (27.6500%)
___Train Local_Simple,  epoch  26, local model 52, internal_epoch   1,  Average loss: 0.0025, Accuracy: 747/789 (94.6768%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 8.5733, Accuracy: 3358/10000 (33.5800%)
___Train Local_Simple,  epoch  26, local model 89, internal_epoch   1,  Average loss: 0.0048, Accuracy: 627/683 (91.8009%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 5.1660, Accuracy: 4443/10000 (44.4300%)
___Train Local_Simple,  epoch  26, local model 54, internal_epoch   1,  Average loss: 0.0013, Accuracy: 813/832 (97.7163%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 8.9154, Accuracy: 3078/10000 (30.7800%)
___Train Local_Simple,  epoch  26, local model 66, internal_epoch   1,  Average loss: 0.0028, Accuracy: 697/733 (95.0887%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 4.1305, Accuracy: 3326/10000 (33.2600%)
___Train Local_Simple,  epoch  26, local model 38, internal_epoch   1,  Average loss: 0.0015, Accuracy: 467/477 (97.9036%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.0353, Accuracy: 6880/10000 (68.8000%)
___Train Local_Simple,  epoch  26, local model 85, internal_epoch   1,  Average loss: 0.0016, Accuracy: 781/807 (96.7782%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 5.5096, Accuracy: 3886/10000 (38.8600%)
___Train Local_Simple,  epoch  26, local model 80, internal_epoch   1,  Average loss: 0.0019, Accuracy: 514/532 (96.6165%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 6.9473, Accuracy: 2816/10000 (28.1600%)
___Train Local_Simple,  epoch  26, local model 96, internal_epoch   1,  Average loss: 0.0013, Accuracy: 517/531 (97.3635%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 4.9419, Accuracy: 3819/10000 (38.1900%)
___Train Local_Simple,  epoch  26, local model 82, internal_epoch   1,  Average loss: 0.0015, Accuracy: 794/815 (97.4233%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 6.8471, Accuracy: 2963/10000 (29.6300%)
___Train Local_Simple,  epoch  26, local model 10, internal_epoch   1,  Average loss: 0.0019, Accuracy: 546/573 (95.2880%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 3.2784, Accuracy: 4830/10000 (48.3000%)
___Train Local_Simple,  epoch  26, local model 87, internal_epoch   1,  Average loss: 0.0018, Accuracy: 641/663 (96.6817%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 6.4362, Accuracy: 2902/10000 (29.0200%)
___Train Local_Simple,  epoch  26, local model 35, internal_epoch   1,  Average loss: 0.0015, Accuracy: 610/630 (96.8254%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 7.2403, Accuracy: 3056/10000 (30.5600%)
___Train Local_Simple,  epoch  26, local model 21, internal_epoch   1,  Average loss: 0.0009, Accuracy: 672/687 (97.8166%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 4.6271, Accuracy: 3389/10000 (33.8900%)
___Train Local_Simple,  epoch  26, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 545/561 (97.1480%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.7081, Accuracy: 5461/10000 (54.6100%)
___Train Local_Simple,  epoch  26, local model 45, internal_epoch   1,  Average loss: 0.0017, Accuracy: 629/647 (97.2179%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 7.9436, Accuracy: 3076/10000 (30.7600%)
___Train Local_Simple,  epoch  26, local model 32, internal_epoch   1,  Average loss: 0.0021, Accuracy: 561/590 (95.0847%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 6.4586, Accuracy: 4146/10000 (41.4600%)
___Train Local_Simple,  epoch  26, local model 99, internal_epoch   1,  Average loss: 0.0033, Accuracy: 665/712 (93.3989%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 2.5843, Accuracy: 4467/10000 (44.6700%)
___Train Local_Simple,  epoch  26, local model 50, internal_epoch   1,  Average loss: 0.0015, Accuracy: 467/477 (97.9036%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 2.4721, Accuracy: 4838/10000 (48.3800%)
___Train Local_Simple,  epoch  26, local model 68, internal_epoch   1,  Average loss: 0.0018, Accuracy: 533/549 (97.0856%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 2.1862, Accuracy: 4826/10000 (48.2600%)
___Train Local_Simple,  epoch  26, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 757/772 (98.0570%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 6.2122, Accuracy: 2866/10000 (28.6600%)
___Train Local_Simple,  epoch  26, local model 9, internal_epoch   1,  Average loss: 0.0022, Accuracy: 485/508 (95.4724%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 4.7277, Accuracy: 4271/10000 (42.7100%)
___Train Local_Simple,  epoch  26, local model 40, internal_epoch   1,  Average loss: 0.0018, Accuracy: 482/498 (96.7871%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 10.6854, Accuracy: 2916/10000 (29.1600%)
___Train Local_Simple,  epoch  26, local model 19, internal_epoch   1,  Average loss: 0.0017, Accuracy: 580/598 (96.9900%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 4.4488, Accuracy: 2947/10000 (29.4700%)
___Train Local_Simple,  epoch  26, local model 75, internal_epoch   1,  Average loss: 0.0024, Accuracy: 724/763 (94.8886%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 3.7915, Accuracy: 3572/10000 (35.7200%)
___Train Local_Simple,  epoch  26, local model 30, internal_epoch   1,  Average loss: 0.0016, Accuracy: 434/443 (97.9684%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.6473, Accuracy: 6390/10000 (63.9000%)
___Train Local_Simple,  epoch  26, local model 1, internal_epoch   1,  Average loss: 0.0006, Accuracy: 530/536 (98.8806%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.6791, Accuracy: 7857/10000 (78.5700%)
___Train Local_Simple,  epoch  26, local model 6, internal_epoch   1,  Average loss: 0.0009, Accuracy: 427/435 (98.1609%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 2.6688, Accuracy: 5757/10000 (57.5700%)
___Train Local_Simple,  epoch  26, local model 60, internal_epoch   1,  Average loss: 0.0019, Accuracy: 550/571 (96.3222%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 2.5875, Accuracy: 3902/10000 (39.0200%)
___Train Local_Simple,  epoch  26, local model 48, internal_epoch   1,  Average loss: 0.0027, Accuracy: 341/363 (93.9394%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 2.0623, Accuracy: 5334/10000 (53.3400%)
___Train Local_Simple,  epoch  26, local model 34, internal_epoch   1,  Average loss: 0.0033, Accuracy: 814/871 (93.4558%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 3.4172, Accuracy: 4048/10000 (40.4800%)
___Train Local_Simple,  epoch  26, local model 37, internal_epoch   1,  Average loss: 0.0024, Accuracy: 437/456 (95.8333%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 5.2930, Accuracy: 4516/10000 (45.1600%)
___Train Local_Simple,  epoch  26, local model 11, internal_epoch   1,  Average loss: 0.0009, Accuracy: 547/554 (98.7365%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.0314, Accuracy: 7474/10000 (74.7400%)
___Train Local_Simple,  epoch  26, local model 4, internal_epoch   1,  Average loss: 0.0008, Accuracy: 737/748 (98.5294%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 4.4547, Accuracy: 3390/10000 (33.9000%)
___Train Local_Simple,  epoch  26, local model 84, internal_epoch   1,  Average loss: 0.0012, Accuracy: 409/420 (97.3810%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.2184, Accuracy: 7286/10000 (72.8600%)
___Train Local_Simple,  epoch  26, local model 63, internal_epoch   1,  Average loss: 0.0020, Accuracy: 291/303 (96.0396%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.5831, Accuracy: 5901/10000 (59.0100%)
___Train Local_Simple,  epoch  26, local model 83, internal_epoch   1,  Average loss: 0.0015, Accuracy: 348/360 (96.6667%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.8674, Accuracy: 7250/10000 (72.5000%)
___Train Local_Simple,  epoch  26, local model 7, internal_epoch   1,  Average loss: 0.0009, Accuracy: 787/802 (98.1297%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 3.8099, Accuracy: 4366/10000 (43.6600%)
time spent on training: 357.7649178504944
___Test Target_Simple poisoned: False, epoch: 26: Average loss: 0.2094, Accuracy: 9342/10000 (93.4200%)
___Test Target_Simple poisoned: True, epoch: 26: Average loss: 4.8840, Accuracy: 86/8968 (0.9590%)
saving model
Done in 387.60582280158997 sec.
Server Epoch:27 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 12, 57, 31, 22, 93, 20, 61, 47, 32, 52, 82, 54, 11, 69, 28, 91, 43, 84, 94, 44, 49, 78, 77, 35, 1, 89, 10, 4, 70, 21, 36, 67, 37, 40, 8, 81, 42, 0, 80, 53, 56, 27, 15, 65, 34, 2, 59, 79, 95, 90, 85, 6, 96, 72, 38, 39, 30, 26, 13, 7, 5, 63, 24, 19, 86, 98, 50, 66, 83, 55, 23, 48, 76, 92, 60, 14, 75, 16, 87, 68, 99, 25, 58, 97, 64, 45, 9, 46, 71, 17].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   1,  Average loss: 0.0242, Accuracy: 279/569 (49.0334%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   2,  Average loss: 0.0145, Accuracy: 286/569 (50.2636%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   3,  Average loss: 0.0128, Accuracy: 271/569 (47.6274%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   4,  Average loss: 0.0114, Accuracy: 307/569 (53.9543%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   5,  Average loss: 0.0117, Accuracy: 291/569 (51.1424%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   6,  Average loss: 0.0115, Accuracy: 293/569 (51.4938%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   7,  Average loss: 0.0119, Accuracy: 268/569 (47.1002%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   8,  Average loss: 0.0112, Accuracy: 297/569 (52.1968%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch   9,  Average loss: 0.0114, Accuracy: 290/569 (50.9666%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 41, internal_epoch  10,  Average loss: 0.0112, Accuracy: 306/569 (53.7786%), train_poison_data_count: 288
Global model norm: 15.420566924641381.
Norm before scaling: 15.506201211159894. Distance: 3.118914974030933
Total norm for 10 adversaries is: 15.506201211159894. distance: 3.118914974030933
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.5371, Accuracy: 7251/8968 (80.8541%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   1,  Average loss: 0.0145, Accuracy: 351/522 (67.2414%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   2,  Average loss: 0.0088, Accuracy: 369/522 (70.6897%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   3,  Average loss: 0.0134, Accuracy: 350/522 (67.0498%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   4,  Average loss: 0.0089, Accuracy: 368/522 (70.4981%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   5,  Average loss: 0.0074, Accuracy: 394/522 (75.4789%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   6,  Average loss: 0.0076, Accuracy: 370/522 (70.8812%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   7,  Average loss: 0.0079, Accuracy: 363/522 (69.5402%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   8,  Average loss: 0.0075, Accuracy: 364/522 (69.7318%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch   9,  Average loss: 0.0073, Accuracy: 379/522 (72.6054%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 73, internal_epoch  10,  Average loss: 0.0073, Accuracy: 386/522 (73.9464%), train_poison_data_count: 266
Global model norm: 15.420566924641381.
Norm before scaling: 15.440658678621437. Distance: 2.521350387216336
Total norm for 10 adversaries is: 15.440658678621437. distance: 2.521350387216336
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.1801, Accuracy: 8893/8968 (99.1637%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   1,  Average loss: 0.0251, Accuracy: 194/385 (50.3896%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   2,  Average loss: 0.0164, Accuracy: 196/385 (50.9091%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   3,  Average loss: 0.0117, Accuracy: 247/385 (64.1558%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   4,  Average loss: 0.0101, Accuracy: 252/385 (65.4545%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   5,  Average loss: 0.0095, Accuracy: 287/385 (74.5455%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   6,  Average loss: 0.0073, Accuracy: 309/385 (80.2597%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   7,  Average loss: 0.0055, Accuracy: 355/385 (92.2078%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   8,  Average loss: 0.0042, Accuracy: 365/385 (94.8052%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch   9,  Average loss: 0.0036, Accuracy: 374/385 (97.1429%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 51, internal_epoch  10,  Average loss: 0.0032, Accuracy: 371/385 (96.3636%), train_poison_data_count: 193
Global model norm: 15.420566924641381.
Norm before scaling: 15.563718204234497. Distance: 3.127418497732745
Total norm for 10 adversaries is: 15.563718204234497. distance: 3.127418497732745
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.1181, Accuracy: 8744/8968 (97.5022%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   1,  Average loss: 0.0129, Accuracy: 429/627 (68.4211%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   2,  Average loss: 0.0039, Accuracy: 567/627 (90.4306%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   3,  Average loss: 0.0015, Accuracy: 603/627 (96.1722%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   4,  Average loss: 0.0010, Accuracy: 610/627 (97.2887%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   5,  Average loss: 0.0012, Accuracy: 610/627 (97.2887%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   6,  Average loss: 0.0010, Accuracy: 620/627 (98.8836%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   7,  Average loss: 0.0008, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   8,  Average loss: 0.0009, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch   9,  Average loss: 0.0009, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 74, internal_epoch  10,  Average loss: 0.0010, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Global model norm: 15.420566924641381.
Norm before scaling: 15.676219273409256. Distance: 3.1846324513352644
Total norm for 10 adversaries is: 15.676219273409256. distance: 3.1846324513352644
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0193, Accuracy: 8898/8968 (99.2194%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 3, internal_epoch   1,  Average loss: 0.0258, Accuracy: 254/516 (49.2248%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 3, internal_epoch   2,  Average loss: 0.0176, Accuracy: 265/516 (51.3566%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 3, internal_epoch   3,  Average loss: 0.0155, Accuracy: 259/516 (50.1938%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 3, internal_epoch   4,  Average loss: 0.0144, Accuracy: 265/516 (51.3566%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 3, internal_epoch   5,  Average loss: 0.0137, Accuracy: 248/516 (48.0620%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 3, internal_epoch   6,  Average loss: 0.0133, Accuracy: 258/516 (50.0000%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 3, internal_epoch   7,  Average loss: 0.0136, Accuracy: 265/516 (51.3566%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 3, internal_epoch   8,  Average loss: 0.0131, Accuracy: 257/516 (49.8062%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 3, internal_epoch   9,  Average loss: 0.0136, Accuracy: 259/516 (50.1938%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 3, internal_epoch  10,  Average loss: 0.0130, Accuracy: 252/516 (48.8372%), train_poison_data_count: 260
Global model norm: 15.420566924641381.
Norm before scaling: 15.591477222742709. Distance: 4.089867767584087
Total norm for 10 adversaries is: 15.591477222742709. distance: 4.089867767584087
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.6463, Accuracy: 7726/8968 (86.1508%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 18, internal_epoch   1,  Average loss: 0.0215, Accuracy: 380/759 (50.0659%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 18, internal_epoch   2,  Average loss: 0.0133, Accuracy: 376/759 (49.5389%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 18, internal_epoch   3,  Average loss: 0.0118, Accuracy: 397/759 (52.3057%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 18, internal_epoch   4,  Average loss: 0.0114, Accuracy: 410/759 (54.0184%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 18, internal_epoch   5,  Average loss: 0.0111, Accuracy: 433/759 (57.0487%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 18, internal_epoch   6,  Average loss: 0.0109, Accuracy: 465/759 (61.2648%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 18, internal_epoch   7,  Average loss: 0.0105, Accuracy: 500/759 (65.8762%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 18, internal_epoch   8,  Average loss: 0.0096, Accuracy: 547/759 (72.0685%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 18, internal_epoch   9,  Average loss: 0.0090, Accuracy: 600/759 (79.0514%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 18, internal_epoch  10,  Average loss: 0.0086, Accuracy: 639/759 (84.1897%), train_poison_data_count: 384
Global model norm: 15.420566924641381.
Norm before scaling: 15.64093181907476. Distance: 3.5942033564670712
Total norm for 10 adversaries is: 15.64093181907476. distance: 3.5942033564670712
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.2258, Accuracy: 8725/8968 (97.2904%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 29, internal_epoch   1,  Average loss: 0.0232, Accuracy: 254/506 (50.1976%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 29, internal_epoch   2,  Average loss: 0.0129, Accuracy: 313/506 (61.8577%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 29, internal_epoch   3,  Average loss: 0.0064, Accuracy: 449/506 (88.7352%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 29, internal_epoch   4,  Average loss: 0.0048, Accuracy: 475/506 (93.8735%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 29, internal_epoch   5,  Average loss: 0.0037, Accuracy: 481/506 (95.0593%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 29, internal_epoch   6,  Average loss: 0.0026, Accuracy: 493/506 (97.4308%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 29, internal_epoch   7,  Average loss: 0.0020, Accuracy: 497/506 (98.2213%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 29, internal_epoch   8,  Average loss: 0.0013, Accuracy: 499/506 (98.6166%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 29, internal_epoch   9,  Average loss: 0.0012, Accuracy: 500/506 (98.8142%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 29, internal_epoch  10,  Average loss: 0.0013, Accuracy: 499/506 (98.6166%), train_poison_data_count: 256
Global model norm: 15.420566924641381.
Norm before scaling: 15.657764475777066. Distance: 3.316108896968363
Total norm for 10 adversaries is: 15.657764475777066. distance: 3.316108896968363
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.2162, Accuracy: 8182/8968 (91.2355%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 62, internal_epoch   1,  Average loss: 0.0115, Accuracy: 416/580 (71.7241%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 62, internal_epoch   2,  Average loss: 0.0031, Accuracy: 546/580 (94.1379%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 62, internal_epoch   3,  Average loss: 0.0017, Accuracy: 558/580 (96.2069%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 62, internal_epoch   4,  Average loss: 0.0013, Accuracy: 568/580 (97.9310%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 62, internal_epoch   5,  Average loss: 0.0013, Accuracy: 564/580 (97.2414%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 62, internal_epoch   6,  Average loss: 0.0011, Accuracy: 566/580 (97.5862%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 62, internal_epoch   7,  Average loss: 0.0010, Accuracy: 567/580 (97.7586%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 62, internal_epoch   8,  Average loss: 0.0009, Accuracy: 568/580 (97.9310%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 62, internal_epoch   9,  Average loss: 0.0010, Accuracy: 567/580 (97.7586%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 62, internal_epoch  10,  Average loss: 0.0011, Accuracy: 566/580 (97.5862%), train_poison_data_count: 292
Global model norm: 15.420566924641381.
Norm before scaling: 15.66532637902969. Distance: 2.821133649908879
Total norm for 10 adversaries is: 15.66532637902969. distance: 2.821133649908879
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0130, Accuracy: 8926/8968 (99.5317%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 33, internal_epoch   1,  Average loss: 0.0236, Accuracy: 289/587 (49.2334%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 33, internal_epoch   2,  Average loss: 0.0147, Accuracy: 296/587 (50.4259%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 33, internal_epoch   3,  Average loss: 0.0146, Accuracy: 300/587 (51.1073%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 33, internal_epoch   4,  Average loss: 0.0132, Accuracy: 299/587 (50.9370%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 33, internal_epoch   5,  Average loss: 0.0128, Accuracy: 284/587 (48.3816%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 33, internal_epoch   6,  Average loss: 0.0132, Accuracy: 290/587 (49.4037%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 33, internal_epoch   7,  Average loss: 0.0127, Accuracy: 309/587 (52.6405%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 33, internal_epoch   8,  Average loss: 0.0125, Accuracy: 316/587 (53.8330%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 33, internal_epoch   9,  Average loss: 0.0123, Accuracy: 309/587 (52.6405%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 33, internal_epoch  10,  Average loss: 0.0124, Accuracy: 310/587 (52.8109%), train_poison_data_count: 299
Global model norm: 15.420566924641381.
Norm before scaling: 15.54895803020882. Distance: 3.319258075910867
Total norm for 10 adversaries is: 15.54895803020882. distance: 3.319258075910867
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.4399, Accuracy: 8223/8968 (91.6927%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 88, internal_epoch   1,  Average loss: 0.0156, Accuracy: 462/734 (62.9428%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 88, internal_epoch   2,  Average loss: 0.0102, Accuracy: 476/734 (64.8501%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 88, internal_epoch   3,  Average loss: 0.0097, Accuracy: 486/734 (66.2125%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 88, internal_epoch   4,  Average loss: 0.0091, Accuracy: 459/734 (62.5341%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 88, internal_epoch   5,  Average loss: 0.0088, Accuracy: 479/734 (65.2589%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 88, internal_epoch   6,  Average loss: 0.0091, Accuracy: 458/734 (62.3978%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 88, internal_epoch   7,  Average loss: 0.0090, Accuracy: 461/734 (62.8065%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 88, internal_epoch   8,  Average loss: 0.0088, Accuracy: 475/734 (64.7139%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 88, internal_epoch   9,  Average loss: 0.0087, Accuracy: 483/734 (65.8038%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 88, internal_epoch  10,  Average loss: 0.0086, Accuracy: 506/734 (68.9373%), train_poison_data_count: 382
Global model norm: 15.420566924641381.
Norm before scaling: 15.518094237995104. Distance: 2.9707241521589
Total norm for 10 adversaries is: 15.518094237995104. distance: 2.9707241521589
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.2517, Accuracy: 8763/8968 (97.7141%)
___Train Local_Simple,  epoch  27, local model 12, internal_epoch   1,  Average loss: 0.0011, Accuracy: 709/725 (97.7931%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 4.9733, Accuracy: 3674/10000 (36.7400%)
___Train Local_Simple,  epoch  27, local model 57, internal_epoch   1,  Average loss: 0.0010, Accuracy: 512/523 (97.8967%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 2.2715, Accuracy: 4661/10000 (46.6100%)
___Train Local_Simple,  epoch  27, local model 31, internal_epoch   1,  Average loss: 0.0011, Accuracy: 581/596 (97.4832%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.9783, Accuracy: 4438/10000 (44.3800%)
___Train Local_Simple,  epoch  27, local model 22, internal_epoch   1,  Average loss: 0.0012, Accuracy: 255/262 (97.3282%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.7128, Accuracy: 7172/10000 (71.7200%)
___Train Local_Simple,  epoch  27, local model 93, internal_epoch   1,  Average loss: 0.0018, Accuracy: 603/630 (95.7143%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 4.4144, Accuracy: 3773/10000 (37.7300%)
___Train Local_Simple,  epoch  27, local model 20, internal_epoch   1,  Average loss: 0.0017, Accuracy: 584/602 (97.0100%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 4.8898, Accuracy: 3783/10000 (37.8300%)
___Train Local_Simple,  epoch  27, local model 61, internal_epoch   1,  Average loss: 0.0020, Accuracy: 274/287 (95.4704%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.9647, Accuracy: 6983/10000 (69.8300%)
___Train Local_Simple,  epoch  27, local model 47, internal_epoch   1,  Average loss: 0.0011, Accuracy: 523/534 (97.9401%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 2.4184, Accuracy: 5457/10000 (54.5700%)
___Train Local_Simple,  epoch  27, local model 32, internal_epoch   1,  Average loss: 0.0011, Accuracy: 575/590 (97.4576%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 4.4819, Accuracy: 4494/10000 (44.9400%)
___Train Local_Simple,  epoch  27, local model 52, internal_epoch   1,  Average loss: 0.0014, Accuracy: 768/789 (97.3384%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 5.1605, Accuracy: 4094/10000 (40.9400%)
___Train Local_Simple,  epoch  27, local model 82, internal_epoch   1,  Average loss: 0.0009, Accuracy: 799/815 (98.0368%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 6.4715, Accuracy: 2969/10000 (29.6900%)
___Train Local_Simple,  epoch  27, local model 54, internal_epoch   1,  Average loss: 0.0009, Accuracy: 819/832 (98.4375%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.8412, Accuracy: 4160/10000 (41.6000%)
___Train Local_Simple,  epoch  27, local model 11, internal_epoch   1,  Average loss: 0.0010, Accuracy: 543/554 (98.0144%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 2.3318, Accuracy: 5914/10000 (59.1400%)
___Train Local_Simple,  epoch  27, local model 69, internal_epoch   1,  Average loss: 0.0026, Accuracy: 642/671 (95.6781%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 5.4194, Accuracy: 3309/10000 (33.0900%)
___Train Local_Simple,  epoch  27, local model 28, internal_epoch   1,  Average loss: 0.0009, Accuracy: 599/611 (98.0360%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 2.4885, Accuracy: 5725/10000 (57.2500%)
___Train Local_Simple,  epoch  27, local model 91, internal_epoch   1,  Average loss: 0.0008, Accuracy: 810/819 (98.9011%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 4.5299, Accuracy: 3515/10000 (35.1500%)
___Train Local_Simple,  epoch  27, local model 43, internal_epoch   1,  Average loss: 0.0011, Accuracy: 424/431 (98.3759%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.9278, Accuracy: 6081/10000 (60.8100%)
___Train Local_Simple,  epoch  27, local model 84, internal_epoch   1,  Average loss: 0.0020, Accuracy: 405/420 (96.4286%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.9118, Accuracy: 6525/10000 (65.2500%)
___Train Local_Simple,  epoch  27, local model 94, internal_epoch   1,  Average loss: 0.0009, Accuracy: 659/671 (98.2116%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.9327, Accuracy: 4992/10000 (49.9200%)
___Train Local_Simple,  epoch  27, local model 44, internal_epoch   1,  Average loss: 0.0006, Accuracy: 555/561 (98.9305%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.1430, Accuracy: 5370/10000 (53.7000%)
___Train Local_Simple,  epoch  27, local model 49, internal_epoch   1,  Average loss: 0.0016, Accuracy: 344/355 (96.9014%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.6917, Accuracy: 5401/10000 (54.0100%)
___Train Local_Simple,  epoch  27, local model 78, internal_epoch   1,  Average loss: 0.0025, Accuracy: 563/587 (95.9114%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 7.1263, Accuracy: 2795/10000 (27.9500%)
___Train Local_Simple,  epoch  27, local model 77, internal_epoch   1,  Average loss: 0.0022, Accuracy: 594/618 (96.1165%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 2.2025, Accuracy: 4652/10000 (46.5200%)
___Train Local_Simple,  epoch  27, local model 35, internal_epoch   1,  Average loss: 0.0015, Accuracy: 615/630 (97.6190%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 6.0383, Accuracy: 3679/10000 (36.7900%)
___Train Local_Simple,  epoch  27, local model 1, internal_epoch   1,  Average loss: 0.0007, Accuracy: 530/536 (98.8806%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.0609, Accuracy: 7446/10000 (74.4600%)
___Train Local_Simple,  epoch  27, local model 89, internal_epoch   1,  Average loss: 0.0022, Accuracy: 657/683 (96.1933%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 2.7915, Accuracy: 5473/10000 (54.7300%)
___Train Local_Simple,  epoch  27, local model 10, internal_epoch   1,  Average loss: 0.0019, Accuracy: 553/573 (96.5096%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.7315, Accuracy: 4442/10000 (44.4200%)
___Train Local_Simple,  epoch  27, local model 4, internal_epoch   1,  Average loss: 0.0010, Accuracy: 732/748 (97.8610%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.7397, Accuracy: 4079/10000 (40.7900%)
___Train Local_Simple,  epoch  27, local model 70, internal_epoch   1,  Average loss: 0.0018, Accuracy: 550/568 (96.8310%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.7298, Accuracy: 4342/10000 (43.4200%)
___Train Local_Simple,  epoch  27, local model 21, internal_epoch   1,  Average loss: 0.0011, Accuracy: 668/687 (97.2344%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 7.3543, Accuracy: 2998/10000 (29.9800%)
___Train Local_Simple,  epoch  27, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 308/315 (97.7778%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.4975, Accuracy: 8333/10000 (83.3300%)
___Train Local_Simple,  epoch  27, local model 67, internal_epoch   1,  Average loss: 0.0017, Accuracy: 428/441 (97.0522%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.4834, Accuracy: 3696/10000 (36.9600%)
___Train Local_Simple,  epoch  27, local model 37, internal_epoch   1,  Average loss: 0.0009, Accuracy: 448/456 (98.2456%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.0264, Accuracy: 6774/10000 (67.7400%)
___Train Local_Simple,  epoch  27, local model 40, internal_epoch   1,  Average loss: 0.0006, Accuracy: 494/498 (99.1968%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 2.6013, Accuracy: 4816/10000 (48.1600%)
___Train Local_Simple,  epoch  27, local model 8, internal_epoch   1,  Average loss: 0.0008, Accuracy: 696/706 (98.5836%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 2.7580, Accuracy: 4839/10000 (48.3900%)
___Train Local_Simple,  epoch  27, local model 81, internal_epoch   1,  Average loss: 0.0024, Accuracy: 615/636 (96.6981%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 2.2065, Accuracy: 4908/10000 (49.0800%)
___Train Local_Simple,  epoch  27, local model 42, internal_epoch   1,  Average loss: 0.0007, Accuracy: 466/473 (98.5201%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.4532, Accuracy: 6257/10000 (62.5700%)
___Train Local_Simple,  epoch  27, local model 0, internal_epoch   1,  Average loss: 0.0010, Accuracy: 428/435 (98.3908%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.8828, Accuracy: 5752/10000 (57.5200%)
___Train Local_Simple,  epoch  27, local model 80, internal_epoch   1,  Average loss: 0.0027, Accuracy: 504/532 (94.7368%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 7.9550, Accuracy: 2649/10000 (26.4900%)
___Train Local_Simple,  epoch  27, local model 53, internal_epoch   1,  Average loss: 0.0013, Accuracy: 545/561 (97.1480%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 5.2775, Accuracy: 4075/10000 (40.7500%)
___Train Local_Simple,  epoch  27, local model 56, internal_epoch   1,  Average loss: 0.0010, Accuracy: 700/715 (97.9021%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.7175, Accuracy: 3679/10000 (36.7900%)
___Train Local_Simple,  epoch  27, local model 27, internal_epoch   1,  Average loss: 0.0014, Accuracy: 724/745 (97.1812%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 8.2758, Accuracy: 2856/10000 (28.5600%)
___Train Local_Simple,  epoch  27, local model 15, internal_epoch   1,  Average loss: 0.0016, Accuracy: 275/282 (97.5177%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.9962, Accuracy: 7161/10000 (71.6100%)
___Train Local_Simple,  epoch  27, local model 65, internal_epoch   1,  Average loss: 0.0022, Accuracy: 593/621 (95.4911%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 4.3716, Accuracy: 3236/10000 (32.3600%)
___Train Local_Simple,  epoch  27, local model 34, internal_epoch   1,  Average loss: 0.0025, Accuracy: 826/871 (94.8335%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.8798, Accuracy: 4451/10000 (44.5100%)
___Train Local_Simple,  epoch  27, local model 2, internal_epoch   1,  Average loss: 0.0016, Accuracy: 546/564 (96.8085%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 4.0661, Accuracy: 3587/10000 (35.8700%)
___Train Local_Simple,  epoch  27, local model 59, internal_epoch   1,  Average loss: 0.0017, Accuracy: 628/644 (97.5155%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 4.7330, Accuracy: 3755/10000 (37.5500%)
___Train Local_Simple,  epoch  27, local model 79, internal_epoch   1,  Average loss: 0.0020, Accuracy: 641/661 (96.9743%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 2.9782, Accuracy: 3885/10000 (38.8500%)
___Train Local_Simple,  epoch  27, local model 95, internal_epoch   1,  Average loss: 0.0029, Accuracy: 570/600 (95.0000%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 2.6603, Accuracy: 5366/10000 (53.6600%)
___Train Local_Simple,  epoch  27, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 577/615 (93.8211%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.5953, Accuracy: 6736/10000 (67.3600%)
___Train Local_Simple,  epoch  27, local model 85, internal_epoch   1,  Average loss: 0.0022, Accuracy: 773/807 (95.7869%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 4.3109, Accuracy: 3574/10000 (35.7400%)
___Train Local_Simple,  epoch  27, local model 6, internal_epoch   1,  Average loss: 0.0015, Accuracy: 422/435 (97.0115%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 2.9780, Accuracy: 5517/10000 (55.1700%)
___Train Local_Simple,  epoch  27, local model 96, internal_epoch   1,  Average loss: 0.0017, Accuracy: 513/531 (96.6102%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 4.2800, Accuracy: 4086/10000 (40.8600%)
___Train Local_Simple,  epoch  27, local model 72, internal_epoch   1,  Average loss: 0.0029, Accuracy: 394/423 (93.1442%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.6523, Accuracy: 3631/10000 (36.3100%)
___Train Local_Simple,  epoch  27, local model 38, internal_epoch   1,  Average loss: 0.0010, Accuracy: 466/477 (97.6939%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.0118, Accuracy: 7105/10000 (71.0500%)
___Train Local_Simple,  epoch  27, local model 39, internal_epoch   1,  Average loss: 0.0014, Accuracy: 480/493 (97.3631%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.5998, Accuracy: 4828/10000 (48.2800%)
___Train Local_Simple,  epoch  27, local model 30, internal_epoch   1,  Average loss: 0.0012, Accuracy: 430/443 (97.0655%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 2.5299, Accuracy: 6091/10000 (60.9100%)
___Train Local_Simple,  epoch  27, local model 26, internal_epoch   1,  Average loss: 0.0012, Accuracy: 507/519 (97.6879%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 2.6531, Accuracy: 4821/10000 (48.2100%)
___Train Local_Simple,  epoch  27, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 697/713 (97.7560%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 6.4818, Accuracy: 3068/10000 (30.6800%)
___Train Local_Simple,  epoch  27, local model 7, internal_epoch   1,  Average loss: 0.0006, Accuracy: 795/802 (99.1272%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 2.3919, Accuracy: 4902/10000 (49.0200%)
___Train Local_Simple,  epoch  27, local model 5, internal_epoch   1,  Average loss: 0.0014, Accuracy: 565/578 (97.7509%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.2159, Accuracy: 6674/10000 (66.7400%)
___Train Local_Simple,  epoch  27, local model 63, internal_epoch   1,  Average loss: 0.0025, Accuracy: 286/303 (94.3894%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 2.7488, Accuracy: 4334/10000 (43.3400%)
___Train Local_Simple,  epoch  27, local model 24, internal_epoch   1,  Average loss: 0.0022, Accuracy: 459/477 (96.2264%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.4810, Accuracy: 4074/10000 (40.7400%)
___Train Local_Simple,  epoch  27, local model 19, internal_epoch   1,  Average loss: 0.0017, Accuracy: 580/598 (96.9900%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 6.1245, Accuracy: 2994/10000 (29.9400%)
___Train Local_Simple,  epoch  27, local model 86, internal_epoch   1,  Average loss: 0.0010, Accuracy: 680/692 (98.2659%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 5.6711, Accuracy: 2598/10000 (25.9800%)
___Train Local_Simple,  epoch  27, local model 98, internal_epoch   1,  Average loss: 0.0034, Accuracy: 512/548 (93.4307%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 2.5276, Accuracy: 5214/10000 (52.1400%)
___Train Local_Simple,  epoch  27, local model 50, internal_epoch   1,  Average loss: 0.0015, Accuracy: 463/477 (97.0650%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.2141, Accuracy: 4055/10000 (40.5500%)
___Train Local_Simple,  epoch  27, local model 66, internal_epoch   1,  Average loss: 0.0028, Accuracy: 693/733 (94.5430%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.1468, Accuracy: 3582/10000 (35.8200%)
___Train Local_Simple,  epoch  27, local model 83, internal_epoch   1,  Average loss: 0.0019, Accuracy: 345/360 (95.8333%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.5404, Accuracy: 5978/10000 (59.7800%)
___Train Local_Simple,  epoch  27, local model 55, internal_epoch   1,  Average loss: 0.0024, Accuracy: 357/375 (95.2000%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.9962, Accuracy: 6035/10000 (60.3500%)
___Train Local_Simple,  epoch  27, local model 23, internal_epoch   1,  Average loss: 0.0018, Accuracy: 530/542 (97.7860%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 4.8678, Accuracy: 3530/10000 (35.3000%)
___Train Local_Simple,  epoch  27, local model 48, internal_epoch   1,  Average loss: 0.0018, Accuracy: 353/363 (97.2452%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.7145, Accuracy: 7840/10000 (78.4000%)
___Train Local_Simple,  epoch  27, local model 76, internal_epoch   1,  Average loss: 0.0033, Accuracy: 433/459 (94.3355%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.1893, Accuracy: 5340/10000 (53.4000%)
___Train Local_Simple,  epoch  27, local model 92, internal_epoch   1,  Average loss: 0.0028, Accuracy: 574/611 (93.9444%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 9.0124, Accuracy: 2660/10000 (26.6000%)
___Train Local_Simple,  epoch  27, local model 60, internal_epoch   1,  Average loss: 0.0021, Accuracy: 552/571 (96.6725%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 5.7936, Accuracy: 2989/10000 (29.8900%)
___Train Local_Simple,  epoch  27, local model 14, internal_epoch   1,  Average loss: 0.0016, Accuracy: 674/692 (97.3988%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.6643, Accuracy: 6180/10000 (61.8000%)
___Train Local_Simple,  epoch  27, local model 75, internal_epoch   1,  Average loss: 0.0029, Accuracy: 716/763 (93.8401%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.5358, Accuracy: 4277/10000 (42.7700%)
___Train Local_Simple,  epoch  27, local model 16, internal_epoch   1,  Average loss: 0.0009, Accuracy: 803/817 (98.2864%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 4.7872, Accuracy: 4133/10000 (41.3300%)
___Train Local_Simple,  epoch  27, local model 87, internal_epoch   1,  Average loss: 0.0019, Accuracy: 645/663 (97.2851%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 6.1373, Accuracy: 3315/10000 (33.1500%)
___Train Local_Simple,  epoch  27, local model 68, internal_epoch   1,  Average loss: 0.0023, Accuracy: 528/549 (96.1749%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 4.5405, Accuracy: 3657/10000 (36.5700%)
___Train Local_Simple,  epoch  27, local model 99, internal_epoch   1,  Average loss: 0.0027, Accuracy: 667/712 (93.6798%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.6523, Accuracy: 4678/10000 (46.7800%)
___Train Local_Simple,  epoch  27, local model 25, internal_epoch   1,  Average loss: 0.0008, Accuracy: 584/592 (98.6486%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.4365, Accuracy: 5440/10000 (54.4000%)
___Train Local_Simple,  epoch  27, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 751/772 (97.2798%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 2.9083, Accuracy: 5007/10000 (50.0700%)
___Train Local_Simple,  epoch  27, local model 97, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1104/1112 (99.2806%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 4.8883, Accuracy: 3028/10000 (30.2800%)
___Train Local_Simple,  epoch  27, local model 64, internal_epoch   1,  Average loss: 0.0009, Accuracy: 597/608 (98.1908%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 6.3018, Accuracy: 3660/10000 (36.6000%)
___Train Local_Simple,  epoch  27, local model 45, internal_epoch   1,  Average loss: 0.0010, Accuracy: 636/647 (98.2998%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 2.8918, Accuracy: 4581/10000 (45.8100%)
___Train Local_Simple,  epoch  27, local model 9, internal_epoch   1,  Average loss: 0.0012, Accuracy: 501/508 (98.6220%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.9790, Accuracy: 6848/10000 (68.4800%)
___Train Local_Simple,  epoch  27, local model 46, internal_epoch   1,  Average loss: 0.0010, Accuracy: 635/650 (97.6923%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 4.2116, Accuracy: 4482/10000 (44.8200%)
___Train Local_Simple,  epoch  27, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 545/561 (97.1480%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.3578, Accuracy: 4335/10000 (43.3500%)
___Train Local_Simple,  epoch  27, local model 17, internal_epoch   1,  Average loss: 0.0009, Accuracy: 516/527 (97.9127%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.6527, Accuracy: 4788/10000 (47.8800%)
time spent on training: 359.2115659713745
___Test Target_Simple poisoned: False, epoch: 27: Average loss: 0.2110, Accuracy: 9405/10000 (94.0500%)
___Test Target_Simple poisoned: True, epoch: 27: Average loss: 3.8048, Accuracy: 364/8968 (4.0589%)
saving model
Done in 390.1095383167267 sec.
Server Epoch:28 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 10, 7, 89, 5, 58, 54, 95, 6, 82, 11, 35, 97, 37, 34, 77, 12, 31, 79, 70, 39, 87, 69, 23, 93, 28, 30, 60, 26, 47, 9, 76, 72, 15, 52, 44, 2, 68, 13, 0, 19, 36, 25, 64, 24, 38, 92, 67, 22, 63, 55, 75, 45, 84, 53, 66, 85, 81, 96, 43, 8, 17, 56, 21, 27, 65, 48, 71, 59, 50, 14, 90, 4, 61, 78, 86, 40, 49, 16, 1, 99, 94, 80, 20, 98, 57, 91, 46, 32, 83, 42].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   1,  Average loss: 0.0211, Accuracy: 283/569 (49.7364%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   2,  Average loss: 0.0134, Accuracy: 284/569 (49.9121%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   3,  Average loss: 0.0122, Accuracy: 286/569 (50.2636%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   4,  Average loss: 0.0118, Accuracy: 293/569 (51.4938%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   5,  Average loss: 0.0114, Accuracy: 287/569 (50.4394%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   6,  Average loss: 0.0115, Accuracy: 279/569 (49.0334%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   7,  Average loss: 0.0114, Accuracy: 301/569 (52.8998%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   8,  Average loss: 0.0114, Accuracy: 283/569 (49.7364%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch   9,  Average loss: 0.0112, Accuracy: 314/569 (55.1845%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 41, internal_epoch  10,  Average loss: 0.0113, Accuracy: 299/569 (52.5483%), train_poison_data_count: 288
Global model norm: 15.419324051307138.
Norm before scaling: 15.467361048753597. Distance: 2.6616724653505313
Total norm for 10 adversaries is: 15.467361048753597. distance: 2.6616724653505313
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.5060, Accuracy: 7537/8968 (84.0433%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   1,  Average loss: 0.0152, Accuracy: 356/522 (68.1992%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   2,  Average loss: 0.0093, Accuracy: 370/522 (70.8812%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   3,  Average loss: 0.0102, Accuracy: 372/522 (71.2644%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   4,  Average loss: 0.0085, Accuracy: 368/522 (70.4981%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   5,  Average loss: 0.0070, Accuracy: 380/522 (72.7969%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   6,  Average loss: 0.0075, Accuracy: 377/522 (72.2222%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   7,  Average loss: 0.0072, Accuracy: 377/522 (72.2222%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   8,  Average loss: 0.0074, Accuracy: 391/522 (74.9042%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch   9,  Average loss: 0.0071, Accuracy: 394/522 (75.4789%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 73, internal_epoch  10,  Average loss: 0.0074, Accuracy: 396/522 (75.8621%), train_poison_data_count: 266
Global model norm: 15.419324051307138.
Norm before scaling: 15.436159145178358. Distance: 2.4589799149209948
Total norm for 10 adversaries is: 15.436159145178358. distance: 2.4589799149209948
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.1398, Accuracy: 8878/8968 (98.9964%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   1,  Average loss: 0.0228, Accuracy: 207/385 (53.7662%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   2,  Average loss: 0.0145, Accuracy: 233/385 (60.5195%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   3,  Average loss: 0.0108, Accuracy: 246/385 (63.8961%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   4,  Average loss: 0.0076, Accuracy: 292/385 (75.8442%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   5,  Average loss: 0.0064, Accuracy: 327/385 (84.9351%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   6,  Average loss: 0.0049, Accuracy: 368/385 (95.5844%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   7,  Average loss: 0.0039, Accuracy: 367/385 (95.3247%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   8,  Average loss: 0.0031, Accuracy: 370/385 (96.1039%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   9,  Average loss: 0.0025, Accuracy: 376/385 (97.6623%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch  10,  Average loss: 0.0022, Accuracy: 381/385 (98.9610%), train_poison_data_count: 193
Global model norm: 15.419324051307138.
Norm before scaling: 15.62758621174953. Distance: 3.209138315122291
Total norm for 10 adversaries is: 15.62758621174953. distance: 3.209138315122291
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.1091, Accuracy: 8721/8968 (97.2458%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   1,  Average loss: 0.0098, Accuracy: 489/627 (77.9904%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   2,  Average loss: 0.0028, Accuracy: 587/627 (93.6204%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   3,  Average loss: 0.0011, Accuracy: 613/627 (97.7671%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   4,  Average loss: 0.0014, Accuracy: 607/627 (96.8102%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   5,  Average loss: 0.0007, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   6,  Average loss: 0.0013, Accuracy: 612/627 (97.6077%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   7,  Average loss: 0.0006, Accuracy: 620/627 (98.8836%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   8,  Average loss: 0.0007, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch   9,  Average loss: 0.0009, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 74, internal_epoch  10,  Average loss: 0.0007, Accuracy: 620/627 (98.8836%), train_poison_data_count: 320
Global model norm: 15.419324051307138.
Norm before scaling: 15.63888884672922. Distance: 2.6070498769047257
Total norm for 10 adversaries is: 15.63888884672922. distance: 2.6070498769047257
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0089, Accuracy: 8933/8968 (99.6097%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 3, internal_epoch   1,  Average loss: 0.0266, Accuracy: 254/516 (49.2248%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 3, internal_epoch   2,  Average loss: 0.0168, Accuracy: 255/516 (49.4186%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 3, internal_epoch   3,  Average loss: 0.0179, Accuracy: 263/516 (50.9690%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 3, internal_epoch   4,  Average loss: 0.0144, Accuracy: 265/516 (51.3566%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 3, internal_epoch   5,  Average loss: 0.0140, Accuracy: 255/516 (49.4186%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 3, internal_epoch   6,  Average loss: 0.0136, Accuracy: 265/516 (51.3566%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 3, internal_epoch   7,  Average loss: 0.0130, Accuracy: 271/516 (52.5194%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 3, internal_epoch   8,  Average loss: 0.0130, Accuracy: 261/516 (50.5814%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 3, internal_epoch   9,  Average loss: 0.0127, Accuracy: 264/516 (51.1628%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 3, internal_epoch  10,  Average loss: 0.0126, Accuracy: 256/516 (49.6124%), train_poison_data_count: 260
Global model norm: 15.419324051307138.
Norm before scaling: 15.580747882879171. Distance: 3.7387182285255958
Total norm for 10 adversaries is: 15.580747882879171. distance: 3.7387182285255958
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.5603, Accuracy: 8038/8968 (89.6298%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 18, internal_epoch   1,  Average loss: 0.0183, Accuracy: 381/759 (50.1976%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 18, internal_epoch   2,  Average loss: 0.0123, Accuracy: 410/759 (54.0184%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 18, internal_epoch   3,  Average loss: 0.0119, Accuracy: 421/759 (55.4677%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 18, internal_epoch   4,  Average loss: 0.0112, Accuracy: 433/759 (57.0487%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 18, internal_epoch   5,  Average loss: 0.0108, Accuracy: 461/759 (60.7378%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 18, internal_epoch   6,  Average loss: 0.0096, Accuracy: 576/759 (75.8893%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 18, internal_epoch   7,  Average loss: 0.0087, Accuracy: 616/759 (81.1594%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 18, internal_epoch   8,  Average loss: 0.0063, Accuracy: 696/759 (91.6996%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 18, internal_epoch   9,  Average loss: 0.0046, Accuracy: 732/759 (96.4427%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 18, internal_epoch  10,  Average loss: 0.0045, Accuracy: 726/759 (95.6522%), train_poison_data_count: 384
Global model norm: 15.419324051307138.
Norm before scaling: 15.606266113077385. Distance: 3.402489502475081
Total norm for 10 adversaries is: 15.606266113077385. distance: 3.402489502475081
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.1968, Accuracy: 8596/8968 (95.8519%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 29, internal_epoch   1,  Average loss: 0.0182, Accuracy: 281/506 (55.5336%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 29, internal_epoch   2,  Average loss: 0.0107, Accuracy: 353/506 (69.7628%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 29, internal_epoch   3,  Average loss: 0.0051, Accuracy: 461/506 (91.1067%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 29, internal_epoch   4,  Average loss: 0.0038, Accuracy: 479/506 (94.6640%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 29, internal_epoch   5,  Average loss: 0.0027, Accuracy: 488/506 (96.4427%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 29, internal_epoch   6,  Average loss: 0.0017, Accuracy: 497/506 (98.2213%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 29, internal_epoch   7,  Average loss: 0.0016, Accuracy: 498/506 (98.4190%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 29, internal_epoch   8,  Average loss: 0.0012, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 29, internal_epoch   9,  Average loss: 0.0009, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 29, internal_epoch  10,  Average loss: 0.0010, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Global model norm: 15.419324051307138.
Norm before scaling: 15.632539684807146. Distance: 2.911491180034461
Total norm for 10 adversaries is: 15.632539684807146. distance: 2.911491180034461
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.4453, Accuracy: 7099/8968 (79.1592%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 62, internal_epoch   1,  Average loss: 0.0118, Accuracy: 437/580 (75.3448%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 62, internal_epoch   2,  Average loss: 0.0036, Accuracy: 531/580 (91.5517%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 62, internal_epoch   3,  Average loss: 0.0019, Accuracy: 554/580 (95.5172%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 62, internal_epoch   4,  Average loss: 0.0016, Accuracy: 560/580 (96.5517%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 62, internal_epoch   5,  Average loss: 0.0013, Accuracy: 562/580 (96.8966%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 62, internal_epoch   6,  Average loss: 0.0010, Accuracy: 568/580 (97.9310%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 62, internal_epoch   7,  Average loss: 0.0011, Accuracy: 569/580 (98.1034%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 62, internal_epoch   8,  Average loss: 0.0009, Accuracy: 570/580 (98.2759%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 62, internal_epoch   9,  Average loss: 0.0012, Accuracy: 567/580 (97.7586%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 62, internal_epoch  10,  Average loss: 0.0007, Accuracy: 571/580 (98.4483%), train_poison_data_count: 292
Global model norm: 15.419324051307138.
Norm before scaling: 15.676263075077026. Distance: 2.7272825847794375
Total norm for 10 adversaries is: 15.676263075077026. distance: 2.7272825847794375
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0115, Accuracy: 8928/8968 (99.5540%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   1,  Average loss: 0.0217, Accuracy: 288/587 (49.0630%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   2,  Average loss: 0.0154, Accuracy: 288/587 (49.0630%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   3,  Average loss: 0.0157, Accuracy: 281/587 (47.8705%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   4,  Average loss: 0.0135, Accuracy: 296/587 (50.4259%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   5,  Average loss: 0.0130, Accuracy: 293/587 (49.9148%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   6,  Average loss: 0.0128, Accuracy: 309/587 (52.6405%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   7,  Average loss: 0.0129, Accuracy: 283/587 (48.2112%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   8,  Average loss: 0.0127, Accuracy: 285/587 (48.5520%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   9,  Average loss: 0.0125, Accuracy: 315/587 (53.6627%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch  10,  Average loss: 0.0122, Accuracy: 298/587 (50.7666%), train_poison_data_count: 299
Global model norm: 15.419324051307138.
Norm before scaling: 15.49086812413229. Distance: 2.902471239208684
Total norm for 10 adversaries is: 15.49086812413229. distance: 2.902471239208684
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.4679, Accuracy: 7671/8968 (85.5375%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 88, internal_epoch   1,  Average loss: 0.0146, Accuracy: 453/734 (61.7166%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 88, internal_epoch   2,  Average loss: 0.0109, Accuracy: 461/734 (62.8065%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 88, internal_epoch   3,  Average loss: 0.0098, Accuracy: 474/734 (64.5777%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 88, internal_epoch   4,  Average loss: 0.0092, Accuracy: 475/734 (64.7139%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 88, internal_epoch   5,  Average loss: 0.0089, Accuracy: 485/734 (66.0763%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 88, internal_epoch   6,  Average loss: 0.0086, Accuracy: 496/734 (67.5749%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 88, internal_epoch   7,  Average loss: 0.0085, Accuracy: 506/734 (68.9373%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 88, internal_epoch   8,  Average loss: 0.0085, Accuracy: 498/734 (67.8474%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 88, internal_epoch   9,  Average loss: 0.0084, Accuracy: 527/734 (71.7984%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 88, internal_epoch  10,  Average loss: 0.0083, Accuracy: 526/734 (71.6621%), train_poison_data_count: 382
Global model norm: 15.419324051307138.
Norm before scaling: 15.501042976974919. Distance: 2.7359102135587845
Total norm for 10 adversaries is: 15.501042976974919. distance: 2.7359102135587845
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.1970, Accuracy: 8726/8968 (97.3015%)
___Train Local_Simple,  epoch  28, local model 10, internal_epoch   1,  Average loss: 0.0022, Accuracy: 543/573 (94.7644%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.6885, Accuracy: 5496/10000 (54.9600%)
___Train Local_Simple,  epoch  28, local model 7, internal_epoch   1,  Average loss: 0.0007, Accuracy: 794/802 (99.0025%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 4.2525, Accuracy: 4278/10000 (42.7800%)
___Train Local_Simple,  epoch  28, local model 89, internal_epoch   1,  Average loss: 0.0050, Accuracy: 630/683 (92.2401%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 3.3693, Accuracy: 4413/10000 (44.1300%)
___Train Local_Simple,  epoch  28, local model 5, internal_epoch   1,  Average loss: 0.0014, Accuracy: 557/578 (96.3668%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.8641, Accuracy: 5529/10000 (55.2900%)
___Train Local_Simple,  epoch  28, local model 58, internal_epoch   1,  Average loss: 0.0012, Accuracy: 750/772 (97.1503%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 3.4935, Accuracy: 4506/10000 (45.0600%)
___Train Local_Simple,  epoch  28, local model 54, internal_epoch   1,  Average loss: 0.0012, Accuracy: 813/832 (97.7163%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 7.6157, Accuracy: 3272/10000 (32.7200%)
___Train Local_Simple,  epoch  28, local model 95, internal_epoch   1,  Average loss: 0.0033, Accuracy: 567/600 (94.5000%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 8.2112, Accuracy: 2948/10000 (29.4800%)
___Train Local_Simple,  epoch  28, local model 6, internal_epoch   1,  Average loss: 0.0009, Accuracy: 430/435 (98.8506%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.2492, Accuracy: 7233/10000 (72.3300%)
___Train Local_Simple,  epoch  28, local model 82, internal_epoch   1,  Average loss: 0.0011, Accuracy: 800/815 (98.1595%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 7.2171, Accuracy: 3096/10000 (30.9600%)
___Train Local_Simple,  epoch  28, local model 11, internal_epoch   1,  Average loss: 0.0007, Accuracy: 545/554 (98.3755%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.0939, Accuracy: 6069/10000 (60.6900%)
___Train Local_Simple,  epoch  28, local model 35, internal_epoch   1,  Average loss: 0.0013, Accuracy: 614/630 (97.4603%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 4.8428, Accuracy: 3863/10000 (38.6300%)
___Train Local_Simple,  epoch  28, local model 97, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1097/1112 (98.6511%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 6.5992, Accuracy: 3621/10000 (36.2100%)
___Train Local_Simple,  epoch  28, local model 37, internal_epoch   1,  Average loss: 0.0020, Accuracy: 438/456 (96.0526%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 4.5499, Accuracy: 4844/10000 (48.4400%)
___Train Local_Simple,  epoch  28, local model 34, internal_epoch   1,  Average loss: 0.0030, Accuracy: 818/871 (93.9150%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 4.0225, Accuracy: 3151/10000 (31.5100%)
___Train Local_Simple,  epoch  28, local model 77, internal_epoch   1,  Average loss: 0.0021, Accuracy: 588/618 (95.1456%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 7.0170, Accuracy: 2470/10000 (24.7000%)
___Train Local_Simple,  epoch  28, local model 12, internal_epoch   1,  Average loss: 0.0008, Accuracy: 717/725 (98.8966%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 3.4493, Accuracy: 4133/10000 (41.3300%)
___Train Local_Simple,  epoch  28, local model 31, internal_epoch   1,  Average loss: 0.0009, Accuracy: 585/596 (98.1544%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.9639, Accuracy: 5808/10000 (58.0800%)
___Train Local_Simple,  epoch  28, local model 79, internal_epoch   1,  Average loss: 0.0012, Accuracy: 651/661 (98.4871%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.7926, Accuracy: 5165/10000 (51.6500%)
___Train Local_Simple,  epoch  28, local model 70, internal_epoch   1,  Average loss: 0.0022, Accuracy: 545/568 (95.9507%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 7.0577, Accuracy: 3453/10000 (34.5300%)
___Train Local_Simple,  epoch  28, local model 39, internal_epoch   1,  Average loss: 0.0010, Accuracy: 483/493 (97.9716%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.7112, Accuracy: 6100/10000 (61.0000%)
___Train Local_Simple,  epoch  28, local model 87, internal_epoch   1,  Average loss: 0.0022, Accuracy: 637/663 (96.0784%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 6.3593, Accuracy: 3833/10000 (38.3300%)
___Train Local_Simple,  epoch  28, local model 69, internal_epoch   1,  Average loss: 0.0020, Accuracy: 645/671 (96.1252%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 4.0341, Accuracy: 3657/10000 (36.5700%)
___Train Local_Simple,  epoch  28, local model 23, internal_epoch   1,  Average loss: 0.0021, Accuracy: 524/542 (96.6790%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.2580, Accuracy: 4467/10000 (44.6700%)
___Train Local_Simple,  epoch  28, local model 93, internal_epoch   1,  Average loss: 0.0021, Accuracy: 602/630 (95.5556%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 5.3102, Accuracy: 2950/10000 (29.5000%)
___Train Local_Simple,  epoch  28, local model 28, internal_epoch   1,  Average loss: 0.0025, Accuracy: 583/611 (95.4173%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 7.3391, Accuracy: 3832/10000 (38.3200%)
___Train Local_Simple,  epoch  28, local model 30, internal_epoch   1,  Average loss: 0.0012, Accuracy: 436/443 (98.4199%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.4538, Accuracy: 6787/10000 (67.8700%)
___Train Local_Simple,  epoch  28, local model 60, internal_epoch   1,  Average loss: 0.0018, Accuracy: 553/571 (96.8476%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 4.8975, Accuracy: 3156/10000 (31.5600%)
___Train Local_Simple,  epoch  28, local model 26, internal_epoch   1,  Average loss: 0.0019, Accuracy: 494/519 (95.1830%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 5.4116, Accuracy: 3806/10000 (38.0600%)
___Train Local_Simple,  epoch  28, local model 47, internal_epoch   1,  Average loss: 0.0022, Accuracy: 513/534 (96.0674%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 6.4997, Accuracy: 3977/10000 (39.7700%)
___Train Local_Simple,  epoch  28, local model 9, internal_epoch   1,  Average loss: 0.0019, Accuracy: 492/508 (96.8504%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 4.2842, Accuracy: 4461/10000 (44.6100%)
___Train Local_Simple,  epoch  28, local model 76, internal_epoch   1,  Average loss: 0.0014, Accuracy: 451/459 (98.2571%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.8725, Accuracy: 7576/10000 (75.7600%)
___Train Local_Simple,  epoch  28, local model 72, internal_epoch   1,  Average loss: 0.0019, Accuracy: 408/423 (96.4539%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.0515, Accuracy: 4401/10000 (44.0100%)
___Train Local_Simple,  epoch  28, local model 15, internal_epoch   1,  Average loss: 0.0012, Accuracy: 279/282 (98.9362%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.6573, Accuracy: 7732/10000 (77.3200%)
___Train Local_Simple,  epoch  28, local model 52, internal_epoch   1,  Average loss: 0.0017, Accuracy: 762/789 (96.5779%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 6.5306, Accuracy: 3410/10000 (34.1000%)
___Train Local_Simple,  epoch  28, local model 44, internal_epoch   1,  Average loss: 0.0005, Accuracy: 557/561 (99.2870%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.7085, Accuracy: 6534/10000 (65.3400%)
___Train Local_Simple,  epoch  28, local model 2, internal_epoch   1,  Average loss: 0.0014, Accuracy: 552/564 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.6943, Accuracy: 4527/10000 (45.2700%)
___Train Local_Simple,  epoch  28, local model 68, internal_epoch   1,  Average loss: 0.0018, Accuracy: 533/549 (97.0856%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.5900, Accuracy: 4463/10000 (44.6300%)
___Train Local_Simple,  epoch  28, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 701/713 (98.3170%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 3.2239, Accuracy: 4025/10000 (40.2500%)
___Train Local_Simple,  epoch  28, local model 0, internal_epoch   1,  Average loss: 0.0023, Accuracy: 416/435 (95.6322%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 4.0825, Accuracy: 5006/10000 (50.0600%)
___Train Local_Simple,  epoch  28, local model 19, internal_epoch   1,  Average loss: 0.0012, Accuracy: 584/598 (97.6589%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 5.1347, Accuracy: 3100/10000 (31.0000%)
___Train Local_Simple,  epoch  28, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 311/315 (98.7302%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.6166, Accuracy: 8191/10000 (81.9100%)
___Train Local_Simple,  epoch  28, local model 25, internal_epoch   1,  Average loss: 0.0004, Accuracy: 590/592 (99.6622%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.8982, Accuracy: 6136/10000 (61.3600%)
___Train Local_Simple,  epoch  28, local model 64, internal_epoch   1,  Average loss: 0.0007, Accuracy: 601/608 (98.8487%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.5150, Accuracy: 6017/10000 (60.1700%)
___Train Local_Simple,  epoch  28, local model 24, internal_epoch   1,  Average loss: 0.0017, Accuracy: 467/477 (97.9036%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.3043, Accuracy: 4240/10000 (42.4000%)
___Train Local_Simple,  epoch  28, local model 38, internal_epoch   1,  Average loss: 0.0016, Accuracy: 468/477 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.8787, Accuracy: 7449/10000 (74.4900%)
___Train Local_Simple,  epoch  28, local model 92, internal_epoch   1,  Average loss: 0.0031, Accuracy: 573/611 (93.7807%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 4.7177, Accuracy: 2989/10000 (29.8900%)
___Train Local_Simple,  epoch  28, local model 67, internal_epoch   1,  Average loss: 0.0018, Accuracy: 429/441 (97.2789%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 3.0338, Accuracy: 4531/10000 (45.3100%)
___Train Local_Simple,  epoch  28, local model 22, internal_epoch   1,  Average loss: 0.0007, Accuracy: 259/262 (98.8550%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.6935, Accuracy: 8152/10000 (81.5200%)
___Train Local_Simple,  epoch  28, local model 63, internal_epoch   1,  Average loss: 0.0026, Accuracy: 286/303 (94.3894%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.9202, Accuracy: 4189/10000 (41.8900%)
___Train Local_Simple,  epoch  28, local model 55, internal_epoch   1,  Average loss: 0.0019, Accuracy: 364/375 (97.0667%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.0069, Accuracy: 5621/10000 (56.2100%)
___Train Local_Simple,  epoch  28, local model 75, internal_epoch   1,  Average loss: 0.0016, Accuracy: 743/763 (97.3788%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 4.5973, Accuracy: 3015/10000 (30.1500%)
___Train Local_Simple,  epoch  28, local model 45, internal_epoch   1,  Average loss: 0.0013, Accuracy: 628/647 (97.0634%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 5.8683, Accuracy: 3505/10000 (35.0500%)
___Train Local_Simple,  epoch  28, local model 84, internal_epoch   1,  Average loss: 0.0013, Accuracy: 409/420 (97.3810%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.7704, Accuracy: 7880/10000 (78.8000%)
___Train Local_Simple,  epoch  28, local model 53, internal_epoch   1,  Average loss: 0.0012, Accuracy: 547/561 (97.5045%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.7066, Accuracy: 4778/10000 (47.7800%)
___Train Local_Simple,  epoch  28, local model 66, internal_epoch   1,  Average loss: 0.0040, Accuracy: 682/733 (93.0423%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.1613, Accuracy: 6581/10000 (65.8100%)
___Train Local_Simple,  epoch  28, local model 85, internal_epoch   1,  Average loss: 0.0017, Accuracy: 782/807 (96.9021%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 5.7928, Accuracy: 2667/10000 (26.6700%)
___Train Local_Simple,  epoch  28, local model 81, internal_epoch   1,  Average loss: 0.0016, Accuracy: 615/636 (96.6981%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.6725, Accuracy: 5163/10000 (51.6300%)
___Train Local_Simple,  epoch  28, local model 96, internal_epoch   1,  Average loss: 0.0011, Accuracy: 520/531 (97.9284%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 4.3302, Accuracy: 4039/10000 (40.3900%)
___Train Local_Simple,  epoch  28, local model 43, internal_epoch   1,  Average loss: 0.0012, Accuracy: 424/431 (98.3759%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.8115, Accuracy: 5576/10000 (55.7600%)
___Train Local_Simple,  epoch  28, local model 8, internal_epoch   1,  Average loss: 0.0015, Accuracy: 688/706 (97.4504%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 4.9983, Accuracy: 4492/10000 (44.9200%)
___Train Local_Simple,  epoch  28, local model 17, internal_epoch   1,  Average loss: 0.0006, Accuracy: 519/527 (98.4820%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.3311, Accuracy: 4979/10000 (49.7900%)
___Train Local_Simple,  epoch  28, local model 56, internal_epoch   1,  Average loss: 0.0009, Accuracy: 707/715 (98.8811%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 5.0090, Accuracy: 3668/10000 (36.6800%)
___Train Local_Simple,  epoch  28, local model 21, internal_epoch   1,  Average loss: 0.0008, Accuracy: 674/687 (98.1077%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 4.3114, Accuracy: 3443/10000 (34.4300%)
___Train Local_Simple,  epoch  28, local model 27, internal_epoch   1,  Average loss: 0.0010, Accuracy: 735/745 (98.6577%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 5.3625, Accuracy: 3332/10000 (33.3200%)
___Train Local_Simple,  epoch  28, local model 65, internal_epoch   1,  Average loss: 0.0024, Accuracy: 592/621 (95.3301%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.3738, Accuracy: 5288/10000 (52.8800%)
___Train Local_Simple,  epoch  28, local model 48, internal_epoch   1,  Average loss: 0.0023, Accuracy: 349/363 (96.1433%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.4735, Accuracy: 6695/10000 (66.9500%)
___Train Local_Simple,  epoch  28, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 546/561 (97.3262%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.9463, Accuracy: 6913/10000 (69.1300%)
___Train Local_Simple,  epoch  28, local model 59, internal_epoch   1,  Average loss: 0.0018, Accuracy: 630/644 (97.8261%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 4.7574, Accuracy: 3716/10000 (37.1600%)
___Train Local_Simple,  epoch  28, local model 50, internal_epoch   1,  Average loss: 0.0015, Accuracy: 464/477 (97.2746%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.7674, Accuracy: 4533/10000 (45.3300%)
___Train Local_Simple,  epoch  28, local model 14, internal_epoch   1,  Average loss: 0.0017, Accuracy: 667/692 (96.3873%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.6921, Accuracy: 4862/10000 (48.6200%)
___Train Local_Simple,  epoch  28, local model 90, internal_epoch   1,  Average loss: 0.0038, Accuracy: 574/615 (93.3333%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.2835, Accuracy: 6201/10000 (62.0100%)
___Train Local_Simple,  epoch  28, local model 4, internal_epoch   1,  Average loss: 0.0009, Accuracy: 737/748 (98.5294%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.2784, Accuracy: 4776/10000 (47.7600%)
___Train Local_Simple,  epoch  28, local model 61, internal_epoch   1,  Average loss: 0.0013, Accuracy: 282/287 (98.2578%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.5631, Accuracy: 8111/10000 (81.1100%)
___Train Local_Simple,  epoch  28, local model 78, internal_epoch   1,  Average loss: 0.0023, Accuracy: 561/587 (95.5707%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 7.5853, Accuracy: 2635/10000 (26.3500%)
___Train Local_Simple,  epoch  28, local model 86, internal_epoch   1,  Average loss: 0.0015, Accuracy: 680/692 (98.2659%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 5.7692, Accuracy: 2758/10000 (27.5800%)
___Train Local_Simple,  epoch  28, local model 40, internal_epoch   1,  Average loss: 0.0014, Accuracy: 488/498 (97.9920%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 10.0370, Accuracy: 2887/10000 (28.8700%)
___Train Local_Simple,  epoch  28, local model 49, internal_epoch   1,  Average loss: 0.0020, Accuracy: 340/355 (95.7746%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.7262, Accuracy: 4759/10000 (47.5900%)
___Train Local_Simple,  epoch  28, local model 16, internal_epoch   1,  Average loss: 0.0006, Accuracy: 810/817 (99.1432%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.6349, Accuracy: 4892/10000 (48.9200%)
___Train Local_Simple,  epoch  28, local model 1, internal_epoch   1,  Average loss: 0.0005, Accuracy: 532/536 (99.2537%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.6457, Accuracy: 8044/10000 (80.4400%)
___Train Local_Simple,  epoch  28, local model 99, internal_epoch   1,  Average loss: 0.0025, Accuracy: 681/712 (95.6461%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 6.0903, Accuracy: 2366/10000 (23.6600%)
___Train Local_Simple,  epoch  28, local model 94, internal_epoch   1,  Average loss: 0.0008, Accuracy: 660/671 (98.3607%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 3.6716, Accuracy: 5002/10000 (50.0200%)
___Train Local_Simple,  epoch  28, local model 80, internal_epoch   1,  Average loss: 0.0023, Accuracy: 513/532 (96.4286%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 7.6625, Accuracy: 2698/10000 (26.9800%)
___Train Local_Simple,  epoch  28, local model 20, internal_epoch   1,  Average loss: 0.0013, Accuracy: 588/602 (97.6744%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.8485, Accuracy: 5158/10000 (51.5800%)
___Train Local_Simple,  epoch  28, local model 98, internal_epoch   1,  Average loss: 0.0032, Accuracy: 513/548 (93.6131%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 8.4492, Accuracy: 2666/10000 (26.6600%)
___Train Local_Simple,  epoch  28, local model 57, internal_epoch   1,  Average loss: 0.0012, Accuracy: 512/523 (97.8967%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 4.1573, Accuracy: 3924/10000 (39.2400%)
___Train Local_Simple,  epoch  28, local model 91, internal_epoch   1,  Average loss: 0.0010, Accuracy: 801/819 (97.8022%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 7.7174, Accuracy: 2959/10000 (29.5900%)
___Train Local_Simple,  epoch  28, local model 46, internal_epoch   1,  Average loss: 0.0013, Accuracy: 638/650 (98.1538%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 4.2188, Accuracy: 4301/10000 (43.0100%)
___Train Local_Simple,  epoch  28, local model 32, internal_epoch   1,  Average loss: 0.0018, Accuracy: 577/590 (97.7966%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 3.0437, Accuracy: 5509/10000 (55.0900%)
___Train Local_Simple,  epoch  28, local model 83, internal_epoch   1,  Average loss: 0.0013, Accuracy: 350/360 (97.2222%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.6273, Accuracy: 7925/10000 (79.2500%)
___Train Local_Simple,  epoch  28, local model 42, internal_epoch   1,  Average loss: 0.0010, Accuracy: 463/473 (97.8858%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.2550, Accuracy: 5611/10000 (56.1100%)
time spent on training: 347.1105914115906
___Test Target_Simple poisoned: False, epoch: 28: Average loss: 0.1964, Accuracy: 9394/10000 (93.9400%)
___Test Target_Simple poisoned: True, epoch: 28: Average loss: 4.5982, Accuracy: 141/8968 (1.5723%)
saving model
Done in 375.29116582870483 sec.
Server Epoch:29 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 75, 94, 70, 25, 24, 79, 65, 39, 13, 61, 67, 60, 86, 97, 76, 31, 42, 5, 7, 55, 78, 99, 40, 71, 37, 8, 28, 63, 80, 27, 58, 66, 68, 91, 22, 19, 98, 96, 14, 57, 47, 90, 43, 85, 56, 34, 1, 46, 44, 81, 30, 35, 50, 52, 15, 12, 84, 45, 0, 4, 11, 38, 6, 36, 20, 49, 10, 54, 64, 53, 89, 83, 82, 87, 17, 93, 21, 59, 16, 69, 72, 77, 26, 2, 95, 92, 9, 48, 32, 23].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   1,  Average loss: 0.0225, Accuracy: 286/569 (50.2636%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   2,  Average loss: 0.0139, Accuracy: 295/569 (51.8453%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   3,  Average loss: 0.0121, Accuracy: 284/569 (49.9121%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   4,  Average loss: 0.0114, Accuracy: 305/569 (53.6028%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   5,  Average loss: 0.0116, Accuracy: 298/569 (52.3726%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   6,  Average loss: 0.0112, Accuracy: 301/569 (52.8998%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   7,  Average loss: 0.0117, Accuracy: 283/569 (49.7364%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   8,  Average loss: 0.0114, Accuracy: 309/569 (54.3058%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   9,  Average loss: 0.0116, Accuracy: 286/569 (50.2636%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch  10,  Average loss: 0.0113, Accuracy: 302/569 (53.0756%), train_poison_data_count: 288
Global model norm: 15.424269717347288.
Norm before scaling: 15.486866462810159. Distance: 2.978630729077144
Total norm for 10 adversaries is: 15.486866462810159. distance: 2.978630729077144
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.4453, Accuracy: 7958/8968 (88.7377%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   1,  Average loss: 0.0166, Accuracy: 356/522 (68.1992%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   2,  Average loss: 0.0096, Accuracy: 356/522 (68.1992%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   3,  Average loss: 0.0108, Accuracy: 365/522 (69.9234%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   4,  Average loss: 0.0088, Accuracy: 367/522 (70.3065%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   5,  Average loss: 0.0078, Accuracy: 368/522 (70.4981%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   6,  Average loss: 0.0081, Accuracy: 357/522 (68.3908%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   7,  Average loss: 0.0074, Accuracy: 380/522 (72.7969%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   8,  Average loss: 0.0077, Accuracy: 365/522 (69.9234%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch   9,  Average loss: 0.0077, Accuracy: 362/522 (69.3487%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 73, internal_epoch  10,  Average loss: 0.0073, Accuracy: 378/522 (72.4138%), train_poison_data_count: 266
Global model norm: 15.424269717347288.
Norm before scaling: 15.486565459029219. Distance: 2.989391963207967
Total norm for 10 adversaries is: 15.486565459029219. distance: 2.989391963207967
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.1659, Accuracy: 8904/8968 (99.2864%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   1,  Average loss: 0.0247, Accuracy: 191/385 (49.6104%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   2,  Average loss: 0.0139, Accuracy: 222/385 (57.6623%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   3,  Average loss: 0.0079, Accuracy: 314/385 (81.5584%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   4,  Average loss: 0.0078, Accuracy: 321/385 (83.3766%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   5,  Average loss: 0.0058, Accuracy: 339/385 (88.0519%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   6,  Average loss: 0.0044, Accuracy: 346/385 (89.8701%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   7,  Average loss: 0.0038, Accuracy: 355/385 (92.2078%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   8,  Average loss: 0.0030, Accuracy: 369/385 (95.8442%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch   9,  Average loss: 0.0027, Accuracy: 371/385 (96.3636%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 51, internal_epoch  10,  Average loss: 0.0024, Accuracy: 374/385 (97.1429%), train_poison_data_count: 193
Global model norm: 15.424269717347288.
Norm before scaling: 15.5647676952855. Distance: 3.0224134500005357
Total norm for 10 adversaries is: 15.5647676952855. distance: 3.0224134500005357
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.1043, Accuracy: 8776/8968 (97.8591%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   1,  Average loss: 0.0110, Accuracy: 465/627 (74.1627%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   2,  Average loss: 0.0028, Accuracy: 588/627 (93.7799%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   3,  Average loss: 0.0017, Accuracy: 607/627 (96.8102%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   4,  Average loss: 0.0012, Accuracy: 614/627 (97.9266%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   5,  Average loss: 0.0012, Accuracy: 612/627 (97.6077%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   6,  Average loss: 0.0010, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   7,  Average loss: 0.0008, Accuracy: 621/627 (99.0431%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   8,  Average loss: 0.0007, Accuracy: 620/627 (98.8836%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch   9,  Average loss: 0.0007, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 74, internal_epoch  10,  Average loss: 0.0007, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Global model norm: 15.424269717347288.
Norm before scaling: 15.670668611655602. Distance: 2.94026557112162
Total norm for 10 adversaries is: 15.670668611655602. distance: 2.94026557112162
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0099, Accuracy: 8928/8968 (99.5540%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 3, internal_epoch   1,  Average loss: 0.0219, Accuracy: 250/516 (48.4496%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 3, internal_epoch   2,  Average loss: 0.0183, Accuracy: 254/516 (49.2248%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 3, internal_epoch   3,  Average loss: 0.0146, Accuracy: 260/516 (50.3876%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 3, internal_epoch   4,  Average loss: 0.0133, Accuracy: 260/516 (50.3876%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 3, internal_epoch   5,  Average loss: 0.0126, Accuracy: 259/516 (50.1938%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 3, internal_epoch   6,  Average loss: 0.0132, Accuracy: 258/516 (50.0000%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 3, internal_epoch   7,  Average loss: 0.0127, Accuracy: 240/516 (46.5116%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 3, internal_epoch   8,  Average loss: 0.0128, Accuracy: 258/516 (50.0000%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 3, internal_epoch   9,  Average loss: 0.0124, Accuracy: 269/516 (52.1318%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 3, internal_epoch  10,  Average loss: 0.0128, Accuracy: 259/516 (50.1938%), train_poison_data_count: 260
Global model norm: 15.424269717347288.
Norm before scaling: 15.55294028201792. Distance: 3.8405543743744675
Total norm for 10 adversaries is: 15.55294028201792. distance: 3.8405543743744675
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.5274, Accuracy: 8182/8968 (91.2355%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 18, internal_epoch   1,  Average loss: 0.0213, Accuracy: 379/759 (49.9341%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 18, internal_epoch   2,  Average loss: 0.0131, Accuracy: 380/759 (50.0659%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 18, internal_epoch   3,  Average loss: 0.0113, Accuracy: 422/759 (55.5995%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 18, internal_epoch   4,  Average loss: 0.0111, Accuracy: 468/759 (61.6601%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 18, internal_epoch   5,  Average loss: 0.0107, Accuracy: 491/759 (64.6904%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 18, internal_epoch   6,  Average loss: 0.0101, Accuracy: 532/759 (70.0922%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 18, internal_epoch   7,  Average loss: 0.0087, Accuracy: 624/759 (82.2134%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 18, internal_epoch   8,  Average loss: 0.0071, Accuracy: 667/759 (87.8788%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 18, internal_epoch   9,  Average loss: 0.0056, Accuracy: 711/759 (93.6759%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 18, internal_epoch  10,  Average loss: 0.0053, Accuracy: 723/759 (95.2569%), train_poison_data_count: 384
Global model norm: 15.424269717347288.
Norm before scaling: 15.65276488234312. Distance: 3.72038745892729
Total norm for 10 adversaries is: 15.65276488234312. distance: 3.72038745892729
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.1883, Accuracy: 8649/8968 (96.4429%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 29, internal_epoch   1,  Average loss: 0.0230, Accuracy: 256/506 (50.5929%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 29, internal_epoch   2,  Average loss: 0.0122, Accuracy: 321/506 (63.4387%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 29, internal_epoch   3,  Average loss: 0.0048, Accuracy: 470/506 (92.8854%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 29, internal_epoch   4,  Average loss: 0.0036, Accuracy: 480/506 (94.8617%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 29, internal_epoch   5,  Average loss: 0.0022, Accuracy: 495/506 (97.8261%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 29, internal_epoch   6,  Average loss: 0.0018, Accuracy: 497/506 (98.2213%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 29, internal_epoch   7,  Average loss: 0.0014, Accuracy: 495/506 (97.8261%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 29, internal_epoch   8,  Average loss: 0.0011, Accuracy: 500/506 (98.8142%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 29, internal_epoch   9,  Average loss: 0.0010, Accuracy: 500/506 (98.8142%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 29, internal_epoch  10,  Average loss: 0.0010, Accuracy: 499/506 (98.6166%), train_poison_data_count: 256
Global model norm: 15.424269717347288.
Norm before scaling: 15.684946042260803. Distance: 3.610210635731742
Total norm for 10 adversaries is: 15.684946042260803. distance: 3.610210635731742
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.2576, Accuracy: 8041/8968 (89.6632%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 62, internal_epoch   1,  Average loss: 0.0127, Accuracy: 423/580 (72.9310%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 62, internal_epoch   2,  Average loss: 0.0045, Accuracy: 546/580 (94.1379%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 62, internal_epoch   3,  Average loss: 0.0050, Accuracy: 513/580 (88.4483%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 62, internal_epoch   4,  Average loss: 0.0014, Accuracy: 563/580 (97.0690%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 62, internal_epoch   5,  Average loss: 0.0017, Accuracy: 556/580 (95.8621%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 62, internal_epoch   6,  Average loss: 0.0014, Accuracy: 563/580 (97.0690%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 62, internal_epoch   7,  Average loss: 0.0012, Accuracy: 569/580 (98.1034%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 62, internal_epoch   8,  Average loss: 0.0009, Accuracy: 571/580 (98.4483%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 62, internal_epoch   9,  Average loss: 0.0012, Accuracy: 571/580 (98.4483%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 62, internal_epoch  10,  Average loss: 0.0011, Accuracy: 568/580 (97.9310%), train_poison_data_count: 292
Global model norm: 15.424269717347288.
Norm before scaling: 15.745702247985847. Distance: 3.0803725658844128
Total norm for 10 adversaries is: 15.745702247985847. distance: 3.0803725658844128
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0219, Accuracy: 8889/8968 (99.1191%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 33, internal_epoch   1,  Average loss: 0.0240, Accuracy: 293/587 (49.9148%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 33, internal_epoch   2,  Average loss: 0.0149, Accuracy: 305/587 (51.9591%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 33, internal_epoch   3,  Average loss: 0.0167, Accuracy: 292/587 (49.7445%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 33, internal_epoch   4,  Average loss: 0.0135, Accuracy: 296/587 (50.4259%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 33, internal_epoch   5,  Average loss: 0.0128, Accuracy: 299/587 (50.9370%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 33, internal_epoch   6,  Average loss: 0.0132, Accuracy: 297/587 (50.5963%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 33, internal_epoch   7,  Average loss: 0.0128, Accuracy: 304/587 (51.7888%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 33, internal_epoch   8,  Average loss: 0.0126, Accuracy: 304/587 (51.7888%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 33, internal_epoch   9,  Average loss: 0.0125, Accuracy: 320/587 (54.5145%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 33, internal_epoch  10,  Average loss: 0.0127, Accuracy: 307/587 (52.2998%), train_poison_data_count: 299
Global model norm: 15.424269717347288.
Norm before scaling: 15.56100027678998. Distance: 3.3581016788776887
Total norm for 10 adversaries is: 15.56100027678998. distance: 3.3581016788776887
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.4207, Accuracy: 7843/8968 (87.4554%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 88, internal_epoch   1,  Average loss: 0.0160, Accuracy: 461/734 (62.8065%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 88, internal_epoch   2,  Average loss: 0.0102, Accuracy: 481/734 (65.5313%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 88, internal_epoch   3,  Average loss: 0.0095, Accuracy: 478/734 (65.1226%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 88, internal_epoch   4,  Average loss: 0.0089, Accuracy: 493/734 (67.1662%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 88, internal_epoch   5,  Average loss: 0.0089, Accuracy: 488/734 (66.4850%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 88, internal_epoch   6,  Average loss: 0.0088, Accuracy: 490/734 (66.7575%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 88, internal_epoch   7,  Average loss: 0.0087, Accuracy: 494/734 (67.3025%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 88, internal_epoch   8,  Average loss: 0.0086, Accuracy: 485/734 (66.0763%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 88, internal_epoch   9,  Average loss: 0.0088, Accuracy: 489/734 (66.6213%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 88, internal_epoch  10,  Average loss: 0.0083, Accuracy: 510/734 (69.4823%), train_poison_data_count: 382
Global model norm: 15.424269717347288.
Norm before scaling: 15.525453894425429. Distance: 3.079420872279457
Total norm for 10 adversaries is: 15.525453894425429. distance: 3.079420872279457
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.2158, Accuracy: 8744/8968 (97.5022%)
___Train Local_Simple,  epoch  29, local model 75, internal_epoch   1,  Average loss: 0.0021, Accuracy: 728/763 (95.4128%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 5.2802, Accuracy: 3346/10000 (33.4600%)
___Train Local_Simple,  epoch  29, local model 94, internal_epoch   1,  Average loss: 0.0011, Accuracy: 655/671 (97.6155%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 3.3391, Accuracy: 5530/10000 (55.3000%)
___Train Local_Simple,  epoch  29, local model 70, internal_epoch   1,  Average loss: 0.0016, Accuracy: 553/568 (97.3592%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 3.0579, Accuracy: 3876/10000 (38.7600%)
___Train Local_Simple,  epoch  29, local model 25, internal_epoch   1,  Average loss: 0.0006, Accuracy: 585/592 (98.8176%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 3.3762, Accuracy: 5246/10000 (52.4600%)
___Train Local_Simple,  epoch  29, local model 24, internal_epoch   1,  Average loss: 0.0021, Accuracy: 462/477 (96.8553%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.3457, Accuracy: 5926/10000 (59.2600%)
___Train Local_Simple,  epoch  29, local model 79, internal_epoch   1,  Average loss: 0.0014, Accuracy: 645/661 (97.5794%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.3773, Accuracy: 5124/10000 (51.2400%)
___Train Local_Simple,  epoch  29, local model 65, internal_epoch   1,  Average loss: 0.0022, Accuracy: 596/621 (95.9742%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 3.5306, Accuracy: 3480/10000 (34.8000%)
___Train Local_Simple,  epoch  29, local model 39, internal_epoch   1,  Average loss: 0.0011, Accuracy: 480/493 (97.3631%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 3.5129, Accuracy: 5040/10000 (50.4000%)
___Train Local_Simple,  epoch  29, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 696/713 (97.6157%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 10.3191, Accuracy: 1991/10000 (19.9100%)
___Train Local_Simple,  epoch  29, local model 61, internal_epoch   1,  Average loss: 0.0017, Accuracy: 276/287 (96.1672%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.0292, Accuracy: 7200/10000 (72.0000%)
___Train Local_Simple,  epoch  29, local model 67, internal_epoch   1,  Average loss: 0.0020, Accuracy: 428/441 (97.0522%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.2722, Accuracy: 4016/10000 (40.1600%)
___Train Local_Simple,  epoch  29, local model 60, internal_epoch   1,  Average loss: 0.0016, Accuracy: 550/571 (96.3222%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 6.7105, Accuracy: 2912/10000 (29.1200%)
___Train Local_Simple,  epoch  29, local model 86, internal_epoch   1,  Average loss: 0.0007, Accuracy: 682/692 (98.5549%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 5.6196, Accuracy: 2632/10000 (26.3200%)
___Train Local_Simple,  epoch  29, local model 97, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1101/1112 (99.0108%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 7.3383, Accuracy: 3481/10000 (34.8100%)
___Train Local_Simple,  epoch  29, local model 76, internal_epoch   1,  Average loss: 0.0030, Accuracy: 440/459 (95.8606%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.8685, Accuracy: 5522/10000 (55.2200%)
___Train Local_Simple,  epoch  29, local model 31, internal_epoch   1,  Average loss: 0.0011, Accuracy: 580/596 (97.3154%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 3.6592, Accuracy: 4589/10000 (45.8900%)
___Train Local_Simple,  epoch  29, local model 42, internal_epoch   1,  Average loss: 0.0005, Accuracy: 469/473 (99.1543%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.8243, Accuracy: 7390/10000 (73.9000%)
___Train Local_Simple,  epoch  29, local model 5, internal_epoch   1,  Average loss: 0.0017, Accuracy: 560/578 (96.8858%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.6705, Accuracy: 5908/10000 (59.0800%)
___Train Local_Simple,  epoch  29, local model 7, internal_epoch   1,  Average loss: 0.0005, Accuracy: 797/802 (99.3766%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.7434, Accuracy: 6326/10000 (63.2600%)
___Train Local_Simple,  epoch  29, local model 55, internal_epoch   1,  Average loss: 0.0013, Accuracy: 368/375 (98.1333%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.2006, Accuracy: 5406/10000 (54.0600%)
___Train Local_Simple,  epoch  29, local model 78, internal_epoch   1,  Average loss: 0.0029, Accuracy: 559/587 (95.2300%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 4.9006, Accuracy: 2759/10000 (27.5900%)
___Train Local_Simple,  epoch  29, local model 99, internal_epoch   1,  Average loss: 0.0024, Accuracy: 669/712 (93.9607%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.9363, Accuracy: 7208/10000 (72.0800%)
___Train Local_Simple,  epoch  29, local model 40, internal_epoch   1,  Average loss: 0.0005, Accuracy: 495/498 (99.3976%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.5113, Accuracy: 5219/10000 (52.1900%)
___Train Local_Simple,  epoch  29, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 544/561 (96.9697%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.9122, Accuracy: 4564/10000 (45.6400%)
___Train Local_Simple,  epoch  29, local model 37, internal_epoch   1,  Average loss: 0.0009, Accuracy: 449/456 (98.4649%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.3031, Accuracy: 6721/10000 (67.2100%)
___Train Local_Simple,  epoch  29, local model 8, internal_epoch   1,  Average loss: 0.0007, Accuracy: 697/706 (98.7252%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.9701, Accuracy: 4982/10000 (49.8200%)
___Train Local_Simple,  epoch  29, local model 28, internal_epoch   1,  Average loss: 0.0009, Accuracy: 600/611 (98.1997%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 3.0052, Accuracy: 5648/10000 (56.4800%)
___Train Local_Simple,  epoch  29, local model 63, internal_epoch   1,  Average loss: 0.0022, Accuracy: 293/303 (96.6997%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.4236, Accuracy: 4959/10000 (49.5900%)
___Train Local_Simple,  epoch  29, local model 80, internal_epoch   1,  Average loss: 0.0023, Accuracy: 507/532 (95.3008%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 7.6366, Accuracy: 2824/10000 (28.2400%)
___Train Local_Simple,  epoch  29, local model 27, internal_epoch   1,  Average loss: 0.0021, Accuracy: 715/745 (95.9732%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 3.7790, Accuracy: 3593/10000 (35.9300%)
___Train Local_Simple,  epoch  29, local model 58, internal_epoch   1,  Average loss: 0.0010, Accuracy: 758/772 (98.1865%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 4.1037, Accuracy: 4028/10000 (40.2800%)
___Train Local_Simple,  epoch  29, local model 66, internal_epoch   1,  Average loss: 0.0024, Accuracy: 706/733 (96.3165%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 6.1130, Accuracy: 2640/10000 (26.4000%)
___Train Local_Simple,  epoch  29, local model 68, internal_epoch   1,  Average loss: 0.0020, Accuracy: 530/549 (96.5392%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 3.7018, Accuracy: 4286/10000 (42.8600%)
___Train Local_Simple,  epoch  29, local model 91, internal_epoch   1,  Average loss: 0.0007, Accuracy: 807/819 (98.5348%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.9633, Accuracy: 4103/10000 (41.0300%)
___Train Local_Simple,  epoch  29, local model 22, internal_epoch   1,  Average loss: 0.0013, Accuracy: 253/262 (96.5649%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.5317, Accuracy: 7096/10000 (70.9600%)
___Train Local_Simple,  epoch  29, local model 19, internal_epoch   1,  Average loss: 0.0013, Accuracy: 579/598 (96.8227%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 3.3452, Accuracy: 4481/10000 (44.8100%)
___Train Local_Simple,  epoch  29, local model 98, internal_epoch   1,  Average loss: 0.0015, Accuracy: 527/548 (96.1679%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 4.5902, Accuracy: 3975/10000 (39.7500%)
___Train Local_Simple,  epoch  29, local model 96, internal_epoch   1,  Average loss: 0.0017, Accuracy: 514/531 (96.7985%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 5.6792, Accuracy: 3403/10000 (34.0300%)
___Train Local_Simple,  epoch  29, local model 14, internal_epoch   1,  Average loss: 0.0015, Accuracy: 675/692 (97.5434%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.5055, Accuracy: 6305/10000 (63.0500%)
___Train Local_Simple,  epoch  29, local model 57, internal_epoch   1,  Average loss: 0.0009, Accuracy: 513/523 (98.0880%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.6975, Accuracy: 4179/10000 (41.7900%)
___Train Local_Simple,  epoch  29, local model 47, internal_epoch   1,  Average loss: 0.0010, Accuracy: 524/534 (98.1273%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.6794, Accuracy: 4955/10000 (49.5500%)
___Train Local_Simple,  epoch  29, local model 90, internal_epoch   1,  Average loss: 0.0027, Accuracy: 583/615 (94.7967%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 5.5032, Accuracy: 3155/10000 (31.5500%)
___Train Local_Simple,  epoch  29, local model 43, internal_epoch   1,  Average loss: 0.0011, Accuracy: 422/431 (97.9118%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.1350, Accuracy: 5934/10000 (59.3400%)
___Train Local_Simple,  epoch  29, local model 85, internal_epoch   1,  Average loss: 0.0020, Accuracy: 768/807 (95.1673%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 3.7835, Accuracy: 4263/10000 (42.6300%)
___Train Local_Simple,  epoch  29, local model 56, internal_epoch   1,  Average loss: 0.0006, Accuracy: 706/715 (98.7413%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 3.0733, Accuracy: 4044/10000 (40.4400%)
___Train Local_Simple,  epoch  29, local model 34, internal_epoch   1,  Average loss: 0.0016, Accuracy: 838/871 (96.2113%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 4.6657, Accuracy: 4558/10000 (45.5800%)
___Train Local_Simple,  epoch  29, local model 1, internal_epoch   1,  Average loss: 0.0006, Accuracy: 531/536 (99.0672%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.8299, Accuracy: 7865/10000 (78.6500%)
___Train Local_Simple,  epoch  29, local model 46, internal_epoch   1,  Average loss: 0.0012, Accuracy: 636/650 (97.8462%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 4.6515, Accuracy: 4217/10000 (42.1700%)
___Train Local_Simple,  epoch  29, local model 44, internal_epoch   1,  Average loss: 0.0009, Accuracy: 549/561 (97.8610%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 4.3139, Accuracy: 4881/10000 (48.8100%)
___Train Local_Simple,  epoch  29, local model 81, internal_epoch   1,  Average loss: 0.0014, Accuracy: 621/636 (97.6415%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.7648, Accuracy: 3965/10000 (39.6500%)
___Train Local_Simple,  epoch  29, local model 30, internal_epoch   1,  Average loss: 0.0034, Accuracy: 416/443 (93.9052%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.3585, Accuracy: 5019/10000 (50.1900%)
___Train Local_Simple,  epoch  29, local model 35, internal_epoch   1,  Average loss: 0.0011, Accuracy: 618/630 (98.0952%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 4.1963, Accuracy: 4218/10000 (42.1800%)
___Train Local_Simple,  epoch  29, local model 50, internal_epoch   1,  Average loss: 0.0013, Accuracy: 466/477 (97.6939%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.6178, Accuracy: 4746/10000 (47.4600%)
___Train Local_Simple,  epoch  29, local model 52, internal_epoch   1,  Average loss: 0.0015, Accuracy: 767/789 (97.2117%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 3.6023, Accuracy: 3842/10000 (38.4200%)
___Train Local_Simple,  epoch  29, local model 15, internal_epoch   1,  Average loss: 0.0017, Accuracy: 276/282 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.7128, Accuracy: 7755/10000 (77.5500%)
___Train Local_Simple,  epoch  29, local model 12, internal_epoch   1,  Average loss: 0.0016, Accuracy: 698/725 (96.2759%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 4.0586, Accuracy: 3710/10000 (37.1000%)
___Train Local_Simple,  epoch  29, local model 84, internal_epoch   1,  Average loss: 0.0021, Accuracy: 400/420 (95.2381%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 4.3273, Accuracy: 4354/10000 (43.5400%)
___Train Local_Simple,  epoch  29, local model 45, internal_epoch   1,  Average loss: 0.0016, Accuracy: 637/647 (98.4544%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 3.6682, Accuracy: 4017/10000 (40.1700%)
___Train Local_Simple,  epoch  29, local model 0, internal_epoch   1,  Average loss: 0.0007, Accuracy: 431/435 (99.0805%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.5982, Accuracy: 6247/10000 (62.4700%)
___Train Local_Simple,  epoch  29, local model 4, internal_epoch   1,  Average loss: 0.0009, Accuracy: 735/748 (98.2620%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 6.4921, Accuracy: 3027/10000 (30.2700%)
___Train Local_Simple,  epoch  29, local model 11, internal_epoch   1,  Average loss: 0.0008, Accuracy: 546/554 (98.5560%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.6303, Accuracy: 6262/10000 (62.6200%)
___Train Local_Simple,  epoch  29, local model 38, internal_epoch   1,  Average loss: 0.0011, Accuracy: 465/477 (97.4843%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.7811, Accuracy: 7676/10000 (76.7600%)
___Train Local_Simple,  epoch  29, local model 6, internal_epoch   1,  Average loss: 0.0026, Accuracy: 412/435 (94.7126%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.9937, Accuracy: 5380/10000 (53.8000%)
___Train Local_Simple,  epoch  29, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 308/315 (97.7778%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.4328, Accuracy: 8530/10000 (85.3000%)
___Train Local_Simple,  epoch  29, local model 20, internal_epoch   1,  Average loss: 0.0017, Accuracy: 581/602 (96.5116%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 4.4976, Accuracy: 3925/10000 (39.2500%)
___Train Local_Simple,  epoch  29, local model 49, internal_epoch   1,  Average loss: 0.0018, Accuracy: 341/355 (96.0563%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.4283, Accuracy: 5988/10000 (59.8800%)
___Train Local_Simple,  epoch  29, local model 10, internal_epoch   1,  Average loss: 0.0014, Accuracy: 557/573 (97.2077%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.2398, Accuracy: 5308/10000 (53.0800%)
___Train Local_Simple,  epoch  29, local model 54, internal_epoch   1,  Average loss: 0.0007, Accuracy: 817/832 (98.1971%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 4.1214, Accuracy: 3807/10000 (38.0700%)
___Train Local_Simple,  epoch  29, local model 64, internal_epoch   1,  Average loss: 0.0008, Accuracy: 598/608 (98.3553%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 4.6315, Accuracy: 3423/10000 (34.2300%)
___Train Local_Simple,  epoch  29, local model 53, internal_epoch   1,  Average loss: 0.0013, Accuracy: 548/561 (97.6827%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 5.4017, Accuracy: 4018/10000 (40.1800%)
___Train Local_Simple,  epoch  29, local model 89, internal_epoch   1,  Average loss: 0.0019, Accuracy: 662/683 (96.9253%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.1902, Accuracy: 5479/10000 (54.7900%)
___Train Local_Simple,  epoch  29, local model 83, internal_epoch   1,  Average loss: 0.0017, Accuracy: 345/360 (95.8333%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.2112, Accuracy: 6681/10000 (66.8100%)
___Train Local_Simple,  epoch  29, local model 82, internal_epoch   1,  Average loss: 0.0009, Accuracy: 801/815 (98.2822%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 5.9998, Accuracy: 3168/10000 (31.6800%)
___Train Local_Simple,  epoch  29, local model 87, internal_epoch   1,  Average loss: 0.0012, Accuracy: 648/663 (97.7376%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 5.9237, Accuracy: 3432/10000 (34.3200%)
___Train Local_Simple,  epoch  29, local model 17, internal_epoch   1,  Average loss: 0.0009, Accuracy: 515/527 (97.7230%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 6.1458, Accuracy: 3313/10000 (33.1300%)
___Train Local_Simple,  epoch  29, local model 93, internal_epoch   1,  Average loss: 0.0020, Accuracy: 602/630 (95.5556%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 5.6420, Accuracy: 3168/10000 (31.6800%)
___Train Local_Simple,  epoch  29, local model 21, internal_epoch   1,  Average loss: 0.0009, Accuracy: 675/687 (98.2533%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 5.6106, Accuracy: 3746/10000 (37.4600%)
___Train Local_Simple,  epoch  29, local model 59, internal_epoch   1,  Average loss: 0.0016, Accuracy: 623/644 (96.7391%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 8.4883, Accuracy: 2062/10000 (20.6200%)
___Train Local_Simple,  epoch  29, local model 16, internal_epoch   1,  Average loss: 0.0013, Accuracy: 800/817 (97.9192%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 4.4436, Accuracy: 3873/10000 (38.7300%)
___Train Local_Simple,  epoch  29, local model 69, internal_epoch   1,  Average loss: 0.0020, Accuracy: 646/671 (96.2742%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 4.5104, Accuracy: 3606/10000 (36.0600%)
___Train Local_Simple,  epoch  29, local model 72, internal_epoch   1,  Average loss: 0.0022, Accuracy: 409/423 (96.6903%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 3.4561, Accuracy: 3568/10000 (35.6800%)
___Train Local_Simple,  epoch  29, local model 77, internal_epoch   1,  Average loss: 0.0022, Accuracy: 590/618 (95.4693%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.8372, Accuracy: 5954/10000 (59.5400%)
___Train Local_Simple,  epoch  29, local model 26, internal_epoch   1,  Average loss: 0.0015, Accuracy: 508/519 (97.8805%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 4.1584, Accuracy: 3987/10000 (39.8700%)
___Train Local_Simple,  epoch  29, local model 2, internal_epoch   1,  Average loss: 0.0016, Accuracy: 548/564 (97.1631%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 3.8958, Accuracy: 3667/10000 (36.6700%)
___Train Local_Simple,  epoch  29, local model 95, internal_epoch   1,  Average loss: 0.0019, Accuracy: 582/600 (97.0000%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.9081, Accuracy: 4758/10000 (47.5800%)
___Train Local_Simple,  epoch  29, local model 92, internal_epoch   1,  Average loss: 0.0029, Accuracy: 571/611 (93.4534%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 7.0566, Accuracy: 2751/10000 (27.5100%)
___Train Local_Simple,  epoch  29, local model 9, internal_epoch   1,  Average loss: 0.0011, Accuracy: 498/508 (98.0315%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.0797, Accuracy: 6586/10000 (65.8600%)
___Train Local_Simple,  epoch  29, local model 48, internal_epoch   1,  Average loss: 0.0016, Accuracy: 354/363 (97.5207%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.8076, Accuracy: 7664/10000 (76.6400%)
___Train Local_Simple,  epoch  29, local model 32, internal_epoch   1,  Average loss: 0.0011, Accuracy: 578/590 (97.9661%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 3.4231, Accuracy: 4689/10000 (46.8900%)
___Train Local_Simple,  epoch  29, local model 23, internal_epoch   1,  Average loss: 0.0015, Accuracy: 527/542 (97.2325%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.9872, Accuracy: 3973/10000 (39.7300%)
time spent on training: 351.91766238212585
___Test Target_Simple poisoned: False, epoch: 29: Average loss: 0.2076, Accuracy: 9408/10000 (94.0800%)
___Test Target_Simple poisoned: True, epoch: 29: Average loss: 3.8560, Accuracy: 373/8968 (4.1592%)
saving model
Done in 380.1472692489624 sec.
Server Epoch:30 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 93, 54, 39, 89, 97, 32, 95, 19, 30, 1, 46, 27, 28, 92, 68, 15, 0, 87, 61, 50, 56, 12, 64, 65, 48, 47, 77, 49, 80, 78, 58, 81, 91, 96, 75, 11, 82, 44, 4, 36, 60, 7, 9, 37, 76, 34, 13, 25, 67, 98, 84, 38, 8, 14, 99, 31, 79, 10, 52, 40, 63, 35, 69, 16, 55, 72, 23, 70, 59, 2, 22, 90, 20, 71, 24, 45, 57, 17, 5, 83, 66, 43, 86, 26, 42, 6, 85, 94, 53, 21].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   1,  Average loss: 0.0212, Accuracy: 287/569 (50.4394%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   2,  Average loss: 0.0134, Accuracy: 283/569 (49.7364%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   3,  Average loss: 0.0125, Accuracy: 292/569 (51.3181%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   4,  Average loss: 0.0114, Accuracy: 309/569 (54.3058%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   5,  Average loss: 0.0114, Accuracy: 295/569 (51.8453%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   6,  Average loss: 0.0114, Accuracy: 294/569 (51.6696%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   7,  Average loss: 0.0115, Accuracy: 282/569 (49.5606%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   8,  Average loss: 0.0114, Accuracy: 291/569 (51.1424%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch   9,  Average loss: 0.0113, Accuracy: 303/569 (53.2513%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 41, internal_epoch  10,  Average loss: 0.0113, Accuracy: 310/569 (54.4815%), train_poison_data_count: 288
Global model norm: 15.42014340899287.
Norm before scaling: 15.472396883082375. Distance: 2.7955539929561293
Total norm for 10 adversaries is: 15.472396883082375. distance: 2.7955539929561293
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.4308, Accuracy: 8457/8968 (94.3020%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   1,  Average loss: 0.0149, Accuracy: 359/522 (68.7739%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   2,  Average loss: 0.0088, Accuracy: 364/522 (69.7318%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   3,  Average loss: 0.0100, Accuracy: 371/522 (71.0728%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   4,  Average loss: 0.0074, Accuracy: 389/522 (74.5211%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   5,  Average loss: 0.0070, Accuracy: 395/522 (75.6705%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   6,  Average loss: 0.0071, Accuracy: 379/522 (72.6054%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   7,  Average loss: 0.0079, Accuracy: 383/522 (73.3716%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   8,  Average loss: 0.0075, Accuracy: 387/522 (74.1379%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   9,  Average loss: 0.0069, Accuracy: 400/522 (76.6284%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch  10,  Average loss: 0.0071, Accuracy: 393/522 (75.2874%), train_poison_data_count: 266
Global model norm: 15.42014340899287.
Norm before scaling: 15.447187959131156. Distance: 2.4995599359391347
Total norm for 10 adversaries is: 15.447187959131156. distance: 2.4995599359391347
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0778, Accuracy: 8962/8968 (99.9331%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   1,  Average loss: 0.0229, Accuracy: 195/385 (50.6494%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   2,  Average loss: 0.0161, Accuracy: 225/385 (58.4416%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   3,  Average loss: 0.0152, Accuracy: 224/385 (58.1818%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   4,  Average loss: 0.0103, Accuracy: 267/385 (69.3506%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   5,  Average loss: 0.0088, Accuracy: 326/385 (84.6753%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   6,  Average loss: 0.0062, Accuracy: 356/385 (92.4675%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   7,  Average loss: 0.0048, Accuracy: 367/385 (95.3247%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   8,  Average loss: 0.0038, Accuracy: 369/385 (95.8442%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch   9,  Average loss: 0.0030, Accuracy: 375/385 (97.4026%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 51, internal_epoch  10,  Average loss: 0.0029, Accuracy: 379/385 (98.4416%), train_poison_data_count: 193
Global model norm: 15.42014340899287.
Norm before scaling: 15.593437849142765. Distance: 3.031358225355375
Total norm for 10 adversaries is: 15.593437849142765. distance: 3.031358225355375
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.2277, Accuracy: 8419/8968 (93.8782%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   1,  Average loss: 0.0104, Accuracy: 482/627 (76.8740%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   2,  Average loss: 0.0032, Accuracy: 586/627 (93.4609%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   3,  Average loss: 0.0012, Accuracy: 614/627 (97.9266%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   4,  Average loss: 0.0010, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   5,  Average loss: 0.0013, Accuracy: 612/627 (97.6077%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   6,  Average loss: 0.0008, Accuracy: 620/627 (98.8836%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   7,  Average loss: 0.0010, Accuracy: 620/627 (98.8836%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   8,  Average loss: 0.0005, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch   9,  Average loss: 0.0006, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 74, internal_epoch  10,  Average loss: 0.0007, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Global model norm: 15.42014340899287.
Norm before scaling: 15.639302048195358. Distance: 2.782791567707103
Total norm for 10 adversaries is: 15.639302048195358. distance: 2.782791567707103
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0059, Accuracy: 8945/8968 (99.7435%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 3, internal_epoch   1,  Average loss: 0.0258, Accuracy: 251/516 (48.6434%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 3, internal_epoch   2,  Average loss: 0.0150, Accuracy: 259/516 (50.1938%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 3, internal_epoch   3,  Average loss: 0.0161, Accuracy: 243/516 (47.0930%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 3, internal_epoch   4,  Average loss: 0.0132, Accuracy: 260/516 (50.3876%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 3, internal_epoch   5,  Average loss: 0.0137, Accuracy: 261/516 (50.5814%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 3, internal_epoch   6,  Average loss: 0.0132, Accuracy: 252/516 (48.8372%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 3, internal_epoch   7,  Average loss: 0.0128, Accuracy: 265/516 (51.3566%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 3, internal_epoch   8,  Average loss: 0.0127, Accuracy: 261/516 (50.5814%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 3, internal_epoch   9,  Average loss: 0.0126, Accuracy: 262/516 (50.7752%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 3, internal_epoch  10,  Average loss: 0.0125, Accuracy: 261/516 (50.5814%), train_poison_data_count: 260
Global model norm: 15.42014340899287.
Norm before scaling: 15.590062013004822. Distance: 3.7233947469711643
Total norm for 10 adversaries is: 15.590062013004822. distance: 3.7233947469711643
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.5384, Accuracy: 8413/8968 (93.8113%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 18, internal_epoch   1,  Average loss: 0.0198, Accuracy: 392/759 (51.6469%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 18, internal_epoch   2,  Average loss: 0.0127, Accuracy: 395/759 (52.0422%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 18, internal_epoch   3,  Average loss: 0.0106, Accuracy: 436/759 (57.4440%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 18, internal_epoch   4,  Average loss: 0.0096, Accuracy: 534/759 (70.3557%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 18, internal_epoch   5,  Average loss: 0.0077, Accuracy: 649/759 (85.5072%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 18, internal_epoch   6,  Average loss: 0.0053, Accuracy: 722/759 (95.1252%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 18, internal_epoch   7,  Average loss: 0.0027, Accuracy: 746/759 (98.2872%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 18, internal_epoch   8,  Average loss: 0.0014, Accuracy: 753/759 (99.2095%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 18, internal_epoch   9,  Average loss: 0.0010, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 18, internal_epoch  10,  Average loss: 0.0011, Accuracy: 750/759 (98.8142%), train_poison_data_count: 384
Global model norm: 15.42014340899287.
Norm before scaling: 15.729760138155516. Distance: 3.8867013288711334
Total norm for 10 adversaries is: 15.729760138155516. distance: 3.8867013288711334
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0978, Accuracy: 8636/8968 (96.2979%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 29, internal_epoch   1,  Average loss: 0.0180, Accuracy: 267/506 (52.7668%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 29, internal_epoch   2,  Average loss: 0.0083, Accuracy: 397/506 (78.4585%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 29, internal_epoch   3,  Average loss: 0.0027, Accuracy: 482/506 (95.2569%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 29, internal_epoch   4,  Average loss: 0.0019, Accuracy: 493/506 (97.4308%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 29, internal_epoch   5,  Average loss: 0.0014, Accuracy: 497/506 (98.2213%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 29, internal_epoch   6,  Average loss: 0.0010, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 29, internal_epoch   7,  Average loss: 0.0008, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 29, internal_epoch   8,  Average loss: 0.0008, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 29, internal_epoch   9,  Average loss: 0.0008, Accuracy: 500/506 (98.8142%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 29, internal_epoch  10,  Average loss: 0.0008, Accuracy: 500/506 (98.8142%), train_poison_data_count: 256
Global model norm: 15.42014340899287.
Norm before scaling: 15.663044504015355. Distance: 3.067228442718967
Total norm for 10 adversaries is: 15.663044504015355. distance: 3.067228442718967
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.2837, Accuracy: 7944/8968 (88.5816%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 62, internal_epoch   1,  Average loss: 0.0101, Accuracy: 453/580 (78.1034%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 62, internal_epoch   2,  Average loss: 0.0034, Accuracy: 546/580 (94.1379%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 62, internal_epoch   3,  Average loss: 0.0018, Accuracy: 556/580 (95.8621%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 62, internal_epoch   4,  Average loss: 0.0011, Accuracy: 567/580 (97.7586%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 62, internal_epoch   5,  Average loss: 0.0011, Accuracy: 566/580 (97.5862%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 62, internal_epoch   6,  Average loss: 0.0010, Accuracy: 568/580 (97.9310%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 62, internal_epoch   7,  Average loss: 0.0010, Accuracy: 565/580 (97.4138%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 62, internal_epoch   8,  Average loss: 0.0010, Accuracy: 568/580 (97.9310%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 62, internal_epoch   9,  Average loss: 0.0010, Accuracy: 570/580 (98.2759%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 62, internal_epoch  10,  Average loss: 0.0006, Accuracy: 572/580 (98.6207%), train_poison_data_count: 292
Global model norm: 15.42014340899287.
Norm before scaling: 15.737340289722761. Distance: 2.883139160174401
Total norm for 10 adversaries is: 15.737340289722761. distance: 2.883139160174401
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0169, Accuracy: 8900/8968 (99.2417%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 33, internal_epoch   1,  Average loss: 0.0213, Accuracy: 288/587 (49.0630%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 33, internal_epoch   2,  Average loss: 0.0136, Accuracy: 300/587 (51.1073%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 33, internal_epoch   3,  Average loss: 0.0154, Accuracy: 294/587 (50.0852%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 33, internal_epoch   4,  Average loss: 0.0128, Accuracy: 309/587 (52.6405%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 33, internal_epoch   5,  Average loss: 0.0124, Accuracy: 306/587 (52.1295%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 33, internal_epoch   6,  Average loss: 0.0127, Accuracy: 309/587 (52.6405%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 33, internal_epoch   7,  Average loss: 0.0125, Accuracy: 296/587 (50.4259%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 33, internal_epoch   8,  Average loss: 0.0122, Accuracy: 316/587 (53.8330%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 33, internal_epoch   9,  Average loss: 0.0125, Accuracy: 292/587 (49.7445%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 33, internal_epoch  10,  Average loss: 0.0125, Accuracy: 298/587 (50.7666%), train_poison_data_count: 299
Global model norm: 15.42014340899287.
Norm before scaling: 15.48744185146595. Distance: 2.730249136850643
Total norm for 10 adversaries is: 15.48744185146595. distance: 2.730249136850643
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.4239, Accuracy: 8301/8968 (92.5624%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 88, internal_epoch   1,  Average loss: 0.0145, Accuracy: 447/734 (60.8992%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 88, internal_epoch   2,  Average loss: 0.0116, Accuracy: 475/734 (64.7139%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 88, internal_epoch   3,  Average loss: 0.0099, Accuracy: 479/734 (65.2589%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 88, internal_epoch   4,  Average loss: 0.0089, Accuracy: 487/734 (66.3488%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 88, internal_epoch   5,  Average loss: 0.0086, Accuracy: 510/734 (69.4823%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 88, internal_epoch   6,  Average loss: 0.0088, Accuracy: 490/734 (66.7575%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 88, internal_epoch   7,  Average loss: 0.0083, Accuracy: 509/734 (69.3460%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 88, internal_epoch   8,  Average loss: 0.0079, Accuracy: 531/734 (72.3433%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 88, internal_epoch   9,  Average loss: 0.0077, Accuracy: 542/734 (73.8420%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 88, internal_epoch  10,  Average loss: 0.0077, Accuracy: 524/734 (71.3896%), train_poison_data_count: 382
Global model norm: 15.42014340899287.
Norm before scaling: 15.541315451464012. Distance: 2.8491702561766363
Total norm for 10 adversaries is: 15.541315451464012. distance: 2.8491702561766363
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.1659, Accuracy: 8815/8968 (98.2939%)
___Train Local_Simple,  epoch  30, local model 93, internal_epoch   1,  Average loss: 0.0024, Accuracy: 607/630 (96.3492%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 3.3102, Accuracy: 3585/10000 (35.8500%)
___Train Local_Simple,  epoch  30, local model 54, internal_epoch   1,  Average loss: 0.0016, Accuracy: 805/832 (96.7548%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 6.4140, Accuracy: 3291/10000 (32.9100%)
___Train Local_Simple,  epoch  30, local model 39, internal_epoch   1,  Average loss: 0.0007, Accuracy: 487/493 (98.7830%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.0599, Accuracy: 5903/10000 (59.0300%)
___Train Local_Simple,  epoch  30, local model 89, internal_epoch   1,  Average loss: 0.0041, Accuracy: 626/683 (91.6545%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 4.2296, Accuracy: 4753/10000 (47.5300%)
___Train Local_Simple,  epoch  30, local model 97, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1097/1112 (98.6511%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 6.8948, Accuracy: 3619/10000 (36.1900%)
___Train Local_Simple,  epoch  30, local model 32, internal_epoch   1,  Average loss: 0.0013, Accuracy: 575/590 (97.4576%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 3.4968, Accuracy: 5372/10000 (53.7200%)
___Train Local_Simple,  epoch  30, local model 95, internal_epoch   1,  Average loss: 0.0031, Accuracy: 566/600 (94.3333%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 5.3104, Accuracy: 4183/10000 (41.8300%)
___Train Local_Simple,  epoch  30, local model 19, internal_epoch   1,  Average loss: 0.0015, Accuracy: 579/598 (96.8227%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.1816, Accuracy: 4830/10000 (48.3000%)
___Train Local_Simple,  epoch  30, local model 30, internal_epoch   1,  Average loss: 0.0009, Accuracy: 439/443 (99.0971%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.1409, Accuracy: 7291/10000 (72.9100%)
___Train Local_Simple,  epoch  30, local model 1, internal_epoch   1,  Average loss: 0.0006, Accuracy: 533/536 (99.4403%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.5931, Accuracy: 8061/10000 (80.6100%)
___Train Local_Simple,  epoch  30, local model 46, internal_epoch   1,  Average loss: 0.0010, Accuracy: 640/650 (98.4615%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.4622, Accuracy: 5471/10000 (54.7100%)
___Train Local_Simple,  epoch  30, local model 27, internal_epoch   1,  Average loss: 0.0018, Accuracy: 724/745 (97.1812%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 3.9778, Accuracy: 3410/10000 (34.1000%)
___Train Local_Simple,  epoch  30, local model 28, internal_epoch   1,  Average loss: 0.0020, Accuracy: 586/611 (95.9083%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 6.0554, Accuracy: 4559/10000 (45.5900%)
___Train Local_Simple,  epoch  30, local model 92, internal_epoch   1,  Average loss: 0.0039, Accuracy: 566/611 (92.6350%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 3.7986, Accuracy: 3309/10000 (33.0900%)
___Train Local_Simple,  epoch  30, local model 68, internal_epoch   1,  Average loss: 0.0015, Accuracy: 535/549 (97.4499%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.5907, Accuracy: 5016/10000 (50.1600%)
___Train Local_Simple,  epoch  30, local model 15, internal_epoch   1,  Average loss: 0.0012, Accuracy: 277/282 (98.2270%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.6859, Accuracy: 7633/10000 (76.3300%)
___Train Local_Simple,  epoch  30, local model 0, internal_epoch   1,  Average loss: 0.0024, Accuracy: 415/435 (95.4023%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 3.9777, Accuracy: 4349/10000 (43.4900%)
___Train Local_Simple,  epoch  30, local model 87, internal_epoch   1,  Average loss: 0.0016, Accuracy: 638/663 (96.2293%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 7.4686, Accuracy: 3651/10000 (36.5100%)
___Train Local_Simple,  epoch  30, local model 61, internal_epoch   1,  Average loss: 0.0011, Accuracy: 282/287 (98.2578%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.6525, Accuracy: 7822/10000 (78.2200%)
___Train Local_Simple,  epoch  30, local model 50, internal_epoch   1,  Average loss: 0.0013, Accuracy: 465/477 (97.4843%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.4338, Accuracy: 4890/10000 (48.9000%)
___Train Local_Simple,  epoch  30, local model 56, internal_epoch   1,  Average loss: 0.0010, Accuracy: 704/715 (98.4615%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 6.0963, Accuracy: 3380/10000 (33.8000%)
___Train Local_Simple,  epoch  30, local model 12, internal_epoch   1,  Average loss: 0.0010, Accuracy: 713/725 (98.3448%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.3336, Accuracy: 5434/10000 (54.3400%)
___Train Local_Simple,  epoch  30, local model 64, internal_epoch   1,  Average loss: 0.0005, Accuracy: 605/608 (99.5066%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.2399, Accuracy: 5535/10000 (55.3500%)
___Train Local_Simple,  epoch  30, local model 65, internal_epoch   1,  Average loss: 0.0019, Accuracy: 597/621 (96.1353%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.7719, Accuracy: 4394/10000 (43.9400%)
___Train Local_Simple,  epoch  30, local model 48, internal_epoch   1,  Average loss: 0.0019, Accuracy: 352/363 (96.9697%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.4136, Accuracy: 6917/10000 (69.1700%)
___Train Local_Simple,  epoch  30, local model 47, internal_epoch   1,  Average loss: 0.0019, Accuracy: 516/534 (96.6292%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 4.4400, Accuracy: 4697/10000 (46.9700%)
___Train Local_Simple,  epoch  30, local model 77, internal_epoch   1,  Average loss: 0.0024, Accuracy: 592/618 (95.7929%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 5.3325, Accuracy: 3209/10000 (32.0900%)
___Train Local_Simple,  epoch  30, local model 49, internal_epoch   1,  Average loss: 0.0014, Accuracy: 347/355 (97.7465%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.1975, Accuracy: 5349/10000 (53.4900%)
___Train Local_Simple,  epoch  30, local model 80, internal_epoch   1,  Average loss: 0.0019, Accuracy: 507/532 (95.3008%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 6.1869, Accuracy: 2754/10000 (27.5400%)
___Train Local_Simple,  epoch  30, local model 78, internal_epoch   1,  Average loss: 0.0039, Accuracy: 551/587 (93.8671%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.8402, Accuracy: 5286/10000 (52.8600%)
___Train Local_Simple,  epoch  30, local model 58, internal_epoch   1,  Average loss: 0.0013, Accuracy: 751/772 (97.2798%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 4.8490, Accuracy: 3159/10000 (31.5900%)
___Train Local_Simple,  epoch  30, local model 81, internal_epoch   1,  Average loss: 0.0011, Accuracy: 624/636 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 3.3567, Accuracy: 3951/10000 (39.5100%)
___Train Local_Simple,  epoch  30, local model 91, internal_epoch   1,  Average loss: 0.0013, Accuracy: 805/819 (98.2906%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 6.7117, Accuracy: 3649/10000 (36.4900%)
___Train Local_Simple,  epoch  30, local model 96, internal_epoch   1,  Average loss: 0.0015, Accuracy: 518/531 (97.5518%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.9526, Accuracy: 4600/10000 (46.0000%)
___Train Local_Simple,  epoch  30, local model 75, internal_epoch   1,  Average loss: 0.0021, Accuracy: 731/763 (95.8060%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.7702, Accuracy: 4275/10000 (42.7500%)
___Train Local_Simple,  epoch  30, local model 11, internal_epoch   1,  Average loss: 0.0007, Accuracy: 548/554 (98.9170%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.1412, Accuracy: 7217/10000 (72.1700%)
___Train Local_Simple,  epoch  30, local model 82, internal_epoch   1,  Average loss: 0.0012, Accuracy: 797/815 (97.7914%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 7.7245, Accuracy: 2971/10000 (29.7100%)
___Train Local_Simple,  epoch  30, local model 44, internal_epoch   1,  Average loss: 0.0005, Accuracy: 557/561 (99.2870%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.5016, Accuracy: 6616/10000 (66.1600%)
___Train Local_Simple,  epoch  30, local model 4, internal_epoch   1,  Average loss: 0.0008, Accuracy: 737/748 (98.5294%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 3.4367, Accuracy: 3447/10000 (34.4700%)
___Train Local_Simple,  epoch  30, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 309/315 (98.0952%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.4597, Accuracy: 8502/10000 (85.0200%)
___Train Local_Simple,  epoch  30, local model 60, internal_epoch   1,  Average loss: 0.0017, Accuracy: 548/571 (95.9720%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 6.9654, Accuracy: 2956/10000 (29.5600%)
___Train Local_Simple,  epoch  30, local model 7, internal_epoch   1,  Average loss: 0.0006, Accuracy: 796/802 (99.2519%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 3.0543, Accuracy: 4726/10000 (47.2600%)
___Train Local_Simple,  epoch  30, local model 9, internal_epoch   1,  Average loss: 0.0014, Accuracy: 495/508 (97.4409%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 3.3267, Accuracy: 4812/10000 (48.1200%)
___Train Local_Simple,  epoch  30, local model 37, internal_epoch   1,  Average loss: 0.0040, Accuracy: 438/456 (96.0526%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.8670, Accuracy: 5852/10000 (58.5200%)
___Train Local_Simple,  epoch  30, local model 76, internal_epoch   1,  Average loss: 0.0013, Accuracy: 452/459 (98.4749%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.5344, Accuracy: 8200/10000 (82.0000%)
___Train Local_Simple,  epoch  30, local model 34, internal_epoch   1,  Average loss: 0.0022, Accuracy: 841/871 (96.5557%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 4.9768, Accuracy: 3458/10000 (34.5800%)
___Train Local_Simple,  epoch  30, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 698/713 (97.8962%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 3.3086, Accuracy: 3837/10000 (38.3700%)
___Train Local_Simple,  epoch  30, local model 25, internal_epoch   1,  Average loss: 0.0004, Accuracy: 589/592 (99.4932%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.3948, Accuracy: 6822/10000 (68.2200%)
___Train Local_Simple,  epoch  30, local model 67, internal_epoch   1,  Average loss: 0.0020, Accuracy: 420/441 (95.2381%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 3.5919, Accuracy: 3627/10000 (36.2700%)
___Train Local_Simple,  epoch  30, local model 98, internal_epoch   1,  Average loss: 0.0029, Accuracy: 518/548 (94.5255%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 5.8390, Accuracy: 2912/10000 (29.1200%)
___Train Local_Simple,  epoch  30, local model 84, internal_epoch   1,  Average loss: 0.0014, Accuracy: 408/420 (97.1429%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.5866, Accuracy: 8090/10000 (80.9000%)
___Train Local_Simple,  epoch  30, local model 38, internal_epoch   1,  Average loss: 0.0010, Accuracy: 466/477 (97.6939%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.8087, Accuracy: 7592/10000 (75.9200%)
___Train Local_Simple,  epoch  30, local model 8, internal_epoch   1,  Average loss: 0.0016, Accuracy: 679/706 (96.1756%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 6.8696, Accuracy: 3134/10000 (31.3400%)
___Train Local_Simple,  epoch  30, local model 14, internal_epoch   1,  Average loss: 0.0020, Accuracy: 662/692 (95.6647%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 3.8796, Accuracy: 4755/10000 (47.5500%)
___Train Local_Simple,  epoch  30, local model 99, internal_epoch   1,  Average loss: 0.0018, Accuracy: 682/712 (95.7865%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 10.0520, Accuracy: 2777/10000 (27.7700%)
___Train Local_Simple,  epoch  30, local model 31, internal_epoch   1,  Average loss: 0.0010, Accuracy: 585/596 (98.1544%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.8336, Accuracy: 5824/10000 (58.2400%)
___Train Local_Simple,  epoch  30, local model 79, internal_epoch   1,  Average loss: 0.0015, Accuracy: 649/661 (98.1846%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.0457, Accuracy: 4656/10000 (46.5600%)
___Train Local_Simple,  epoch  30, local model 10, internal_epoch   1,  Average loss: 0.0019, Accuracy: 556/573 (97.0332%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.3532, Accuracy: 5681/10000 (56.8100%)
___Train Local_Simple,  epoch  30, local model 52, internal_epoch   1,  Average loss: 0.0030, Accuracy: 740/789 (93.7896%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 5.2011, Accuracy: 3018/10000 (30.1800%)
___Train Local_Simple,  epoch  30, local model 40, internal_epoch   1,  Average loss: 0.0016, Accuracy: 485/498 (97.3896%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 9.0298, Accuracy: 3509/10000 (35.0900%)
___Train Local_Simple,  epoch  30, local model 63, internal_epoch   1,  Average loss: 0.0026, Accuracy: 286/303 (94.3894%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 3.0251, Accuracy: 3885/10000 (38.8500%)
___Train Local_Simple,  epoch  30, local model 35, internal_epoch   1,  Average loss: 0.0014, Accuracy: 611/630 (96.9841%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 6.4949, Accuracy: 3425/10000 (34.2500%)
___Train Local_Simple,  epoch  30, local model 69, internal_epoch   1,  Average loss: 0.0018, Accuracy: 649/671 (96.7213%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 4.2489, Accuracy: 3366/10000 (33.6600%)
___Train Local_Simple,  epoch  30, local model 16, internal_epoch   1,  Average loss: 0.0006, Accuracy: 807/817 (98.7760%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.2988, Accuracy: 5450/10000 (54.5000%)
___Train Local_Simple,  epoch  30, local model 55, internal_epoch   1,  Average loss: 0.0018, Accuracy: 365/375 (97.3333%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.9148, Accuracy: 5544/10000 (55.4400%)
___Train Local_Simple,  epoch  30, local model 72, internal_epoch   1,  Average loss: 0.0018, Accuracy: 407/423 (96.2175%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 3.3049, Accuracy: 3430/10000 (34.3000%)
___Train Local_Simple,  epoch  30, local model 23, internal_epoch   1,  Average loss: 0.0014, Accuracy: 530/542 (97.7860%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.5755, Accuracy: 4719/10000 (47.1900%)
___Train Local_Simple,  epoch  30, local model 70, internal_epoch   1,  Average loss: 0.0027, Accuracy: 545/568 (95.9507%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 7.4705, Accuracy: 2761/10000 (27.6100%)
___Train Local_Simple,  epoch  30, local model 59, internal_epoch   1,  Average loss: 0.0023, Accuracy: 618/644 (95.9627%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.3725, Accuracy: 5204/10000 (52.0400%)
___Train Local_Simple,  epoch  30, local model 2, internal_epoch   1,  Average loss: 0.0017, Accuracy: 544/564 (96.4539%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.5374, Accuracy: 4718/10000 (47.1800%)
___Train Local_Simple,  epoch  30, local model 22, internal_epoch   1,  Average loss: 0.0006, Accuracy: 259/262 (98.8550%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.5925, Accuracy: 8228/10000 (82.2800%)
___Train Local_Simple,  epoch  30, local model 90, internal_epoch   1,  Average loss: 0.0015, Accuracy: 596/615 (96.9106%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.1063, Accuracy: 5996/10000 (59.9600%)
___Train Local_Simple,  epoch  30, local model 20, internal_epoch   1,  Average loss: 0.0016, Accuracy: 586/602 (97.3422%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.5306, Accuracy: 5240/10000 (52.4000%)
___Train Local_Simple,  epoch  30, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 544/561 (96.9697%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.4070, Accuracy: 6430/10000 (64.3000%)
___Train Local_Simple,  epoch  30, local model 24, internal_epoch   1,  Average loss: 0.0018, Accuracy: 461/477 (96.6457%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.3154, Accuracy: 5596/10000 (55.9600%)
___Train Local_Simple,  epoch  30, local model 45, internal_epoch   1,  Average loss: 0.0012, Accuracy: 632/647 (97.6816%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 7.7134, Accuracy: 3146/10000 (31.4600%)
___Train Local_Simple,  epoch  30, local model 57, internal_epoch   1,  Average loss: 0.0014, Accuracy: 511/523 (97.7055%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 6.2723, Accuracy: 3211/10000 (32.1100%)
___Train Local_Simple,  epoch  30, local model 17, internal_epoch   1,  Average loss: 0.0007, Accuracy: 521/527 (98.8615%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.9467, Accuracy: 5146/10000 (51.4600%)
___Train Local_Simple,  epoch  30, local model 5, internal_epoch   1,  Average loss: 0.0013, Accuracy: 566/578 (97.9239%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.8430, Accuracy: 6482/10000 (64.8200%)
___Train Local_Simple,  epoch  30, local model 83, internal_epoch   1,  Average loss: 0.0013, Accuracy: 350/360 (97.2222%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.5334, Accuracy: 8312/10000 (83.1200%)
___Train Local_Simple,  epoch  30, local model 66, internal_epoch   1,  Average loss: 0.0024, Accuracy: 697/733 (95.0887%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.4484, Accuracy: 5274/10000 (52.7400%)
___Train Local_Simple,  epoch  30, local model 43, internal_epoch   1,  Average loss: 0.0013, Accuracy: 423/431 (98.1439%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.1634, Accuracy: 6761/10000 (67.6100%)
___Train Local_Simple,  epoch  30, local model 86, internal_epoch   1,  Average loss: 0.0014, Accuracy: 675/692 (97.5434%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 8.1930, Accuracy: 2021/10000 (20.2100%)
___Train Local_Simple,  epoch  30, local model 26, internal_epoch   1,  Average loss: 0.0018, Accuracy: 497/519 (95.7611%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 5.2983, Accuracy: 4546/10000 (45.4600%)
___Train Local_Simple,  epoch  30, local model 42, internal_epoch   1,  Average loss: 0.0010, Accuracy: 462/473 (97.6744%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.8362, Accuracy: 5382/10000 (53.8200%)
___Train Local_Simple,  epoch  30, local model 6, internal_epoch   1,  Average loss: 0.0007, Accuracy: 431/435 (99.0805%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.0835, Accuracy: 7330/10000 (73.3000%)
___Train Local_Simple,  epoch  30, local model 85, internal_epoch   1,  Average loss: 0.0015, Accuracy: 777/807 (96.2825%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 3.9550, Accuracy: 4401/10000 (44.0100%)
___Train Local_Simple,  epoch  30, local model 94, internal_epoch   1,  Average loss: 0.0008, Accuracy: 657/671 (97.9136%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 3.7062, Accuracy: 4822/10000 (48.2200%)
___Train Local_Simple,  epoch  30, local model 53, internal_epoch   1,  Average loss: 0.0010, Accuracy: 549/561 (97.8610%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.4614, Accuracy: 6636/10000 (66.3600%)
___Train Local_Simple,  epoch  30, local model 21, internal_epoch   1,  Average loss: 0.0008, Accuracy: 677/687 (98.5444%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.3290, Accuracy: 5200/10000 (52.0000%)
time spent on training: 359.38205194473267
___Test Target_Simple poisoned: False, epoch: 30: Average loss: 0.1982, Accuracy: 9395/10000 (93.9500%)
___Test Target_Simple poisoned: True, epoch: 30: Average loss: 4.2211, Accuracy: 224/8968 (2.4978%)
saving model
Saving model on epoch 30
Done in 389.4983596801758 sec.
Server Epoch:31 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 26, 30, 52, 32, 58, 20, 24, 66, 78, 42, 63, 40, 77, 44, 97, 81, 57, 53, 96, 11, 17, 98, 83, 45, 37, 43, 75, 7, 61, 69, 16, 1, 46, 27, 14, 49, 4, 99, 89, 91, 12, 85, 36, 72, 64, 25, 0, 8, 95, 47, 54, 50, 70, 93, 90, 5, 67, 82, 28, 13, 68, 86, 94, 80, 10, 60, 87, 31, 19, 23, 76, 48, 21, 38, 39, 22, 56, 9, 2, 65, 34, 15, 59, 71, 35, 6, 79, 92, 55, 84].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   1,  Average loss: 0.0224, Accuracy: 283/569 (49.7364%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   2,  Average loss: 0.0142, Accuracy: 283/569 (49.7364%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   3,  Average loss: 0.0117, Accuracy: 298/569 (52.3726%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   4,  Average loss: 0.0117, Accuracy: 294/569 (51.6696%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   5,  Average loss: 0.0115, Accuracy: 291/569 (51.1424%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   6,  Average loss: 0.0115, Accuracy: 302/569 (53.0756%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   7,  Average loss: 0.0117, Accuracy: 292/569 (51.3181%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   8,  Average loss: 0.0116, Accuracy: 301/569 (52.8998%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch   9,  Average loss: 0.0114, Accuracy: 302/569 (53.0756%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 41, internal_epoch  10,  Average loss: 0.0110, Accuracy: 325/569 (57.1178%), train_poison_data_count: 288
Global model norm: 15.424411182510289.
Norm before scaling: 15.483415160084395. Distance: 2.904034498172697
Total norm for 10 adversaries is: 15.483415160084395. distance: 2.904034498172697
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.5006, Accuracy: 7609/8968 (84.8461%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   1,  Average loss: 0.0129, Accuracy: 365/522 (69.9234%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   2,  Average loss: 0.0092, Accuracy: 362/522 (69.3487%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   3,  Average loss: 0.0082, Accuracy: 377/522 (72.2222%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   4,  Average loss: 0.0076, Accuracy: 375/522 (71.8391%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   5,  Average loss: 0.0073, Accuracy: 375/522 (71.8391%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   6,  Average loss: 0.0072, Accuracy: 376/522 (72.0307%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   7,  Average loss: 0.0070, Accuracy: 385/522 (73.7548%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   8,  Average loss: 0.0075, Accuracy: 395/522 (75.6705%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch   9,  Average loss: 0.0064, Accuracy: 406/522 (77.7778%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 73, internal_epoch  10,  Average loss: 0.0066, Accuracy: 417/522 (79.8851%), train_poison_data_count: 266
Global model norm: 15.424411182510289.
Norm before scaling: 15.41666182784271. Distance: 2.2263461894653043
Total norm for 10 adversaries is: 15.41666182784271. distance: 2.2263461894653043
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.1413, Accuracy: 8793/8968 (98.0486%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   1,  Average loss: 0.0224, Accuracy: 192/385 (49.8701%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   2,  Average loss: 0.0137, Accuracy: 204/385 (52.9870%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   3,  Average loss: 0.0084, Accuracy: 258/385 (67.0130%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   4,  Average loss: 0.0071, Accuracy: 336/385 (87.2727%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   5,  Average loss: 0.0047, Accuracy: 365/385 (94.8052%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   6,  Average loss: 0.0042, Accuracy: 366/385 (95.0649%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   7,  Average loss: 0.0028, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   8,  Average loss: 0.0023, Accuracy: 376/385 (97.6623%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch   9,  Average loss: 0.0020, Accuracy: 381/385 (98.9610%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 51, internal_epoch  10,  Average loss: 0.0018, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Global model norm: 15.424411182510289.
Norm before scaling: 15.577360480707199. Distance: 2.943482819761225
Total norm for 10 adversaries is: 15.577360480707199. distance: 2.943482819761225
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.1307, Accuracy: 8617/8968 (96.0861%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   1,  Average loss: 0.0100, Accuracy: 464/627 (74.0032%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   2,  Average loss: 0.0031, Accuracy: 583/627 (92.9825%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   3,  Average loss: 0.0011, Accuracy: 613/627 (97.7671%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   4,  Average loss: 0.0010, Accuracy: 614/627 (97.9266%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   5,  Average loss: 0.0009, Accuracy: 616/627 (98.2456%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   6,  Average loss: 0.0008, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   7,  Average loss: 0.0008, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   8,  Average loss: 0.0007, Accuracy: 624/627 (99.5215%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   9,  Average loss: 0.0004, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch  10,  Average loss: 0.0009, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Global model norm: 15.424411182510289.
Norm before scaling: 15.656657383048154. Distance: 2.8075676795906768
Total norm for 10 adversaries is: 15.656657383048154. distance: 2.8075676795906768
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0064, Accuracy: 8945/8968 (99.7435%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 3, internal_epoch   1,  Average loss: 0.0226, Accuracy: 253/516 (49.0310%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 3, internal_epoch   2,  Average loss: 0.0166, Accuracy: 253/516 (49.0310%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 3, internal_epoch   3,  Average loss: 0.0142, Accuracy: 257/516 (49.8062%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 3, internal_epoch   4,  Average loss: 0.0130, Accuracy: 257/516 (49.8062%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 3, internal_epoch   5,  Average loss: 0.0129, Accuracy: 258/516 (50.0000%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 3, internal_epoch   6,  Average loss: 0.0127, Accuracy: 256/516 (49.6124%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 3, internal_epoch   7,  Average loss: 0.0129, Accuracy: 254/516 (49.2248%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 3, internal_epoch   8,  Average loss: 0.0126, Accuracy: 231/516 (44.7674%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 3, internal_epoch   9,  Average loss: 0.0127, Accuracy: 252/516 (48.8372%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 3, internal_epoch  10,  Average loss: 0.0123, Accuracy: 269/516 (52.1318%), train_poison_data_count: 260
Global model norm: 15.424411182510289.
Norm before scaling: 15.537506010218568. Distance: 3.603706698016923
Total norm for 10 adversaries is: 15.537506010218568. distance: 3.603706698016923
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.4828, Accuracy: 8639/8968 (96.3314%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 18, internal_epoch   1,  Average loss: 0.0210, Accuracy: 382/759 (50.3294%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 18, internal_epoch   2,  Average loss: 0.0127, Accuracy: 415/759 (54.6772%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 18, internal_epoch   3,  Average loss: 0.0094, Accuracy: 531/759 (69.9605%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 18, internal_epoch   4,  Average loss: 0.0080, Accuracy: 656/759 (86.4295%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 18, internal_epoch   5,  Average loss: 0.0056, Accuracy: 710/759 (93.5441%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 18, internal_epoch   6,  Average loss: 0.0032, Accuracy: 736/759 (96.9697%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 18, internal_epoch   7,  Average loss: 0.0018, Accuracy: 747/759 (98.4190%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 18, internal_epoch   8,  Average loss: 0.0011, Accuracy: 749/759 (98.6825%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 18, internal_epoch   9,  Average loss: 0.0010, Accuracy: 747/759 (98.4190%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 18, internal_epoch  10,  Average loss: 0.0009, Accuracy: 750/759 (98.8142%), train_poison_data_count: 384
Global model norm: 15.424411182510289.
Norm before scaling: 15.747679524310577. Distance: 3.9089162043511703
Total norm for 10 adversaries is: 15.747679524310577. distance: 3.9089162043511703
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0876, Accuracy: 8690/8968 (96.9001%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 29, internal_epoch   1,  Average loss: 0.0227, Accuracy: 255/506 (50.3953%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 29, internal_epoch   2,  Average loss: 0.0116, Accuracy: 334/506 (66.0079%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 29, internal_epoch   3,  Average loss: 0.0050, Accuracy: 432/506 (85.3755%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 29, internal_epoch   4,  Average loss: 0.0035, Accuracy: 478/506 (94.4664%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 29, internal_epoch   5,  Average loss: 0.0027, Accuracy: 493/506 (97.4308%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 29, internal_epoch   6,  Average loss: 0.0017, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 29, internal_epoch   7,  Average loss: 0.0013, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 29, internal_epoch   8,  Average loss: 0.0012, Accuracy: 500/506 (98.8142%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 29, internal_epoch   9,  Average loss: 0.0010, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 29, internal_epoch  10,  Average loss: 0.0010, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Global model norm: 15.424411182510289.
Norm before scaling: 15.667344964676928. Distance: 3.3199913677425075
Total norm for 10 adversaries is: 15.667344964676928. distance: 3.3199913677425075
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.2685, Accuracy: 8024/8968 (89.4737%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 62, internal_epoch   1,  Average loss: 0.0120, Accuracy: 418/580 (72.0690%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 62, internal_epoch   2,  Average loss: 0.0041, Accuracy: 538/580 (92.7586%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 62, internal_epoch   3,  Average loss: 0.0025, Accuracy: 549/580 (94.6552%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 62, internal_epoch   4,  Average loss: 0.0012, Accuracy: 565/580 (97.4138%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 62, internal_epoch   5,  Average loss: 0.0016, Accuracy: 560/580 (96.5517%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 62, internal_epoch   6,  Average loss: 0.0012, Accuracy: 564/580 (97.2414%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 62, internal_epoch   7,  Average loss: 0.0012, Accuracy: 567/580 (97.7586%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 62, internal_epoch   8,  Average loss: 0.0012, Accuracy: 568/580 (97.9310%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 62, internal_epoch   9,  Average loss: 0.0013, Accuracy: 566/580 (97.5862%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 62, internal_epoch  10,  Average loss: 0.0011, Accuracy: 570/580 (98.2759%), train_poison_data_count: 292
Global model norm: 15.424411182510289.
Norm before scaling: 15.651658410875896. Distance: 2.772688041756265
Total norm for 10 adversaries is: 15.651658410875896. distance: 2.772688041756265
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0196, Accuracy: 8902/8968 (99.2640%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 33, internal_epoch   1,  Average loss: 0.0233, Accuracy: 283/587 (48.2112%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 33, internal_epoch   2,  Average loss: 0.0154, Accuracy: 288/587 (49.0630%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 33, internal_epoch   3,  Average loss: 0.0141, Accuracy: 292/587 (49.7445%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 33, internal_epoch   4,  Average loss: 0.0129, Accuracy: 308/587 (52.4702%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 33, internal_epoch   5,  Average loss: 0.0127, Accuracy: 299/587 (50.9370%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 33, internal_epoch   6,  Average loss: 0.0126, Accuracy: 300/587 (51.1073%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 33, internal_epoch   7,  Average loss: 0.0127, Accuracy: 305/587 (51.9591%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 33, internal_epoch   8,  Average loss: 0.0125, Accuracy: 293/587 (49.9148%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 33, internal_epoch   9,  Average loss: 0.0124, Accuracy: 297/587 (50.5963%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 33, internal_epoch  10,  Average loss: 0.0123, Accuracy: 316/587 (53.8330%), train_poison_data_count: 299
Global model norm: 15.424411182510289.
Norm before scaling: 15.543641211263601. Distance: 3.291855593382046
Total norm for 10 adversaries is: 15.543641211263601. distance: 3.291855593382046
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.4064, Accuracy: 8512/8968 (94.9153%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 88, internal_epoch   1,  Average loss: 0.0167, Accuracy: 465/734 (63.3515%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 88, internal_epoch   2,  Average loss: 0.0099, Accuracy: 482/734 (65.6676%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 88, internal_epoch   3,  Average loss: 0.0113, Accuracy: 469/734 (63.8965%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 88, internal_epoch   4,  Average loss: 0.0092, Accuracy: 484/734 (65.9401%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 88, internal_epoch   5,  Average loss: 0.0089, Accuracy: 489/734 (66.6213%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 88, internal_epoch   6,  Average loss: 0.0084, Accuracy: 512/734 (69.7548%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 88, internal_epoch   7,  Average loss: 0.0083, Accuracy: 513/734 (69.8910%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 88, internal_epoch   8,  Average loss: 0.0081, Accuracy: 528/734 (71.9346%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 88, internal_epoch   9,  Average loss: 0.0075, Accuracy: 561/734 (76.4305%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 88, internal_epoch  10,  Average loss: 0.0076, Accuracy: 574/734 (78.2016%), train_poison_data_count: 382
Global model norm: 15.424411182510289.
Norm before scaling: 15.563903500185484. Distance: 3.200060462380457
Total norm for 10 adversaries is: 15.563903500185484. distance: 3.200060462380457
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.1592, Accuracy: 8739/8968 (97.4465%)
___Train Local_Simple,  epoch  31, local model 26, internal_epoch   1,  Average loss: 0.0010, Accuracy: 510/519 (98.2659%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.2815, Accuracy: 5170/10000 (51.7000%)
___Train Local_Simple,  epoch  31, local model 30, internal_epoch   1,  Average loss: 0.0019, Accuracy: 429/443 (96.8397%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.1601, Accuracy: 6624/10000 (66.2400%)
___Train Local_Simple,  epoch  31, local model 52, internal_epoch   1,  Average loss: 0.0015, Accuracy: 763/789 (96.7047%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.0650, Accuracy: 4878/10000 (48.7800%)
___Train Local_Simple,  epoch  31, local model 32, internal_epoch   1,  Average loss: 0.0013, Accuracy: 576/590 (97.6271%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.0477, Accuracy: 5861/10000 (58.6100%)
___Train Local_Simple,  epoch  31, local model 58, internal_epoch   1,  Average loss: 0.0009, Accuracy: 760/772 (98.4456%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 4.1224, Accuracy: 4080/10000 (40.8000%)
___Train Local_Simple,  epoch  31, local model 20, internal_epoch   1,  Average loss: 0.0021, Accuracy: 577/602 (95.8472%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.3953, Accuracy: 5549/10000 (55.4900%)
___Train Local_Simple,  epoch  31, local model 24, internal_epoch   1,  Average loss: 0.0017, Accuracy: 465/477 (97.4843%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.9357, Accuracy: 5576/10000 (55.7600%)
___Train Local_Simple,  epoch  31, local model 66, internal_epoch   1,  Average loss: 0.0022, Accuracy: 701/733 (95.6344%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 4.1291, Accuracy: 3904/10000 (39.0400%)
___Train Local_Simple,  epoch  31, local model 78, internal_epoch   1,  Average loss: 0.0025, Accuracy: 564/587 (96.0818%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 6.8234, Accuracy: 2527/10000 (25.2700%)
___Train Local_Simple,  epoch  31, local model 42, internal_epoch   1,  Average loss: 0.0005, Accuracy: 470/473 (99.3658%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.8343, Accuracy: 7386/10000 (73.8600%)
___Train Local_Simple,  epoch  31, local model 63, internal_epoch   1,  Average loss: 0.0028, Accuracy: 290/303 (95.7096%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.8139, Accuracy: 5213/10000 (52.1300%)
___Train Local_Simple,  epoch  31, local model 40, internal_epoch   1,  Average loss: 0.0004, Accuracy: 496/498 (99.5984%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.5922, Accuracy: 5633/10000 (56.3300%)
___Train Local_Simple,  epoch  31, local model 77, internal_epoch   1,  Average loss: 0.0014, Accuracy: 602/618 (97.4110%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.3688, Accuracy: 5563/10000 (55.6300%)
___Train Local_Simple,  epoch  31, local model 44, internal_epoch   1,  Average loss: 0.0009, Accuracy: 550/561 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 4.5785, Accuracy: 4472/10000 (44.7200%)
___Train Local_Simple,  epoch  31, local model 97, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1097/1112 (98.6511%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 4.3239, Accuracy: 3758/10000 (37.5800%)
___Train Local_Simple,  epoch  31, local model 81, internal_epoch   1,  Average loss: 0.0013, Accuracy: 621/636 (97.6415%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.1602, Accuracy: 4758/10000 (47.5800%)
___Train Local_Simple,  epoch  31, local model 57, internal_epoch   1,  Average loss: 0.0009, Accuracy: 513/523 (98.0880%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.7384, Accuracy: 4048/10000 (40.4800%)
___Train Local_Simple,  epoch  31, local model 53, internal_epoch   1,  Average loss: 0.0016, Accuracy: 543/561 (96.7914%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 4.5901, Accuracy: 4270/10000 (42.7000%)
___Train Local_Simple,  epoch  31, local model 96, internal_epoch   1,  Average loss: 0.0021, Accuracy: 510/531 (96.0452%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 5.0790, Accuracy: 3845/10000 (38.4500%)
___Train Local_Simple,  epoch  31, local model 11, internal_epoch   1,  Average loss: 0.0011, Accuracy: 542/554 (97.8339%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.0653, Accuracy: 5663/10000 (56.6300%)
___Train Local_Simple,  epoch  31, local model 17, internal_epoch   1,  Average loss: 0.0012, Accuracy: 513/527 (97.3435%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 5.1153, Accuracy: 3549/10000 (35.4900%)
___Train Local_Simple,  epoch  31, local model 98, internal_epoch   1,  Average loss: 0.0016, Accuracy: 529/548 (96.5328%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.3975, Accuracy: 3282/10000 (32.8200%)
___Train Local_Simple,  epoch  31, local model 83, internal_epoch   1,  Average loss: 0.0016, Accuracy: 346/360 (96.1111%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.1187, Accuracy: 7322/10000 (73.2200%)
___Train Local_Simple,  epoch  31, local model 45, internal_epoch   1,  Average loss: 0.0013, Accuracy: 637/647 (98.4544%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 4.8714, Accuracy: 3739/10000 (37.3900%)
___Train Local_Simple,  epoch  31, local model 37, internal_epoch   1,  Average loss: 0.0008, Accuracy: 451/456 (98.9035%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.2952, Accuracy: 6777/10000 (67.7700%)
___Train Local_Simple,  epoch  31, local model 43, internal_epoch   1,  Average loss: 0.0013, Accuracy: 419/431 (97.2158%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.7320, Accuracy: 5586/10000 (55.8600%)
___Train Local_Simple,  epoch  31, local model 75, internal_epoch   1,  Average loss: 0.0014, Accuracy: 741/763 (97.1166%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.3438, Accuracy: 4230/10000 (42.3000%)
___Train Local_Simple,  epoch  31, local model 7, internal_epoch   1,  Average loss: 0.0005, Accuracy: 796/802 (99.2519%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.0349, Accuracy: 5127/10000 (51.2700%)
___Train Local_Simple,  epoch  31, local model 61, internal_epoch   1,  Average loss: 0.0021, Accuracy: 275/287 (95.8188%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.6981, Accuracy: 6571/10000 (65.7100%)
___Train Local_Simple,  epoch  31, local model 69, internal_epoch   1,  Average loss: 0.0017, Accuracy: 654/671 (97.4665%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 5.8948, Accuracy: 3200/10000 (32.0000%)
___Train Local_Simple,  epoch  31, local model 16, internal_epoch   1,  Average loss: 0.0015, Accuracy: 795/817 (97.3072%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 4.6385, Accuracy: 4180/10000 (41.8000%)
___Train Local_Simple,  epoch  31, local model 1, internal_epoch   1,  Average loss: 0.0006, Accuracy: 532/536 (99.2537%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.8155, Accuracy: 6945/10000 (69.4500%)
___Train Local_Simple,  epoch  31, local model 46, internal_epoch   1,  Average loss: 0.0014, Accuracy: 631/650 (97.0769%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 5.9915, Accuracy: 3291/10000 (32.9100%)
___Train Local_Simple,  epoch  31, local model 27, internal_epoch   1,  Average loss: 0.0013, Accuracy: 735/745 (98.6577%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 5.8006, Accuracy: 3251/10000 (32.5100%)
___Train Local_Simple,  epoch  31, local model 14, internal_epoch   1,  Average loss: 0.0013, Accuracy: 670/692 (96.8208%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.2879, Accuracy: 5058/10000 (50.5800%)
___Train Local_Simple,  epoch  31, local model 49, internal_epoch   1,  Average loss: 0.0014, Accuracy: 344/355 (96.9014%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.8209, Accuracy: 5296/10000 (52.9600%)
___Train Local_Simple,  epoch  31, local model 4, internal_epoch   1,  Average loss: 0.0016, Accuracy: 731/748 (97.7273%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 6.5005, Accuracy: 2781/10000 (27.8100%)
___Train Local_Simple,  epoch  31, local model 99, internal_epoch   1,  Average loss: 0.0025, Accuracy: 678/712 (95.2247%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.0310, Accuracy: 6945/10000 (69.4500%)
___Train Local_Simple,  epoch  31, local model 89, internal_epoch   1,  Average loss: 0.0016, Accuracy: 664/683 (97.2182%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.5895, Accuracy: 5175/10000 (51.7500%)
___Train Local_Simple,  epoch  31, local model 91, internal_epoch   1,  Average loss: 0.0009, Accuracy: 811/819 (99.0232%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.2980, Accuracy: 4925/10000 (49.2500%)
___Train Local_Simple,  epoch  31, local model 12, internal_epoch   1,  Average loss: 0.0018, Accuracy: 701/725 (96.6897%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 7.0180, Accuracy: 3140/10000 (31.4000%)
___Train Local_Simple,  epoch  31, local model 85, internal_epoch   1,  Average loss: 0.0016, Accuracy: 780/807 (96.6543%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 4.0857, Accuracy: 3969/10000 (39.6900%)
___Train Local_Simple,  epoch  31, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 307/315 (97.4603%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.4543, Accuracy: 8569/10000 (85.6900%)
___Train Local_Simple,  epoch  31, local model 72, internal_epoch   1,  Average loss: 0.0019, Accuracy: 405/423 (95.7447%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.5459, Accuracy: 3588/10000 (35.8800%)
___Train Local_Simple,  epoch  31, local model 64, internal_epoch   1,  Average loss: 0.0013, Accuracy: 591/608 (97.2039%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.1526, Accuracy: 5066/10000 (50.6600%)
___Train Local_Simple,  epoch  31, local model 25, internal_epoch   1,  Average loss: 0.0013, Accuracy: 576/592 (97.2973%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 4.4414, Accuracy: 4607/10000 (46.0700%)
___Train Local_Simple,  epoch  31, local model 0, internal_epoch   1,  Average loss: 0.0008, Accuracy: 430/435 (98.8506%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.6490, Accuracy: 6192/10000 (61.9200%)
___Train Local_Simple,  epoch  31, local model 8, internal_epoch   1,  Average loss: 0.0009, Accuracy: 695/706 (98.4419%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.5974, Accuracy: 3501/10000 (35.0100%)
___Train Local_Simple,  epoch  31, local model 95, internal_epoch   1,  Average loss: 0.0024, Accuracy: 576/600 (96.0000%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.0876, Accuracy: 5121/10000 (51.2100%)
___Train Local_Simple,  epoch  31, local model 47, internal_epoch   1,  Average loss: 0.0008, Accuracy: 527/534 (98.6891%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.2105, Accuracy: 5340/10000 (53.4000%)
___Train Local_Simple,  epoch  31, local model 54, internal_epoch   1,  Average loss: 0.0006, Accuracy: 819/832 (98.4375%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.8208, Accuracy: 4931/10000 (49.3100%)
___Train Local_Simple,  epoch  31, local model 50, internal_epoch   1,  Average loss: 0.0026, Accuracy: 461/477 (96.6457%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.8246, Accuracy: 4114/10000 (41.1400%)
___Train Local_Simple,  epoch  31, local model 70, internal_epoch   1,  Average loss: 0.0014, Accuracy: 553/568 (97.3592%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.7363, Accuracy: 4999/10000 (49.9900%)
___Train Local_Simple,  epoch  31, local model 93, internal_epoch   1,  Average loss: 0.0019, Accuracy: 605/630 (96.0317%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 5.5439, Accuracy: 3036/10000 (30.3600%)
___Train Local_Simple,  epoch  31, local model 90, internal_epoch   1,  Average loss: 0.0034, Accuracy: 579/615 (94.1463%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.7880, Accuracy: 4408/10000 (44.0800%)
___Train Local_Simple,  epoch  31, local model 5, internal_epoch   1,  Average loss: 0.0022, Accuracy: 559/578 (96.7128%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.0719, Accuracy: 4844/10000 (48.4400%)
___Train Local_Simple,  epoch  31, local model 67, internal_epoch   1,  Average loss: 0.0017, Accuracy: 428/441 (97.0522%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.6731, Accuracy: 4283/10000 (42.8300%)
___Train Local_Simple,  epoch  31, local model 82, internal_epoch   1,  Average loss: 0.0008, Accuracy: 802/815 (98.4049%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 4.1230, Accuracy: 3854/10000 (38.5400%)
___Train Local_Simple,  epoch  31, local model 28, internal_epoch   1,  Average loss: 0.0011, Accuracy: 600/611 (98.1997%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.1568, Accuracy: 6223/10000 (62.2300%)
___Train Local_Simple,  epoch  31, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 691/713 (96.9144%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 4.9482, Accuracy: 3321/10000 (33.2100%)
___Train Local_Simple,  epoch  31, local model 68, internal_epoch   1,  Average loss: 0.0015, Accuracy: 537/549 (97.8142%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.9567, Accuracy: 4751/10000 (47.5100%)
___Train Local_Simple,  epoch  31, local model 86, internal_epoch   1,  Average loss: 0.0008, Accuracy: 681/692 (98.4104%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 4.6855, Accuracy: 3361/10000 (33.6100%)
___Train Local_Simple,  epoch  31, local model 94, internal_epoch   1,  Average loss: 0.0011, Accuracy: 659/671 (98.2116%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 5.8429, Accuracy: 3870/10000 (38.7000%)
___Train Local_Simple,  epoch  31, local model 80, internal_epoch   1,  Average loss: 0.0024, Accuracy: 508/532 (95.4887%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 5.9289, Accuracy: 2965/10000 (29.6500%)
___Train Local_Simple,  epoch  31, local model 10, internal_epoch   1,  Average loss: 0.0014, Accuracy: 558/573 (97.3822%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.0232, Accuracy: 5419/10000 (54.1900%)
___Train Local_Simple,  epoch  31, local model 60, internal_epoch   1,  Average loss: 0.0015, Accuracy: 555/571 (97.1979%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 4.3639, Accuracy: 3180/10000 (31.8000%)
___Train Local_Simple,  epoch  31, local model 87, internal_epoch   1,  Average loss: 0.0009, Accuracy: 652/663 (98.3409%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 4.1285, Accuracy: 4156/10000 (41.5600%)
___Train Local_Simple,  epoch  31, local model 31, internal_epoch   1,  Average loss: 0.0013, Accuracy: 581/596 (97.4832%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.6216, Accuracy: 4366/10000 (43.6600%)
___Train Local_Simple,  epoch  31, local model 19, internal_epoch   1,  Average loss: 0.0010, Accuracy: 584/598 (97.6589%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 5.4862, Accuracy: 3105/10000 (31.0500%)
___Train Local_Simple,  epoch  31, local model 23, internal_epoch   1,  Average loss: 0.0012, Accuracy: 530/542 (97.7860%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.5284, Accuracy: 3913/10000 (39.1300%)
___Train Local_Simple,  epoch  31, local model 76, internal_epoch   1,  Average loss: 0.0019, Accuracy: 445/459 (96.9499%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.1890, Accuracy: 6109/10000 (61.0900%)
___Train Local_Simple,  epoch  31, local model 48, internal_epoch   1,  Average loss: 0.0014, Accuracy: 355/363 (97.7961%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.7928, Accuracy: 7711/10000 (77.1100%)
___Train Local_Simple,  epoch  31, local model 21, internal_epoch   1,  Average loss: 0.0010, Accuracy: 678/687 (98.6900%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 6.5726, Accuracy: 3280/10000 (32.8000%)
___Train Local_Simple,  epoch  31, local model 38, internal_epoch   1,  Average loss: 0.0009, Accuracy: 468/477 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.7025, Accuracy: 7902/10000 (79.0200%)
___Train Local_Simple,  epoch  31, local model 39, internal_epoch   1,  Average loss: 0.0012, Accuracy: 479/493 (97.1602%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.6984, Accuracy: 5165/10000 (51.6500%)
___Train Local_Simple,  epoch  31, local model 22, internal_epoch   1,  Average loss: 0.0017, Accuracy: 252/262 (96.1832%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.5732, Accuracy: 7409/10000 (74.0900%)
___Train Local_Simple,  epoch  31, local model 56, internal_epoch   1,  Average loss: 0.0005, Accuracy: 706/715 (98.7413%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.0556, Accuracy: 4400/10000 (44.0000%)
___Train Local_Simple,  epoch  31, local model 9, internal_epoch   1,  Average loss: 0.0010, Accuracy: 499/508 (98.2283%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.7274, Accuracy: 7638/10000 (76.3800%)
___Train Local_Simple,  epoch  31, local model 2, internal_epoch   1,  Average loss: 0.0014, Accuracy: 550/564 (97.5177%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.4841, Accuracy: 4613/10000 (46.1300%)
___Train Local_Simple,  epoch  31, local model 65, internal_epoch   1,  Average loss: 0.0018, Accuracy: 595/621 (95.8132%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 4.9103, Accuracy: 3180/10000 (31.8000%)
___Train Local_Simple,  epoch  31, local model 34, internal_epoch   1,  Average loss: 0.0012, Accuracy: 849/871 (97.4742%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 5.3205, Accuracy: 3365/10000 (33.6500%)
___Train Local_Simple,  epoch  31, local model 15, internal_epoch   1,  Average loss: 0.0015, Accuracy: 275/282 (97.5177%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.1006, Accuracy: 7039/10000 (70.3900%)
___Train Local_Simple,  epoch  31, local model 59, internal_epoch   1,  Average loss: 0.0009, Accuracy: 634/644 (98.4472%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 4.8846, Accuracy: 3797/10000 (37.9700%)
___Train Local_Simple,  epoch  31, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 533/561 (95.0089%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.6638, Accuracy: 4177/10000 (41.7700%)
___Train Local_Simple,  epoch  31, local model 35, internal_epoch   1,  Average loss: 0.0011, Accuracy: 618/630 (98.0952%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 5.9049, Accuracy: 3553/10000 (35.5300%)
___Train Local_Simple,  epoch  31, local model 6, internal_epoch   1,  Average loss: 0.0024, Accuracy: 416/435 (95.6322%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.3547, Accuracy: 5344/10000 (53.4400%)
___Train Local_Simple,  epoch  31, local model 79, internal_epoch   1,  Average loss: 0.0012, Accuracy: 649/661 (98.1846%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.3971, Accuracy: 4908/10000 (49.0800%)
___Train Local_Simple,  epoch  31, local model 92, internal_epoch   1,  Average loss: 0.0024, Accuracy: 569/611 (93.1260%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 4.5611, Accuracy: 2999/10000 (29.9900%)
___Train Local_Simple,  epoch  31, local model 55, internal_epoch   1,  Average loss: 0.0015, Accuracy: 364/375 (97.0667%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.0044, Accuracy: 6047/10000 (60.4700%)
___Train Local_Simple,  epoch  31, local model 84, internal_epoch   1,  Average loss: 0.0025, Accuracy: 400/420 (95.2381%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.1884, Accuracy: 6541/10000 (65.4100%)
time spent on training: 380.3398504257202
___Test Target_Simple poisoned: False, epoch: 31: Average loss: 0.1995, Accuracy: 9421/10000 (94.2100%)
___Test Target_Simple poisoned: True, epoch: 31: Average loss: 4.0812, Accuracy: 331/8968 (3.6909%)
saving model
Saving model on epoch 31
Done in 413.299298286438 sec.
Server Epoch:32 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 37, 53, 58, 44, 11, 40, 89, 59, 83, 7, 95, 30, 78, 31, 16, 14, 49, 75, 32, 50, 81, 23, 27, 86, 66, 92, 87, 98, 71, 68, 26, 76, 93, 28, 52, 60, 82, 25, 64, 0, 96, 55, 46, 48, 17, 35, 43, 85, 19, 2, 57, 12, 8, 67, 45, 99, 36, 42, 22, 21, 63, 1, 39, 24, 56, 94, 4, 90, 84, 65, 6, 9, 15, 54, 20, 10, 97, 61, 72, 47, 70, 80, 34, 69, 79, 38, 77, 5, 13, 91].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   1,  Average loss: 0.0217, Accuracy: 280/569 (49.2091%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   2,  Average loss: 0.0139, Accuracy: 280/569 (49.2091%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   3,  Average loss: 0.0117, Accuracy: 303/569 (53.2513%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   4,  Average loss: 0.0116, Accuracy: 307/569 (53.9543%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   5,  Average loss: 0.0116, Accuracy: 278/569 (48.8576%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   6,  Average loss: 0.0113, Accuracy: 296/569 (52.0211%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   7,  Average loss: 0.0112, Accuracy: 313/569 (55.0088%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   8,  Average loss: 0.0110, Accuracy: 332/569 (58.3480%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch   9,  Average loss: 0.0114, Accuracy: 295/569 (51.8453%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 41, internal_epoch  10,  Average loss: 0.0113, Accuracy: 292/569 (51.3181%), train_poison_data_count: 288
Global model norm: 15.422507229631856.
Norm before scaling: 15.486456583880448. Distance: 3.0022312449951776
Total norm for 10 adversaries is: 15.486456583880448. distance: 3.0022312449951776
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.4882, Accuracy: 8078/8968 (90.0758%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   1,  Average loss: 0.0140, Accuracy: 369/522 (70.6897%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   2,  Average loss: 0.0092, Accuracy: 359/522 (68.7739%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   3,  Average loss: 0.0085, Accuracy: 377/522 (72.2222%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   4,  Average loss: 0.0071, Accuracy: 376/522 (72.0307%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   5,  Average loss: 0.0077, Accuracy: 374/522 (71.6475%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   6,  Average loss: 0.0069, Accuracy: 396/522 (75.8621%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   7,  Average loss: 0.0068, Accuracy: 393/522 (75.2874%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   8,  Average loss: 0.0062, Accuracy: 443/522 (84.8659%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch   9,  Average loss: 0.0058, Accuracy: 441/522 (84.4828%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 73, internal_epoch  10,  Average loss: 0.0055, Accuracy: 454/522 (86.9732%), train_poison_data_count: 266
Global model norm: 15.422507229631856.
Norm before scaling: 15.432307926220481. Distance: 2.6103683682352767
Total norm for 10 adversaries is: 15.432307926220481. distance: 2.6103683682352767
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0956, Accuracy: 8923/8968 (99.4982%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   1,  Average loss: 0.0237, Accuracy: 195/385 (50.6494%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   2,  Average loss: 0.0144, Accuracy: 206/385 (53.5065%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   3,  Average loss: 0.0152, Accuracy: 254/385 (65.9740%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   4,  Average loss: 0.0092, Accuracy: 330/385 (85.7143%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   5,  Average loss: 0.0074, Accuracy: 360/385 (93.5065%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   6,  Average loss: 0.0046, Accuracy: 370/385 (96.1039%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   7,  Average loss: 0.0038, Accuracy: 368/385 (95.5844%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   8,  Average loss: 0.0024, Accuracy: 378/385 (98.1818%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch   9,  Average loss: 0.0025, Accuracy: 375/385 (97.4026%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 51, internal_epoch  10,  Average loss: 0.0019, Accuracy: 378/385 (98.1818%), train_poison_data_count: 193
Global model norm: 15.422507229631856.
Norm before scaling: 15.604173131448233. Distance: 3.093474404746589
Total norm for 10 adversaries is: 15.604173131448233. distance: 3.093474404746589
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.1979, Accuracy: 8301/8968 (92.5624%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   1,  Average loss: 0.0109, Accuracy: 470/627 (74.9601%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   2,  Average loss: 0.0024, Accuracy: 596/627 (95.0558%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   3,  Average loss: 0.0016, Accuracy: 601/627 (95.8533%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   4,  Average loss: 0.0012, Accuracy: 614/627 (97.9266%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   5,  Average loss: 0.0011, Accuracy: 612/627 (97.6077%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   6,  Average loss: 0.0010, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   7,  Average loss: 0.0007, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   8,  Average loss: 0.0011, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch   9,  Average loss: 0.0007, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 74, internal_epoch  10,  Average loss: 0.0006, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Global model norm: 15.422507229631856.
Norm before scaling: 15.648838748444074. Distance: 2.881744600488365
Total norm for 10 adversaries is: 15.648838748444074. distance: 2.881744600488365
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0074, Accuracy: 8945/8968 (99.7435%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 3, internal_epoch   1,  Average loss: 0.0261, Accuracy: 258/516 (50.0000%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 3, internal_epoch   2,  Average loss: 0.0149, Accuracy: 244/516 (47.2868%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 3, internal_epoch   3,  Average loss: 0.0158, Accuracy: 244/516 (47.2868%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 3, internal_epoch   4,  Average loss: 0.0143, Accuracy: 254/516 (49.2248%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 3, internal_epoch   5,  Average loss: 0.0137, Accuracy: 245/516 (47.4806%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 3, internal_epoch   6,  Average loss: 0.0136, Accuracy: 238/516 (46.1240%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 3, internal_epoch   7,  Average loss: 0.0128, Accuracy: 255/516 (49.4186%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 3, internal_epoch   8,  Average loss: 0.0127, Accuracy: 270/516 (52.3256%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 3, internal_epoch   9,  Average loss: 0.0130, Accuracy: 261/516 (50.5814%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 3, internal_epoch  10,  Average loss: 0.0127, Accuracy: 259/516 (50.1938%), train_poison_data_count: 260
Global model norm: 15.422507229631856.
Norm before scaling: 15.609854964780563. Distance: 3.969316096744993
Total norm for 10 adversaries is: 15.609854964780563. distance: 3.969316096744993
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.4113, Accuracy: 8596/8968 (95.8519%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 18, internal_epoch   1,  Average loss: 0.0187, Accuracy: 389/759 (51.2516%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 18, internal_epoch   2,  Average loss: 0.0116, Accuracy: 445/759 (58.6298%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 18, internal_epoch   3,  Average loss: 0.0083, Accuracy: 577/759 (76.0211%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 18, internal_epoch   4,  Average loss: 0.0056, Accuracy: 698/759 (91.9631%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 18, internal_epoch   5,  Average loss: 0.0033, Accuracy: 738/759 (97.2332%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 18, internal_epoch   6,  Average loss: 0.0018, Accuracy: 745/759 (98.1555%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 18, internal_epoch   7,  Average loss: 0.0009, Accuracy: 754/759 (99.3412%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 18, internal_epoch   8,  Average loss: 0.0006, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 18, internal_epoch   9,  Average loss: 0.0005, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 18, internal_epoch  10,  Average loss: 0.0006, Accuracy: 753/759 (99.2095%), train_poison_data_count: 384
Global model norm: 15.422507229631856.
Norm before scaling: 15.736778886315868. Distance: 3.800647509771233
Total norm for 10 adversaries is: 15.736778886315868. distance: 3.800647509771233
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0765, Accuracy: 8708/8968 (97.1008%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 29, internal_epoch   1,  Average loss: 0.0191, Accuracy: 293/506 (57.9051%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 29, internal_epoch   2,  Average loss: 0.0081, Accuracy: 396/506 (78.2609%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 29, internal_epoch   3,  Average loss: 0.0025, Accuracy: 488/506 (96.4427%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 29, internal_epoch   4,  Average loss: 0.0016, Accuracy: 496/506 (98.0237%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 29, internal_epoch   5,  Average loss: 0.0016, Accuracy: 495/506 (97.8261%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 29, internal_epoch   6,  Average loss: 0.0012, Accuracy: 499/506 (98.6166%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 29, internal_epoch   7,  Average loss: 0.0010, Accuracy: 500/506 (98.8142%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 29, internal_epoch   8,  Average loss: 0.0008, Accuracy: 500/506 (98.8142%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 29, internal_epoch   9,  Average loss: 0.0007, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 29, internal_epoch  10,  Average loss: 0.0007, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Global model norm: 15.422507229631856.
Norm before scaling: 15.68448394111274. Distance: 3.395474810874641
Total norm for 10 adversaries is: 15.68448394111274. distance: 3.395474810874641
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.2519, Accuracy: 8125/8968 (90.5999%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 62, internal_epoch   1,  Average loss: 0.0084, Accuracy: 461/580 (79.4828%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 62, internal_epoch   2,  Average loss: 0.0024, Accuracy: 561/580 (96.7241%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 62, internal_epoch   3,  Average loss: 0.0015, Accuracy: 562/580 (96.8966%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 62, internal_epoch   4,  Average loss: 0.0013, Accuracy: 564/580 (97.2414%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 62, internal_epoch   5,  Average loss: 0.0013, Accuracy: 565/580 (97.4138%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 62, internal_epoch   6,  Average loss: 0.0012, Accuracy: 565/580 (97.4138%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 62, internal_epoch   7,  Average loss: 0.0009, Accuracy: 568/580 (97.9310%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 62, internal_epoch   8,  Average loss: 0.0009, Accuracy: 571/580 (98.4483%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 62, internal_epoch   9,  Average loss: 0.0009, Accuracy: 568/580 (97.9310%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 62, internal_epoch  10,  Average loss: 0.0009, Accuracy: 569/580 (98.1034%), train_poison_data_count: 292
Global model norm: 15.422507229631856.
Norm before scaling: 15.612449549401823. Distance: 2.4549299269734965
Total norm for 10 adversaries is: 15.612449549401823. distance: 2.4549299269734965
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0186, Accuracy: 8901/8968 (99.2529%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 33, internal_epoch   1,  Average loss: 0.0219, Accuracy: 298/587 (50.7666%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 33, internal_epoch   2,  Average loss: 0.0150, Accuracy: 292/587 (49.7445%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 33, internal_epoch   3,  Average loss: 0.0140, Accuracy: 296/587 (50.4259%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 33, internal_epoch   4,  Average loss: 0.0131, Accuracy: 296/587 (50.4259%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 33, internal_epoch   5,  Average loss: 0.0124, Accuracy: 303/587 (51.6184%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 33, internal_epoch   6,  Average loss: 0.0129, Accuracy: 298/587 (50.7666%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 33, internal_epoch   7,  Average loss: 0.0125, Accuracy: 313/587 (53.3220%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 33, internal_epoch   8,  Average loss: 0.0125, Accuracy: 309/587 (52.6405%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 33, internal_epoch   9,  Average loss: 0.0127, Accuracy: 301/587 (51.2777%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 33, internal_epoch  10,  Average loss: 0.0124, Accuracy: 314/587 (53.4923%), train_poison_data_count: 299
Global model norm: 15.422507229631856.
Norm before scaling: 15.486943806535777. Distance: 2.816941378437475
Total norm for 10 adversaries is: 15.486943806535777. distance: 2.816941378437475
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.3328, Accuracy: 8278/8968 (92.3060%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 88, internal_epoch   1,  Average loss: 0.0142, Accuracy: 470/734 (64.0327%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 88, internal_epoch   2,  Average loss: 0.0101, Accuracy: 489/734 (66.6213%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 88, internal_epoch   3,  Average loss: 0.0096, Accuracy: 465/734 (63.3515%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 88, internal_epoch   4,  Average loss: 0.0087, Accuracy: 512/734 (69.7548%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 88, internal_epoch   5,  Average loss: 0.0087, Accuracy: 499/734 (67.9837%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 88, internal_epoch   6,  Average loss: 0.0084, Accuracy: 520/734 (70.8447%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 88, internal_epoch   7,  Average loss: 0.0078, Accuracy: 559/734 (76.1580%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 88, internal_epoch   8,  Average loss: 0.0073, Accuracy: 568/734 (77.3842%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 88, internal_epoch   9,  Average loss: 0.0065, Accuracy: 638/734 (86.9210%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 88, internal_epoch  10,  Average loss: 0.0065, Accuracy: 646/734 (88.0109%), train_poison_data_count: 382
Global model norm: 15.422507229631856.
Norm before scaling: 15.512685199526528. Distance: 2.7118941935826886
Total norm for 10 adversaries is: 15.512685199526528. distance: 2.7118941935826886
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.1454, Accuracy: 8817/8968 (98.3162%)
___Train Local_Simple,  epoch  32, local model 37, internal_epoch   1,  Average loss: 0.0031, Accuracy: 443/456 (97.1491%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.8718, Accuracy: 5674/10000 (56.7400%)
___Train Local_Simple,  epoch  32, local model 53, internal_epoch   1,  Average loss: 0.0007, Accuracy: 550/561 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.7251, Accuracy: 6189/10000 (61.8900%)
___Train Local_Simple,  epoch  32, local model 58, internal_epoch   1,  Average loss: 0.0008, Accuracy: 762/772 (98.7047%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 3.2920, Accuracy: 4658/10000 (46.5800%)
___Train Local_Simple,  epoch  32, local model 44, internal_epoch   1,  Average loss: 0.0005, Accuracy: 556/561 (99.1087%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.4094, Accuracy: 6666/10000 (66.6600%)
___Train Local_Simple,  epoch  32, local model 11, internal_epoch   1,  Average loss: 0.0008, Accuracy: 547/554 (98.7365%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.9358, Accuracy: 7622/10000 (76.2200%)
___Train Local_Simple,  epoch  32, local model 40, internal_epoch   1,  Average loss: 0.0015, Accuracy: 483/498 (96.9880%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 7.9760, Accuracy: 3441/10000 (34.4100%)
___Train Local_Simple,  epoch  32, local model 89, internal_epoch   1,  Average loss: 0.0041, Accuracy: 635/683 (92.9722%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 5.8093, Accuracy: 4186/10000 (41.8600%)
___Train Local_Simple,  epoch  32, local model 59, internal_epoch   1,  Average loss: 0.0013, Accuracy: 632/644 (98.1366%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.7151, Accuracy: 4865/10000 (48.6500%)
___Train Local_Simple,  epoch  32, local model 83, internal_epoch   1,  Average loss: 0.0013, Accuracy: 351/360 (97.5000%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.5454, Accuracy: 8294/10000 (82.9400%)
___Train Local_Simple,  epoch  32, local model 7, internal_epoch   1,  Average loss: 0.0006, Accuracy: 797/802 (99.3766%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.5023, Accuracy: 6063/10000 (60.6300%)
___Train Local_Simple,  epoch  32, local model 95, internal_epoch   1,  Average loss: 0.0026, Accuracy: 575/600 (95.8333%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 7.5260, Accuracy: 2923/10000 (29.2300%)
___Train Local_Simple,  epoch  32, local model 30, internal_epoch   1,  Average loss: 0.0009, Accuracy: 440/443 (99.3228%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.3178, Accuracy: 6787/10000 (67.8700%)
___Train Local_Simple,  epoch  32, local model 78, internal_epoch   1,  Average loss: 0.0032, Accuracy: 558/587 (95.0596%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 3.9489, Accuracy: 3613/10000 (36.1300%)
___Train Local_Simple,  epoch  32, local model 31, internal_epoch   1,  Average loss: 0.0010, Accuracy: 586/596 (98.3221%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.5631, Accuracy: 5978/10000 (59.7800%)
___Train Local_Simple,  epoch  32, local model 16, internal_epoch   1,  Average loss: 0.0004, Accuracy: 810/817 (99.1432%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.7550, Accuracy: 5959/10000 (59.5900%)
___Train Local_Simple,  epoch  32, local model 14, internal_epoch   1,  Average loss: 0.0015, Accuracy: 671/692 (96.9653%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 5.9805, Accuracy: 3780/10000 (37.8000%)
___Train Local_Simple,  epoch  32, local model 49, internal_epoch   1,  Average loss: 0.0019, Accuracy: 343/355 (96.6197%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.0561, Accuracy: 5055/10000 (50.5500%)
___Train Local_Simple,  epoch  32, local model 75, internal_epoch   1,  Average loss: 0.0021, Accuracy: 729/763 (95.5439%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 4.5071, Accuracy: 2940/10000 (29.4000%)
___Train Local_Simple,  epoch  32, local model 32, internal_epoch   1,  Average loss: 0.0027, Accuracy: 562/590 (95.2542%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.6392, Accuracy: 6518/10000 (65.1800%)
___Train Local_Simple,  epoch  32, local model 50, internal_epoch   1,  Average loss: 0.0011, Accuracy: 469/477 (98.3229%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.9937, Accuracy: 5434/10000 (54.3400%)
___Train Local_Simple,  epoch  32, local model 81, internal_epoch   1,  Average loss: 0.0015, Accuracy: 619/636 (97.3270%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 5.1311, Accuracy: 3116/10000 (31.1600%)
___Train Local_Simple,  epoch  32, local model 23, internal_epoch   1,  Average loss: 0.0017, Accuracy: 529/542 (97.6015%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.0689, Accuracy: 5165/10000 (51.6500%)
___Train Local_Simple,  epoch  32, local model 27, internal_epoch   1,  Average loss: 0.0014, Accuracy: 728/745 (97.7181%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 4.9711, Accuracy: 3718/10000 (37.1800%)
___Train Local_Simple,  epoch  32, local model 86, internal_epoch   1,  Average loss: 0.0011, Accuracy: 677/692 (97.8324%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 12.7207, Accuracy: 2010/10000 (20.1000%)
___Train Local_Simple,  epoch  32, local model 66, internal_epoch   1,  Average loss: 0.0034, Accuracy: 690/733 (94.1337%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 3.2203, Accuracy: 3749/10000 (37.4900%)
___Train Local_Simple,  epoch  32, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 571/611 (93.4534%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 7.3301, Accuracy: 1629/10000 (16.2900%)
___Train Local_Simple,  epoch  32, local model 87, internal_epoch   1,  Average loss: 0.0017, Accuracy: 640/663 (96.5309%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 6.4191, Accuracy: 3068/10000 (30.6800%)
___Train Local_Simple,  epoch  32, local model 98, internal_epoch   1,  Average loss: 0.0023, Accuracy: 520/548 (94.8905%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 8.0883, Accuracy: 2806/10000 (28.0600%)
___Train Local_Simple,  epoch  32, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 548/561 (97.6827%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.9501, Accuracy: 6848/10000 (68.4800%)
___Train Local_Simple,  epoch  32, local model 68, internal_epoch   1,  Average loss: 0.0016, Accuracy: 535/549 (97.4499%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.1764, Accuracy: 5265/10000 (52.6500%)
___Train Local_Simple,  epoch  32, local model 26, internal_epoch   1,  Average loss: 0.0021, Accuracy: 498/519 (95.9538%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 5.2367, Accuracy: 3564/10000 (35.6400%)
___Train Local_Simple,  epoch  32, local model 76, internal_epoch   1,  Average loss: 0.0012, Accuracy: 450/459 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.6065, Accuracy: 8154/10000 (81.5400%)
___Train Local_Simple,  epoch  32, local model 93, internal_epoch   1,  Average loss: 0.0024, Accuracy: 598/630 (94.9206%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 3.5714, Accuracy: 3106/10000 (31.0600%)
___Train Local_Simple,  epoch  32, local model 28, internal_epoch   1,  Average loss: 0.0026, Accuracy: 572/611 (93.6170%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 5.3459, Accuracy: 4554/10000 (45.5400%)
___Train Local_Simple,  epoch  32, local model 52, internal_epoch   1,  Average loss: 0.0041, Accuracy: 722/789 (91.5082%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 4.3305, Accuracy: 3679/10000 (36.7900%)
___Train Local_Simple,  epoch  32, local model 60, internal_epoch   1,  Average loss: 0.0017, Accuracy: 554/571 (97.0228%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 6.1556, Accuracy: 2854/10000 (28.5400%)
___Train Local_Simple,  epoch  32, local model 82, internal_epoch   1,  Average loss: 0.0010, Accuracy: 798/815 (97.9141%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 6.1554, Accuracy: 3310/10000 (33.1000%)
___Train Local_Simple,  epoch  32, local model 25, internal_epoch   1,  Average loss: 0.0003, Accuracy: 590/592 (99.6622%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.0116, Accuracy: 7434/10000 (74.3400%)
___Train Local_Simple,  epoch  32, local model 64, internal_epoch   1,  Average loss: 0.0005, Accuracy: 606/608 (99.6711%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 3.3048, Accuracy: 4947/10000 (49.4700%)
___Train Local_Simple,  epoch  32, local model 0, internal_epoch   1,  Average loss: 0.0026, Accuracy: 412/435 (94.7126%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 4.4780, Accuracy: 4137/10000 (41.3700%)
___Train Local_Simple,  epoch  32, local model 96, internal_epoch   1,  Average loss: 0.0008, Accuracy: 521/531 (98.1168%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.7410, Accuracy: 5296/10000 (52.9600%)
___Train Local_Simple,  epoch  32, local model 55, internal_epoch   1,  Average loss: 0.0019, Accuracy: 359/375 (95.7333%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.4402, Accuracy: 6307/10000 (63.0700%)
___Train Local_Simple,  epoch  32, local model 46, internal_epoch   1,  Average loss: 0.0006, Accuracy: 645/650 (99.2308%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.7579, Accuracy: 5169/10000 (51.6900%)
___Train Local_Simple,  epoch  32, local model 48, internal_epoch   1,  Average loss: 0.0021, Accuracy: 350/363 (96.4187%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.8906, Accuracy: 7609/10000 (76.0900%)
___Train Local_Simple,  epoch  32, local model 17, internal_epoch   1,  Average loss: 0.0005, Accuracy: 520/527 (98.6717%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.5082, Accuracy: 5959/10000 (59.5900%)
___Train Local_Simple,  epoch  32, local model 35, internal_epoch   1,  Average loss: 0.0015, Accuracy: 612/630 (97.1429%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 5.2280, Accuracy: 3429/10000 (34.2900%)
___Train Local_Simple,  epoch  32, local model 43, internal_epoch   1,  Average loss: 0.0008, Accuracy: 424/431 (98.3759%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.9822, Accuracy: 6996/10000 (69.9600%)
___Train Local_Simple,  epoch  32, local model 85, internal_epoch   1,  Average loss: 0.0015, Accuracy: 776/807 (96.1586%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 5.4779, Accuracy: 3060/10000 (30.6000%)
___Train Local_Simple,  epoch  32, local model 19, internal_epoch   1,  Average loss: 0.0010, Accuracy: 586/598 (97.9933%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 4.9079, Accuracy: 3383/10000 (33.8300%)
___Train Local_Simple,  epoch  32, local model 2, internal_epoch   1,  Average loss: 0.0015, Accuracy: 550/564 (97.5177%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.9819, Accuracy: 4002/10000 (40.0200%)
___Train Local_Simple,  epoch  32, local model 57, internal_epoch   1,  Average loss: 0.0011, Accuracy: 514/523 (98.2792%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 3.2837, Accuracy: 4515/10000 (45.1500%)
___Train Local_Simple,  epoch  32, local model 12, internal_epoch   1,  Average loss: 0.0008, Accuracy: 716/725 (98.7586%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.9195, Accuracy: 5776/10000 (57.7600%)
___Train Local_Simple,  epoch  32, local model 8, internal_epoch   1,  Average loss: 0.0020, Accuracy: 681/706 (96.4589%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 8.3672, Accuracy: 3024/10000 (30.2400%)
___Train Local_Simple,  epoch  32, local model 67, internal_epoch   1,  Average loss: 0.0032, Accuracy: 416/441 (94.3311%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.8303, Accuracy: 3882/10000 (38.8200%)
___Train Local_Simple,  epoch  32, local model 45, internal_epoch   1,  Average loss: 0.0014, Accuracy: 629/647 (97.2179%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 4.9715, Accuracy: 3849/10000 (38.4900%)
___Train Local_Simple,  epoch  32, local model 99, internal_epoch   1,  Average loss: 0.0028, Accuracy: 683/712 (95.9270%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 12.7938, Accuracy: 1172/10000 (11.7200%)
___Train Local_Simple,  epoch  32, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 310/315 (98.4127%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.6440, Accuracy: 8102/10000 (81.0200%)
___Train Local_Simple,  epoch  32, local model 42, internal_epoch   1,  Average loss: 0.0009, Accuracy: 464/473 (98.0973%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.0199, Accuracy: 5848/10000 (58.4800%)
___Train Local_Simple,  epoch  32, local model 22, internal_epoch   1,  Average loss: 0.0005, Accuracy: 260/262 (99.2366%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.4487, Accuracy: 8513/10000 (85.1300%)
___Train Local_Simple,  epoch  32, local model 21, internal_epoch   1,  Average loss: 0.0006, Accuracy: 681/687 (99.1266%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.4530, Accuracy: 5327/10000 (53.2700%)
___Train Local_Simple,  epoch  32, local model 63, internal_epoch   1,  Average loss: 0.0018, Accuracy: 291/303 (96.0396%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.7668, Accuracy: 3988/10000 (39.8800%)
___Train Local_Simple,  epoch  32, local model 1, internal_epoch   1,  Average loss: 0.0004, Accuracy: 533/536 (99.4403%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3773, Accuracy: 8730/10000 (87.3000%)
___Train Local_Simple,  epoch  32, local model 39, internal_epoch   1,  Average loss: 0.0010, Accuracy: 486/493 (98.5801%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.3694, Accuracy: 6569/10000 (65.6900%)
___Train Local_Simple,  epoch  32, local model 24, internal_epoch   1,  Average loss: 0.0016, Accuracy: 466/477 (97.6939%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.6185, Accuracy: 5505/10000 (55.0500%)
___Train Local_Simple,  epoch  32, local model 56, internal_epoch   1,  Average loss: 0.0007, Accuracy: 706/715 (98.7413%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 4.0029, Accuracy: 4439/10000 (44.3900%)
___Train Local_Simple,  epoch  32, local model 94, internal_epoch   1,  Average loss: 0.0007, Accuracy: 661/671 (98.5097%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.9310, Accuracy: 5569/10000 (55.6900%)
___Train Local_Simple,  epoch  32, local model 4, internal_epoch   1,  Average loss: 0.0006, Accuracy: 741/748 (99.0642%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.3034, Accuracy: 6329/10000 (63.2900%)
___Train Local_Simple,  epoch  32, local model 90, internal_epoch   1,  Average loss: 0.0012, Accuracy: 603/615 (98.0488%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.3603, Accuracy: 5954/10000 (59.5400%)
___Train Local_Simple,  epoch  32, local model 84, internal_epoch   1,  Average loss: 0.0009, Accuracy: 412/420 (98.0952%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.9769, Accuracy: 7482/10000 (74.8200%)
___Train Local_Simple,  epoch  32, local model 65, internal_epoch   1,  Average loss: 0.0015, Accuracy: 601/621 (96.7794%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.4807, Accuracy: 5603/10000 (56.0300%)
___Train Local_Simple,  epoch  32, local model 6, internal_epoch   1,  Average loss: 0.0008, Accuracy: 431/435 (99.0805%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.0096, Accuracy: 7026/10000 (70.2600%)
___Train Local_Simple,  epoch  32, local model 9, internal_epoch   1,  Average loss: 0.0020, Accuracy: 491/508 (96.6535%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.9423, Accuracy: 5277/10000 (52.7700%)
___Train Local_Simple,  epoch  32, local model 15, internal_epoch   1,  Average loss: 0.0010, Accuracy: 280/282 (99.2908%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.5332, Accuracy: 8150/10000 (81.5000%)
___Train Local_Simple,  epoch  32, local model 54, internal_epoch   1,  Average loss: 0.0011, Accuracy: 817/832 (98.1971%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 6.4516, Accuracy: 3468/10000 (34.6800%)
___Train Local_Simple,  epoch  32, local model 20, internal_epoch   1,  Average loss: 0.0008, Accuracy: 594/602 (98.6711%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.0744, Accuracy: 6042/10000 (60.4200%)
___Train Local_Simple,  epoch  32, local model 10, internal_epoch   1,  Average loss: 0.0017, Accuracy: 551/573 (96.1606%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.4586, Accuracy: 4765/10000 (47.6500%)
___Train Local_Simple,  epoch  32, local model 97, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1096/1112 (98.5612%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 7.4936, Accuracy: 3115/10000 (31.1500%)
___Train Local_Simple,  epoch  32, local model 61, internal_epoch   1,  Average loss: 0.0012, Accuracy: 279/287 (97.2125%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.4901, Accuracy: 8404/10000 (84.0400%)
___Train Local_Simple,  epoch  32, local model 72, internal_epoch   1,  Average loss: 0.0017, Accuracy: 410/423 (96.9267%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 3.0413, Accuracy: 4192/10000 (41.9200%)
___Train Local_Simple,  epoch  32, local model 47, internal_epoch   1,  Average loss: 0.0015, Accuracy: 519/534 (97.1910%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 7.1219, Accuracy: 3669/10000 (36.6900%)
___Train Local_Simple,  epoch  32, local model 70, internal_epoch   1,  Average loss: 0.0022, Accuracy: 549/568 (96.6549%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 5.8800, Accuracy: 2905/10000 (29.0500%)
___Train Local_Simple,  epoch  32, local model 80, internal_epoch   1,  Average loss: 0.0025, Accuracy: 508/532 (95.4887%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 6.7573, Accuracy: 2817/10000 (28.1700%)
___Train Local_Simple,  epoch  32, local model 34, internal_epoch   1,  Average loss: 0.0014, Accuracy: 847/871 (97.2445%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 5.2007, Accuracy: 3701/10000 (37.0100%)
___Train Local_Simple,  epoch  32, local model 69, internal_epoch   1,  Average loss: 0.0018, Accuracy: 649/671 (96.7213%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 3.6993, Accuracy: 3478/10000 (34.7800%)
___Train Local_Simple,  epoch  32, local model 79, internal_epoch   1,  Average loss: 0.0012, Accuracy: 650/661 (98.3359%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.9653, Accuracy: 4535/10000 (45.3500%)
___Train Local_Simple,  epoch  32, local model 38, internal_epoch   1,  Average loss: 0.0009, Accuracy: 469/477 (98.3229%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.9001, Accuracy: 7440/10000 (74.4000%)
___Train Local_Simple,  epoch  32, local model 77, internal_epoch   1,  Average loss: 0.0024, Accuracy: 593/618 (95.9547%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 3.6239, Accuracy: 4437/10000 (44.3700%)
___Train Local_Simple,  epoch  32, local model 5, internal_epoch   1,  Average loss: 0.0015, Accuracy: 560/578 (96.8858%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.4671, Accuracy: 5606/10000 (56.0600%)
___Train Local_Simple,  epoch  32, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 700/713 (98.1767%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.2458, Accuracy: 5030/10000 (50.3000%)
___Train Local_Simple,  epoch  32, local model 91, internal_epoch   1,  Average loss: 0.0012, Accuracy: 798/819 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 8.7165, Accuracy: 2812/10000 (28.1200%)
time spent on training: 375.1037595272064
___Test Target_Simple poisoned: False, epoch: 32: Average loss: 0.1927, Accuracy: 9413/10000 (94.1300%)
___Test Target_Simple poisoned: True, epoch: 32: Average loss: 3.9747, Accuracy: 311/8968 (3.4679%)
saving model
Saving model on epoch 32
Done in 408.95740127563477 sec.
Server Epoch:33 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 46, 76, 47, 96, 54, 98, 9, 23, 58, 43, 26, 22, 15, 66, 40, 59, 56, 55, 86, 90, 31, 85, 24, 35, 69, 60, 65, 13, 30, 92, 79, 95, 70, 12, 42, 77, 14, 1, 25, 99, 83, 94, 37, 67, 7, 39, 97, 71, 72, 63, 19, 87, 57, 81, 10, 75, 8, 49, 82, 50, 2, 64, 11, 45, 61, 17, 38, 0, 28, 48, 52, 68, 5, 78, 91, 89, 27, 34, 21, 4, 80, 20, 84, 16, 53, 44, 93, 6, 32, 36].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   1,  Average loss: 0.0225, Accuracy: 294/569 (51.6696%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   2,  Average loss: 0.0146, Accuracy: 282/569 (49.5606%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   3,  Average loss: 0.0115, Accuracy: 306/569 (53.7786%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   4,  Average loss: 0.0115, Accuracy: 297/569 (52.1968%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   5,  Average loss: 0.0114, Accuracy: 300/569 (52.7241%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   6,  Average loss: 0.0110, Accuracy: 339/569 (59.5782%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   7,  Average loss: 0.0106, Accuracy: 350/569 (61.5114%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   8,  Average loss: 0.0103, Accuracy: 370/569 (65.0264%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch   9,  Average loss: 0.0102, Accuracy: 376/569 (66.0808%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 41, internal_epoch  10,  Average loss: 0.0101, Accuracy: 377/569 (66.2566%), train_poison_data_count: 288
Global model norm: 15.425067049495938.
Norm before scaling: 15.502230576018125. Distance: 3.1059893861430847
Total norm for 10 adversaries is: 15.502230576018125. distance: 3.1059893861430847
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.5050, Accuracy: 7218/8968 (80.4862%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   1,  Average loss: 0.0135, Accuracy: 366/522 (70.1149%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   2,  Average loss: 0.0083, Accuracy: 382/522 (73.1801%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   3,  Average loss: 0.0087, Accuracy: 373/522 (71.4559%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   4,  Average loss: 0.0077, Accuracy: 400/522 (76.6284%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   5,  Average loss: 0.0067, Accuracy: 411/522 (78.7356%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   6,  Average loss: 0.0071, Accuracy: 389/522 (74.5211%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   7,  Average loss: 0.0061, Accuracy: 427/522 (81.8008%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   8,  Average loss: 0.0058, Accuracy: 446/522 (85.4406%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch   9,  Average loss: 0.0053, Accuracy: 441/522 (84.4828%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 73, internal_epoch  10,  Average loss: 0.0052, Accuracy: 454/522 (86.9732%), train_poison_data_count: 266
Global model norm: 15.425067049495938.
Norm before scaling: 15.440353315194795. Distance: 2.4815364912471782
Total norm for 10 adversaries is: 15.440353315194795. distance: 2.4815364912471782
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0712, Accuracy: 8914/8968 (99.3979%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   1,  Average loss: 0.0220, Accuracy: 197/385 (51.1688%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   2,  Average loss: 0.0136, Accuracy: 243/385 (63.1169%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   3,  Average loss: 0.0121, Accuracy: 233/385 (60.5195%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   4,  Average loss: 0.0081, Accuracy: 305/385 (79.2208%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   5,  Average loss: 0.0078, Accuracy: 294/385 (76.3636%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   6,  Average loss: 0.0066, Accuracy: 301/385 (78.1818%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   7,  Average loss: 0.0049, Accuracy: 333/385 (86.4935%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   8,  Average loss: 0.0040, Accuracy: 369/385 (95.8442%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch   9,  Average loss: 0.0035, Accuracy: 377/385 (97.9221%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 51, internal_epoch  10,  Average loss: 0.0038, Accuracy: 374/385 (97.1429%), train_poison_data_count: 193
Global model norm: 15.425067049495938.
Norm before scaling: 15.519554355161507. Distance: 3.0224377460237073
Total norm for 10 adversaries is: 15.519554355161507. distance: 3.0224377460237073
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.2018, Accuracy: 8361/8968 (93.2315%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   1,  Average loss: 0.0081, Accuracy: 494/627 (78.7879%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   2,  Average loss: 0.0031, Accuracy: 580/627 (92.5040%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   3,  Average loss: 0.0011, Accuracy: 611/627 (97.4482%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   4,  Average loss: 0.0013, Accuracy: 609/627 (97.1292%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   5,  Average loss: 0.0007, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   6,  Average loss: 0.0009, Accuracy: 616/627 (98.2456%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   7,  Average loss: 0.0009, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   8,  Average loss: 0.0005, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch   9,  Average loss: 0.0006, Accuracy: 621/627 (99.0431%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 74, internal_epoch  10,  Average loss: 0.0006, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Global model norm: 15.425067049495938.
Norm before scaling: 15.594197177017582. Distance: 2.6375541211401443
Total norm for 10 adversaries is: 15.594197177017582. distance: 2.6375541211401443
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0079, Accuracy: 8943/8968 (99.7212%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 3, internal_epoch   1,  Average loss: 0.0227, Accuracy: 251/516 (48.6434%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 3, internal_epoch   2,  Average loss: 0.0171, Accuracy: 255/516 (49.4186%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 3, internal_epoch   3,  Average loss: 0.0128, Accuracy: 268/516 (51.9380%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 3, internal_epoch   4,  Average loss: 0.0130, Accuracy: 261/516 (50.5814%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 3, internal_epoch   5,  Average loss: 0.0127, Accuracy: 260/516 (50.3876%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 3, internal_epoch   6,  Average loss: 0.0132, Accuracy: 248/516 (48.0620%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 3, internal_epoch   7,  Average loss: 0.0129, Accuracy: 265/516 (51.3566%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 3, internal_epoch   8,  Average loss: 0.0129, Accuracy: 255/516 (49.4186%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 3, internal_epoch   9,  Average loss: 0.0125, Accuracy: 263/516 (50.9690%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 3, internal_epoch  10,  Average loss: 0.0125, Accuracy: 269/516 (52.1318%), train_poison_data_count: 260
Global model norm: 15.425067049495938.
Norm before scaling: 15.524188456924044. Distance: 3.5550801154658065
Total norm for 10 adversaries is: 15.524188456924044. distance: 3.5550801154658065
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.5739, Accuracy: 8460/8968 (94.3354%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 18, internal_epoch   1,  Average loss: 0.0204, Accuracy: 388/759 (51.1199%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 18, internal_epoch   2,  Average loss: 0.0108, Accuracy: 465/759 (61.2648%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 18, internal_epoch   3,  Average loss: 0.0059, Accuracy: 668/759 (88.0105%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 18, internal_epoch   4,  Average loss: 0.0034, Accuracy: 731/759 (96.3109%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 18, internal_epoch   5,  Average loss: 0.0020, Accuracy: 742/759 (97.7602%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 18, internal_epoch   6,  Average loss: 0.0013, Accuracy: 750/759 (98.8142%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 18, internal_epoch   7,  Average loss: 0.0009, Accuracy: 751/759 (98.9460%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 18, internal_epoch   8,  Average loss: 0.0005, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 18, internal_epoch   9,  Average loss: 0.0006, Accuracy: 753/759 (99.2095%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 18, internal_epoch  10,  Average loss: 0.0006, Accuracy: 754/759 (99.3412%), train_poison_data_count: 384
Global model norm: 15.425067049495938.
Norm before scaling: 15.759441149722363. Distance: 3.917490662817426
Total norm for 10 adversaries is: 15.759441149722363. distance: 3.917490662817426
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0836, Accuracy: 8673/8968 (96.7105%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 29, internal_epoch   1,  Average loss: 0.0212, Accuracy: 265/506 (52.3715%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 29, internal_epoch   2,  Average loss: 0.0097, Accuracy: 360/506 (71.1462%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 29, internal_epoch   3,  Average loss: 0.0027, Accuracy: 491/506 (97.0356%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 29, internal_epoch   4,  Average loss: 0.0023, Accuracy: 491/506 (97.0356%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 29, internal_epoch   5,  Average loss: 0.0015, Accuracy: 500/506 (98.8142%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 29, internal_epoch   6,  Average loss: 0.0012, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 29, internal_epoch   7,  Average loss: 0.0010, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 29, internal_epoch   8,  Average loss: 0.0010, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 29, internal_epoch   9,  Average loss: 0.0007, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 29, internal_epoch  10,  Average loss: 0.0006, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Global model norm: 15.425067049495938.
Norm before scaling: 15.687132325746116. Distance: 3.2375188466116342
Total norm for 10 adversaries is: 15.687132325746116. distance: 3.2375188466116342
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.3539, Accuracy: 7667/8968 (85.4929%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 62, internal_epoch   1,  Average loss: 0.0112, Accuracy: 440/580 (75.8621%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 62, internal_epoch   2,  Average loss: 0.0026, Accuracy: 554/580 (95.5172%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 62, internal_epoch   3,  Average loss: 0.0018, Accuracy: 560/580 (96.5517%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 62, internal_epoch   4,  Average loss: 0.0013, Accuracy: 565/580 (97.4138%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 62, internal_epoch   5,  Average loss: 0.0013, Accuracy: 565/580 (97.4138%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 62, internal_epoch   6,  Average loss: 0.0013, Accuracy: 565/580 (97.4138%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 62, internal_epoch   7,  Average loss: 0.0009, Accuracy: 569/580 (98.1034%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 62, internal_epoch   8,  Average loss: 0.0008, Accuracy: 572/580 (98.6207%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 62, internal_epoch   9,  Average loss: 0.0007, Accuracy: 570/580 (98.2759%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 62, internal_epoch  10,  Average loss: 0.0016, Accuracy: 563/580 (97.0690%), train_poison_data_count: 292
Global model norm: 15.425067049495938.
Norm before scaling: 15.6958151129703. Distance: 2.90833937490395
Total norm for 10 adversaries is: 15.6958151129703. distance: 2.90833937490395
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0217, Accuracy: 8891/8968 (99.1414%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 33, internal_epoch   1,  Average loss: 0.0226, Accuracy: 287/587 (48.8927%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 33, internal_epoch   2,  Average loss: 0.0142, Accuracy: 312/587 (53.1516%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 33, internal_epoch   3,  Average loss: 0.0163, Accuracy: 288/587 (49.0630%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 33, internal_epoch   4,  Average loss: 0.0137, Accuracy: 272/587 (46.3373%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 33, internal_epoch   5,  Average loss: 0.0125, Accuracy: 305/587 (51.9591%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 33, internal_epoch   6,  Average loss: 0.0126, Accuracy: 305/587 (51.9591%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 33, internal_epoch   7,  Average loss: 0.0127, Accuracy: 298/587 (50.7666%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 33, internal_epoch   8,  Average loss: 0.0121, Accuracy: 316/587 (53.8330%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 33, internal_epoch   9,  Average loss: 0.0120, Accuracy: 328/587 (55.8773%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 33, internal_epoch  10,  Average loss: 0.0119, Accuracy: 324/587 (55.1959%), train_poison_data_count: 299
Global model norm: 15.425067049495938.
Norm before scaling: 15.530917925901667. Distance: 3.225799100775188
Total norm for 10 adversaries is: 15.530917925901667. distance: 3.225799100775188
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.3963, Accuracy: 8723/8968 (97.2681%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 88, internal_epoch   1,  Average loss: 0.0150, Accuracy: 465/734 (63.3515%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 88, internal_epoch   2,  Average loss: 0.0095, Accuracy: 488/734 (66.4850%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 88, internal_epoch   3,  Average loss: 0.0093, Accuracy: 493/734 (67.1662%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 88, internal_epoch   4,  Average loss: 0.0077, Accuracy: 556/734 (75.7493%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 88, internal_epoch   5,  Average loss: 0.0064, Accuracy: 603/734 (82.1526%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 88, internal_epoch   6,  Average loss: 0.0058, Accuracy: 603/734 (82.1526%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 88, internal_epoch   7,  Average loss: 0.0046, Accuracy: 668/734 (91.0082%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 88, internal_epoch   8,  Average loss: 0.0033, Accuracy: 697/734 (94.9591%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 88, internal_epoch   9,  Average loss: 0.0027, Accuracy: 712/734 (97.0027%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 88, internal_epoch  10,  Average loss: 0.0027, Accuracy: 707/734 (96.3215%), train_poison_data_count: 382
Global model norm: 15.425067049495938.
Norm before scaling: 15.577893346290391. Distance: 3.0657591313096493
Total norm for 10 adversaries is: 15.577893346290391. distance: 3.0657591313096493
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0813, Accuracy: 8741/8968 (97.4688%)
___Train Local_Simple,  epoch  33, local model 46, internal_epoch   1,  Average loss: 0.0013, Accuracy: 636/650 (97.8462%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 5.7175, Accuracy: 3850/10000 (38.5000%)
___Train Local_Simple,  epoch  33, local model 76, internal_epoch   1,  Average loss: 0.0037, Accuracy: 424/459 (92.3747%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.5038, Accuracy: 5978/10000 (59.7800%)
___Train Local_Simple,  epoch  33, local model 47, internal_epoch   1,  Average loss: 0.0009, Accuracy: 526/534 (98.5019%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.6265, Accuracy: 6001/10000 (60.0100%)
___Train Local_Simple,  epoch  33, local model 96, internal_epoch   1,  Average loss: 0.0032, Accuracy: 500/531 (94.1620%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 4.1851, Accuracy: 3871/10000 (38.7100%)
___Train Local_Simple,  epoch  33, local model 54, internal_epoch   1,  Average loss: 0.0009, Accuracy: 814/832 (97.8365%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 3.4632, Accuracy: 4575/10000 (45.7500%)
___Train Local_Simple,  epoch  33, local model 98, internal_epoch   1,  Average loss: 0.0014, Accuracy: 532/548 (97.0803%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.5910, Accuracy: 4536/10000 (45.3600%)
___Train Local_Simple,  epoch  33, local model 9, internal_epoch   1,  Average loss: 0.0010, Accuracy: 500/508 (98.4252%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.6380, Accuracy: 7870/10000 (78.7000%)
___Train Local_Simple,  epoch  33, local model 23, internal_epoch   1,  Average loss: 0.0015, Accuracy: 530/542 (97.7860%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 4.2587, Accuracy: 3537/10000 (35.3700%)
___Train Local_Simple,  epoch  33, local model 58, internal_epoch   1,  Average loss: 0.0008, Accuracy: 762/772 (98.7047%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 3.8037, Accuracy: 4449/10000 (44.4900%)
___Train Local_Simple,  epoch  33, local model 43, internal_epoch   1,  Average loss: 0.0011, Accuracy: 422/431 (97.9118%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.2094, Accuracy: 6111/10000 (61.1100%)
___Train Local_Simple,  epoch  33, local model 26, internal_epoch   1,  Average loss: 0.0012, Accuracy: 508/519 (97.8805%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.3911, Accuracy: 5293/10000 (52.9300%)
___Train Local_Simple,  epoch  33, local model 22, internal_epoch   1,  Average loss: 0.0015, Accuracy: 253/262 (96.5649%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.2407, Accuracy: 6679/10000 (66.7900%)
___Train Local_Simple,  epoch  33, local model 15, internal_epoch   1,  Average loss: 0.0019, Accuracy: 276/282 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.7394, Accuracy: 7823/10000 (78.2300%)
___Train Local_Simple,  epoch  33, local model 66, internal_epoch   1,  Average loss: 0.0025, Accuracy: 697/733 (95.0887%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.4445, Accuracy: 6595/10000 (65.9500%)
___Train Local_Simple,  epoch  33, local model 40, internal_epoch   1,  Average loss: 0.0005, Accuracy: 492/498 (98.7952%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.8757, Accuracy: 5822/10000 (58.2200%)
___Train Local_Simple,  epoch  33, local model 59, internal_epoch   1,  Average loss: 0.0040, Accuracy: 625/644 (97.0497%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 12.7094, Accuracy: 2216/10000 (22.1600%)
___Train Local_Simple,  epoch  33, local model 56, internal_epoch   1,  Average loss: 0.0005, Accuracy: 706/715 (98.7413%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.4198, Accuracy: 4803/10000 (48.0300%)
___Train Local_Simple,  epoch  33, local model 55, internal_epoch   1,  Average loss: 0.0017, Accuracy: 359/375 (95.7333%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.8583, Accuracy: 6346/10000 (63.4600%)
___Train Local_Simple,  epoch  33, local model 86, internal_epoch   1,  Average loss: 0.0006, Accuracy: 686/692 (99.1329%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 3.4647, Accuracy: 3854/10000 (38.5400%)
___Train Local_Simple,  epoch  33, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 579/615 (94.1463%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.5702, Accuracy: 6767/10000 (67.6700%)
___Train Local_Simple,  epoch  33, local model 31, internal_epoch   1,  Average loss: 0.0014, Accuracy: 579/596 (97.1477%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 3.0073, Accuracy: 4802/10000 (48.0200%)
___Train Local_Simple,  epoch  33, local model 85, internal_epoch   1,  Average loss: 0.0024, Accuracy: 766/807 (94.9195%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.8970, Accuracy: 5794/10000 (57.9400%)
___Train Local_Simple,  epoch  33, local model 24, internal_epoch   1,  Average loss: 0.0019, Accuracy: 466/477 (97.6939%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.7231, Accuracy: 5813/10000 (58.1300%)
___Train Local_Simple,  epoch  33, local model 35, internal_epoch   1,  Average loss: 0.0014, Accuracy: 613/630 (97.3016%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 6.9058, Accuracy: 3473/10000 (34.7300%)
___Train Local_Simple,  epoch  33, local model 69, internal_epoch   1,  Average loss: 0.0015, Accuracy: 652/671 (97.1684%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 7.8577, Accuracy: 2832/10000 (28.3200%)
___Train Local_Simple,  epoch  33, local model 60, internal_epoch   1,  Average loss: 0.0017, Accuracy: 553/571 (96.8476%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 3.5042, Accuracy: 4171/10000 (41.7100%)
___Train Local_Simple,  epoch  33, local model 65, internal_epoch   1,  Average loss: 0.0019, Accuracy: 593/621 (95.4911%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 3.0650, Accuracy: 4113/10000 (41.1300%)
___Train Local_Simple,  epoch  33, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 695/713 (97.4755%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 5.9551, Accuracy: 2999/10000 (29.9900%)
___Train Local_Simple,  epoch  33, local model 30, internal_epoch   1,  Average loss: 0.0026, Accuracy: 424/443 (95.7111%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.9533, Accuracy: 6275/10000 (62.7500%)
___Train Local_Simple,  epoch  33, local model 92, internal_epoch   1,  Average loss: 0.0024, Accuracy: 580/611 (94.9264%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 3.8091, Accuracy: 3983/10000 (39.8300%)
___Train Local_Simple,  epoch  33, local model 79, internal_epoch   1,  Average loss: 0.0012, Accuracy: 650/661 (98.3359%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.7443, Accuracy: 4200/10000 (42.0000%)
___Train Local_Simple,  epoch  33, local model 95, internal_epoch   1,  Average loss: 0.0023, Accuracy: 582/600 (97.0000%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.5502, Accuracy: 5286/10000 (52.8600%)
___Train Local_Simple,  epoch  33, local model 70, internal_epoch   1,  Average loss: 0.0014, Accuracy: 553/568 (97.3592%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.4138, Accuracy: 5276/10000 (52.7600%)
___Train Local_Simple,  epoch  33, local model 12, internal_epoch   1,  Average loss: 0.0017, Accuracy: 705/725 (97.2414%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 4.3260, Accuracy: 3749/10000 (37.4900%)
___Train Local_Simple,  epoch  33, local model 42, internal_epoch   1,  Average loss: 0.0005, Accuracy: 472/473 (99.7886%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.7556, Accuracy: 7630/10000 (76.3000%)
___Train Local_Simple,  epoch  33, local model 77, internal_epoch   1,  Average loss: 0.0020, Accuracy: 601/618 (97.2492%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.5234, Accuracy: 6144/10000 (61.4400%)
___Train Local_Simple,  epoch  33, local model 14, internal_epoch   1,  Average loss: 0.0015, Accuracy: 675/692 (97.5434%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.5656, Accuracy: 5970/10000 (59.7000%)
___Train Local_Simple,  epoch  33, local model 1, internal_epoch   1,  Average loss: 0.0008, Accuracy: 530/536 (98.8806%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.7604, Accuracy: 7943/10000 (79.4300%)
___Train Local_Simple,  epoch  33, local model 25, internal_epoch   1,  Average loss: 0.0010, Accuracy: 578/592 (97.6351%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 6.3725, Accuracy: 3697/10000 (36.9700%)
___Train Local_Simple,  epoch  33, local model 99, internal_epoch   1,  Average loss: 0.0024, Accuracy: 689/712 (96.7697%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.4011, Accuracy: 4551/10000 (45.5100%)
___Train Local_Simple,  epoch  33, local model 83, internal_epoch   1,  Average loss: 0.0019, Accuracy: 345/360 (95.8333%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.2933, Accuracy: 6890/10000 (68.9000%)
___Train Local_Simple,  epoch  33, local model 94, internal_epoch   1,  Average loss: 0.0013, Accuracy: 652/671 (97.1684%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 4.3320, Accuracy: 4621/10000 (46.2100%)
___Train Local_Simple,  epoch  33, local model 37, internal_epoch   1,  Average loss: 0.0008, Accuracy: 449/456 (98.4649%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.1110, Accuracy: 7031/10000 (70.3100%)
___Train Local_Simple,  epoch  33, local model 67, internal_epoch   1,  Average loss: 0.0018, Accuracy: 427/441 (96.8254%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.4595, Accuracy: 4398/10000 (43.9800%)
___Train Local_Simple,  epoch  33, local model 7, internal_epoch   1,  Average loss: 0.0005, Accuracy: 798/802 (99.5012%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.1286, Accuracy: 7067/10000 (70.6700%)
___Train Local_Simple,  epoch  33, local model 39, internal_epoch   1,  Average loss: 0.0010, Accuracy: 481/493 (97.5659%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 3.2445, Accuracy: 5035/10000 (50.3500%)
___Train Local_Simple,  epoch  33, local model 97, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1096/1112 (98.5612%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 5.6712, Accuracy: 3508/10000 (35.0800%)
___Train Local_Simple,  epoch  33, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 532/561 (94.8307%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 3.2540, Accuracy: 4724/10000 (47.2400%)
___Train Local_Simple,  epoch  33, local model 72, internal_epoch   1,  Average loss: 0.0022, Accuracy: 404/423 (95.5083%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.9576, Accuracy: 4042/10000 (40.4200%)
___Train Local_Simple,  epoch  33, local model 63, internal_epoch   1,  Average loss: 0.0017, Accuracy: 294/303 (97.0297%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.9622, Accuracy: 5684/10000 (56.8400%)
___Train Local_Simple,  epoch  33, local model 19, internal_epoch   1,  Average loss: 0.0010, Accuracy: 584/598 (97.6589%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 4.2654, Accuracy: 3534/10000 (35.3400%)
___Train Local_Simple,  epoch  33, local model 87, internal_epoch   1,  Average loss: 0.0010, Accuracy: 652/663 (98.3409%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 3.5427, Accuracy: 4086/10000 (40.8600%)
___Train Local_Simple,  epoch  33, local model 57, internal_epoch   1,  Average loss: 0.0008, Accuracy: 515/523 (98.4704%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.9555, Accuracy: 5009/10000 (50.0900%)
___Train Local_Simple,  epoch  33, local model 81, internal_epoch   1,  Average loss: 0.0012, Accuracy: 623/636 (97.9560%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.8450, Accuracy: 4369/10000 (43.6900%)
___Train Local_Simple,  epoch  33, local model 10, internal_epoch   1,  Average loss: 0.0013, Accuracy: 559/573 (97.5567%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.9152, Accuracy: 5923/10000 (59.2300%)
___Train Local_Simple,  epoch  33, local model 75, internal_epoch   1,  Average loss: 0.0017, Accuracy: 736/763 (96.4613%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 4.7784, Accuracy: 3401/10000 (34.0100%)
___Train Local_Simple,  epoch  33, local model 8, internal_epoch   1,  Average loss: 0.0009, Accuracy: 695/706 (98.4419%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.5144, Accuracy: 4530/10000 (45.3000%)
___Train Local_Simple,  epoch  33, local model 49, internal_epoch   1,  Average loss: 0.0012, Accuracy: 346/355 (97.4648%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.7720, Accuracy: 7548/10000 (75.4800%)
___Train Local_Simple,  epoch  33, local model 82, internal_epoch   1,  Average loss: 0.0007, Accuracy: 804/815 (98.6503%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 3.5228, Accuracy: 4531/10000 (45.3100%)
___Train Local_Simple,  epoch  33, local model 50, internal_epoch   1,  Average loss: 0.0012, Accuracy: 467/477 (97.9036%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 3.6730, Accuracy: 4485/10000 (44.8500%)
___Train Local_Simple,  epoch  33, local model 2, internal_epoch   1,  Average loss: 0.0011, Accuracy: 553/564 (98.0496%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 3.7960, Accuracy: 3631/10000 (36.3100%)
___Train Local_Simple,  epoch  33, local model 64, internal_epoch   1,  Average loss: 0.0012, Accuracy: 599/608 (98.5197%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 4.5778, Accuracy: 4745/10000 (47.4500%)
___Train Local_Simple,  epoch  33, local model 11, internal_epoch   1,  Average loss: 0.0010, Accuracy: 543/554 (98.0144%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 3.3256, Accuracy: 5187/10000 (51.8700%)
___Train Local_Simple,  epoch  33, local model 45, internal_epoch   1,  Average loss: 0.0010, Accuracy: 637/647 (98.4544%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.3899, Accuracy: 5362/10000 (53.6200%)
___Train Local_Simple,  epoch  33, local model 61, internal_epoch   1,  Average loss: 0.0021, Accuracy: 276/287 (96.1672%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.1532, Accuracy: 6934/10000 (69.3400%)
___Train Local_Simple,  epoch  33, local model 17, internal_epoch   1,  Average loss: 0.0016, Accuracy: 506/527 (96.0152%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 5.5967, Accuracy: 3244/10000 (32.4400%)
___Train Local_Simple,  epoch  33, local model 38, internal_epoch   1,  Average loss: 0.0009, Accuracy: 469/477 (98.3229%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.8542, Accuracy: 7598/10000 (75.9800%)
___Train Local_Simple,  epoch  33, local model 0, internal_epoch   1,  Average loss: 0.0009, Accuracy: 428/435 (98.3908%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.6410, Accuracy: 5890/10000 (58.9000%)
___Train Local_Simple,  epoch  33, local model 28, internal_epoch   1,  Average loss: 0.0010, Accuracy: 597/611 (97.7087%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.2753, Accuracy: 5811/10000 (58.1100%)
___Train Local_Simple,  epoch  33, local model 48, internal_epoch   1,  Average loss: 0.0015, Accuracy: 352/363 (96.9697%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.7018, Accuracy: 7921/10000 (79.2100%)
___Train Local_Simple,  epoch  33, local model 52, internal_epoch   1,  Average loss: 0.0015, Accuracy: 764/789 (96.8314%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.8540, Accuracy: 4688/10000 (46.8800%)
___Train Local_Simple,  epoch  33, local model 68, internal_epoch   1,  Average loss: 0.0022, Accuracy: 527/549 (95.9927%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 3.4005, Accuracy: 4807/10000 (48.0700%)
___Train Local_Simple,  epoch  33, local model 5, internal_epoch   1,  Average loss: 0.0016, Accuracy: 559/578 (96.7128%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.8161, Accuracy: 7677/10000 (76.7700%)
___Train Local_Simple,  epoch  33, local model 78, internal_epoch   1,  Average loss: 0.0022, Accuracy: 564/587 (96.0818%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 5.3410, Accuracy: 2972/10000 (29.7200%)
___Train Local_Simple,  epoch  33, local model 91, internal_epoch   1,  Average loss: 0.0006, Accuracy: 814/819 (99.3895%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.6167, Accuracy: 4033/10000 (40.3300%)
___Train Local_Simple,  epoch  33, local model 89, internal_epoch   1,  Average loss: 0.0013, Accuracy: 669/683 (97.9502%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.2948, Accuracy: 5547/10000 (55.4700%)
___Train Local_Simple,  epoch  33, local model 27, internal_epoch   1,  Average loss: 0.0011, Accuracy: 731/745 (98.1208%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 4.7093, Accuracy: 3675/10000 (36.7500%)
___Train Local_Simple,  epoch  33, local model 34, internal_epoch   1,  Average loss: 0.0015, Accuracy: 848/871 (97.3594%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.9949, Accuracy: 4969/10000 (49.6900%)
___Train Local_Simple,  epoch  33, local model 21, internal_epoch   1,  Average loss: 0.0010, Accuracy: 672/687 (97.8166%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 3.2257, Accuracy: 5124/10000 (51.2400%)
___Train Local_Simple,  epoch  33, local model 4, internal_epoch   1,  Average loss: 0.0009, Accuracy: 737/748 (98.5294%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 4.8132, Accuracy: 3389/10000 (33.8900%)
___Train Local_Simple,  epoch  33, local model 80, internal_epoch   1,  Average loss: 0.0019, Accuracy: 514/532 (96.6165%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 6.4388, Accuracy: 2851/10000 (28.5100%)
___Train Local_Simple,  epoch  33, local model 20, internal_epoch   1,  Average loss: 0.0019, Accuracy: 576/602 (95.6811%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 3.4436, Accuracy: 4642/10000 (46.4200%)
___Train Local_Simple,  epoch  33, local model 84, internal_epoch   1,  Average loss: 0.0024, Accuracy: 399/420 (95.0000%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.4591, Accuracy: 6109/10000 (61.0900%)
___Train Local_Simple,  epoch  33, local model 16, internal_epoch   1,  Average loss: 0.0007, Accuracy: 805/817 (98.5312%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 5.2701, Accuracy: 4246/10000 (42.4600%)
___Train Local_Simple,  epoch  33, local model 53, internal_epoch   1,  Average loss: 0.0016, Accuracy: 546/561 (97.3262%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 4.6622, Accuracy: 4229/10000 (42.2900%)
___Train Local_Simple,  epoch  33, local model 44, internal_epoch   1,  Average loss: 0.0008, Accuracy: 553/561 (98.5740%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 4.5712, Accuracy: 5056/10000 (50.5600%)
___Train Local_Simple,  epoch  33, local model 93, internal_epoch   1,  Average loss: 0.0025, Accuracy: 592/630 (93.9683%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.5445, Accuracy: 5267/10000 (52.6700%)
___Train Local_Simple,  epoch  33, local model 6, internal_epoch   1,  Average loss: 0.0031, Accuracy: 406/435 (93.3333%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 3.4703, Accuracy: 5351/10000 (53.5100%)
___Train Local_Simple,  epoch  33, local model 32, internal_epoch   1,  Average loss: 0.0008, Accuracy: 582/590 (98.6441%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 3.0928, Accuracy: 5302/10000 (53.0200%)
___Train Local_Simple,  epoch  33, local model 36, internal_epoch   1,  Average loss: 0.0011, Accuracy: 306/315 (97.1429%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.4031, Accuracy: 8612/10000 (86.1200%)
time spent on training: 370.3400378227234
___Test Target_Simple poisoned: False, epoch: 33: Average loss: 0.1982, Accuracy: 9415/10000 (94.1500%)
___Test Target_Simple poisoned: True, epoch: 33: Average loss: 4.0728, Accuracy: 370/8968 (4.1258%)
saving model
Saving model on epoch 33
Done in 401.9054560661316 sec.
Server Epoch:34 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 95, 10, 55, 96, 64, 16, 34, 61, 12, 78, 66, 91, 67, 32, 42, 85, 92, 23, 82, 2, 68, 45, 59, 24, 49, 44, 5, 58, 47, 25, 76, 38, 0, 60, 56, 1, 9, 57, 30, 27, 81, 72, 17, 69, 28, 84, 14, 50, 71, 19, 15, 22, 21, 93, 75, 31, 98, 90, 35, 53, 39, 79, 11, 77, 54, 36, 70, 6, 83, 8, 37, 46, 63, 7, 89, 86, 13, 99, 80, 94, 48, 87, 26, 65, 97, 4, 40, 43, 20, 52].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   1,  Average loss: 0.0211, Accuracy: 285/569 (50.0879%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   2,  Average loss: 0.0142, Accuracy: 266/569 (46.7487%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   3,  Average loss: 0.0119, Accuracy: 297/569 (52.1968%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   4,  Average loss: 0.0116, Accuracy: 315/569 (55.3603%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   5,  Average loss: 0.0116, Accuracy: 299/569 (52.5483%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   6,  Average loss: 0.0114, Accuracy: 317/569 (55.7118%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   7,  Average loss: 0.0110, Accuracy: 345/569 (60.6327%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   8,  Average loss: 0.0109, Accuracy: 368/569 (64.6749%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   9,  Average loss: 0.0109, Accuracy: 359/569 (63.0931%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch  10,  Average loss: 0.0108, Accuracy: 372/569 (65.3779%), train_poison_data_count: 288
Global model norm: 15.424286040316927.
Norm before scaling: 15.493489528619351. Distance: 2.938408082244584
Total norm for 10 adversaries is: 15.493489528619351. distance: 2.938408082244584
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.4396, Accuracy: 7939/8968 (88.5259%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   1,  Average loss: 0.0145, Accuracy: 364/522 (69.7318%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   2,  Average loss: 0.0091, Accuracy: 377/522 (72.2222%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   3,  Average loss: 0.0079, Accuracy: 386/522 (73.9464%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   4,  Average loss: 0.0067, Accuracy: 423/522 (81.0345%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   5,  Average loss: 0.0058, Accuracy: 426/522 (81.6092%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   6,  Average loss: 0.0052, Accuracy: 445/522 (85.2490%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   7,  Average loss: 0.0046, Accuracy: 481/522 (92.1456%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   8,  Average loss: 0.0039, Accuracy: 487/522 (93.2950%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch   9,  Average loss: 0.0031, Accuracy: 504/522 (96.5517%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 73, internal_epoch  10,  Average loss: 0.0032, Accuracy: 506/522 (96.9349%), train_poison_data_count: 266
Global model norm: 15.424286040316927.
Norm before scaling: 15.493148273756924. Distance: 2.8690645066272866
Total norm for 10 adversaries is: 15.493148273756924. distance: 2.8690645066272866
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0362, Accuracy: 8918/8968 (99.4425%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   1,  Average loss: 0.0204, Accuracy: 197/385 (51.1688%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   2,  Average loss: 0.0115, Accuracy: 273/385 (70.9091%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   3,  Average loss: 0.0181, Accuracy: 248/385 (64.4156%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   4,  Average loss: 0.0083, Accuracy: 288/385 (74.8052%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   5,  Average loss: 0.0047, Accuracy: 369/385 (95.8442%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   6,  Average loss: 0.0040, Accuracy: 368/385 (95.5844%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   7,  Average loss: 0.0028, Accuracy: 377/385 (97.9221%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   8,  Average loss: 0.0026, Accuracy: 374/385 (97.1429%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch   9,  Average loss: 0.0022, Accuracy: 379/385 (98.4416%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 51, internal_epoch  10,  Average loss: 0.0022, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Global model norm: 15.424286040316927.
Norm before scaling: 15.568576346538812. Distance: 2.694104352333255
Total norm for 10 adversaries is: 15.568576346538812. distance: 2.694104352333255
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.2204, Accuracy: 8273/8968 (92.2502%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   1,  Average loss: 0.0111, Accuracy: 463/627 (73.8437%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   2,  Average loss: 0.0025, Accuracy: 599/627 (95.5343%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   3,  Average loss: 0.0017, Accuracy: 607/627 (96.8102%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   4,  Average loss: 0.0013, Accuracy: 610/627 (97.2887%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   5,  Average loss: 0.0009, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   6,  Average loss: 0.0009, Accuracy: 616/627 (98.2456%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   7,  Average loss: 0.0011, Accuracy: 616/627 (98.2456%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   8,  Average loss: 0.0010, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch   9,  Average loss: 0.0009, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 74, internal_epoch  10,  Average loss: 0.0007, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Global model norm: 15.424286040316927.
Norm before scaling: 15.690373009453321. Distance: 3.012587999506894
Total norm for 10 adversaries is: 15.690373009453321. distance: 3.012587999506894
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0131, Accuracy: 8921/8968 (99.4759%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 3, internal_epoch   1,  Average loss: 0.0246, Accuracy: 256/516 (49.6124%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 3, internal_epoch   2,  Average loss: 0.0152, Accuracy: 256/516 (49.6124%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 3, internal_epoch   3,  Average loss: 0.0187, Accuracy: 255/516 (49.4186%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 3, internal_epoch   4,  Average loss: 0.0150, Accuracy: 258/516 (50.0000%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 3, internal_epoch   5,  Average loss: 0.0141, Accuracy: 258/516 (50.0000%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 3, internal_epoch   6,  Average loss: 0.0131, Accuracy: 269/516 (52.1318%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 3, internal_epoch   7,  Average loss: 0.0135, Accuracy: 257/516 (49.8062%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 3, internal_epoch   8,  Average loss: 0.0132, Accuracy: 276/516 (53.4884%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 3, internal_epoch   9,  Average loss: 0.0129, Accuracy: 258/516 (50.0000%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 3, internal_epoch  10,  Average loss: 0.0128, Accuracy: 263/516 (50.9690%), train_poison_data_count: 260
Global model norm: 15.424286040316927.
Norm before scaling: 15.543660353895591. Distance: 3.636311083110445
Total norm for 10 adversaries is: 15.543660353895591. distance: 3.636311083110445
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.3944, Accuracy: 8577/8968 (95.6401%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 18, internal_epoch   1,  Average loss: 0.0182, Accuracy: 385/759 (50.7246%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 18, internal_epoch   2,  Average loss: 0.0105, Accuracy: 483/759 (63.6364%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 18, internal_epoch   3,  Average loss: 0.0044, Accuracy: 712/759 (93.8076%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 18, internal_epoch   4,  Average loss: 0.0025, Accuracy: 740/759 (97.4967%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 18, internal_epoch   5,  Average loss: 0.0014, Accuracy: 749/759 (98.6825%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 18, internal_epoch   6,  Average loss: 0.0008, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 18, internal_epoch   7,  Average loss: 0.0006, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 18, internal_epoch   8,  Average loss: 0.0005, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 18, internal_epoch   9,  Average loss: 0.0004, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 18, internal_epoch  10,  Average loss: 0.0005, Accuracy: 753/759 (99.2095%), train_poison_data_count: 384
Global model norm: 15.424286040316927.
Norm before scaling: 15.739661804986522. Distance: 3.754840270199508
Total norm for 10 adversaries is: 15.739661804986522. distance: 3.754840270199508
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0850, Accuracy: 8646/8968 (96.4095%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 29, internal_epoch   1,  Average loss: 0.0194, Accuracy: 289/506 (57.1146%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 29, internal_epoch   2,  Average loss: 0.0078, Accuracy: 400/506 (79.0514%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 29, internal_epoch   3,  Average loss: 0.0021, Accuracy: 494/506 (97.6285%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 29, internal_epoch   4,  Average loss: 0.0016, Accuracy: 498/506 (98.4190%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 29, internal_epoch   5,  Average loss: 0.0013, Accuracy: 497/506 (98.2213%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 29, internal_epoch   6,  Average loss: 0.0011, Accuracy: 500/506 (98.8142%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 29, internal_epoch   7,  Average loss: 0.0009, Accuracy: 500/506 (98.8142%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 29, internal_epoch   8,  Average loss: 0.0008, Accuracy: 499/506 (98.6166%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 29, internal_epoch   9,  Average loss: 0.0008, Accuracy: 498/506 (98.4190%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 29, internal_epoch  10,  Average loss: 0.0005, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Global model norm: 15.424286040316927.
Norm before scaling: 15.686334209515529. Distance: 3.5455513387418742
Total norm for 10 adversaries is: 15.686334209515529. distance: 3.5455513387418742
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.2938, Accuracy: 7947/8968 (88.6151%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 62, internal_epoch   1,  Average loss: 0.0091, Accuracy: 445/580 (76.7241%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 62, internal_epoch   2,  Average loss: 0.0026, Accuracy: 554/580 (95.5172%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 62, internal_epoch   3,  Average loss: 0.0015, Accuracy: 557/580 (96.0345%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 62, internal_epoch   4,  Average loss: 0.0009, Accuracy: 569/580 (98.1034%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 62, internal_epoch   5,  Average loss: 0.0011, Accuracy: 568/580 (97.9310%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 62, internal_epoch   6,  Average loss: 0.0009, Accuracy: 568/580 (97.9310%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 62, internal_epoch   7,  Average loss: 0.0007, Accuracy: 573/580 (98.7931%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 62, internal_epoch   8,  Average loss: 0.0007, Accuracy: 572/580 (98.6207%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 62, internal_epoch   9,  Average loss: 0.0008, Accuracy: 570/580 (98.2759%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 62, internal_epoch  10,  Average loss: 0.0008, Accuracy: 571/580 (98.4483%), train_poison_data_count: 292
Global model norm: 15.424286040316927.
Norm before scaling: 15.619057463710398. Distance: 2.5253970447762564
Total norm for 10 adversaries is: 15.619057463710398. distance: 2.5253970447762564
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0165, Accuracy: 8912/8968 (99.3756%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 33, internal_epoch   1,  Average loss: 0.0240, Accuracy: 298/587 (50.7666%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 33, internal_epoch   2,  Average loss: 0.0161, Accuracy: 269/587 (45.8262%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 33, internal_epoch   3,  Average loss: 0.0165, Accuracy: 309/587 (52.6405%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 33, internal_epoch   4,  Average loss: 0.0131, Accuracy: 311/587 (52.9813%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 33, internal_epoch   5,  Average loss: 0.0126, Accuracy: 307/587 (52.2998%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 33, internal_epoch   6,  Average loss: 0.0131, Accuracy: 308/587 (52.4702%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 33, internal_epoch   7,  Average loss: 0.0125, Accuracy: 316/587 (53.8330%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 33, internal_epoch   8,  Average loss: 0.0121, Accuracy: 312/587 (53.1516%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 33, internal_epoch   9,  Average loss: 0.0120, Accuracy: 327/587 (55.7070%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 33, internal_epoch  10,  Average loss: 0.0118, Accuracy: 341/587 (58.0920%), train_poison_data_count: 299
Global model norm: 15.424286040316927.
Norm before scaling: 15.540001228558308. Distance: 3.4034224507180646
Total norm for 10 adversaries is: 15.540001228558308. distance: 3.4034224507180646
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.3134, Accuracy: 8772/8968 (97.8145%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 88, internal_epoch   1,  Average loss: 0.0150, Accuracy: 450/734 (61.3079%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 88, internal_epoch   2,  Average loss: 0.0106, Accuracy: 484/734 (65.9401%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 88, internal_epoch   3,  Average loss: 0.0096, Accuracy: 493/734 (67.1662%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 88, internal_epoch   4,  Average loss: 0.0087, Accuracy: 524/734 (71.3896%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 88, internal_epoch   5,  Average loss: 0.0079, Accuracy: 554/734 (75.4768%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 88, internal_epoch   6,  Average loss: 0.0067, Accuracy: 600/734 (81.7439%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 88, internal_epoch   7,  Average loss: 0.0055, Accuracy: 647/734 (88.1471%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 88, internal_epoch   8,  Average loss: 0.0046, Accuracy: 674/734 (91.8256%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 88, internal_epoch   9,  Average loss: 0.0039, Accuracy: 690/734 (94.0054%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 88, internal_epoch  10,  Average loss: 0.0036, Accuracy: 697/734 (94.9591%), train_poison_data_count: 382
Global model norm: 15.424286040316927.
Norm before scaling: 15.558867861789462. Distance: 3.1543664127396984
Total norm for 10 adversaries is: 15.558867861789462. distance: 3.1543664127396984
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.1021, Accuracy: 8671/8968 (96.6882%)
___Train Local_Simple,  epoch  34, local model 95, internal_epoch   1,  Average loss: 0.0030, Accuracy: 563/600 (93.8333%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 6.5133, Accuracy: 3255/10000 (32.5500%)
___Train Local_Simple,  epoch  34, local model 10, internal_epoch   1,  Average loss: 0.0016, Accuracy: 548/573 (95.6370%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 3.1788, Accuracy: 4176/10000 (41.7600%)
___Train Local_Simple,  epoch  34, local model 55, internal_epoch   1,  Average loss: 0.0012, Accuracy: 369/375 (98.4000%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.7883, Accuracy: 6025/10000 (60.2500%)
___Train Local_Simple,  epoch  34, local model 96, internal_epoch   1,  Average loss: 0.0010, Accuracy: 517/531 (97.3635%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 3.8275, Accuracy: 4428/10000 (44.2800%)
___Train Local_Simple,  epoch  34, local model 64, internal_epoch   1,  Average loss: 0.0007, Accuracy: 601/608 (98.8487%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.6667, Accuracy: 5860/10000 (58.6000%)
___Train Local_Simple,  epoch  34, local model 16, internal_epoch   1,  Average loss: 0.0003, Accuracy: 813/817 (99.5104%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.8661, Accuracy: 6328/10000 (63.2800%)
___Train Local_Simple,  epoch  34, local model 34, internal_epoch   1,  Average loss: 0.0011, Accuracy: 851/871 (97.7038%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 6.8448, Accuracy: 3337/10000 (33.3700%)
___Train Local_Simple,  epoch  34, local model 61, internal_epoch   1,  Average loss: 0.0011, Accuracy: 282/287 (98.2578%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.4967, Accuracy: 8344/10000 (83.4400%)
___Train Local_Simple,  epoch  34, local model 12, internal_epoch   1,  Average loss: 0.0007, Accuracy: 717/725 (98.8966%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.4651, Accuracy: 6709/10000 (67.0900%)
___Train Local_Simple,  epoch  34, local model 78, internal_epoch   1,  Average loss: 0.0043, Accuracy: 546/587 (93.0153%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 2.1264, Accuracy: 5163/10000 (51.6300%)
___Train Local_Simple,  epoch  34, local model 66, internal_epoch   1,  Average loss: 0.0030, Accuracy: 693/733 (94.5430%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 2.1491, Accuracy: 5297/10000 (52.9700%)
___Train Local_Simple,  epoch  34, local model 91, internal_epoch   1,  Average loss: 0.0010, Accuracy: 804/819 (98.1685%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 6.2179, Accuracy: 3069/10000 (30.6900%)
___Train Local_Simple,  epoch  34, local model 67, internal_epoch   1,  Average loss: 0.0020, Accuracy: 424/441 (96.1451%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 3.0353, Accuracy: 4236/10000 (42.3600%)
___Train Local_Simple,  epoch  34, local model 32, internal_epoch   1,  Average loss: 0.0018, Accuracy: 571/590 (96.7797%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 4.4755, Accuracy: 4492/10000 (44.9200%)
___Train Local_Simple,  epoch  34, local model 42, internal_epoch   1,  Average loss: 0.0008, Accuracy: 468/473 (98.9429%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 2.1096, Accuracy: 5900/10000 (59.0000%)
___Train Local_Simple,  epoch  34, local model 85, internal_epoch   1,  Average loss: 0.0018, Accuracy: 772/807 (95.6629%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 3.4886, Accuracy: 4083/10000 (40.8300%)
___Train Local_Simple,  epoch  34, local model 92, internal_epoch   1,  Average loss: 0.0032, Accuracy: 571/611 (93.4534%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 4.1819, Accuracy: 3323/10000 (33.2300%)
___Train Local_Simple,  epoch  34, local model 23, internal_epoch   1,  Average loss: 0.0011, Accuracy: 534/542 (98.5240%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 3.1471, Accuracy: 4067/10000 (40.6700%)
___Train Local_Simple,  epoch  34, local model 82, internal_epoch   1,  Average loss: 0.0011, Accuracy: 797/815 (97.7914%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 8.9578, Accuracy: 2970/10000 (29.7000%)
___Train Local_Simple,  epoch  34, local model 2, internal_epoch   1,  Average loss: 0.0012, Accuracy: 555/564 (98.4043%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 2.4239, Accuracy: 4748/10000 (47.4800%)
___Train Local_Simple,  epoch  34, local model 68, internal_epoch   1,  Average loss: 0.0017, Accuracy: 532/549 (96.9035%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 3.5541, Accuracy: 3738/10000 (37.3800%)
___Train Local_Simple,  epoch  34, local model 45, internal_epoch   1,  Average loss: 0.0019, Accuracy: 627/647 (96.9088%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 5.5641, Accuracy: 3744/10000 (37.4400%)
___Train Local_Simple,  epoch  34, local model 59, internal_epoch   1,  Average loss: 0.0011, Accuracy: 633/644 (98.2919%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 5.5118, Accuracy: 3396/10000 (33.9600%)
___Train Local_Simple,  epoch  34, local model 24, internal_epoch   1,  Average loss: 0.0017, Accuracy: 465/477 (97.4843%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.8859, Accuracy: 4808/10000 (48.0800%)
___Train Local_Simple,  epoch  34, local model 49, internal_epoch   1,  Average loss: 0.0015, Accuracy: 345/355 (97.1831%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 2.8723, Accuracy: 4761/10000 (47.6100%)
___Train Local_Simple,  epoch  34, local model 44, internal_epoch   1,  Average loss: 0.0004, Accuracy: 555/561 (98.9305%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.2867, Accuracy: 6792/10000 (67.9200%)
___Train Local_Simple,  epoch  34, local model 5, internal_epoch   1,  Average loss: 0.0014, Accuracy: 560/578 (96.8858%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 2.3639, Accuracy: 5502/10000 (55.0200%)
___Train Local_Simple,  epoch  34, local model 58, internal_epoch   1,  Average loss: 0.0010, Accuracy: 755/772 (97.7979%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 3.7012, Accuracy: 4090/10000 (40.9000%)
___Train Local_Simple,  epoch  34, local model 47, internal_epoch   1,  Average loss: 0.0020, Accuracy: 516/534 (96.6292%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 4.9208, Accuracy: 4691/10000 (46.9100%)
___Train Local_Simple,  epoch  34, local model 25, internal_epoch   1,  Average loss: 0.0003, Accuracy: 591/592 (99.8311%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.8214, Accuracy: 7792/10000 (77.9200%)
___Train Local_Simple,  epoch  34, local model 76, internal_epoch   1,  Average loss: 0.0012, Accuracy: 453/459 (98.6928%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.6078, Accuracy: 8230/10000 (82.3000%)
___Train Local_Simple,  epoch  34, local model 38, internal_epoch   1,  Average loss: 0.0009, Accuracy: 468/477 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.7272, Accuracy: 7757/10000 (77.5700%)
___Train Local_Simple,  epoch  34, local model 0, internal_epoch   1,  Average loss: 0.0018, Accuracy: 420/435 (96.5517%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 3.4670, Accuracy: 5477/10000 (54.7700%)
___Train Local_Simple,  epoch  34, local model 60, internal_epoch   1,  Average loss: 0.0019, Accuracy: 552/571 (96.6725%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 5.3761, Accuracy: 3068/10000 (30.6800%)
___Train Local_Simple,  epoch  34, local model 56, internal_epoch   1,  Average loss: 0.0008, Accuracy: 700/715 (97.9021%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 4.4817, Accuracy: 3932/10000 (39.3200%)
___Train Local_Simple,  epoch  34, local model 1, internal_epoch   1,  Average loss: 0.0008, Accuracy: 532/536 (99.2537%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3467, Accuracy: 8821/10000 (88.2100%)
___Train Local_Simple,  epoch  34, local model 9, internal_epoch   1,  Average loss: 0.0017, Accuracy: 496/508 (97.6378%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 2.0700, Accuracy: 5673/10000 (56.7300%)
___Train Local_Simple,  epoch  34, local model 57, internal_epoch   1,  Average loss: 0.0014, Accuracy: 509/523 (97.3231%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 4.4674, Accuracy: 3560/10000 (35.6000%)
___Train Local_Simple,  epoch  34, local model 30, internal_epoch   1,  Average loss: 0.0012, Accuracy: 436/443 (98.4199%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.8050, Accuracy: 7578/10000 (75.7800%)
___Train Local_Simple,  epoch  34, local model 27, internal_epoch   1,  Average loss: 0.0011, Accuracy: 731/745 (98.1208%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 5.5192, Accuracy: 3371/10000 (33.7100%)
___Train Local_Simple,  epoch  34, local model 81, internal_epoch   1,  Average loss: 0.0012, Accuracy: 622/636 (97.7987%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 2.7297, Accuracy: 5009/10000 (50.0900%)
___Train Local_Simple,  epoch  34, local model 72, internal_epoch   1,  Average loss: 0.0017, Accuracy: 411/423 (97.1631%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 2.6521, Accuracy: 3547/10000 (35.4700%)
___Train Local_Simple,  epoch  34, local model 17, internal_epoch   1,  Average loss: 0.0005, Accuracy: 524/527 (99.4307%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.9476, Accuracy: 6932/10000 (69.3200%)
___Train Local_Simple,  epoch  34, local model 69, internal_epoch   1,  Average loss: 0.0015, Accuracy: 653/671 (97.3174%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 4.0455, Accuracy: 3776/10000 (37.7600%)
___Train Local_Simple,  epoch  34, local model 28, internal_epoch   1,  Average loss: 0.0017, Accuracy: 593/611 (97.0540%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 5.2111, Accuracy: 4951/10000 (49.5100%)
___Train Local_Simple,  epoch  34, local model 84, internal_epoch   1,  Average loss: 0.0008, Accuracy: 411/420 (97.8571%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.5666, Accuracy: 8151/10000 (81.5100%)
___Train Local_Simple,  epoch  34, local model 14, internal_epoch   1,  Average loss: 0.0014, Accuracy: 670/692 (96.8208%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 3.2787, Accuracy: 5133/10000 (51.3300%)
___Train Local_Simple,  epoch  34, local model 50, internal_epoch   1,  Average loss: 0.0013, Accuracy: 466/477 (97.6939%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 2.0225, Accuracy: 5613/10000 (56.1300%)
___Train Local_Simple,  epoch  34, local model 71, internal_epoch   1,  Average loss: 0.0009, Accuracy: 548/561 (97.6827%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.7315, Accuracy: 7539/10000 (75.3900%)
___Train Local_Simple,  epoch  34, local model 19, internal_epoch   1,  Average loss: 0.0009, Accuracy: 591/598 (98.8294%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.9597, Accuracy: 5133/10000 (51.3300%)
___Train Local_Simple,  epoch  34, local model 15, internal_epoch   1,  Average loss: 0.0011, Accuracy: 280/282 (99.2908%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.4551, Accuracy: 8407/10000 (84.0700%)
___Train Local_Simple,  epoch  34, local model 22, internal_epoch   1,  Average loss: 0.0005, Accuracy: 260/262 (99.2366%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.4221, Accuracy: 8627/10000 (86.2700%)
___Train Local_Simple,  epoch  34, local model 21, internal_epoch   1,  Average loss: 0.0006, Accuracy: 679/687 (98.8355%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 3.3623, Accuracy: 4097/10000 (40.9700%)
___Train Local_Simple,  epoch  34, local model 93, internal_epoch   1,  Average loss: 0.0024, Accuracy: 603/630 (95.7143%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 3.0679, Accuracy: 3757/10000 (37.5700%)
___Train Local_Simple,  epoch  34, local model 75, internal_epoch   1,  Average loss: 0.0026, Accuracy: 731/763 (95.8060%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 2.0043, Accuracy: 4939/10000 (49.3900%)
___Train Local_Simple,  epoch  34, local model 31, internal_epoch   1,  Average loss: 0.0011, Accuracy: 586/596 (98.3221%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.2654, Accuracy: 6775/10000 (67.7500%)
___Train Local_Simple,  epoch  34, local model 98, internal_epoch   1,  Average loss: 0.0033, Accuracy: 517/548 (94.3431%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 6.1441, Accuracy: 2605/10000 (26.0500%)
___Train Local_Simple,  epoch  34, local model 90, internal_epoch   1,  Average loss: 0.0020, Accuracy: 585/615 (95.1220%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 2.2270, Accuracy: 4960/10000 (49.6000%)
___Train Local_Simple,  epoch  34, local model 35, internal_epoch   1,  Average loss: 0.0014, Accuracy: 609/630 (96.6667%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 3.7462, Accuracy: 4119/10000 (41.1900%)
___Train Local_Simple,  epoch  34, local model 53, internal_epoch   1,  Average loss: 0.0008, Accuracy: 553/561 (98.5740%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.6872, Accuracy: 5965/10000 (59.6500%)
___Train Local_Simple,  epoch  34, local model 39, internal_epoch   1,  Average loss: 0.0007, Accuracy: 486/493 (98.5801%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.4749, Accuracy: 6423/10000 (64.2300%)
___Train Local_Simple,  epoch  34, local model 79, internal_epoch   1,  Average loss: 0.0011, Accuracy: 652/661 (98.6384%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.6946, Accuracy: 5331/10000 (53.3100%)
___Train Local_Simple,  epoch  34, local model 11, internal_epoch   1,  Average loss: 0.0006, Accuracy: 549/554 (99.0975%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.8994, Accuracy: 7443/10000 (74.4300%)
___Train Local_Simple,  epoch  34, local model 77, internal_epoch   1,  Average loss: 0.0020, Accuracy: 593/618 (95.9547%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 5.3828, Accuracy: 3220/10000 (32.2000%)
___Train Local_Simple,  epoch  34, local model 54, internal_epoch   1,  Average loss: 0.0011, Accuracy: 813/832 (97.7163%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 6.8073, Accuracy: 3495/10000 (34.9500%)
___Train Local_Simple,  epoch  34, local model 36, internal_epoch   1,  Average loss: 0.0008, Accuracy: 311/315 (98.7302%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3542, Accuracy: 8803/10000 (88.0300%)
___Train Local_Simple,  epoch  34, local model 70, internal_epoch   1,  Average loss: 0.0025, Accuracy: 545/568 (95.9507%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 5.3832, Accuracy: 2883/10000 (28.8300%)
___Train Local_Simple,  epoch  34, local model 6, internal_epoch   1,  Average loss: 0.0011, Accuracy: 430/435 (98.8506%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.0633, Accuracy: 6995/10000 (69.9500%)
___Train Local_Simple,  epoch  34, local model 83, internal_epoch   1,  Average loss: 0.0014, Accuracy: 350/360 (97.2222%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.4423, Accuracy: 8596/10000 (85.9600%)
___Train Local_Simple,  epoch  34, local model 8, internal_epoch   1,  Average loss: 0.0015, Accuracy: 690/706 (97.7337%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 6.7634, Accuracy: 3487/10000 (34.8700%)
___Train Local_Simple,  epoch  34, local model 37, internal_epoch   1,  Average loss: 0.0020, Accuracy: 442/456 (96.9298%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 3.9709, Accuracy: 5431/10000 (54.3100%)
___Train Local_Simple,  epoch  34, local model 46, internal_epoch   1,  Average loss: 0.0009, Accuracy: 641/650 (98.6154%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.8528, Accuracy: 5680/10000 (56.8000%)
___Train Local_Simple,  epoch  34, local model 63, internal_epoch   1,  Average loss: 0.0022, Accuracy: 292/303 (96.3696%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 2.7733, Accuracy: 4342/10000 (43.4200%)
___Train Local_Simple,  epoch  34, local model 7, internal_epoch   1,  Average loss: 0.0007, Accuracy: 797/802 (99.3766%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 2.3880, Accuracy: 5099/10000 (50.9900%)
___Train Local_Simple,  epoch  34, local model 89, internal_epoch   1,  Average loss: 0.0031, Accuracy: 640/683 (93.7042%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 5.3261, Accuracy: 3871/10000 (38.7100%)
___Train Local_Simple,  epoch  34, local model 86, internal_epoch   1,  Average loss: 0.0010, Accuracy: 680/692 (98.2659%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 9.3707, Accuracy: 1985/10000 (19.8500%)
___Train Local_Simple,  epoch  34, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 695/713 (97.4755%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.2949, Accuracy: 6783/10000 (67.8300%)
___Train Local_Simple,  epoch  34, local model 99, internal_epoch   1,  Average loss: 0.0039, Accuracy: 652/712 (91.5730%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 5.1144, Accuracy: 2541/10000 (25.4100%)
___Train Local_Simple,  epoch  34, local model 80, internal_epoch   1,  Average loss: 0.0021, Accuracy: 509/532 (95.6767%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 7.4049, Accuracy: 2468/10000 (24.6800%)
___Train Local_Simple,  epoch  34, local model 94, internal_epoch   1,  Average loss: 0.0009, Accuracy: 659/671 (98.2116%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 3.7931, Accuracy: 4775/10000 (47.7500%)
___Train Local_Simple,  epoch  34, local model 48, internal_epoch   1,  Average loss: 0.0019, Accuracy: 352/363 (96.9697%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.1204, Accuracy: 7279/10000 (72.7900%)
___Train Local_Simple,  epoch  34, local model 87, internal_epoch   1,  Average loss: 0.0015, Accuracy: 644/663 (97.1342%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 6.8822, Accuracy: 3428/10000 (34.2800%)
___Train Local_Simple,  epoch  34, local model 26, internal_epoch   1,  Average loss: 0.0020, Accuracy: 498/519 (95.9538%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 4.8735, Accuracy: 3800/10000 (38.0000%)
___Train Local_Simple,  epoch  34, local model 65, internal_epoch   1,  Average loss: 0.0016, Accuracy: 604/621 (97.2625%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.0081, Accuracy: 6480/10000 (64.8000%)
___Train Local_Simple,  epoch  34, local model 97, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1097/1112 (98.6511%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 4.0772, Accuracy: 4328/10000 (43.2800%)
___Train Local_Simple,  epoch  34, local model 4, internal_epoch   1,  Average loss: 0.0006, Accuracy: 741/748 (99.0642%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.8792, Accuracy: 5398/10000 (53.9800%)
___Train Local_Simple,  epoch  34, local model 40, internal_epoch   1,  Average loss: 0.0011, Accuracy: 488/498 (97.9920%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 8.8142, Accuracy: 3572/10000 (35.7200%)
___Train Local_Simple,  epoch  34, local model 43, internal_epoch   1,  Average loss: 0.0009, Accuracy: 425/431 (98.6079%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.0305, Accuracy: 7131/10000 (71.3100%)
___Train Local_Simple,  epoch  34, local model 20, internal_epoch   1,  Average loss: 0.0011, Accuracy: 586/602 (97.3422%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.7586, Accuracy: 6225/10000 (62.2500%)
___Train Local_Simple,  epoch  34, local model 52, internal_epoch   1,  Average loss: 0.0024, Accuracy: 752/789 (95.3105%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 4.6457, Accuracy: 4288/10000 (42.8800%)
time spent on training: 382.9222538471222
___Test Target_Simple poisoned: False, epoch: 34: Average loss: 0.1770, Accuracy: 9475/10000 (94.7500%)
___Test Target_Simple poisoned: True, epoch: 34: Average loss: 3.6576, Accuracy: 448/8968 (4.9955%)
saving model
Saving model on epoch 34
Done in 416.43299674987793 sec.
Server Epoch:35 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 61, 81, 65, 47, 78, 98, 90, 16, 63, 36, 50, 85, 70, 66, 14, 21, 52, 80, 27, 12, 26, 72, 84, 9, 39, 10, 24, 89, 6, 43, 25, 59, 58, 17, 49, 4, 37, 8, 2, 97, 75, 23, 38, 53, 22, 34, 46, 86, 96, 64, 11, 30, 13, 68, 5, 28, 35, 99, 48, 40, 42, 93, 87, 15, 55, 31, 76, 94, 92, 56, 60, 91, 67, 71, 0, 20, 83, 7, 32, 57, 19, 54, 45, 82, 1, 69, 77, 79, 95, 44].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   1,  Average loss: 0.0218, Accuracy: 284/569 (49.9121%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   2,  Average loss: 0.0139, Accuracy: 263/569 (46.2214%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   3,  Average loss: 0.0117, Accuracy: 308/569 (54.1301%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   4,  Average loss: 0.0118, Accuracy: 305/569 (53.6028%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   5,  Average loss: 0.0114, Accuracy: 321/569 (56.4148%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   6,  Average loss: 0.0112, Accuracy: 308/569 (54.1301%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   7,  Average loss: 0.0107, Accuracy: 353/569 (62.0387%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   8,  Average loss: 0.0108, Accuracy: 353/569 (62.0387%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch   9,  Average loss: 0.0105, Accuracy: 353/569 (62.0387%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 41, internal_epoch  10,  Average loss: 0.0106, Accuracy: 378/569 (66.4323%), train_poison_data_count: 288
Global model norm: 15.4263153949684.
Norm before scaling: 15.479814737477986. Distance: 2.9542561943000236
Total norm for 10 adversaries is: 15.479814737477986. distance: 2.9542561943000236
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.4182, Accuracy: 8300/8968 (92.5513%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   1,  Average loss: 0.0120, Accuracy: 366/522 (70.1149%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   2,  Average loss: 0.0096, Accuracy: 358/522 (68.5824%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   3,  Average loss: 0.0076, Accuracy: 386/522 (73.9464%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   4,  Average loss: 0.0070, Accuracy: 379/522 (72.6054%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   5,  Average loss: 0.0071, Accuracy: 377/522 (72.2222%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   6,  Average loss: 0.0066, Accuracy: 412/522 (78.9272%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   7,  Average loss: 0.0060, Accuracy: 434/522 (83.1418%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   8,  Average loss: 0.0057, Accuracy: 452/522 (86.5900%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   9,  Average loss: 0.0053, Accuracy: 466/522 (89.2720%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch  10,  Average loss: 0.0051, Accuracy: 468/522 (89.6552%), train_poison_data_count: 266
Global model norm: 15.4263153949684.
Norm before scaling: 15.436293581877045. Distance: 2.0902634243843745
Total norm for 10 adversaries is: 15.436293581877045. distance: 2.0902634243843745
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0776, Accuracy: 8939/8968 (99.6766%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   1,  Average loss: 0.0222, Accuracy: 192/385 (49.8701%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   2,  Average loss: 0.0115, Accuracy: 266/385 (69.0909%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   3,  Average loss: 0.0043, Accuracy: 348/385 (90.3896%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   4,  Average loss: 0.0036, Accuracy: 352/385 (91.4286%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   5,  Average loss: 0.0037, Accuracy: 354/385 (91.9481%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   6,  Average loss: 0.0021, Accuracy: 371/385 (96.3636%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   7,  Average loss: 0.0023, Accuracy: 375/385 (97.4026%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   8,  Average loss: 0.0017, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch   9,  Average loss: 0.0014, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 51, internal_epoch  10,  Average loss: 0.0017, Accuracy: 379/385 (98.4416%), train_poison_data_count: 193
Global model norm: 15.4263153949684.
Norm before scaling: 15.601118957296832. Distance: 2.9195816913562194
Total norm for 10 adversaries is: 15.601118957296832. distance: 2.9195816913562194
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.1211, Accuracy: 8660/8968 (96.5656%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   1,  Average loss: 0.0073, Accuracy: 510/627 (81.3397%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   2,  Average loss: 0.0020, Accuracy: 598/627 (95.3748%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   3,  Average loss: 0.0010, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   4,  Average loss: 0.0014, Accuracy: 609/627 (97.1292%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   5,  Average loss: 0.0008, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   6,  Average loss: 0.0008, Accuracy: 620/627 (98.8836%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   7,  Average loss: 0.0009, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   8,  Average loss: 0.0008, Accuracy: 620/627 (98.8836%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch   9,  Average loss: 0.0006, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 74, internal_epoch  10,  Average loss: 0.0007, Accuracy: 620/627 (98.8836%), train_poison_data_count: 320
Global model norm: 15.4263153949684.
Norm before scaling: 15.58296102531243. Distance: 2.547471146349963
Total norm for 10 adversaries is: 15.58296102531243. distance: 2.547471146349963
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0123, Accuracy: 8920/8968 (99.4648%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 3, internal_epoch   1,  Average loss: 0.0226, Accuracy: 246/516 (47.6744%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 3, internal_epoch   2,  Average loss: 0.0225, Accuracy: 260/516 (50.3876%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 3, internal_epoch   3,  Average loss: 0.0175, Accuracy: 260/516 (50.3876%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 3, internal_epoch   4,  Average loss: 0.0169, Accuracy: 263/516 (50.9690%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 3, internal_epoch   5,  Average loss: 0.0149, Accuracy: 260/516 (50.3876%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 3, internal_epoch   6,  Average loss: 0.0144, Accuracy: 260/516 (50.3876%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 3, internal_epoch   7,  Average loss: 0.0129, Accuracy: 274/516 (53.1008%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 3, internal_epoch   8,  Average loss: 0.0122, Accuracy: 297/516 (57.5581%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 3, internal_epoch   9,  Average loss: 0.0118, Accuracy: 350/516 (67.8295%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 3, internal_epoch  10,  Average loss: 0.0114, Accuracy: 334/516 (64.7287%), train_poison_data_count: 260
Global model norm: 15.4263153949684.
Norm before scaling: 15.607910087510264. Distance: 4.0419800364866285
Total norm for 10 adversaries is: 15.607910087510264. distance: 4.0419800364866285
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.5018, Accuracy: 8559/8968 (95.4393%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 18, internal_epoch   1,  Average loss: 0.0205, Accuracy: 380/759 (50.0659%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 18, internal_epoch   2,  Average loss: 0.0072, Accuracy: 602/759 (79.3149%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 18, internal_epoch   3,  Average loss: 0.0010, Accuracy: 747/759 (98.4190%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 18, internal_epoch   4,  Average loss: 0.0007, Accuracy: 753/759 (99.2095%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 18, internal_epoch   5,  Average loss: 0.0006, Accuracy: 753/759 (99.2095%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 18, internal_epoch   6,  Average loss: 0.0004, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 18, internal_epoch   7,  Average loss: 0.0005, Accuracy: 754/759 (99.3412%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 18, internal_epoch   8,  Average loss: 0.0005, Accuracy: 753/759 (99.2095%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 18, internal_epoch   9,  Average loss: 0.0003, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 18, internal_epoch  10,  Average loss: 0.0002, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Global model norm: 15.4263153949684.
Norm before scaling: 15.818496712925535. Distance: 4.080855467626396
Total norm for 10 adversaries is: 15.818496712925535. distance: 4.080855467626396
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0895, Accuracy: 8611/8968 (96.0192%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 29, internal_epoch   1,  Average loss: 0.0195, Accuracy: 263/506 (51.9763%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 29, internal_epoch   2,  Average loss: 0.0078, Accuracy: 416/506 (82.2134%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 29, internal_epoch   3,  Average loss: 0.0018, Accuracy: 500/506 (98.8142%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 29, internal_epoch   4,  Average loss: 0.0012, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 29, internal_epoch   5,  Average loss: 0.0012, Accuracy: 498/506 (98.4190%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 29, internal_epoch   6,  Average loss: 0.0007, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 29, internal_epoch   7,  Average loss: 0.0006, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 29, internal_epoch   8,  Average loss: 0.0006, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 29, internal_epoch   9,  Average loss: 0.0007, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 29, internal_epoch  10,  Average loss: 0.0006, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Global model norm: 15.4263153949684.
Norm before scaling: 15.707676773448727. Distance: 3.1091866747695374
Total norm for 10 adversaries is: 15.707676773448727. distance: 3.1091866747695374
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.4216, Accuracy: 7435/8968 (82.9059%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 62, internal_epoch   1,  Average loss: 0.0080, Accuracy: 470/580 (81.0345%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 62, internal_epoch   2,  Average loss: 0.0036, Accuracy: 533/580 (91.8966%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 62, internal_epoch   3,  Average loss: 0.0019, Accuracy: 557/580 (96.0345%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 62, internal_epoch   4,  Average loss: 0.0018, Accuracy: 560/580 (96.5517%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 62, internal_epoch   5,  Average loss: 0.0015, Accuracy: 560/580 (96.5517%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 62, internal_epoch   6,  Average loss: 0.0010, Accuracy: 568/580 (97.9310%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 62, internal_epoch   7,  Average loss: 0.0012, Accuracy: 565/580 (97.4138%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 62, internal_epoch   8,  Average loss: 0.0009, Accuracy: 568/580 (97.9310%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 62, internal_epoch   9,  Average loss: 0.0010, Accuracy: 567/580 (97.7586%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 62, internal_epoch  10,  Average loss: 0.0010, Accuracy: 567/580 (97.7586%), train_poison_data_count: 292
Global model norm: 15.4263153949684.
Norm before scaling: 15.667500791596837. Distance: 2.8314583876426913
Total norm for 10 adversaries is: 15.667500791596837. distance: 2.8314583876426913
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0275, Accuracy: 8869/8968 (98.8961%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   1,  Average loss: 0.0230, Accuracy: 294/587 (50.0852%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   2,  Average loss: 0.0144, Accuracy: 308/587 (52.4702%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   3,  Average loss: 0.0146, Accuracy: 293/587 (49.9148%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   4,  Average loss: 0.0127, Accuracy: 313/587 (53.3220%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   5,  Average loss: 0.0125, Accuracy: 297/587 (50.5963%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   6,  Average loss: 0.0119, Accuracy: 328/587 (55.8773%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   7,  Average loss: 0.0119, Accuracy: 319/587 (54.3441%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   8,  Average loss: 0.0114, Accuracy: 401/587 (68.3135%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   9,  Average loss: 0.0109, Accuracy: 432/587 (73.5945%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch  10,  Average loss: 0.0109, Accuracy: 423/587 (72.0613%), train_poison_data_count: 299
Global model norm: 15.4263153949684.
Norm before scaling: 15.544408861406918. Distance: 3.291383626494762
Total norm for 10 adversaries is: 15.544408861406918. distance: 3.291383626494762
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.2680, Accuracy: 8906/8968 (99.3087%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 88, internal_epoch   1,  Average loss: 0.0150, Accuracy: 490/734 (66.7575%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 88, internal_epoch   2,  Average loss: 0.0089, Accuracy: 509/734 (69.3460%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 88, internal_epoch   3,  Average loss: 0.0054, Accuracy: 628/734 (85.5586%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 88, internal_epoch   4,  Average loss: 0.0042, Accuracy: 688/734 (93.7330%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 88, internal_epoch   5,  Average loss: 0.0032, Accuracy: 703/734 (95.7766%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 88, internal_epoch   6,  Average loss: 0.0021, Accuracy: 715/734 (97.4114%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 88, internal_epoch   7,  Average loss: 0.0016, Accuracy: 714/734 (97.2752%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 88, internal_epoch   8,  Average loss: 0.0012, Accuracy: 723/734 (98.5014%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 88, internal_epoch   9,  Average loss: 0.0011, Accuracy: 721/734 (98.2289%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 88, internal_epoch  10,  Average loss: 0.0011, Accuracy: 719/734 (97.9564%), train_poison_data_count: 382
Global model norm: 15.4263153949684.
Norm before scaling: 15.661540768804635. Distance: 3.5503735198042126
Total norm for 10 adversaries is: 15.661540768804635. distance: 3.5503735198042126
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0498, Accuracy: 8794/8968 (98.0598%)
___Train Local_Simple,  epoch  35, local model 61, internal_epoch   1,  Average loss: 0.0017, Accuracy: 278/287 (96.8641%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.7515, Accuracy: 7673/10000 (76.7300%)
___Train Local_Simple,  epoch  35, local model 81, internal_epoch   1,  Average loss: 0.0012, Accuracy: 623/636 (97.9560%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.5415, Accuracy: 5762/10000 (57.6200%)
___Train Local_Simple,  epoch  35, local model 65, internal_epoch   1,  Average loss: 0.0021, Accuracy: 602/621 (96.9404%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.9447, Accuracy: 5970/10000 (59.7000%)
___Train Local_Simple,  epoch  35, local model 47, internal_epoch   1,  Average loss: 0.0008, Accuracy: 526/534 (98.5019%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.8256, Accuracy: 4951/10000 (49.5100%)
___Train Local_Simple,  epoch  35, local model 78, internal_epoch   1,  Average loss: 0.0036, Accuracy: 565/587 (96.2521%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.6087, Accuracy: 3854/10000 (38.5400%)
___Train Local_Simple,  epoch  35, local model 98, internal_epoch   1,  Average loss: 0.0014, Accuracy: 538/548 (98.1752%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.0077, Accuracy: 5195/10000 (51.9500%)
___Train Local_Simple,  epoch  35, local model 90, internal_epoch   1,  Average loss: 0.0019, Accuracy: 597/615 (97.0732%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.2931, Accuracy: 4475/10000 (44.7500%)
___Train Local_Simple,  epoch  35, local model 16, internal_epoch   1,  Average loss: 0.0015, Accuracy: 798/817 (97.6744%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.6145, Accuracy: 4825/10000 (48.2500%)
___Train Local_Simple,  epoch  35, local model 63, internal_epoch   1,  Average loss: 0.0017, Accuracy: 291/303 (96.0396%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.1027, Accuracy: 5467/10000 (54.6700%)
___Train Local_Simple,  epoch  35, local model 36, internal_epoch   1,  Average loss: 0.0009, Accuracy: 310/315 (98.4127%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.3065, Accuracy: 8994/10000 (89.9400%)
___Train Local_Simple,  epoch  35, local model 50, internal_epoch   1,  Average loss: 0.0013, Accuracy: 464/477 (97.2746%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.6897, Accuracy: 4533/10000 (45.3300%)
___Train Local_Simple,  epoch  35, local model 85, internal_epoch   1,  Average loss: 0.0020, Accuracy: 772/807 (95.6629%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.6789, Accuracy: 5400/10000 (54.0000%)
___Train Local_Simple,  epoch  35, local model 70, internal_epoch   1,  Average loss: 0.0011, Accuracy: 555/568 (97.7113%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.7535, Accuracy: 5153/10000 (51.5300%)
___Train Local_Simple,  epoch  35, local model 66, internal_epoch   1,  Average loss: 0.0018, Accuracy: 705/733 (96.1801%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.1899, Accuracy: 4951/10000 (49.5100%)
___Train Local_Simple,  epoch  35, local model 14, internal_epoch   1,  Average loss: 0.0021, Accuracy: 663/692 (95.8092%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.2015, Accuracy: 6619/10000 (66.1900%)
___Train Local_Simple,  epoch  35, local model 21, internal_epoch   1,  Average loss: 0.0006, Accuracy: 680/687 (98.9811%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 4.9349, Accuracy: 4153/10000 (41.5300%)
___Train Local_Simple,  epoch  35, local model 52, internal_epoch   1,  Average loss: 0.0021, Accuracy: 760/789 (96.3245%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.8918, Accuracy: 5956/10000 (59.5600%)
___Train Local_Simple,  epoch  35, local model 80, internal_epoch   1,  Average loss: 0.0017, Accuracy: 513/532 (96.4286%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 5.5284, Accuracy: 3145/10000 (31.4500%)
___Train Local_Simple,  epoch  35, local model 27, internal_epoch   1,  Average loss: 0.0007, Accuracy: 736/745 (98.7919%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 4.8457, Accuracy: 3652/10000 (36.5200%)
___Train Local_Simple,  epoch  35, local model 12, internal_epoch   1,  Average loss: 0.0016, Accuracy: 712/725 (98.2069%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.8306, Accuracy: 4468/10000 (44.6800%)
___Train Local_Simple,  epoch  35, local model 26, internal_epoch   1,  Average loss: 0.0010, Accuracy: 507/519 (97.6879%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.4129, Accuracy: 5120/10000 (51.2000%)
___Train Local_Simple,  epoch  35, local model 72, internal_epoch   1,  Average loss: 0.0023, Accuracy: 408/423 (96.4539%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.8235, Accuracy: 4774/10000 (47.7400%)
___Train Local_Simple,  epoch  35, local model 84, internal_epoch   1,  Average loss: 0.0026, Accuracy: 400/420 (95.2381%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.4938, Accuracy: 5815/10000 (58.1500%)
___Train Local_Simple,  epoch  35, local model 9, internal_epoch   1,  Average loss: 0.0010, Accuracy: 502/508 (98.8189%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.7819, Accuracy: 7382/10000 (73.8200%)
___Train Local_Simple,  epoch  35, local model 39, internal_epoch   1,  Average loss: 0.0013, Accuracy: 479/493 (97.1602%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.3632, Accuracy: 4995/10000 (49.9500%)
___Train Local_Simple,  epoch  35, local model 10, internal_epoch   1,  Average loss: 0.0011, Accuracy: 559/573 (97.5567%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.7261, Accuracy: 5652/10000 (56.5200%)
___Train Local_Simple,  epoch  35, local model 24, internal_epoch   1,  Average loss: 0.0016, Accuracy: 467/477 (97.9036%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.9574, Accuracy: 4710/10000 (47.1000%)
___Train Local_Simple,  epoch  35, local model 89, internal_epoch   1,  Average loss: 0.0011, Accuracy: 668/683 (97.8038%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.8696, Accuracy: 5904/10000 (59.0400%)
___Train Local_Simple,  epoch  35, local model 6, internal_epoch   1,  Average loss: 0.0021, Accuracy: 419/435 (96.3218%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.2278, Accuracy: 6388/10000 (63.8800%)
___Train Local_Simple,  epoch  35, local model 43, internal_epoch   1,  Average loss: 0.0012, Accuracy: 424/431 (98.3759%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.8929, Accuracy: 6090/10000 (60.9000%)
___Train Local_Simple,  epoch  35, local model 25, internal_epoch   1,  Average loss: 0.0008, Accuracy: 583/592 (98.4797%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 4.3914, Accuracy: 4625/10000 (46.2500%)
___Train Local_Simple,  epoch  35, local model 59, internal_epoch   1,  Average loss: 0.0011, Accuracy: 635/644 (98.6025%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.0529, Accuracy: 4621/10000 (46.2100%)
___Train Local_Simple,  epoch  35, local model 58, internal_epoch   1,  Average loss: 0.0008, Accuracy: 760/772 (98.4456%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.7603, Accuracy: 4478/10000 (44.7800%)
___Train Local_Simple,  epoch  35, local model 17, internal_epoch   1,  Average loss: 0.0020, Accuracy: 506/527 (96.0152%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 5.6001, Accuracy: 2948/10000 (29.4800%)
___Train Local_Simple,  epoch  35, local model 49, internal_epoch   1,  Average loss: 0.0012, Accuracy: 347/355 (97.7465%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.3589, Accuracy: 6118/10000 (61.1800%)
___Train Local_Simple,  epoch  35, local model 4, internal_epoch   1,  Average loss: 0.0009, Accuracy: 736/748 (98.3957%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 5.8543, Accuracy: 3247/10000 (32.4700%)
___Train Local_Simple,  epoch  35, local model 37, internal_epoch   1,  Average loss: 0.0009, Accuracy: 449/456 (98.4649%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.7483, Accuracy: 7468/10000 (74.6800%)
___Train Local_Simple,  epoch  35, local model 8, internal_epoch   1,  Average loss: 0.0007, Accuracy: 694/706 (98.3003%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.1446, Accuracy: 4175/10000 (41.7500%)
___Train Local_Simple,  epoch  35, local model 2, internal_epoch   1,  Average loss: 0.0012, Accuracy: 551/564 (97.6950%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.9118, Accuracy: 3474/10000 (34.7400%)
___Train Local_Simple,  epoch  35, local model 97, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1104/1112 (99.2806%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 5.3107, Accuracy: 3510/10000 (35.1000%)
___Train Local_Simple,  epoch  35, local model 75, internal_epoch   1,  Average loss: 0.0016, Accuracy: 738/763 (96.7235%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.6630, Accuracy: 5257/10000 (52.5700%)
___Train Local_Simple,  epoch  35, local model 23, internal_epoch   1,  Average loss: 0.0014, Accuracy: 530/542 (97.7860%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 5.3968, Accuracy: 3386/10000 (33.8600%)
___Train Local_Simple,  epoch  35, local model 38, internal_epoch   1,  Average loss: 0.0009, Accuracy: 469/477 (98.3229%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.7839, Accuracy: 7700/10000 (77.0000%)
___Train Local_Simple,  epoch  35, local model 53, internal_epoch   1,  Average loss: 0.0011, Accuracy: 550/561 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 4.4505, Accuracy: 4481/10000 (44.8100%)
___Train Local_Simple,  epoch  35, local model 22, internal_epoch   1,  Average loss: 0.0020, Accuracy: 252/262 (96.1832%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.3682, Accuracy: 7766/10000 (77.6600%)
___Train Local_Simple,  epoch  35, local model 34, internal_epoch   1,  Average loss: 0.0015, Accuracy: 841/871 (96.5557%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 4.2095, Accuracy: 4206/10000 (42.0600%)
___Train Local_Simple,  epoch  35, local model 46, internal_epoch   1,  Average loss: 0.0011, Accuracy: 639/650 (98.3077%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 4.8336, Accuracy: 4605/10000 (46.0500%)
___Train Local_Simple,  epoch  35, local model 86, internal_epoch   1,  Average loss: 0.0006, Accuracy: 687/692 (99.2775%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.5216, Accuracy: 3736/10000 (37.3600%)
___Train Local_Simple,  epoch  35, local model 96, internal_epoch   1,  Average loss: 0.0027, Accuracy: 503/531 (94.7269%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.5427, Accuracy: 5258/10000 (52.5800%)
___Train Local_Simple,  epoch  35, local model 64, internal_epoch   1,  Average loss: 0.0012, Accuracy: 596/608 (98.0263%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.9247, Accuracy: 5645/10000 (56.4500%)
___Train Local_Simple,  epoch  35, local model 11, internal_epoch   1,  Average loss: 0.0010, Accuracy: 544/554 (98.1949%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.7321, Accuracy: 5787/10000 (57.8700%)
___Train Local_Simple,  epoch  35, local model 30, internal_epoch   1,  Average loss: 0.0016, Accuracy: 423/443 (95.4853%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.6181, Accuracy: 5957/10000 (59.5700%)
___Train Local_Simple,  epoch  35, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 696/713 (97.6157%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 4.3786, Accuracy: 3776/10000 (37.7600%)
___Train Local_Simple,  epoch  35, local model 68, internal_epoch   1,  Average loss: 0.0020, Accuracy: 531/549 (96.7213%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.5621, Accuracy: 4749/10000 (47.4900%)
___Train Local_Simple,  epoch  35, local model 5, internal_epoch   1,  Average loss: 0.0014, Accuracy: 562/578 (97.2318%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.8921, Accuracy: 7585/10000 (75.8500%)
___Train Local_Simple,  epoch  35, local model 28, internal_epoch   1,  Average loss: 0.0008, Accuracy: 600/611 (98.1997%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.8140, Accuracy: 6108/10000 (61.0800%)
___Train Local_Simple,  epoch  35, local model 35, internal_epoch   1,  Average loss: 0.0018, Accuracy: 610/630 (96.8254%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.8413, Accuracy: 5308/10000 (53.0800%)
___Train Local_Simple,  epoch  35, local model 99, internal_epoch   1,  Average loss: 0.0017, Accuracy: 685/712 (96.2079%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.4885, Accuracy: 6033/10000 (60.3300%)
___Train Local_Simple,  epoch  35, local model 48, internal_epoch   1,  Average loss: 0.0024, Accuracy: 346/363 (95.3168%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.6146, Accuracy: 8130/10000 (81.3000%)
___Train Local_Simple,  epoch  35, local model 40, internal_epoch   1,  Average loss: 0.0004, Accuracy: 496/498 (99.5984%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.0690, Accuracy: 5743/10000 (57.4300%)
___Train Local_Simple,  epoch  35, local model 42, internal_epoch   1,  Average loss: 0.0005, Accuracy: 470/473 (99.3658%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.6758, Accuracy: 7843/10000 (78.4300%)
___Train Local_Simple,  epoch  35, local model 93, internal_epoch   1,  Average loss: 0.0016, Accuracy: 612/630 (97.1429%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 4.9269, Accuracy: 3240/10000 (32.4000%)
___Train Local_Simple,  epoch  35, local model 87, internal_epoch   1,  Average loss: 0.0009, Accuracy: 653/663 (98.4917%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.4567, Accuracy: 4901/10000 (49.0100%)
___Train Local_Simple,  epoch  35, local model 15, internal_epoch   1,  Average loss: 0.0014, Accuracy: 276/282 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.1147, Accuracy: 7682/10000 (76.8200%)
___Train Local_Simple,  epoch  35, local model 55, internal_epoch   1,  Average loss: 0.0012, Accuracy: 367/375 (97.8667%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.6610, Accuracy: 5454/10000 (54.5400%)
___Train Local_Simple,  epoch  35, local model 31, internal_epoch   1,  Average loss: 0.0012, Accuracy: 578/596 (96.9799%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.6361, Accuracy: 4922/10000 (49.2200%)
___Train Local_Simple,  epoch  35, local model 76, internal_epoch   1,  Average loss: 0.0020, Accuracy: 446/459 (97.1678%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.8262, Accuracy: 6882/10000 (68.8200%)
___Train Local_Simple,  epoch  35, local model 94, internal_epoch   1,  Average loss: 0.0011, Accuracy: 656/671 (97.7645%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 4.0756, Accuracy: 5169/10000 (51.6900%)
___Train Local_Simple,  epoch  35, local model 92, internal_epoch   1,  Average loss: 0.0030, Accuracy: 576/611 (94.2717%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 6.0786, Accuracy: 2290/10000 (22.9000%)
___Train Local_Simple,  epoch  35, local model 56, internal_epoch   1,  Average loss: 0.0006, Accuracy: 707/715 (98.8811%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.8355, Accuracy: 4398/10000 (43.9800%)
___Train Local_Simple,  epoch  35, local model 60, internal_epoch   1,  Average loss: 0.0014, Accuracy: 554/571 (97.0228%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.6493, Accuracy: 4111/10000 (41.1100%)
___Train Local_Simple,  epoch  35, local model 91, internal_epoch   1,  Average loss: 0.0006, Accuracy: 813/819 (99.2674%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.7046, Accuracy: 5857/10000 (58.5700%)
___Train Local_Simple,  epoch  35, local model 67, internal_epoch   1,  Average loss: 0.0012, Accuracy: 432/441 (97.9592%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.8215, Accuracy: 5272/10000 (52.7200%)
___Train Local_Simple,  epoch  35, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 537/561 (95.7219%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.5034, Accuracy: 5214/10000 (52.1400%)
___Train Local_Simple,  epoch  35, local model 0, internal_epoch   1,  Average loss: 0.0009, Accuracy: 429/435 (98.6207%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.4602, Accuracy: 6474/10000 (64.7400%)
___Train Local_Simple,  epoch  35, local model 20, internal_epoch   1,  Average loss: 0.0023, Accuracy: 570/602 (94.6844%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 5.0640, Accuracy: 3836/10000 (38.3600%)
___Train Local_Simple,  epoch  35, local model 83, internal_epoch   1,  Average loss: 0.0014, Accuracy: 347/360 (96.3889%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.6214, Accuracy: 8062/10000 (80.6200%)
___Train Local_Simple,  epoch  35, local model 7, internal_epoch   1,  Average loss: 0.0006, Accuracy: 794/802 (99.0025%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.4610, Accuracy: 5461/10000 (54.6100%)
___Train Local_Simple,  epoch  35, local model 32, internal_epoch   1,  Average loss: 0.0007, Accuracy: 585/590 (99.1525%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.3261, Accuracy: 5250/10000 (52.5000%)
___Train Local_Simple,  epoch  35, local model 57, internal_epoch   1,  Average loss: 0.0008, Accuracy: 514/523 (98.2792%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.0257, Accuracy: 5150/10000 (51.5000%)
___Train Local_Simple,  epoch  35, local model 19, internal_epoch   1,  Average loss: 0.0012, Accuracy: 583/598 (97.4916%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.7685, Accuracy: 4435/10000 (44.3500%)
___Train Local_Simple,  epoch  35, local model 54, internal_epoch   1,  Average loss: 0.0008, Accuracy: 817/832 (98.1971%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.3224, Accuracy: 4167/10000 (41.6700%)
___Train Local_Simple,  epoch  35, local model 45, internal_epoch   1,  Average loss: 0.0011, Accuracy: 638/647 (98.6090%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.1365, Accuracy: 4477/10000 (44.7700%)
___Train Local_Simple,  epoch  35, local model 82, internal_epoch   1,  Average loss: 0.0008, Accuracy: 803/815 (98.5276%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.6676, Accuracy: 4487/10000 (44.8700%)
___Train Local_Simple,  epoch  35, local model 1, internal_epoch   1,  Average loss: 0.0006, Accuracy: 532/536 (99.2537%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.6526, Accuracy: 7389/10000 (73.8900%)
___Train Local_Simple,  epoch  35, local model 69, internal_epoch   1,  Average loss: 0.0019, Accuracy: 650/671 (96.8703%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 4.9709, Accuracy: 3765/10000 (37.6500%)
___Train Local_Simple,  epoch  35, local model 77, internal_epoch   1,  Average loss: 0.0014, Accuracy: 600/618 (97.0874%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.4013, Accuracy: 6471/10000 (64.7100%)
___Train Local_Simple,  epoch  35, local model 79, internal_epoch   1,  Average loss: 0.0012, Accuracy: 651/661 (98.4871%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.0159, Accuracy: 4716/10000 (47.1600%)
___Train Local_Simple,  epoch  35, local model 95, internal_epoch   1,  Average loss: 0.0018, Accuracy: 583/600 (97.1667%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.1556, Accuracy: 5802/10000 (58.0200%)
___Train Local_Simple,  epoch  35, local model 44, internal_epoch   1,  Average loss: 0.0007, Accuracy: 554/561 (98.7522%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.6719, Accuracy: 5405/10000 (54.0500%)
time spent on training: 389.6812176704407
___Test Target_Simple poisoned: False, epoch: 35: Average loss: 0.1671, Accuracy: 9514/10000 (95.1400%)
___Test Target_Simple poisoned: True, epoch: 35: Average loss: 4.1786, Accuracy: 363/8968 (4.0477%)
saving model
Saving model on epoch 35
Done in 426.3278019428253 sec.
Server Epoch:36 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 17, 27, 8, 5, 11, 64, 72, 91, 81, 65, 77, 16, 92, 26, 20, 97, 25, 79, 56, 57, 43, 95, 76, 90, 67, 36, 0, 52, 49, 58, 15, 32, 46, 84, 21, 78, 34, 44, 69, 7, 47, 24, 68, 42, 23, 50, 59, 66, 6, 98, 35, 86, 19, 82, 12, 94, 48, 37, 75, 2, 1, 83, 39, 4, 71, 38, 87, 85, 14, 30, 60, 96, 31, 89, 13, 93, 28, 54, 22, 9, 40, 10, 55, 61, 45, 70, 53, 99, 80, 63].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   1,  Average loss: 0.0220, Accuracy: 282/569 (49.5606%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   2,  Average loss: 0.0138, Accuracy: 321/569 (56.4148%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   3,  Average loss: 0.0121, Accuracy: 324/569 (56.9420%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   4,  Average loss: 0.0110, Accuracy: 335/569 (58.8752%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   5,  Average loss: 0.0109, Accuracy: 335/569 (58.8752%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   6,  Average loss: 0.0101, Accuracy: 360/569 (63.2689%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   7,  Average loss: 0.0092, Accuracy: 437/569 (76.8014%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   8,  Average loss: 0.0085, Accuracy: 437/569 (76.8014%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch   9,  Average loss: 0.0081, Accuracy: 447/569 (78.5589%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 41, internal_epoch  10,  Average loss: 0.0075, Accuracy: 452/569 (79.4376%), train_poison_data_count: 288
Global model norm: 15.430903828640433.
Norm before scaling: 15.50997800529096. Distance: 3.1430912487973686
Total norm for 10 adversaries is: 15.50997800529096. distance: 3.1430912487973686
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.3320, Accuracy: 8734/8968 (97.3907%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   1,  Average loss: 0.0145, Accuracy: 374/522 (71.6475%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   2,  Average loss: 0.0088, Accuracy: 376/522 (72.0307%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   3,  Average loss: 0.0047, Accuracy: 452/522 (86.5900%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   4,  Average loss: 0.0042, Accuracy: 483/522 (92.5287%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   5,  Average loss: 0.0034, Accuracy: 500/522 (95.7854%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   6,  Average loss: 0.0027, Accuracy: 504/522 (96.5517%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   7,  Average loss: 0.0022, Accuracy: 513/522 (98.2759%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   8,  Average loss: 0.0013, Accuracy: 517/522 (99.0421%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch   9,  Average loss: 0.0012, Accuracy: 518/522 (99.2337%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 73, internal_epoch  10,  Average loss: 0.0010, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Global model norm: 15.430903828640433.
Norm before scaling: 15.532618993834143. Distance: 3.0562398336978633
Total norm for 10 adversaries is: 15.532618993834143. distance: 3.0562398336978633
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0291, Accuracy: 8883/8968 (99.0522%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   1,  Average loss: 0.0223, Accuracy: 190/385 (49.3506%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   2,  Average loss: 0.0112, Accuracy: 265/385 (68.8312%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   3,  Average loss: 0.0056, Accuracy: 334/385 (86.7532%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   4,  Average loss: 0.0053, Accuracy: 345/385 (89.6104%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   5,  Average loss: 0.0039, Accuracy: 347/385 (90.1299%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   6,  Average loss: 0.0027, Accuracy: 368/385 (95.5844%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   7,  Average loss: 0.0025, Accuracy: 375/385 (97.4026%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   8,  Average loss: 0.0017, Accuracy: 381/385 (98.9610%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch   9,  Average loss: 0.0014, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 51, internal_epoch  10,  Average loss: 0.0015, Accuracy: 381/385 (98.9610%), train_poison_data_count: 193
Global model norm: 15.430903828640433.
Norm before scaling: 15.596879480720904. Distance: 2.9806423311695522
Total norm for 10 adversaries is: 15.596879480720904. distance: 2.9806423311695522
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.1047, Accuracy: 8673/8968 (96.7105%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   1,  Average loss: 0.0078, Accuracy: 500/627 (79.7448%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   2,  Average loss: 0.0026, Accuracy: 581/627 (92.6635%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   3,  Average loss: 0.0019, Accuracy: 597/627 (95.2153%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   4,  Average loss: 0.0015, Accuracy: 614/627 (97.9266%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   5,  Average loss: 0.0011, Accuracy: 616/627 (98.2456%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   6,  Average loss: 0.0008, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   7,  Average loss: 0.0005, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   8,  Average loss: 0.0005, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch   9,  Average loss: 0.0007, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 74, internal_epoch  10,  Average loss: 0.0010, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Global model norm: 15.430903828640433.
Norm before scaling: 15.645009648584333. Distance: 2.553053680507039
Total norm for 10 adversaries is: 15.645009648584333. distance: 2.553053680507039
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0077, Accuracy: 8937/8968 (99.6543%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 3, internal_epoch   1,  Average loss: 0.0247, Accuracy: 257/516 (49.8062%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 3, internal_epoch   2,  Average loss: 0.0156, Accuracy: 249/516 (48.2558%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 3, internal_epoch   3,  Average loss: 0.0163, Accuracy: 259/516 (50.1938%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 3, internal_epoch   4,  Average loss: 0.0150, Accuracy: 241/516 (46.7054%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 3, internal_epoch   5,  Average loss: 0.0129, Accuracy: 264/516 (51.1628%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 3, internal_epoch   6,  Average loss: 0.0134, Accuracy: 272/516 (52.7132%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 3, internal_epoch   7,  Average loss: 0.0133, Accuracy: 267/516 (51.7442%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 3, internal_epoch   8,  Average loss: 0.0125, Accuracy: 279/516 (54.0698%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 3, internal_epoch   9,  Average loss: 0.0123, Accuracy: 267/516 (51.7442%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 3, internal_epoch  10,  Average loss: 0.0125, Accuracy: 269/516 (52.1318%), train_poison_data_count: 260
Global model norm: 15.430903828640433.
Norm before scaling: 15.545727128635953. Distance: 3.6984101875047695
Total norm for 10 adversaries is: 15.545727128635953. distance: 3.6984101875047695
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.3700, Accuracy: 8940/8968 (99.6878%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 18, internal_epoch   1,  Average loss: 0.0183, Accuracy: 387/759 (50.9881%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 18, internal_epoch   2,  Average loss: 0.0068, Accuracy: 607/759 (79.9736%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 18, internal_epoch   3,  Average loss: 0.0010, Accuracy: 749/759 (98.6825%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 18, internal_epoch   4,  Average loss: 0.0006, Accuracy: 754/759 (99.3412%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 18, internal_epoch   5,  Average loss: 0.0005, Accuracy: 754/759 (99.3412%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 18, internal_epoch   6,  Average loss: 0.0003, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 18, internal_epoch   7,  Average loss: 0.0004, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 18, internal_epoch   8,  Average loss: 0.0003, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 18, internal_epoch   9,  Average loss: 0.0004, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 18, internal_epoch  10,  Average loss: 0.0004, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Global model norm: 15.430903828640433.
Norm before scaling: 15.773628071223719. Distance: 3.8296270420962895
Total norm for 10 adversaries is: 15.773628071223719. distance: 3.8296270420962895
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0511, Accuracy: 8784/8968 (97.9483%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 29, internal_epoch   1,  Average loss: 0.0197, Accuracy: 273/506 (53.9526%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 29, internal_epoch   2,  Average loss: 0.0089, Accuracy: 387/506 (76.4822%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 29, internal_epoch   3,  Average loss: 0.0032, Accuracy: 487/506 (96.2451%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 29, internal_epoch   4,  Average loss: 0.0019, Accuracy: 498/506 (98.4190%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 29, internal_epoch   5,  Average loss: 0.0015, Accuracy: 498/506 (98.4190%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 29, internal_epoch   6,  Average loss: 0.0012, Accuracy: 497/506 (98.2213%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 29, internal_epoch   7,  Average loss: 0.0008, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 29, internal_epoch   8,  Average loss: 0.0008, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 29, internal_epoch   9,  Average loss: 0.0008, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 29, internal_epoch  10,  Average loss: 0.0007, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Global model norm: 15.430903828640433.
Norm before scaling: 15.705946089099852. Distance: 3.5164444032068425
Total norm for 10 adversaries is: 15.705946089099852. distance: 3.5164444032068425
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.4060, Accuracy: 7516/8968 (83.8091%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 62, internal_epoch   1,  Average loss: 0.0078, Accuracy: 473/580 (81.5517%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 62, internal_epoch   2,  Average loss: 0.0052, Accuracy: 530/580 (91.3793%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 62, internal_epoch   3,  Average loss: 0.0023, Accuracy: 559/580 (96.3793%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 62, internal_epoch   4,  Average loss: 0.0017, Accuracy: 569/580 (98.1034%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 62, internal_epoch   5,  Average loss: 0.0012, Accuracy: 572/580 (98.6207%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 62, internal_epoch   6,  Average loss: 0.0013, Accuracy: 567/580 (97.7586%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 62, internal_epoch   7,  Average loss: 0.0013, Accuracy: 563/580 (97.0690%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 62, internal_epoch   8,  Average loss: 0.0010, Accuracy: 568/580 (97.9310%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 62, internal_epoch   9,  Average loss: 0.0012, Accuracy: 564/580 (97.2414%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 62, internal_epoch  10,  Average loss: 0.0011, Accuracy: 571/580 (98.4483%), train_poison_data_count: 292
Global model norm: 15.430903828640433.
Norm before scaling: 15.672025426901442. Distance: 2.789862082706104
Total norm for 10 adversaries is: 15.672025426901442. distance: 2.789862082706104
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0269, Accuracy: 8866/8968 (98.8626%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 33, internal_epoch   1,  Average loss: 0.0226, Accuracy: 288/587 (49.0630%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 33, internal_epoch   2,  Average loss: 0.0136, Accuracy: 308/587 (52.4702%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 33, internal_epoch   3,  Average loss: 0.0155, Accuracy: 292/587 (49.7445%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 33, internal_epoch   4,  Average loss: 0.0122, Accuracy: 325/587 (55.3663%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 33, internal_epoch   5,  Average loss: 0.0122, Accuracy: 302/587 (51.4480%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 33, internal_epoch   6,  Average loss: 0.0107, Accuracy: 392/587 (66.7802%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 33, internal_epoch   7,  Average loss: 0.0097, Accuracy: 431/587 (73.4242%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 33, internal_epoch   8,  Average loss: 0.0087, Accuracy: 459/587 (78.1942%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 33, internal_epoch   9,  Average loss: 0.0079, Accuracy: 506/587 (86.2010%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 33, internal_epoch  10,  Average loss: 0.0074, Accuracy: 519/587 (88.4157%), train_poison_data_count: 299
Global model norm: 15.430903828640433.
Norm before scaling: 15.573306579131394. Distance: 3.2028183208751013
Total norm for 10 adversaries is: 15.573306579131394. distance: 3.2028183208751013
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.3084, Accuracy: 8359/8968 (93.2092%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 88, internal_epoch   1,  Average loss: 0.0141, Accuracy: 467/734 (63.6240%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 88, internal_epoch   2,  Average loss: 0.0082, Accuracy: 543/734 (73.9782%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 88, internal_epoch   3,  Average loss: 0.0075, Accuracy: 558/734 (76.0218%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 88, internal_epoch   4,  Average loss: 0.0045, Accuracy: 664/734 (90.4632%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 88, internal_epoch   5,  Average loss: 0.0033, Accuracy: 696/734 (94.8229%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 88, internal_epoch   6,  Average loss: 0.0022, Accuracy: 713/734 (97.1390%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 88, internal_epoch   7,  Average loss: 0.0017, Accuracy: 715/734 (97.4114%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 88, internal_epoch   8,  Average loss: 0.0012, Accuracy: 720/734 (98.0926%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 88, internal_epoch   9,  Average loss: 0.0011, Accuracy: 726/734 (98.9101%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 88, internal_epoch  10,  Average loss: 0.0010, Accuracy: 725/734 (98.7738%), train_poison_data_count: 382
Global model norm: 15.430903828640433.
Norm before scaling: 15.602674479964465. Distance: 3.170574353770636
Total norm for 10 adversaries is: 15.602674479964465. distance: 3.170574353770636
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0600, Accuracy: 8755/8968 (97.6249%)
___Train Local_Simple,  epoch  36, local model 17, internal_epoch   1,  Average loss: 0.0007, Accuracy: 521/527 (98.8615%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.0370, Accuracy: 6619/10000 (66.1900%)
___Train Local_Simple,  epoch  36, local model 27, internal_epoch   1,  Average loss: 0.0008, Accuracy: 732/745 (98.2550%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.0567, Accuracy: 4421/10000 (44.2100%)
___Train Local_Simple,  epoch  36, local model 8, internal_epoch   1,  Average loss: 0.0012, Accuracy: 692/706 (98.0170%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 6.0429, Accuracy: 3365/10000 (33.6500%)
___Train Local_Simple,  epoch  36, local model 5, internal_epoch   1,  Average loss: 0.0013, Accuracy: 560/578 (96.8858%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.9306, Accuracy: 6383/10000 (63.8300%)
___Train Local_Simple,  epoch  36, local model 11, internal_epoch   1,  Average loss: 0.0007, Accuracy: 546/554 (98.5560%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.9464, Accuracy: 7590/10000 (75.9000%)
___Train Local_Simple,  epoch  36, local model 64, internal_epoch   1,  Average loss: 0.0006, Accuracy: 601/608 (98.8487%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.2636, Accuracy: 4457/10000 (44.5700%)
___Train Local_Simple,  epoch  36, local model 72, internal_epoch   1,  Average loss: 0.0018, Accuracy: 408/423 (96.4539%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 2.8252, Accuracy: 3157/10000 (31.5700%)
___Train Local_Simple,  epoch  36, local model 91, internal_epoch   1,  Average loss: 0.0009, Accuracy: 805/819 (98.2906%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 4.7952, Accuracy: 3571/10000 (35.7100%)
___Train Local_Simple,  epoch  36, local model 81, internal_epoch   1,  Average loss: 0.0013, Accuracy: 620/636 (97.4843%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.2106, Accuracy: 3581/10000 (35.8100%)
___Train Local_Simple,  epoch  36, local model 65, internal_epoch   1,  Average loss: 0.0018, Accuracy: 602/621 (96.9404%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.4244, Accuracy: 5307/10000 (53.0700%)
___Train Local_Simple,  epoch  36, local model 77, internal_epoch   1,  Average loss: 0.0018, Accuracy: 594/618 (96.1165%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 5.2632, Accuracy: 3448/10000 (34.4800%)
___Train Local_Simple,  epoch  36, local model 16, internal_epoch   1,  Average loss: 0.0004, Accuracy: 813/817 (99.5104%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.6435, Accuracy: 6366/10000 (63.6600%)
___Train Local_Simple,  epoch  36, local model 92, internal_epoch   1,  Average loss: 0.0029, Accuracy: 574/611 (93.9444%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 4.0193, Accuracy: 3125/10000 (31.2500%)
___Train Local_Simple,  epoch  36, local model 26, internal_epoch   1,  Average loss: 0.0021, Accuracy: 504/519 (97.1098%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.1199, Accuracy: 4940/10000 (49.4000%)
___Train Local_Simple,  epoch  36, local model 20, internal_epoch   1,  Average loss: 0.0010, Accuracy: 592/602 (98.3389%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.7308, Accuracy: 6249/10000 (62.4900%)
___Train Local_Simple,  epoch  36, local model 97, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1100/1112 (98.9209%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 4.8352, Accuracy: 3145/10000 (31.4500%)
___Train Local_Simple,  epoch  36, local model 25, internal_epoch   1,  Average loss: 0.0003, Accuracy: 588/592 (99.3243%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.9857, Accuracy: 7525/10000 (75.2500%)
___Train Local_Simple,  epoch  36, local model 79, internal_epoch   1,  Average loss: 0.0013, Accuracy: 651/661 (98.4871%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.7641, Accuracy: 5496/10000 (54.9600%)
___Train Local_Simple,  epoch  36, local model 56, internal_epoch   1,  Average loss: 0.0008, Accuracy: 704/715 (98.4615%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.5084, Accuracy: 4453/10000 (44.5300%)
___Train Local_Simple,  epoch  36, local model 57, internal_epoch   1,  Average loss: 0.0012, Accuracy: 511/523 (97.7055%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.2592, Accuracy: 3718/10000 (37.1800%)
___Train Local_Simple,  epoch  36, local model 43, internal_epoch   1,  Average loss: 0.0010, Accuracy: 425/431 (98.6079%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.2737, Accuracy: 6663/10000 (66.6300%)
___Train Local_Simple,  epoch  36, local model 95, internal_epoch   1,  Average loss: 0.0031, Accuracy: 567/600 (94.5000%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 4.4905, Accuracy: 4626/10000 (46.2600%)
___Train Local_Simple,  epoch  36, local model 76, internal_epoch   1,  Average loss: 0.0014, Accuracy: 451/459 (98.2571%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.5163, Accuracy: 8361/10000 (83.6100%)
___Train Local_Simple,  epoch  36, local model 90, internal_epoch   1,  Average loss: 0.0021, Accuracy: 588/615 (95.6098%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.1458, Accuracy: 6842/10000 (68.4200%)
___Train Local_Simple,  epoch  36, local model 67, internal_epoch   1,  Average loss: 0.0017, Accuracy: 425/441 (96.3719%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 2.2835, Accuracy: 4242/10000 (42.4200%)
___Train Local_Simple,  epoch  36, local model 36, internal_epoch   1,  Average loss: 0.0009, Accuracy: 310/315 (98.4127%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.3994, Accuracy: 8711/10000 (87.1100%)
___Train Local_Simple,  epoch  36, local model 0, internal_epoch   1,  Average loss: 0.0014, Accuracy: 421/435 (96.7816%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 2.9515, Accuracy: 5599/10000 (55.9900%)
___Train Local_Simple,  epoch  36, local model 52, internal_epoch   1,  Average loss: 0.0017, Accuracy: 762/789 (96.5779%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 5.0092, Accuracy: 3694/10000 (36.9400%)
___Train Local_Simple,  epoch  36, local model 49, internal_epoch   1,  Average loss: 0.0021, Accuracy: 341/355 (96.0563%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.7156, Accuracy: 5626/10000 (56.2600%)
___Train Local_Simple,  epoch  36, local model 58, internal_epoch   1,  Average loss: 0.0010, Accuracy: 757/772 (98.0570%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.5546, Accuracy: 4299/10000 (42.9900%)
___Train Local_Simple,  epoch  36, local model 15, internal_epoch   1,  Average loss: 0.0009, Accuracy: 279/282 (98.9362%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.4452, Accuracy: 8445/10000 (84.4500%)
___Train Local_Simple,  epoch  36, local model 32, internal_epoch   1,  Average loss: 0.0012, Accuracy: 576/590 (97.6271%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.0011, Accuracy: 5327/10000 (53.2700%)
___Train Local_Simple,  epoch  36, local model 46, internal_epoch   1,  Average loss: 0.0008, Accuracy: 641/650 (98.6154%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.4174, Accuracy: 6262/10000 (62.6200%)
___Train Local_Simple,  epoch  36, local model 84, internal_epoch   1,  Average loss: 0.0009, Accuracy: 412/420 (98.0952%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.7142, Accuracy: 8095/10000 (80.9500%)
___Train Local_Simple,  epoch  36, local model 21, internal_epoch   1,  Average loss: 0.0006, Accuracy: 681/687 (99.1266%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 2.0107, Accuracy: 5230/10000 (52.3000%)
___Train Local_Simple,  epoch  36, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 565/587 (96.2521%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 7.7462, Accuracy: 2583/10000 (25.8300%)
___Train Local_Simple,  epoch  36, local model 34, internal_epoch   1,  Average loss: 0.0014, Accuracy: 848/871 (97.3594%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 4.5081, Accuracy: 3476/10000 (34.7600%)
___Train Local_Simple,  epoch  36, local model 44, internal_epoch   1,  Average loss: 0.0004, Accuracy: 557/561 (99.2870%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.8886, Accuracy: 7355/10000 (73.5500%)
___Train Local_Simple,  epoch  36, local model 69, internal_epoch   1,  Average loss: 0.0021, Accuracy: 648/671 (96.5723%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 4.2801, Accuracy: 3434/10000 (34.3400%)
___Train Local_Simple,  epoch  36, local model 7, internal_epoch   1,  Average loss: 0.0007, Accuracy: 797/802 (99.3766%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.3934, Accuracy: 6238/10000 (62.3800%)
___Train Local_Simple,  epoch  36, local model 47, internal_epoch   1,  Average loss: 0.0015, Accuracy: 523/534 (97.9401%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.0496, Accuracy: 5327/10000 (53.2700%)
___Train Local_Simple,  epoch  36, local model 24, internal_epoch   1,  Average loss: 0.0017, Accuracy: 465/477 (97.4843%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.9777, Accuracy: 6795/10000 (67.9500%)
___Train Local_Simple,  epoch  36, local model 68, internal_epoch   1,  Average loss: 0.0019, Accuracy: 530/549 (96.5392%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.1965, Accuracy: 3765/10000 (37.6500%)
___Train Local_Simple,  epoch  36, local model 42, internal_epoch   1,  Average loss: 0.0006, Accuracy: 469/473 (99.1543%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.1023, Accuracy: 7179/10000 (71.7900%)
___Train Local_Simple,  epoch  36, local model 23, internal_epoch   1,  Average loss: 0.0013, Accuracy: 532/542 (98.1550%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.6163, Accuracy: 5261/10000 (52.6100%)
___Train Local_Simple,  epoch  36, local model 50, internal_epoch   1,  Average loss: 0.0011, Accuracy: 467/477 (97.9036%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 2.1058, Accuracy: 5406/10000 (54.0600%)
___Train Local_Simple,  epoch  36, local model 59, internal_epoch   1,  Average loss: 0.0017, Accuracy: 622/644 (96.5839%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.6317, Accuracy: 5770/10000 (57.7000%)
___Train Local_Simple,  epoch  36, local model 66, internal_epoch   1,  Average loss: 0.0038, Accuracy: 683/733 (93.1787%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 5.3477, Accuracy: 2217/10000 (22.1700%)
___Train Local_Simple,  epoch  36, local model 6, internal_epoch   1,  Average loss: 0.0009, Accuracy: 429/435 (98.6207%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.6386, Accuracy: 7881/10000 (78.8100%)
___Train Local_Simple,  epoch  36, local model 98, internal_epoch   1,  Average loss: 0.0017, Accuracy: 532/548 (97.0803%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 5.1228, Accuracy: 3420/10000 (34.2000%)
___Train Local_Simple,  epoch  36, local model 35, internal_epoch   1,  Average loss: 0.0013, Accuracy: 613/630 (97.3016%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.9815, Accuracy: 3890/10000 (38.9000%)
___Train Local_Simple,  epoch  36, local model 86, internal_epoch   1,  Average loss: 0.0010, Accuracy: 681/692 (98.4104%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 5.3023, Accuracy: 3503/10000 (35.0300%)
___Train Local_Simple,  epoch  36, local model 19, internal_epoch   1,  Average loss: 0.0022, Accuracy: 583/598 (97.4916%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.2894, Accuracy: 6627/10000 (66.2700%)
___Train Local_Simple,  epoch  36, local model 82, internal_epoch   1,  Average loss: 0.0010, Accuracy: 800/815 (98.1595%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 7.6512, Accuracy: 3030/10000 (30.3000%)
___Train Local_Simple,  epoch  36, local model 12, internal_epoch   1,  Average loss: 0.0007, Accuracy: 713/725 (98.3448%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.1177, Accuracy: 7030/10000 (70.3000%)
___Train Local_Simple,  epoch  36, local model 94, internal_epoch   1,  Average loss: 0.0007, Accuracy: 663/671 (98.8077%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 2.6296, Accuracy: 5741/10000 (57.4100%)
___Train Local_Simple,  epoch  36, local model 48, internal_epoch   1,  Average loss: 0.0012, Accuracy: 358/363 (98.6226%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.6824, Accuracy: 8062/10000 (80.6200%)
___Train Local_Simple,  epoch  36, local model 37, internal_epoch   1,  Average loss: 0.0012, Accuracy: 444/456 (97.3684%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 2.8862, Accuracy: 6062/10000 (60.6200%)
___Train Local_Simple,  epoch  36, local model 75, internal_epoch   1,  Average loss: 0.0017, Accuracy: 735/763 (96.3303%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.0791, Accuracy: 3926/10000 (39.2600%)
___Train Local_Simple,  epoch  36, local model 2, internal_epoch   1,  Average loss: 0.0012, Accuracy: 548/564 (97.1631%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.4129, Accuracy: 3977/10000 (39.7700%)
___Train Local_Simple,  epoch  36, local model 1, internal_epoch   1,  Average loss: 0.0005, Accuracy: 532/536 (99.2537%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2909, Accuracy: 9021/10000 (90.2100%)
___Train Local_Simple,  epoch  36, local model 83, internal_epoch   1,  Average loss: 0.0015, Accuracy: 352/360 (97.7778%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.3425, Accuracy: 8976/10000 (89.7600%)
___Train Local_Simple,  epoch  36, local model 39, internal_epoch   1,  Average loss: 0.0008, Accuracy: 483/493 (97.9716%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.3095, Accuracy: 6580/10000 (65.8000%)
___Train Local_Simple,  epoch  36, local model 4, internal_epoch   1,  Average loss: 0.0006, Accuracy: 738/748 (98.6631%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 2.6354, Accuracy: 4388/10000 (43.8800%)
___Train Local_Simple,  epoch  36, local model 71, internal_epoch   1,  Average loss: 0.0011, Accuracy: 547/561 (97.5045%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.8298, Accuracy: 7186/10000 (71.8600%)
___Train Local_Simple,  epoch  36, local model 38, internal_epoch   1,  Average loss: 0.0009, Accuracy: 469/477 (98.3229%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.4767, Accuracy: 8495/10000 (84.9500%)
___Train Local_Simple,  epoch  36, local model 87, internal_epoch   1,  Average loss: 0.0012, Accuracy: 647/663 (97.5867%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 7.9782, Accuracy: 2824/10000 (28.2400%)
___Train Local_Simple,  epoch  36, local model 85, internal_epoch   1,  Average loss: 0.0013, Accuracy: 789/807 (97.7695%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 5.0050, Accuracy: 4107/10000 (41.0700%)
___Train Local_Simple,  epoch  36, local model 14, internal_epoch   1,  Average loss: 0.0017, Accuracy: 673/692 (97.2543%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.7159, Accuracy: 5780/10000 (57.8000%)
___Train Local_Simple,  epoch  36, local model 30, internal_epoch   1,  Average loss: 0.0010, Accuracy: 437/443 (98.6456%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.6901, Accuracy: 7863/10000 (78.6300%)
___Train Local_Simple,  epoch  36, local model 60, internal_epoch   1,  Average loss: 0.0020, Accuracy: 550/571 (96.3222%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 4.8460, Accuracy: 3181/10000 (31.8100%)
___Train Local_Simple,  epoch  36, local model 96, internal_epoch   1,  Average loss: 0.0013, Accuracy: 521/531 (98.1168%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.3649, Accuracy: 3902/10000 (39.0200%)
___Train Local_Simple,  epoch  36, local model 31, internal_epoch   1,  Average loss: 0.0008, Accuracy: 587/596 (98.4899%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.9906, Accuracy: 6970/10000 (69.7000%)
___Train Local_Simple,  epoch  36, local model 89, internal_epoch   1,  Average loss: 0.0024, Accuracy: 652/683 (95.4612%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 5.3467, Accuracy: 3760/10000 (37.6000%)
___Train Local_Simple,  epoch  36, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 700/713 (98.1767%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.2925, Accuracy: 6354/10000 (63.5400%)
___Train Local_Simple,  epoch  36, local model 93, internal_epoch   1,  Average loss: 0.0027, Accuracy: 602/630 (95.5556%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.8140, Accuracy: 3283/10000 (32.8300%)
___Train Local_Simple,  epoch  36, local model 28, internal_epoch   1,  Average loss: 0.0011, Accuracy: 598/611 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 4.1843, Accuracy: 5159/10000 (51.5900%)
___Train Local_Simple,  epoch  36, local model 54, internal_epoch   1,  Average loss: 0.0012, Accuracy: 815/832 (97.9567%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 5.1654, Accuracy: 4018/10000 (40.1800%)
___Train Local_Simple,  epoch  36, local model 22, internal_epoch   1,  Average loss: 0.0005, Accuracy: 261/262 (99.6183%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.3312, Accuracy: 8890/10000 (88.9000%)
___Train Local_Simple,  epoch  36, local model 9, internal_epoch   1,  Average loss: 0.0017, Accuracy: 496/508 (97.6378%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 2.4086, Accuracy: 5540/10000 (55.4000%)
___Train Local_Simple,  epoch  36, local model 40, internal_epoch   1,  Average loss: 0.0008, Accuracy: 491/498 (98.5944%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 6.1197, Accuracy: 4118/10000 (41.1800%)
___Train Local_Simple,  epoch  36, local model 10, internal_epoch   1,  Average loss: 0.0019, Accuracy: 552/573 (96.3351%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 2.7755, Accuracy: 4992/10000 (49.9200%)
___Train Local_Simple,  epoch  36, local model 55, internal_epoch   1,  Average loss: 0.0017, Accuracy: 361/375 (96.2667%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.1396, Accuracy: 6731/10000 (67.3100%)
___Train Local_Simple,  epoch  36, local model 61, internal_epoch   1,  Average loss: 0.0016, Accuracy: 277/287 (96.5157%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.4251, Accuracy: 8669/10000 (86.6900%)
___Train Local_Simple,  epoch  36, local model 45, internal_epoch   1,  Average loss: 0.0009, Accuracy: 632/647 (97.6816%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 6.3361, Accuracy: 3262/10000 (32.6200%)
___Train Local_Simple,  epoch  36, local model 70, internal_epoch   1,  Average loss: 0.0020, Accuracy: 548/568 (96.4789%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 4.1965, Accuracy: 3239/10000 (32.3900%)
___Train Local_Simple,  epoch  36, local model 53, internal_epoch   1,  Average loss: 0.0008, Accuracy: 554/561 (98.7522%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.2996, Accuracy: 6484/10000 (64.8400%)
___Train Local_Simple,  epoch  36, local model 99, internal_epoch   1,  Average loss: 0.0028, Accuracy: 669/712 (93.9607%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.5712, Accuracy: 4131/10000 (41.3100%)
___Train Local_Simple,  epoch  36, local model 80, internal_epoch   1,  Average loss: 0.0063, Accuracy: 498/532 (93.6090%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 6.1847, Accuracy: 2122/10000 (21.2200%)
___Train Local_Simple,  epoch  36, local model 63, internal_epoch   1,  Average loss: 0.0020, Accuracy: 290/303 (95.7096%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 2.3395, Accuracy: 4867/10000 (48.6700%)
time spent on training: 385.0906207561493
___Test Target_Simple poisoned: False, epoch: 36: Average loss: 0.1530, Accuracy: 9555/10000 (95.5500%)
___Test Target_Simple poisoned: True, epoch: 36: Average loss: 3.4596, Accuracy: 578/8968 (6.4451%)
saving model
Saving model on epoch 36
Done in 419.6657829284668 sec.
Server Epoch:37 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 96, 15, 59, 44, 53, 95, 27, 48, 47, 93, 13, 80, 84, 7, 56, 50, 69, 75, 83, 92, 77, 10, 97, 37, 57, 19, 61, 43, 22, 1, 24, 91, 11, 35, 36, 64, 23, 16, 63, 49, 14, 32, 20, 12, 72, 85, 78, 2, 54, 55, 9, 30, 87, 67, 28, 52, 4, 26, 5, 66, 90, 99, 31, 38, 0, 94, 82, 98, 70, 76, 68, 42, 45, 71, 8, 40, 89, 86, 17, 81, 39, 6, 65, 46, 60, 58, 21, 79, 25, 34].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   1,  Average loss: 0.0208, Accuracy: 274/569 (48.1547%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   2,  Average loss: 0.0130, Accuracy: 280/569 (49.2091%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   3,  Average loss: 0.0112, Accuracy: 341/569 (59.9297%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   4,  Average loss: 0.0103, Accuracy: 381/569 (66.9596%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   5,  Average loss: 0.0097, Accuracy: 427/569 (75.0439%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   6,  Average loss: 0.0088, Accuracy: 459/569 (80.6678%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   7,  Average loss: 0.0084, Accuracy: 452/569 (79.4376%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   8,  Average loss: 0.0073, Accuracy: 477/569 (83.8313%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   9,  Average loss: 0.0067, Accuracy: 473/569 (83.1283%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch  10,  Average loss: 0.0063, Accuracy: 488/569 (85.7645%), train_poison_data_count: 288
Global model norm: 15.42716553756514.
Norm before scaling: 15.541739101428611. Distance: 3.0154415727083768
Total norm for 10 adversaries is: 15.541739101428611. distance: 3.0154415727083768
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.3365, Accuracy: 8368/8968 (93.3095%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   1,  Average loss: 0.0127, Accuracy: 378/522 (72.4138%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   2,  Average loss: 0.0068, Accuracy: 406/522 (77.7778%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   3,  Average loss: 0.0070, Accuracy: 418/522 (80.0766%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   4,  Average loss: 0.0036, Accuracy: 482/522 (92.3372%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   5,  Average loss: 0.0026, Accuracy: 505/522 (96.7433%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   6,  Average loss: 0.0019, Accuracy: 509/522 (97.5096%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   7,  Average loss: 0.0015, Accuracy: 516/522 (98.8506%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   8,  Average loss: 0.0011, Accuracy: 517/522 (99.0421%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch   9,  Average loss: 0.0009, Accuracy: 517/522 (99.0421%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 73, internal_epoch  10,  Average loss: 0.0008, Accuracy: 518/522 (99.2337%), train_poison_data_count: 266
Global model norm: 15.42716553756514.
Norm before scaling: 15.51068239345216. Distance: 2.633765888501127
Total norm for 10 adversaries is: 15.51068239345216. distance: 2.633765888501127
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0201, Accuracy: 8911/8968 (99.3644%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   1,  Average loss: 0.0209, Accuracy: 203/385 (52.7273%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   2,  Average loss: 0.0096, Accuracy: 278/385 (72.2078%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   3,  Average loss: 0.0030, Accuracy: 373/385 (96.8831%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   4,  Average loss: 0.0019, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   5,  Average loss: 0.0022, Accuracy: 381/385 (98.9610%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   6,  Average loss: 0.0014, Accuracy: 383/385 (99.4805%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   7,  Average loss: 0.0009, Accuracy: 384/385 (99.7403%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   8,  Average loss: 0.0011, Accuracy: 381/385 (98.9610%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch   9,  Average loss: 0.0008, Accuracy: 383/385 (99.4805%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 51, internal_epoch  10,  Average loss: 0.0006, Accuracy: 384/385 (99.7403%), train_poison_data_count: 193
Global model norm: 15.42716553756514.
Norm before scaling: 15.620804124128021. Distance: 2.986607540374149
Total norm for 10 adversaries is: 15.620804124128021. distance: 2.986607540374149
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.1141, Accuracy: 8608/8968 (95.9857%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   1,  Average loss: 0.0061, Accuracy: 538/627 (85.8054%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   2,  Average loss: 0.0013, Accuracy: 614/627 (97.9266%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   3,  Average loss: 0.0015, Accuracy: 611/627 (97.4482%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   4,  Average loss: 0.0013, Accuracy: 610/627 (97.2887%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   5,  Average loss: 0.0007, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   6,  Average loss: 0.0005, Accuracy: 624/627 (99.5215%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   7,  Average loss: 0.0008, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   8,  Average loss: 0.0004, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch   9,  Average loss: 0.0004, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 74, internal_epoch  10,  Average loss: 0.0004, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Global model norm: 15.42716553756514.
Norm before scaling: 15.561448885185788. Distance: 2.1799722027537536
Total norm for 10 adversaries is: 15.561448885185788. distance: 2.1799722027537536
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0056, Accuracy: 8945/8968 (99.7435%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 3, internal_epoch   1,  Average loss: 0.0223, Accuracy: 253/516 (49.0310%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 3, internal_epoch   2,  Average loss: 0.0176, Accuracy: 267/516 (51.7442%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 3, internal_epoch   3,  Average loss: 0.0133, Accuracy: 257/516 (49.8062%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 3, internal_epoch   4,  Average loss: 0.0132, Accuracy: 263/516 (50.9690%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 3, internal_epoch   5,  Average loss: 0.0126, Accuracy: 291/516 (56.3953%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 3, internal_epoch   6,  Average loss: 0.0127, Accuracy: 286/516 (55.4264%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 3, internal_epoch   7,  Average loss: 0.0119, Accuracy: 280/516 (54.2636%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 3, internal_epoch   8,  Average loss: 0.0118, Accuracy: 287/516 (55.6202%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 3, internal_epoch   9,  Average loss: 0.0117, Accuracy: 278/516 (53.8760%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 3, internal_epoch  10,  Average loss: 0.0119, Accuracy: 283/516 (54.8450%), train_poison_data_count: 260
Global model norm: 15.42716553756514.
Norm before scaling: 15.576269224813341. Distance: 3.651988096821534
Total norm for 10 adversaries is: 15.576269224813341. distance: 3.651988096821534
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.4595, Accuracy: 8117/8968 (90.5107%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   1,  Average loss: 0.0181, Accuracy: 398/759 (52.4374%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   2,  Average loss: 0.0053, Accuracy: 650/759 (85.6390%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   3,  Average loss: 0.0005, Accuracy: 754/759 (99.3412%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   4,  Average loss: 0.0004, Accuracy: 754/759 (99.3412%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   5,  Average loss: 0.0003, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   6,  Average loss: 0.0004, Accuracy: 753/759 (99.2095%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   7,  Average loss: 0.0002, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   8,  Average loss: 0.0002, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   9,  Average loss: 0.0003, Accuracy: 754/759 (99.3412%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch  10,  Average loss: 0.0003, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Global model norm: 15.42716553756514.
Norm before scaling: 15.810109557146793. Distance: 3.952717756320683
Total norm for 10 adversaries is: 15.810109557146793. distance: 3.952717756320683
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0589, Accuracy: 8752/8968 (97.5914%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 29, internal_epoch   1,  Average loss: 0.0181, Accuracy: 282/506 (55.7312%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 29, internal_epoch   2,  Average loss: 0.0069, Accuracy: 430/506 (84.9802%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 29, internal_epoch   3,  Average loss: 0.0018, Accuracy: 498/506 (98.4190%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 29, internal_epoch   4,  Average loss: 0.0015, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 29, internal_epoch   5,  Average loss: 0.0011, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 29, internal_epoch   6,  Average loss: 0.0009, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 29, internal_epoch   7,  Average loss: 0.0007, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 29, internal_epoch   8,  Average loss: 0.0008, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 29, internal_epoch   9,  Average loss: 0.0005, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 29, internal_epoch  10,  Average loss: 0.0006, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Global model norm: 15.42716553756514.
Norm before scaling: 15.710370782450372. Distance: 3.0980329056057987
Total norm for 10 adversaries is: 15.710370782450372. distance: 3.0980329056057987
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.3923, Accuracy: 7580/8968 (84.5227%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   1,  Average loss: 0.0071, Accuracy: 479/580 (82.5862%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   2,  Average loss: 0.0023, Accuracy: 557/580 (96.0345%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   3,  Average loss: 0.0013, Accuracy: 564/580 (97.2414%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   4,  Average loss: 0.0009, Accuracy: 574/580 (98.9655%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   5,  Average loss: 0.0011, Accuracy: 568/580 (97.9310%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   6,  Average loss: 0.0012, Accuracy: 571/580 (98.4483%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   7,  Average loss: 0.0010, Accuracy: 569/580 (98.1034%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   8,  Average loss: 0.0008, Accuracy: 568/580 (97.9310%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   9,  Average loss: 0.0009, Accuracy: 572/580 (98.6207%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch  10,  Average loss: 0.0007, Accuracy: 572/580 (98.6207%), train_poison_data_count: 292
Global model norm: 15.42716553756514.
Norm before scaling: 15.633266368036603. Distance: 2.4999043446360747
Total norm for 10 adversaries is: 15.633266368036603. distance: 2.4999043446360747
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0127, Accuracy: 8918/8968 (99.4425%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   1,  Average loss: 0.0220, Accuracy: 296/587 (50.4259%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   2,  Average loss: 0.0140, Accuracy: 314/587 (53.4923%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   3,  Average loss: 0.0107, Accuracy: 407/587 (69.3356%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   4,  Average loss: 0.0079, Accuracy: 492/587 (83.8160%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   5,  Average loss: 0.0057, Accuracy: 530/587 (90.2896%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   6,  Average loss: 0.0038, Accuracy: 569/587 (96.9336%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   7,  Average loss: 0.0026, Accuracy: 579/587 (98.6371%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   8,  Average loss: 0.0018, Accuracy: 579/587 (98.6371%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   9,  Average loss: 0.0014, Accuracy: 577/587 (98.2964%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch  10,  Average loss: 0.0014, Accuracy: 578/587 (98.4668%), train_poison_data_count: 299
Global model norm: 15.42716553756514.
Norm before scaling: 15.705299522946666. Distance: 3.6818194844236114
Total norm for 10 adversaries is: 15.705299522946666. distance: 3.6818194844236114
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.5591, Accuracy: 6802/8968 (75.8475%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 88, internal_epoch   1,  Average loss: 0.0148, Accuracy: 467/734 (63.6240%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 88, internal_epoch   2,  Average loss: 0.0067, Accuracy: 578/734 (78.7466%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 88, internal_epoch   3,  Average loss: 0.0029, Accuracy: 685/734 (93.3243%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 88, internal_epoch   4,  Average loss: 0.0019, Accuracy: 709/734 (96.5940%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 88, internal_epoch   5,  Average loss: 0.0014, Accuracy: 715/734 (97.4114%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 88, internal_epoch   6,  Average loss: 0.0011, Accuracy: 721/734 (98.2289%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 88, internal_epoch   7,  Average loss: 0.0009, Accuracy: 722/734 (98.3651%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 88, internal_epoch   8,  Average loss: 0.0008, Accuracy: 726/734 (98.9101%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 88, internal_epoch   9,  Average loss: 0.0008, Accuracy: 724/734 (98.6376%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 88, internal_epoch  10,  Average loss: 0.0008, Accuracy: 722/734 (98.3651%), train_poison_data_count: 382
Global model norm: 15.42716553756514.
Norm before scaling: 15.695682413043812. Distance: 3.3989174690249064
Total norm for 10 adversaries is: 15.695682413043812. distance: 3.3989174690249064
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0497, Accuracy: 8790/8968 (98.0152%)
___Train Local_Simple,  epoch  37, local model 96, internal_epoch   1,  Average loss: 0.0014, Accuracy: 513/531 (96.6102%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 4.6616, Accuracy: 4177/10000 (41.7700%)
___Train Local_Simple,  epoch  37, local model 15, internal_epoch   1,  Average loss: 0.0013, Accuracy: 279/282 (98.9362%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.7240, Accuracy: 7905/10000 (79.0500%)
___Train Local_Simple,  epoch  37, local model 59, internal_epoch   1,  Average loss: 0.0024, Accuracy: 629/644 (97.6708%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 5.3430, Accuracy: 3280/10000 (32.8000%)
___Train Local_Simple,  epoch  37, local model 44, internal_epoch   1,  Average loss: 0.0007, Accuracy: 552/561 (98.3957%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 3.5450, Accuracy: 5730/10000 (57.3000%)
___Train Local_Simple,  epoch  37, local model 53, internal_epoch   1,  Average loss: 0.0013, Accuracy: 546/561 (97.3262%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 3.3417, Accuracy: 5482/10000 (54.8200%)
___Train Local_Simple,  epoch  37, local model 95, internal_epoch   1,  Average loss: 0.0017, Accuracy: 575/600 (95.8333%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.7421, Accuracy: 6272/10000 (62.7200%)
___Train Local_Simple,  epoch  37, local model 27, internal_epoch   1,  Average loss: 0.0007, Accuracy: 734/745 (98.5235%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 4.8270, Accuracy: 3473/10000 (34.7300%)
___Train Local_Simple,  epoch  37, local model 48, internal_epoch   1,  Average loss: 0.0014, Accuracy: 354/363 (97.5207%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.5437, Accuracy: 8394/10000 (83.9400%)
___Train Local_Simple,  epoch  37, local model 47, internal_epoch   1,  Average loss: 0.0009, Accuracy: 525/534 (98.3146%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.2442, Accuracy: 5460/10000 (54.6000%)
___Train Local_Simple,  epoch  37, local model 93, internal_epoch   1,  Average loss: 0.0018, Accuracy: 604/630 (95.8730%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.9028, Accuracy: 4246/10000 (42.4600%)
___Train Local_Simple,  epoch  37, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 687/713 (96.3534%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 5.1138, Accuracy: 3517/10000 (35.1700%)
___Train Local_Simple,  epoch  37, local model 80, internal_epoch   1,  Average loss: 0.0018, Accuracy: 517/532 (97.1805%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 6.2797, Accuracy: 2908/10000 (29.0800%)
___Train Local_Simple,  epoch  37, local model 84, internal_epoch   1,  Average loss: 0.0014, Accuracy: 408/420 (97.1429%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.0799, Accuracy: 7760/10000 (77.6000%)
___Train Local_Simple,  epoch  37, local model 7, internal_epoch   1,  Average loss: 0.0007, Accuracy: 794/802 (99.0025%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.6304, Accuracy: 5032/10000 (50.3200%)
___Train Local_Simple,  epoch  37, local model 56, internal_epoch   1,  Average loss: 0.0006, Accuracy: 706/715 (98.7413%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.1925, Accuracy: 5178/10000 (51.7800%)
___Train Local_Simple,  epoch  37, local model 50, internal_epoch   1,  Average loss: 0.0012, Accuracy: 465/477 (97.4843%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.8817, Accuracy: 4807/10000 (48.0700%)
___Train Local_Simple,  epoch  37, local model 69, internal_epoch   1,  Average loss: 0.0015, Accuracy: 655/671 (97.6155%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 6.2332, Accuracy: 3320/10000 (33.2000%)
___Train Local_Simple,  epoch  37, local model 75, internal_epoch   1,  Average loss: 0.0018, Accuracy: 731/763 (95.8060%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 4.0071, Accuracy: 4358/10000 (43.5800%)
___Train Local_Simple,  epoch  37, local model 83, internal_epoch   1,  Average loss: 0.0013, Accuracy: 350/360 (97.2222%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.5766, Accuracy: 8162/10000 (81.6200%)
___Train Local_Simple,  epoch  37, local model 92, internal_epoch   1,  Average loss: 0.0018, Accuracy: 586/611 (95.9083%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 4.1229, Accuracy: 3333/10000 (33.3300%)
___Train Local_Simple,  epoch  37, local model 77, internal_epoch   1,  Average loss: 0.0011, Accuracy: 605/618 (97.8964%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.9846, Accuracy: 5757/10000 (57.5700%)
___Train Local_Simple,  epoch  37, local model 10, internal_epoch   1,  Average loss: 0.0012, Accuracy: 562/573 (98.0803%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.5837, Accuracy: 5168/10000 (51.6800%)
___Train Local_Simple,  epoch  37, local model 97, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1099/1112 (98.8309%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 4.5090, Accuracy: 3942/10000 (39.4200%)
___Train Local_Simple,  epoch  37, local model 37, internal_epoch   1,  Average loss: 0.0007, Accuracy: 451/456 (98.9035%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.7170, Accuracy: 7675/10000 (76.7500%)
___Train Local_Simple,  epoch  37, local model 57, internal_epoch   1,  Average loss: 0.0009, Accuracy: 514/523 (98.2792%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.7509, Accuracy: 4016/10000 (40.1600%)
___Train Local_Simple,  epoch  37, local model 19, internal_epoch   1,  Average loss: 0.0013, Accuracy: 584/598 (97.6589%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 4.3787, Accuracy: 3870/10000 (38.7000%)
___Train Local_Simple,  epoch  37, local model 61, internal_epoch   1,  Average loss: 0.0017, Accuracy: 275/287 (95.8188%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.6544, Accuracy: 7965/10000 (79.6500%)
___Train Local_Simple,  epoch  37, local model 43, internal_epoch   1,  Average loss: 0.0011, Accuracy: 423/431 (98.1439%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.6572, Accuracy: 6628/10000 (66.2800%)
___Train Local_Simple,  epoch  37, local model 22, internal_epoch   1,  Average loss: 0.0014, Accuracy: 253/262 (96.5649%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.1984, Accuracy: 8000/10000 (80.0000%)
___Train Local_Simple,  epoch  37, local model 1, internal_epoch   1,  Average loss: 0.0006, Accuracy: 533/536 (99.4403%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.9223, Accuracy: 8000/10000 (80.0000%)
___Train Local_Simple,  epoch  37, local model 24, internal_epoch   1,  Average loss: 0.0016, Accuracy: 463/477 (97.0650%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.5371, Accuracy: 5151/10000 (51.5100%)
___Train Local_Simple,  epoch  37, local model 91, internal_epoch   1,  Average loss: 0.0005, Accuracy: 811/819 (99.0232%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.8649, Accuracy: 4789/10000 (47.8900%)
___Train Local_Simple,  epoch  37, local model 11, internal_epoch   1,  Average loss: 0.0007, Accuracy: 544/554 (98.1949%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.1993, Accuracy: 6590/10000 (65.9000%)
___Train Local_Simple,  epoch  37, local model 35, internal_epoch   1,  Average loss: 0.0013, Accuracy: 616/630 (97.7778%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 5.0623, Accuracy: 3905/10000 (39.0500%)
___Train Local_Simple,  epoch  37, local model 36, internal_epoch   1,  Average loss: 0.0011, Accuracy: 308/315 (97.7778%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.4221, Accuracy: 8724/10000 (87.2400%)
___Train Local_Simple,  epoch  37, local model 64, internal_epoch   1,  Average loss: 0.0006, Accuracy: 602/608 (99.0132%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 3.0912, Accuracy: 5374/10000 (53.7400%)
___Train Local_Simple,  epoch  37, local model 23, internal_epoch   1,  Average loss: 0.0010, Accuracy: 534/542 (98.5240%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 7.5748, Accuracy: 2880/10000 (28.8000%)
___Train Local_Simple,  epoch  37, local model 16, internal_epoch   1,  Average loss: 0.0008, Accuracy: 809/817 (99.0208%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.0374, Accuracy: 6231/10000 (62.3100%)
___Train Local_Simple,  epoch  37, local model 63, internal_epoch   1,  Average loss: 0.0019, Accuracy: 294/303 (97.0297%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.1025, Accuracy: 5490/10000 (54.9000%)
___Train Local_Simple,  epoch  37, local model 49, internal_epoch   1,  Average loss: 0.0011, Accuracy: 348/355 (98.0282%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.0715, Accuracy: 6762/10000 (67.6200%)
___Train Local_Simple,  epoch  37, local model 14, internal_epoch   1,  Average loss: 0.0020, Accuracy: 666/692 (96.2428%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.0810, Accuracy: 6734/10000 (67.3400%)
___Train Local_Simple,  epoch  37, local model 32, internal_epoch   1,  Average loss: 0.0010, Accuracy: 579/590 (98.1356%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.6602, Accuracy: 5557/10000 (55.5700%)
___Train Local_Simple,  epoch  37, local model 20, internal_epoch   1,  Average loss: 0.0015, Accuracy: 587/602 (97.5083%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 4.2023, Accuracy: 4481/10000 (44.8100%)
___Train Local_Simple,  epoch  37, local model 12, internal_epoch   1,  Average loss: 0.0007, Accuracy: 710/725 (97.9310%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 4.0345, Accuracy: 4699/10000 (46.9900%)
___Train Local_Simple,  epoch  37, local model 72, internal_epoch   1,  Average loss: 0.0017, Accuracy: 406/423 (95.9811%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.0322, Accuracy: 4920/10000 (49.2000%)
___Train Local_Simple,  epoch  37, local model 85, internal_epoch   1,  Average loss: 0.0019, Accuracy: 771/807 (95.5390%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.7794, Accuracy: 5831/10000 (58.3100%)
___Train Local_Simple,  epoch  37, local model 78, internal_epoch   1,  Average loss: 0.0033, Accuracy: 558/587 (95.0596%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.6905, Accuracy: 4548/10000 (45.4800%)
___Train Local_Simple,  epoch  37, local model 2, internal_epoch   1,  Average loss: 0.0012, Accuracy: 553/564 (98.0496%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.1275, Accuracy: 5061/10000 (50.6100%)
___Train Local_Simple,  epoch  37, local model 54, internal_epoch   1,  Average loss: 0.0006, Accuracy: 818/832 (98.3173%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 3.5081, Accuracy: 4707/10000 (47.0700%)
___Train Local_Simple,  epoch  37, local model 55, internal_epoch   1,  Average loss: 0.0013, Accuracy: 364/375 (97.0667%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 3.1686, Accuracy: 5255/10000 (52.5500%)
___Train Local_Simple,  epoch  37, local model 9, internal_epoch   1,  Average loss: 0.0009, Accuracy: 500/508 (98.4252%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.6908, Accuracy: 7609/10000 (76.0900%)
___Train Local_Simple,  epoch  37, local model 30, internal_epoch   1,  Average loss: 0.0012, Accuracy: 437/443 (98.6456%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.2405, Accuracy: 6352/10000 (63.5200%)
___Train Local_Simple,  epoch  37, local model 87, internal_epoch   1,  Average loss: 0.0007, Accuracy: 654/663 (98.6425%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.4960, Accuracy: 5431/10000 (54.3100%)
___Train Local_Simple,  epoch  37, local model 67, internal_epoch   1,  Average loss: 0.0012, Accuracy: 431/441 (97.7324%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.6220, Accuracy: 5722/10000 (57.2200%)
___Train Local_Simple,  epoch  37, local model 28, internal_epoch   1,  Average loss: 0.0008, Accuracy: 601/611 (98.3633%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.2383, Accuracy: 5826/10000 (58.2600%)
___Train Local_Simple,  epoch  37, local model 52, internal_epoch   1,  Average loss: 0.0013, Accuracy: 768/789 (97.3384%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 4.4005, Accuracy: 4481/10000 (44.8100%)
___Train Local_Simple,  epoch  37, local model 4, internal_epoch   1,  Average loss: 0.0010, Accuracy: 733/748 (97.9947%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 5.1223, Accuracy: 3260/10000 (32.6000%)
___Train Local_Simple,  epoch  37, local model 26, internal_epoch   1,  Average loss: 0.0010, Accuracy: 509/519 (98.0732%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.4418, Accuracy: 5035/10000 (50.3500%)
___Train Local_Simple,  epoch  37, local model 5, internal_epoch   1,  Average loss: 0.0010, Accuracy: 562/578 (97.2318%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.0838, Accuracy: 7079/10000 (70.7900%)
___Train Local_Simple,  epoch  37, local model 66, internal_epoch   1,  Average loss: 0.0024, Accuracy: 703/733 (95.9072%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.1487, Accuracy: 5999/10000 (59.9900%)
___Train Local_Simple,  epoch  37, local model 90, internal_epoch   1,  Average loss: 0.0013, Accuracy: 595/615 (96.7480%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 3.1838, Accuracy: 4920/10000 (49.2000%)
___Train Local_Simple,  epoch  37, local model 99, internal_epoch   1,  Average loss: 0.0019, Accuracy: 686/712 (96.3483%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.5422, Accuracy: 6427/10000 (64.2700%)
___Train Local_Simple,  epoch  37, local model 31, internal_epoch   1,  Average loss: 0.0013, Accuracy: 584/596 (97.9866%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.9318, Accuracy: 6180/10000 (61.8000%)
___Train Local_Simple,  epoch  37, local model 38, internal_epoch   1,  Average loss: 0.0011, Accuracy: 470/477 (98.5325%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.5074, Accuracy: 8388/10000 (83.8800%)
___Train Local_Simple,  epoch  37, local model 0, internal_epoch   1,  Average loss: 0.0008, Accuracy: 429/435 (98.6207%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.2441, Accuracy: 6656/10000 (66.5600%)
___Train Local_Simple,  epoch  37, local model 94, internal_epoch   1,  Average loss: 0.0010, Accuracy: 658/671 (98.0626%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 3.6547, Accuracy: 5475/10000 (54.7500%)
___Train Local_Simple,  epoch  37, local model 82, internal_epoch   1,  Average loss: 0.0007, Accuracy: 806/815 (98.8957%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 3.6278, Accuracy: 3726/10000 (37.2600%)
___Train Local_Simple,  epoch  37, local model 98, internal_epoch   1,  Average loss: 0.0010, Accuracy: 541/548 (98.7226%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.7451, Accuracy: 5024/10000 (50.2400%)
___Train Local_Simple,  epoch  37, local model 70, internal_epoch   1,  Average loss: 0.0013, Accuracy: 555/568 (97.7113%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.0464, Accuracy: 5581/10000 (55.8100%)
___Train Local_Simple,  epoch  37, local model 76, internal_epoch   1,  Average loss: 0.0021, Accuracy: 437/459 (95.2070%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.1198, Accuracy: 6722/10000 (67.2200%)
___Train Local_Simple,  epoch  37, local model 68, internal_epoch   1,  Average loss: 0.0018, Accuracy: 531/549 (96.7213%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 3.3298, Accuracy: 4713/10000 (47.1300%)
___Train Local_Simple,  epoch  37, local model 42, internal_epoch   1,  Average loss: 0.0005, Accuracy: 471/473 (99.5772%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.7655, Accuracy: 7686/10000 (76.8600%)
___Train Local_Simple,  epoch  37, local model 45, internal_epoch   1,  Average loss: 0.0011, Accuracy: 638/647 (98.6090%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.6937, Accuracy: 5881/10000 (58.8100%)
___Train Local_Simple,  epoch  37, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 546/561 (97.3262%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.1850, Accuracy: 5763/10000 (57.6300%)
___Train Local_Simple,  epoch  37, local model 8, internal_epoch   1,  Average loss: 0.0007, Accuracy: 698/706 (98.8669%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.4912, Accuracy: 4893/10000 (48.9300%)
___Train Local_Simple,  epoch  37, local model 40, internal_epoch   1,  Average loss: 0.0005, Accuracy: 494/498 (99.1968%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.9501, Accuracy: 5754/10000 (57.5400%)
___Train Local_Simple,  epoch  37, local model 89, internal_epoch   1,  Average loss: 0.0015, Accuracy: 667/683 (97.6574%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.0393, Accuracy: 5621/10000 (56.2100%)
___Train Local_Simple,  epoch  37, local model 86, internal_epoch   1,  Average loss: 0.0005, Accuracy: 688/692 (99.4220%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.9438, Accuracy: 4072/10000 (40.7200%)
___Train Local_Simple,  epoch  37, local model 17, internal_epoch   1,  Average loss: 0.0012, Accuracy: 515/527 (97.7230%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 3.1507, Accuracy: 4792/10000 (47.9200%)
___Train Local_Simple,  epoch  37, local model 81, internal_epoch   1,  Average loss: 0.0011, Accuracy: 628/636 (98.7421%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.4303, Accuracy: 3992/10000 (39.9200%)
___Train Local_Simple,  epoch  37, local model 39, internal_epoch   1,  Average loss: 0.0012, Accuracy: 483/493 (97.9716%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.5551, Accuracy: 5820/10000 (58.2000%)
___Train Local_Simple,  epoch  37, local model 6, internal_epoch   1,  Average loss: 0.0019, Accuracy: 421/435 (96.7816%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.5958, Accuracy: 5784/10000 (57.8400%)
___Train Local_Simple,  epoch  37, local model 65, internal_epoch   1,  Average loss: 0.0020, Accuracy: 592/621 (95.3301%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.3727, Accuracy: 6106/10000 (61.0600%)
___Train Local_Simple,  epoch  37, local model 46, internal_epoch   1,  Average loss: 0.0011, Accuracy: 635/650 (97.6923%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 4.1910, Accuracy: 4026/10000 (40.2600%)
___Train Local_Simple,  epoch  37, local model 60, internal_epoch   1,  Average loss: 0.0012, Accuracy: 557/571 (97.5482%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 5.7788, Accuracy: 3143/10000 (31.4300%)
___Train Local_Simple,  epoch  37, local model 58, internal_epoch   1,  Average loss: 0.0010, Accuracy: 756/772 (97.9275%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.7463, Accuracy: 5179/10000 (51.7900%)
___Train Local_Simple,  epoch  37, local model 21, internal_epoch   1,  Average loss: 0.0007, Accuracy: 674/687 (98.1077%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 3.6749, Accuracy: 4934/10000 (49.3400%)
___Train Local_Simple,  epoch  37, local model 79, internal_epoch   1,  Average loss: 0.0011, Accuracy: 651/661 (98.4871%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.5116, Accuracy: 4639/10000 (46.3900%)
___Train Local_Simple,  epoch  37, local model 25, internal_epoch   1,  Average loss: 0.0007, Accuracy: 581/592 (98.1419%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 3.4969, Accuracy: 5276/10000 (52.7600%)
___Train Local_Simple,  epoch  37, local model 34, internal_epoch   1,  Average loss: 0.0014, Accuracy: 852/871 (97.8186%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 4.0121, Accuracy: 4032/10000 (40.3200%)
time spent on training: 391.08607625961304
___Test Target_Simple poisoned: False, epoch: 37: Average loss: 0.1435, Accuracy: 9621/10000 (96.2100%)
___Test Target_Simple poisoned: True, epoch: 37: Average loss: 3.9882, Accuracy: 455/8968 (5.0736%)
saving model
Saving model on epoch 37
Done in 425.29922747612 sec.
Server Epoch:38 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 69, 61, 30, 25, 10, 43, 98, 71, 31, 22, 37, 0, 87, 52, 17, 72, 77, 55, 32, 35, 99, 58, 20, 82, 70, 92, 28, 39, 90, 83, 38, 13, 19, 46, 7, 63, 45, 50, 24, 85, 14, 9, 11, 60, 48, 66, 76, 93, 6, 56, 5, 54, 59, 27, 79, 23, 15, 16, 84, 57, 94, 68, 81, 86, 21, 42, 78, 8, 40, 67, 47, 36, 75, 65, 12, 2, 53, 44, 91, 64, 96, 26, 49, 89, 95, 4, 34, 97, 1, 80].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   1,  Average loss: 0.0231, Accuracy: 273/569 (47.9789%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   2,  Average loss: 0.0138, Accuracy: 318/569 (55.8875%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   3,  Average loss: 0.0105, Accuracy: 350/569 (61.5114%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   4,  Average loss: 0.0091, Accuracy: 432/569 (75.9227%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   5,  Average loss: 0.0081, Accuracy: 432/569 (75.9227%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   6,  Average loss: 0.0066, Accuracy: 493/569 (86.6432%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   7,  Average loss: 0.0050, Accuracy: 513/569 (90.1582%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   8,  Average loss: 0.0041, Accuracy: 533/569 (93.6731%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch   9,  Average loss: 0.0032, Accuracy: 545/569 (95.7821%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 41, internal_epoch  10,  Average loss: 0.0031, Accuracy: 553/569 (97.1880%), train_poison_data_count: 288
Global model norm: 15.43330950367834.
Norm before scaling: 15.629069782479858. Distance: 3.804452125114737
Total norm for 10 adversaries is: 15.629069782479858. distance: 3.804452125114737
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.4651, Accuracy: 7061/8968 (78.7355%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   1,  Average loss: 0.0136, Accuracy: 370/522 (70.8812%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   2,  Average loss: 0.0068, Accuracy: 418/522 (80.0766%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   3,  Average loss: 0.0036, Accuracy: 476/522 (91.1877%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   4,  Average loss: 0.0032, Accuracy: 489/522 (93.6782%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   5,  Average loss: 0.0022, Accuracy: 505/522 (96.7433%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   6,  Average loss: 0.0019, Accuracy: 511/522 (97.8927%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   7,  Average loss: 0.0012, Accuracy: 513/522 (98.2759%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   8,  Average loss: 0.0010, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch   9,  Average loss: 0.0010, Accuracy: 517/522 (99.0421%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 73, internal_epoch  10,  Average loss: 0.0009, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Global model norm: 15.43330950367834.
Norm before scaling: 15.555980864266132. Distance: 2.8829038031781264
Total norm for 10 adversaries is: 15.555980864266132. distance: 2.8829038031781264
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0277, Accuracy: 8863/8968 (98.8292%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   1,  Average loss: 0.0206, Accuracy: 199/385 (51.6883%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   2,  Average loss: 0.0118, Accuracy: 266/385 (69.0909%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   3,  Average loss: 0.0123, Accuracy: 255/385 (66.2338%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   4,  Average loss: 0.0047, Accuracy: 363/385 (94.2857%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   5,  Average loss: 0.0038, Accuracy: 369/385 (95.8442%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   6,  Average loss: 0.0029, Accuracy: 377/385 (97.9221%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   7,  Average loss: 0.0023, Accuracy: 374/385 (97.1429%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   8,  Average loss: 0.0017, Accuracy: 379/385 (98.4416%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   9,  Average loss: 0.0016, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch  10,  Average loss: 0.0013, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Global model norm: 15.43330950367834.
Norm before scaling: 15.608450219727734. Distance: 2.9070397401238224
Total norm for 10 adversaries is: 15.608450219727734. distance: 2.9070397401238224
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.2230, Accuracy: 8208/8968 (91.5254%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   1,  Average loss: 0.0091, Accuracy: 496/627 (79.1069%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   2,  Average loss: 0.0020, Accuracy: 606/627 (96.6507%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   3,  Average loss: 0.0012, Accuracy: 613/627 (97.7671%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   4,  Average loss: 0.0010, Accuracy: 614/627 (97.9266%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   5,  Average loss: 0.0007, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   6,  Average loss: 0.0010, Accuracy: 621/627 (99.0431%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   7,  Average loss: 0.0011, Accuracy: 616/627 (98.2456%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   8,  Average loss: 0.0006, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch   9,  Average loss: 0.0010, Accuracy: 616/627 (98.2456%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 74, internal_epoch  10,  Average loss: 0.0007, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Global model norm: 15.43330950367834.
Norm before scaling: 15.674541577414931. Distance: 2.7852714696648517
Total norm for 10 adversaries is: 15.674541577414931. distance: 2.7852714696648517
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0090, Accuracy: 8932/8968 (99.5986%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 3, internal_epoch   1,  Average loss: 0.0250, Accuracy: 256/516 (49.6124%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 3, internal_epoch   2,  Average loss: 0.0147, Accuracy: 269/516 (52.1318%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 3, internal_epoch   3,  Average loss: 0.0184, Accuracy: 267/516 (51.7442%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 3, internal_epoch   4,  Average loss: 0.0133, Accuracy: 285/516 (55.2326%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 3, internal_epoch   5,  Average loss: 0.0124, Accuracy: 264/516 (51.1628%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 3, internal_epoch   6,  Average loss: 0.0116, Accuracy: 287/516 (55.6202%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 3, internal_epoch   7,  Average loss: 0.0104, Accuracy: 383/516 (74.2248%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 3, internal_epoch   8,  Average loss: 0.0086, Accuracy: 397/516 (76.9380%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 3, internal_epoch   9,  Average loss: 0.0082, Accuracy: 416/516 (80.6202%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 3, internal_epoch  10,  Average loss: 0.0082, Accuracy: 409/516 (79.2636%), train_poison_data_count: 260
Global model norm: 15.43330950367834.
Norm before scaling: 15.615913373487997. Distance: 3.8604052940622475
Total norm for 10 adversaries is: 15.615913373487997. distance: 3.8604052940622475
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.3466, Accuracy: 8529/8968 (95.1048%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 18, internal_epoch   1,  Average loss: 0.0188, Accuracy: 410/759 (54.0184%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 18, internal_epoch   2,  Average loss: 0.0045, Accuracy: 669/759 (88.1423%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 18, internal_epoch   3,  Average loss: 0.0006, Accuracy: 752/759 (99.0777%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 18, internal_epoch   4,  Average loss: 0.0003, Accuracy: 753/759 (99.2095%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 18, internal_epoch   5,  Average loss: 0.0003, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 18, internal_epoch   6,  Average loss: 0.0003, Accuracy: 753/759 (99.2095%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 18, internal_epoch   7,  Average loss: 0.0003, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 18, internal_epoch   8,  Average loss: 0.0003, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 18, internal_epoch   9,  Average loss: 0.0002, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 18, internal_epoch  10,  Average loss: 0.0002, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Global model norm: 15.43330950367834.
Norm before scaling: 15.889988349156463. Distance: 4.211476477276389
Total norm for 10 adversaries is: 15.889988349156463. distance: 4.211476477276389
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0456, Accuracy: 8804/8968 (98.1713%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   1,  Average loss: 0.0169, Accuracy: 308/506 (60.8696%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   2,  Average loss: 0.0041, Accuracy: 479/506 (94.6640%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   3,  Average loss: 0.0014, Accuracy: 499/506 (98.6166%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   4,  Average loss: 0.0008, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   5,  Average loss: 0.0010, Accuracy: 498/506 (98.4190%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   6,  Average loss: 0.0010, Accuracy: 499/506 (98.6166%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   7,  Average loss: 0.0005, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   8,  Average loss: 0.0005, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   9,  Average loss: 0.0005, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch  10,  Average loss: 0.0007, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Global model norm: 15.43330950367834.
Norm before scaling: 15.714027135133467. Distance: 3.073868029896887
Total norm for 10 adversaries is: 15.714027135133467. distance: 3.073868029896887
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.3754, Accuracy: 7708/8968 (85.9500%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 62, internal_epoch   1,  Average loss: 0.0067, Accuracy: 485/580 (83.6207%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 62, internal_epoch   2,  Average loss: 0.0017, Accuracy: 562/580 (96.8966%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 62, internal_epoch   3,  Average loss: 0.0011, Accuracy: 568/580 (97.9310%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 62, internal_epoch   4,  Average loss: 0.0010, Accuracy: 569/580 (98.1034%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 62, internal_epoch   5,  Average loss: 0.0008, Accuracy: 569/580 (98.1034%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 62, internal_epoch   6,  Average loss: 0.0010, Accuracy: 567/580 (97.7586%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 62, internal_epoch   7,  Average loss: 0.0007, Accuracy: 572/580 (98.6207%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 62, internal_epoch   8,  Average loss: 0.0006, Accuracy: 573/580 (98.7931%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 62, internal_epoch   9,  Average loss: 0.0006, Accuracy: 574/580 (98.9655%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 62, internal_epoch  10,  Average loss: 0.0007, Accuracy: 573/580 (98.7931%), train_poison_data_count: 292
Global model norm: 15.43330950367834.
Norm before scaling: 15.569719593264697. Distance: 2.148705261190793
Total norm for 10 adversaries is: 15.569719593264697. distance: 2.148705261190793
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0210, Accuracy: 8895/8968 (99.1860%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 33, internal_epoch   1,  Average loss: 0.0231, Accuracy: 294/587 (50.0852%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 33, internal_epoch   2,  Average loss: 0.0131, Accuracy: 352/587 (59.9659%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 33, internal_epoch   3,  Average loss: 0.0097, Accuracy: 394/587 (67.1210%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 33, internal_epoch   4,  Average loss: 0.0058, Accuracy: 539/587 (91.8228%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 33, internal_epoch   5,  Average loss: 0.0043, Accuracy: 551/587 (93.8671%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 33, internal_epoch   6,  Average loss: 0.0025, Accuracy: 581/587 (98.9779%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 33, internal_epoch   7,  Average loss: 0.0017, Accuracy: 583/587 (99.3186%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 33, internal_epoch   8,  Average loss: 0.0011, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 33, internal_epoch   9,  Average loss: 0.0010, Accuracy: 581/587 (98.9779%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 33, internal_epoch  10,  Average loss: 0.0010, Accuracy: 583/587 (99.3186%), train_poison_data_count: 299
Global model norm: 15.43330950367834.
Norm before scaling: 15.717033641383319. Distance: 3.701361256286143
Total norm for 10 adversaries is: 15.717033641383319. distance: 3.701361256286143
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.4414, Accuracy: 7367/8968 (82.1476%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 88, internal_epoch   1,  Average loss: 0.0147, Accuracy: 480/734 (65.3951%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 88, internal_epoch   2,  Average loss: 0.0067, Accuracy: 599/734 (81.6076%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 88, internal_epoch   3,  Average loss: 0.0018, Accuracy: 715/734 (97.4114%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 88, internal_epoch   4,  Average loss: 0.0013, Accuracy: 721/734 (98.2289%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 88, internal_epoch   5,  Average loss: 0.0012, Accuracy: 722/734 (98.3651%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 88, internal_epoch   6,  Average loss: 0.0010, Accuracy: 719/734 (97.9564%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 88, internal_epoch   7,  Average loss: 0.0009, Accuracy: 721/734 (98.2289%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 88, internal_epoch   8,  Average loss: 0.0008, Accuracy: 723/734 (98.5014%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 88, internal_epoch   9,  Average loss: 0.0007, Accuracy: 725/734 (98.7738%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 88, internal_epoch  10,  Average loss: 0.0007, Accuracy: 723/734 (98.5014%), train_poison_data_count: 382
Global model norm: 15.43330950367834.
Norm before scaling: 15.707113824080386. Distance: 3.5619763441205246
Total norm for 10 adversaries is: 15.707113824080386. distance: 3.5619763441205246
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0554, Accuracy: 8775/8968 (97.8479%)
___Train Local_Simple,  epoch  38, local model 69, internal_epoch   1,  Average loss: 0.0019, Accuracy: 654/671 (97.4665%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 5.2868, Accuracy: 3374/10000 (33.7400%)
___Train Local_Simple,  epoch  38, local model 61, internal_epoch   1,  Average loss: 0.0010, Accuracy: 283/287 (98.6063%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3839, Accuracy: 8791/10000 (87.9100%)
___Train Local_Simple,  epoch  38, local model 30, internal_epoch   1,  Average loss: 0.0007, Accuracy: 439/443 (99.0971%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.7121, Accuracy: 7839/10000 (78.3900%)
___Train Local_Simple,  epoch  38, local model 25, internal_epoch   1,  Average loss: 0.0003, Accuracy: 590/592 (99.6622%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.9541, Accuracy: 7835/10000 (78.3500%)
___Train Local_Simple,  epoch  38, local model 10, internal_epoch   1,  Average loss: 0.0016, Accuracy: 555/573 (96.8586%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 2.2812, Accuracy: 5222/10000 (52.2200%)
___Train Local_Simple,  epoch  38, local model 43, internal_epoch   1,  Average loss: 0.0008, Accuracy: 426/431 (98.8399%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.5847, Accuracy: 8203/10000 (82.0300%)
___Train Local_Simple,  epoch  38, local model 98, internal_epoch   1,  Average loss: 0.0017, Accuracy: 531/548 (96.8978%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 6.0342, Accuracy: 2900/10000 (29.0000%)
___Train Local_Simple,  epoch  38, local model 71, internal_epoch   1,  Average loss: 0.0012, Accuracy: 546/561 (97.3262%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.8970, Accuracy: 7141/10000 (71.4100%)
___Train Local_Simple,  epoch  38, local model 31, internal_epoch   1,  Average loss: 0.0007, Accuracy: 588/596 (98.6577%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.1959, Accuracy: 6565/10000 (65.6500%)
___Train Local_Simple,  epoch  38, local model 22, internal_epoch   1,  Average loss: 0.0005, Accuracy: 261/262 (99.6183%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3222, Accuracy: 8928/10000 (89.2800%)
___Train Local_Simple,  epoch  38, local model 37, internal_epoch   1,  Average loss: 0.0014, Accuracy: 445/456 (97.5877%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 2.2198, Accuracy: 5685/10000 (56.8500%)
___Train Local_Simple,  epoch  38, local model 0, internal_epoch   1,  Average loss: 0.0013, Accuracy: 427/435 (98.1609%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 3.0728, Accuracy: 5759/10000 (57.5900%)
___Train Local_Simple,  epoch  38, local model 87, internal_epoch   1,  Average loss: 0.0014, Accuracy: 645/663 (97.2851%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 7.0920, Accuracy: 3469/10000 (34.6900%)
___Train Local_Simple,  epoch  38, local model 52, internal_epoch   1,  Average loss: 0.0017, Accuracy: 758/789 (96.0710%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 3.6891, Accuracy: 4627/10000 (46.2700%)
___Train Local_Simple,  epoch  38, local model 17, internal_epoch   1,  Average loss: 0.0006, Accuracy: 521/527 (98.8615%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.0645, Accuracy: 6819/10000 (68.1900%)
___Train Local_Simple,  epoch  38, local model 72, internal_epoch   1,  Average loss: 0.0016, Accuracy: 409/423 (96.6903%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 2.5426, Accuracy: 3794/10000 (37.9400%)
___Train Local_Simple,  epoch  38, local model 77, internal_epoch   1,  Average loss: 0.0020, Accuracy: 594/618 (96.1165%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 3.5761, Accuracy: 3866/10000 (38.6600%)
___Train Local_Simple,  epoch  38, local model 55, internal_epoch   1,  Average loss: 0.0013, Accuracy: 367/375 (97.8667%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.4375, Accuracy: 6433/10000 (64.3300%)
___Train Local_Simple,  epoch  38, local model 32, internal_epoch   1,  Average loss: 0.0014, Accuracy: 572/590 (96.9492%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 4.2367, Accuracy: 4927/10000 (49.2700%)
___Train Local_Simple,  epoch  38, local model 35, internal_epoch   1,  Average loss: 0.0012, Accuracy: 615/630 (97.6190%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.3004, Accuracy: 6633/10000 (66.3300%)
___Train Local_Simple,  epoch  38, local model 99, internal_epoch   1,  Average loss: 0.0022, Accuracy: 680/712 (95.5056%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 2.6983, Accuracy: 4762/10000 (47.6200%)
___Train Local_Simple,  epoch  38, local model 58, internal_epoch   1,  Average loss: 0.0008, Accuracy: 762/772 (98.7047%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 3.2303, Accuracy: 4754/10000 (47.5400%)
___Train Local_Simple,  epoch  38, local model 20, internal_epoch   1,  Average loss: 0.0010, Accuracy: 592/602 (98.3389%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.4461, Accuracy: 6410/10000 (64.1000%)
___Train Local_Simple,  epoch  38, local model 82, internal_epoch   1,  Average loss: 0.0010, Accuracy: 802/815 (98.4049%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 7.2584, Accuracy: 3048/10000 (30.4800%)
___Train Local_Simple,  epoch  38, local model 70, internal_epoch   1,  Average loss: 0.0019, Accuracy: 541/568 (95.2465%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 4.8120, Accuracy: 3045/10000 (30.4500%)
___Train Local_Simple,  epoch  38, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 565/611 (92.4714%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.5217, Accuracy: 5775/10000 (57.7500%)
___Train Local_Simple,  epoch  38, local model 28, internal_epoch   1,  Average loss: 0.0014, Accuracy: 596/611 (97.5450%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 2.3166, Accuracy: 5734/10000 (57.3400%)
___Train Local_Simple,  epoch  38, local model 39, internal_epoch   1,  Average loss: 0.0008, Accuracy: 485/493 (98.3773%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.0678, Accuracy: 7162/10000 (71.6200%)
___Train Local_Simple,  epoch  38, local model 90, internal_epoch   1,  Average loss: 0.0019, Accuracy: 593/615 (96.4228%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.7971, Accuracy: 5973/10000 (59.7300%)
___Train Local_Simple,  epoch  38, local model 83, internal_epoch   1,  Average loss: 0.0014, Accuracy: 346/360 (96.1111%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3652, Accuracy: 8876/10000 (88.7600%)
___Train Local_Simple,  epoch  38, local model 38, internal_epoch   1,  Average loss: 0.0008, Accuracy: 468/477 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.5202, Accuracy: 8394/10000 (83.9400%)
___Train Local_Simple,  epoch  38, local model 13, internal_epoch   1,  Average loss: 0.0007, Accuracy: 703/713 (98.5975%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.9530, Accuracy: 5715/10000 (57.1500%)
___Train Local_Simple,  epoch  38, local model 19, internal_epoch   1,  Average loss: 0.0009, Accuracy: 587/598 (98.1605%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.9146, Accuracy: 5526/10000 (55.2600%)
___Train Local_Simple,  epoch  38, local model 46, internal_epoch   1,  Average loss: 0.0006, Accuracy: 643/650 (98.9231%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 3.6035, Accuracy: 4644/10000 (46.4400%)
___Train Local_Simple,  epoch  38, local model 7, internal_epoch   1,  Average loss: 0.0006, Accuracy: 795/802 (99.1272%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 2.7353, Accuracy: 4985/10000 (49.8500%)
___Train Local_Simple,  epoch  38, local model 63, internal_epoch   1,  Average loss: 0.0018, Accuracy: 295/303 (97.3597%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 2.0664, Accuracy: 5605/10000 (56.0500%)
___Train Local_Simple,  epoch  38, local model 45, internal_epoch   1,  Average loss: 0.0010, Accuracy: 634/647 (97.9907%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 3.0664, Accuracy: 4890/10000 (48.9000%)
___Train Local_Simple,  epoch  38, local model 50, internal_epoch   1,  Average loss: 0.0011, Accuracy: 466/477 (97.6939%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 2.0549, Accuracy: 4975/10000 (49.7500%)
___Train Local_Simple,  epoch  38, local model 24, internal_epoch   1,  Average loss: 0.0017, Accuracy: 465/477 (97.4843%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.4020, Accuracy: 6072/10000 (60.7200%)
___Train Local_Simple,  epoch  38, local model 85, internal_epoch   1,  Average loss: 0.0014, Accuracy: 783/807 (97.0260%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 4.1157, Accuracy: 4001/10000 (40.0100%)
___Train Local_Simple,  epoch  38, local model 14, internal_epoch   1,  Average loss: 0.0013, Accuracy: 678/692 (97.9769%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.9913, Accuracy: 6229/10000 (62.2900%)
___Train Local_Simple,  epoch  38, local model 9, internal_epoch   1,  Average loss: 0.0013, Accuracy: 497/508 (97.8346%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.8140, Accuracy: 5971/10000 (59.7100%)
___Train Local_Simple,  epoch  38, local model 11, internal_epoch   1,  Average loss: 0.0007, Accuracy: 547/554 (98.7365%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.6428, Accuracy: 8062/10000 (80.6200%)
___Train Local_Simple,  epoch  38, local model 60, internal_epoch   1,  Average loss: 0.0018, Accuracy: 549/571 (96.1471%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 3.0500, Accuracy: 4099/10000 (40.9900%)
___Train Local_Simple,  epoch  38, local model 48, internal_epoch   1,  Average loss: 0.0014, Accuracy: 357/363 (98.3471%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.8341, Accuracy: 7624/10000 (76.2400%)
___Train Local_Simple,  epoch  38, local model 66, internal_epoch   1,  Average loss: 0.0014, Accuracy: 710/733 (96.8622%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 6.5680, Accuracy: 2760/10000 (27.6000%)
___Train Local_Simple,  epoch  38, local model 76, internal_epoch   1,  Average loss: 0.0011, Accuracy: 454/459 (98.9107%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.4199, Accuracy: 8614/10000 (86.1400%)
___Train Local_Simple,  epoch  38, local model 93, internal_epoch   1,  Average loss: 0.0019, Accuracy: 605/630 (96.0317%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 2.8261, Accuracy: 3877/10000 (38.7700%)
___Train Local_Simple,  epoch  38, local model 6, internal_epoch   1,  Average loss: 0.0008, Accuracy: 429/435 (98.6207%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.6728, Accuracy: 7938/10000 (79.3800%)
___Train Local_Simple,  epoch  38, local model 56, internal_epoch   1,  Average loss: 0.0008, Accuracy: 703/715 (98.3217%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 4.4914, Accuracy: 3539/10000 (35.3900%)
___Train Local_Simple,  epoch  38, local model 5, internal_epoch   1,  Average loss: 0.0009, Accuracy: 568/578 (98.2699%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.0101, Accuracy: 7484/10000 (74.8400%)
___Train Local_Simple,  epoch  38, local model 54, internal_epoch   1,  Average loss: 0.0008, Accuracy: 818/832 (98.3173%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 5.0502, Accuracy: 3685/10000 (36.8500%)
___Train Local_Simple,  epoch  38, local model 59, internal_epoch   1,  Average loss: 0.0011, Accuracy: 632/644 (98.1366%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 3.2624, Accuracy: 4637/10000 (46.3700%)
___Train Local_Simple,  epoch  38, local model 27, internal_epoch   1,  Average loss: 0.0013, Accuracy: 725/745 (97.3154%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 4.7943, Accuracy: 3355/10000 (33.5500%)
___Train Local_Simple,  epoch  38, local model 79, internal_epoch   1,  Average loss: 0.0013, Accuracy: 651/661 (98.4871%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.4434, Accuracy: 5758/10000 (57.5800%)
___Train Local_Simple,  epoch  38, local model 23, internal_epoch   1,  Average loss: 0.0019, Accuracy: 524/542 (96.6790%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 2.2546, Accuracy: 5240/10000 (52.4000%)
___Train Local_Simple,  epoch  38, local model 15, internal_epoch   1,  Average loss: 0.0009, Accuracy: 279/282 (98.9362%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3686, Accuracy: 8723/10000 (87.2300%)
___Train Local_Simple,  epoch  38, local model 16, internal_epoch   1,  Average loss: 0.0003, Accuracy: 811/817 (99.2656%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.4356, Accuracy: 6557/10000 (65.5700%)
___Train Local_Simple,  epoch  38, local model 84, internal_epoch   1,  Average loss: 0.0009, Accuracy: 413/420 (98.3333%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.5683, Accuracy: 8208/10000 (82.0800%)
___Train Local_Simple,  epoch  38, local model 57, internal_epoch   1,  Average loss: 0.0011, Accuracy: 513/523 (98.0880%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 3.7063, Accuracy: 3620/10000 (36.2000%)
___Train Local_Simple,  epoch  38, local model 94, internal_epoch   1,  Average loss: 0.0007, Accuracy: 663/671 (98.8077%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 2.5239, Accuracy: 5725/10000 (57.2500%)
___Train Local_Simple,  epoch  38, local model 68, internal_epoch   1,  Average loss: 0.0014, Accuracy: 536/549 (97.6321%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 3.6261, Accuracy: 3582/10000 (35.8200%)
___Train Local_Simple,  epoch  38, local model 81, internal_epoch   1,  Average loss: 0.0014, Accuracy: 618/636 (97.1698%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 2.1928, Accuracy: 5069/10000 (50.6900%)
___Train Local_Simple,  epoch  38, local model 86, internal_epoch   1,  Average loss: 0.0007, Accuracy: 682/692 (98.5549%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 6.3360, Accuracy: 2945/10000 (29.4500%)
___Train Local_Simple,  epoch  38, local model 21, internal_epoch   1,  Average loss: 0.0006, Accuracy: 679/687 (98.8355%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 2.9413, Accuracy: 4321/10000 (43.2100%)
___Train Local_Simple,  epoch  38, local model 42, internal_epoch   1,  Average loss: 0.0005, Accuracy: 470/473 (99.3658%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.0924, Accuracy: 7118/10000 (71.1800%)
___Train Local_Simple,  epoch  38, local model 78, internal_epoch   1,  Average loss: 0.0024, Accuracy: 571/587 (97.2743%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 8.2589, Accuracy: 2072/10000 (20.7200%)
___Train Local_Simple,  epoch  38, local model 8, internal_epoch   1,  Average loss: 0.0010, Accuracy: 691/706 (97.8754%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 4.3835, Accuracy: 3536/10000 (35.3600%)
___Train Local_Simple,  epoch  38, local model 40, internal_epoch   1,  Average loss: 0.0007, Accuracy: 492/498 (98.7952%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 4.8057, Accuracy: 4780/10000 (47.8000%)
___Train Local_Simple,  epoch  38, local model 67, internal_epoch   1,  Average loss: 0.0016, Accuracy: 427/441 (96.8254%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.8971, Accuracy: 5106/10000 (51.0600%)
___Train Local_Simple,  epoch  38, local model 47, internal_epoch   1,  Average loss: 0.0010, Accuracy: 522/534 (97.7528%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 6.2305, Accuracy: 3885/10000 (38.8500%)
___Train Local_Simple,  epoch  38, local model 36, internal_epoch   1,  Average loss: 0.0007, Accuracy: 311/315 (98.7302%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2804, Accuracy: 9041/10000 (90.4100%)
___Train Local_Simple,  epoch  38, local model 75, internal_epoch   1,  Average loss: 0.0017, Accuracy: 735/763 (96.3303%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 6.1357, Accuracy: 2774/10000 (27.7400%)
___Train Local_Simple,  epoch  38, local model 65, internal_epoch   1,  Average loss: 0.0021, Accuracy: 592/621 (95.3301%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.2966, Accuracy: 6132/10000 (61.3200%)
___Train Local_Simple,  epoch  38, local model 12, internal_epoch   1,  Average loss: 0.0005, Accuracy: 717/725 (98.8966%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 2.1675, Accuracy: 5610/10000 (56.1000%)
___Train Local_Simple,  epoch  38, local model 2, internal_epoch   1,  Average loss: 0.0011, Accuracy: 554/564 (98.2270%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.7508, Accuracy: 5607/10000 (56.0700%)
___Train Local_Simple,  epoch  38, local model 53, internal_epoch   1,  Average loss: 0.0007, Accuracy: 553/561 (98.5740%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.3757, Accuracy: 6418/10000 (64.1800%)
___Train Local_Simple,  epoch  38, local model 44, internal_epoch   1,  Average loss: 0.0004, Accuracy: 556/561 (99.1087%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.8089, Accuracy: 7567/10000 (75.6700%)
___Train Local_Simple,  epoch  38, local model 91, internal_epoch   1,  Average loss: 0.0008, Accuracy: 810/819 (98.9011%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 5.8568, Accuracy: 3350/10000 (33.5000%)
___Train Local_Simple,  epoch  38, local model 64, internal_epoch   1,  Average loss: 0.0009, Accuracy: 599/608 (98.5197%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 3.0529, Accuracy: 4616/10000 (46.1600%)
___Train Local_Simple,  epoch  38, local model 96, internal_epoch   1,  Average loss: 0.0009, Accuracy: 521/531 (98.1168%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 3.2599, Accuracy: 4471/10000 (44.7100%)
___Train Local_Simple,  epoch  38, local model 26, internal_epoch   1,  Average loss: 0.0013, Accuracy: 505/519 (97.3025%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 2.5768, Accuracy: 5391/10000 (53.9100%)
___Train Local_Simple,  epoch  38, local model 49, internal_epoch   1,  Average loss: 0.0017, Accuracy: 343/355 (96.6197%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.7918, Accuracy: 5107/10000 (51.0700%)
___Train Local_Simple,  epoch  38, local model 89, internal_epoch   1,  Average loss: 0.0022, Accuracy: 662/683 (96.9253%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 5.1453, Accuracy: 4229/10000 (42.2900%)
___Train Local_Simple,  epoch  38, local model 95, internal_epoch   1,  Average loss: 0.0025, Accuracy: 572/600 (95.3333%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 3.8556, Accuracy: 4389/10000 (43.8900%)
___Train Local_Simple,  epoch  38, local model 4, internal_epoch   1,  Average loss: 0.0005, Accuracy: 742/748 (99.1979%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 2.4022, Accuracy: 4970/10000 (49.7000%)
___Train Local_Simple,  epoch  38, local model 34, internal_epoch   1,  Average loss: 0.0015, Accuracy: 849/871 (97.4742%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 5.8962, Accuracy: 3427/10000 (34.2700%)
___Train Local_Simple,  epoch  38, local model 97, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1100/1112 (98.9209%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 4.6709, Accuracy: 4127/10000 (41.2700%)
___Train Local_Simple,  epoch  38, local model 1, internal_epoch   1,  Average loss: 0.0005, Accuracy: 533/536 (99.4403%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2434, Accuracy: 9213/10000 (92.1300%)
___Train Local_Simple,  epoch  38, local model 80, internal_epoch   1,  Average loss: 0.0022, Accuracy: 510/532 (95.8647%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 6.3427, Accuracy: 2804/10000 (28.0400%)
time spent on training: 384.06738090515137
___Test Target_Simple poisoned: False, epoch: 38: Average loss: 0.1331, Accuracy: 9622/10000 (96.2200%)
___Test Target_Simple poisoned: True, epoch: 38: Average loss: 3.3764, Accuracy: 720/8968 (8.0285%)
saving model
Saving model on epoch 38
Done in 417.8237316608429 sec.
Server Epoch:39 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 77, 4, 32, 50, 10, 14, 83, 70, 90, 22, 57, 91, 60, 6, 55, 23, 39, 48, 98, 68, 80, 9, 81, 5, 16, 61, 69, 35, 54, 43, 12, 46, 66, 52, 36, 92, 96, 97, 17, 26, 58, 63, 38, 71, 30, 34, 59, 21, 15, 49, 1, 25, 0, 56, 53, 47, 72, 37, 95, 45, 28, 2, 87, 78, 42, 86, 40, 79, 94, 82, 24, 67, 64, 11, 76, 31, 93, 27, 99, 13, 8, 75, 65, 44, 84, 7, 85, 20, 19, 89].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   1,  Average loss: 0.0215, Accuracy: 287/569 (50.4394%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   2,  Average loss: 0.0122, Accuracy: 348/569 (61.1599%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   3,  Average loss: 0.0096, Accuracy: 396/569 (69.5958%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   4,  Average loss: 0.0082, Accuracy: 434/569 (76.2742%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   5,  Average loss: 0.0072, Accuracy: 477/569 (83.8313%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   6,  Average loss: 0.0056, Accuracy: 485/569 (85.2373%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   7,  Average loss: 0.0043, Accuracy: 522/569 (91.7399%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   8,  Average loss: 0.0031, Accuracy: 546/569 (95.9578%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch   9,  Average loss: 0.0027, Accuracy: 546/569 (95.9578%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 41, internal_epoch  10,  Average loss: 0.0026, Accuracy: 549/569 (96.4851%), train_poison_data_count: 288
Global model norm: 15.431909452355633.
Norm before scaling: 15.615417960342011. Distance: 3.371745765903428
Total norm for 10 adversaries is: 15.615417960342011. distance: 3.371745765903428
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.5535, Accuracy: 6756/8968 (75.3345%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   1,  Average loss: 0.0136, Accuracy: 363/522 (69.5402%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   2,  Average loss: 0.0066, Accuracy: 410/522 (78.5441%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   3,  Average loss: 0.0038, Accuracy: 454/522 (86.9732%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   4,  Average loss: 0.0026, Accuracy: 495/522 (94.8276%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   5,  Average loss: 0.0015, Accuracy: 516/522 (98.8506%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   6,  Average loss: 0.0012, Accuracy: 518/522 (99.2337%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   7,  Average loss: 0.0010, Accuracy: 518/522 (99.2337%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   8,  Average loss: 0.0009, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   9,  Average loss: 0.0006, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch  10,  Average loss: 0.0007, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Global model norm: 15.431909452355633.
Norm before scaling: 15.561779327251692. Distance: 2.796728034393809
Total norm for 10 adversaries is: 15.561779327251692. distance: 2.796728034393809
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0260, Accuracy: 8877/8968 (98.9853%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   1,  Average loss: 0.0180, Accuracy: 218/385 (56.6234%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   2,  Average loss: 0.0090, Accuracy: 286/385 (74.2857%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   3,  Average loss: 0.0036, Accuracy: 372/385 (96.6234%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   4,  Average loss: 0.0024, Accuracy: 379/385 (98.4416%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   5,  Average loss: 0.0022, Accuracy: 374/385 (97.1429%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   6,  Average loss: 0.0018, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   7,  Average loss: 0.0015, Accuracy: 378/385 (98.1818%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   8,  Average loss: 0.0011, Accuracy: 381/385 (98.9610%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch   9,  Average loss: 0.0008, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 51, internal_epoch  10,  Average loss: 0.0009, Accuracy: 383/385 (99.4805%), train_poison_data_count: 193
Global model norm: 15.431909452355633.
Norm before scaling: 15.611352926955464. Distance: 2.733633060614209
Total norm for 10 adversaries is: 15.611352926955464. distance: 2.733633060614209
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.1714, Accuracy: 8519/8968 (94.9933%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 532/627 (84.8485%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   2,  Average loss: 0.0014, Accuracy: 615/627 (98.0861%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   3,  Average loss: 0.0010, Accuracy: 615/627 (98.0861%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   4,  Average loss: 0.0010, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   5,  Average loss: 0.0007, Accuracy: 615/627 (98.0861%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   6,  Average loss: 0.0006, Accuracy: 616/627 (98.2456%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   7,  Average loss: 0.0005, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   8,  Average loss: 0.0007, Accuracy: 621/627 (99.0431%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch   9,  Average loss: 0.0007, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 74, internal_epoch  10,  Average loss: 0.0006, Accuracy: 621/627 (99.0431%), train_poison_data_count: 320
Global model norm: 15.431909452355633.
Norm before scaling: 15.597127483680689. Distance: 2.391810005048529
Total norm for 10 adversaries is: 15.597127483680689. distance: 2.391810005048529
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0116, Accuracy: 8927/8968 (99.5428%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   1,  Average loss: 0.0230, Accuracy: 257/516 (49.8062%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   2,  Average loss: 0.0148, Accuracy: 289/516 (56.0078%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   3,  Average loss: 0.0147, Accuracy: 279/516 (54.0698%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   4,  Average loss: 0.0122, Accuracy: 319/516 (61.8217%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   5,  Average loss: 0.0098, Accuracy: 429/516 (83.1395%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   6,  Average loss: 0.0074, Accuracy: 436/516 (84.4961%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   7,  Average loss: 0.0053, Accuracy: 457/516 (88.5659%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   8,  Average loss: 0.0039, Accuracy: 493/516 (95.5426%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   9,  Average loss: 0.0029, Accuracy: 506/516 (98.0620%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch  10,  Average loss: 0.0028, Accuracy: 505/516 (97.8682%), train_poison_data_count: 260
Global model norm: 15.431909452355633.
Norm before scaling: 15.69138193923932. Distance: 4.041420578428833
Total norm for 10 adversaries is: 15.69138193923932. distance: 4.041420578428833
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.4986, Accuracy: 7075/8968 (78.8916%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 18, internal_epoch   1,  Average loss: 0.0176, Accuracy: 416/759 (54.8090%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 18, internal_epoch   2,  Average loss: 0.0030, Accuracy: 712/759 (93.8076%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 18, internal_epoch   3,  Average loss: 0.0004, Accuracy: 753/759 (99.2095%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 18, internal_epoch   4,  Average loss: 0.0005, Accuracy: 752/759 (99.0777%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 18, internal_epoch   5,  Average loss: 0.0002, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 18, internal_epoch   6,  Average loss: 0.0002, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 18, internal_epoch   7,  Average loss: 0.0002, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 18, internal_epoch   8,  Average loss: 0.0002, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 18, internal_epoch   9,  Average loss: 0.0001, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 18, internal_epoch  10,  Average loss: 0.0001, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Global model norm: 15.431909452355633.
Norm before scaling: 15.908735819235007. Distance: 4.040118022365628
Total norm for 10 adversaries is: 15.908735819235007. distance: 4.040118022365628
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0953, Accuracy: 8636/8968 (96.2979%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 29, internal_epoch   1,  Average loss: 0.0192, Accuracy: 292/506 (57.7075%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 29, internal_epoch   2,  Average loss: 0.0063, Accuracy: 442/506 (87.3518%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 29, internal_epoch   3,  Average loss: 0.0012, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 29, internal_epoch   4,  Average loss: 0.0009, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 29, internal_epoch   5,  Average loss: 0.0010, Accuracy: 500/506 (98.8142%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 29, internal_epoch   6,  Average loss: 0.0009, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 29, internal_epoch   7,  Average loss: 0.0008, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 29, internal_epoch   8,  Average loss: 0.0007, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 29, internal_epoch   9,  Average loss: 0.0005, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 29, internal_epoch  10,  Average loss: 0.0007, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Global model norm: 15.431909452355633.
Norm before scaling: 15.772495251079091. Distance: 3.2979182179283275
Total norm for 10 adversaries is: 15.772495251079091. distance: 3.2979182179283275
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.3932, Accuracy: 7481/8968 (83.4188%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 62, internal_epoch   1,  Average loss: 0.0065, Accuracy: 492/580 (84.8276%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 62, internal_epoch   2,  Average loss: 0.0018, Accuracy: 562/580 (96.8966%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 62, internal_epoch   3,  Average loss: 0.0011, Accuracy: 569/580 (98.1034%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 62, internal_epoch   4,  Average loss: 0.0014, Accuracy: 565/580 (97.4138%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 62, internal_epoch   5,  Average loss: 0.0008, Accuracy: 568/580 (97.9310%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 62, internal_epoch   6,  Average loss: 0.0007, Accuracy: 572/580 (98.6207%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 62, internal_epoch   7,  Average loss: 0.0008, Accuracy: 569/580 (98.1034%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 62, internal_epoch   8,  Average loss: 0.0007, Accuracy: 570/580 (98.2759%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 62, internal_epoch   9,  Average loss: 0.0007, Accuracy: 570/580 (98.2759%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 62, internal_epoch  10,  Average loss: 0.0006, Accuracy: 572/580 (98.6207%), train_poison_data_count: 292
Global model norm: 15.431909452355633.
Norm before scaling: 15.631996480451361. Distance: 2.286848436124683
Total norm for 10 adversaries is: 15.631996480451361. distance: 2.286848436124683
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0207, Accuracy: 8898/8968 (99.2194%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 33, internal_epoch   1,  Average loss: 0.0213, Accuracy: 298/587 (50.7666%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 33, internal_epoch   2,  Average loss: 0.0112, Accuracy: 360/587 (61.3288%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 33, internal_epoch   3,  Average loss: 0.0069, Accuracy: 438/587 (74.6167%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 33, internal_epoch   4,  Average loss: 0.0033, Accuracy: 567/587 (96.5928%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 33, internal_epoch   5,  Average loss: 0.0022, Accuracy: 579/587 (98.6371%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 33, internal_epoch   6,  Average loss: 0.0018, Accuracy: 579/587 (98.6371%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 33, internal_epoch   7,  Average loss: 0.0013, Accuracy: 580/587 (98.8075%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 33, internal_epoch   8,  Average loss: 0.0011, Accuracy: 581/587 (98.9779%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 33, internal_epoch   9,  Average loss: 0.0010, Accuracy: 581/587 (98.9779%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 33, internal_epoch  10,  Average loss: 0.0009, Accuracy: 580/587 (98.8075%), train_poison_data_count: 299
Global model norm: 15.431909452355633.
Norm before scaling: 15.713744562912959. Distance: 3.53422272722653
Total norm for 10 adversaries is: 15.713744562912959. distance: 3.53422272722653
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.6765, Accuracy: 6504/8968 (72.5245%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 88, internal_epoch   1,  Average loss: 0.0136, Accuracy: 496/734 (67.5749%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 88, internal_epoch   2,  Average loss: 0.0053, Accuracy: 623/734 (84.8774%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 88, internal_epoch   3,  Average loss: 0.0014, Accuracy: 718/734 (97.8202%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 88, internal_epoch   4,  Average loss: 0.0010, Accuracy: 722/734 (98.3651%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 88, internal_epoch   5,  Average loss: 0.0009, Accuracy: 726/734 (98.9101%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 88, internal_epoch   6,  Average loss: 0.0008, Accuracy: 722/734 (98.3651%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 88, internal_epoch   7,  Average loss: 0.0009, Accuracy: 723/734 (98.5014%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 88, internal_epoch   8,  Average loss: 0.0007, Accuracy: 727/734 (99.0463%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 88, internal_epoch   9,  Average loss: 0.0005, Accuracy: 729/734 (99.3188%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 88, internal_epoch  10,  Average loss: 0.0006, Accuracy: 727/734 (99.0463%), train_poison_data_count: 382
Global model norm: 15.431909452355633.
Norm before scaling: 15.719960949099427. Distance: 3.3193642372929393
Total norm for 10 adversaries is: 15.719960949099427. distance: 3.3193642372929393
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0489, Accuracy: 8790/8968 (98.0152%)
___Train Local_Simple,  epoch  39, local model 77, internal_epoch   1,  Average loss: 0.0019, Accuracy: 598/618 (96.7638%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.4076, Accuracy: 6549/10000 (65.4900%)
___Train Local_Simple,  epoch  39, local model 4, internal_epoch   1,  Average loss: 0.0010, Accuracy: 737/748 (98.5294%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 3.8775, Accuracy: 3826/10000 (38.2600%)
___Train Local_Simple,  epoch  39, local model 32, internal_epoch   1,  Average loss: 0.0014, Accuracy: 578/590 (97.9661%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.1721, Accuracy: 5908/10000 (59.0800%)
___Train Local_Simple,  epoch  39, local model 50, internal_epoch   1,  Average loss: 0.0010, Accuracy: 467/477 (97.9036%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.8120, Accuracy: 5637/10000 (56.3700%)
___Train Local_Simple,  epoch  39, local model 10, internal_epoch   1,  Average loss: 0.0011, Accuracy: 562/573 (98.0803%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.7221, Accuracy: 4950/10000 (49.5000%)
___Train Local_Simple,  epoch  39, local model 14, internal_epoch   1,  Average loss: 0.0011, Accuracy: 678/692 (97.9769%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.6307, Accuracy: 4317/10000 (43.1700%)
___Train Local_Simple,  epoch  39, local model 83, internal_epoch   1,  Average loss: 0.0013, Accuracy: 352/360 (97.7778%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.5279, Accuracy: 8375/10000 (83.7500%)
___Train Local_Simple,  epoch  39, local model 70, internal_epoch   1,  Average loss: 0.0010, Accuracy: 559/568 (98.4155%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.8887, Accuracy: 4627/10000 (46.2700%)
___Train Local_Simple,  epoch  39, local model 90, internal_epoch   1,  Average loss: 0.0020, Accuracy: 590/615 (95.9350%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.5980, Accuracy: 6803/10000 (68.0300%)
___Train Local_Simple,  epoch  39, local model 22, internal_epoch   1,  Average loss: 0.0011, Accuracy: 258/262 (98.4733%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.7458, Accuracy: 8354/10000 (83.5400%)
___Train Local_Simple,  epoch  39, local model 57, internal_epoch   1,  Average loss: 0.0007, Accuracy: 516/523 (98.6616%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.9029, Accuracy: 5278/10000 (52.7800%)
___Train Local_Simple,  epoch  39, local model 91, internal_epoch   1,  Average loss: 0.0005, Accuracy: 814/819 (99.3895%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.8188, Accuracy: 5559/10000 (55.5900%)
___Train Local_Simple,  epoch  39, local model 60, internal_epoch   1,  Average loss: 0.0015, Accuracy: 553/571 (96.8476%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 4.8534, Accuracy: 3279/10000 (32.7900%)
___Train Local_Simple,  epoch  39, local model 6, internal_epoch   1,  Average loss: 0.0011, Accuracy: 427/435 (98.1609%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.2449, Accuracy: 6503/10000 (65.0300%)
___Train Local_Simple,  epoch  39, local model 55, internal_epoch   1,  Average loss: 0.0014, Accuracy: 362/375 (96.5333%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.2876, Accuracy: 5731/10000 (57.3100%)
___Train Local_Simple,  epoch  39, local model 23, internal_epoch   1,  Average loss: 0.0011, Accuracy: 530/542 (97.7860%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 3.0032, Accuracy: 4806/10000 (48.0600%)
___Train Local_Simple,  epoch  39, local model 39, internal_epoch   1,  Average loss: 0.0009, Accuracy: 484/493 (98.1744%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.2651, Accuracy: 6225/10000 (62.2500%)
___Train Local_Simple,  epoch  39, local model 48, internal_epoch   1,  Average loss: 0.0018, Accuracy: 350/363 (96.4187%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.6506, Accuracy: 8059/10000 (80.5900%)
___Train Local_Simple,  epoch  39, local model 98, internal_epoch   1,  Average loss: 0.0011, Accuracy: 534/548 (97.4453%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.7523, Accuracy: 4909/10000 (49.0900%)
___Train Local_Simple,  epoch  39, local model 68, internal_epoch   1,  Average loss: 0.0013, Accuracy: 536/549 (97.6321%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.5493, Accuracy: 5148/10000 (51.4800%)
___Train Local_Simple,  epoch  39, local model 80, internal_epoch   1,  Average loss: 0.0024, Accuracy: 510/532 (95.8647%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 4.3997, Accuracy: 3245/10000 (32.4500%)
___Train Local_Simple,  epoch  39, local model 9, internal_epoch   1,  Average loss: 0.0010, Accuracy: 499/508 (98.2283%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.9896, Accuracy: 6969/10000 (69.6900%)
___Train Local_Simple,  epoch  39, local model 81, internal_epoch   1,  Average loss: 0.0011, Accuracy: 627/636 (98.5849%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.6486, Accuracy: 6169/10000 (61.6900%)
___Train Local_Simple,  epoch  39, local model 5, internal_epoch   1,  Average loss: 0.0009, Accuracy: 568/578 (98.2699%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.8052, Accuracy: 7806/10000 (78.0600%)
___Train Local_Simple,  epoch  39, local model 16, internal_epoch   1,  Average loss: 0.0007, Accuracy: 805/817 (98.5312%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 4.6356, Accuracy: 4183/10000 (41.8300%)
___Train Local_Simple,  epoch  39, local model 61, internal_epoch   1,  Average loss: 0.0012, Accuracy: 281/287 (97.9094%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.4107, Accuracy: 8734/10000 (87.3400%)
___Train Local_Simple,  epoch  39, local model 69, internal_epoch   1,  Average loss: 0.0015, Accuracy: 654/671 (97.4665%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 4.0090, Accuracy: 4068/10000 (40.6800%)
___Train Local_Simple,  epoch  39, local model 35, internal_epoch   1,  Average loss: 0.0016, Accuracy: 613/630 (97.3016%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 5.9029, Accuracy: 3691/10000 (36.9100%)
___Train Local_Simple,  epoch  39, local model 54, internal_epoch   1,  Average loss: 0.0007, Accuracy: 819/832 (98.4375%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 4.1723, Accuracy: 4062/10000 (40.6200%)
___Train Local_Simple,  epoch  39, local model 43, internal_epoch   1,  Average loss: 0.0009, Accuracy: 423/431 (98.1439%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.4001, Accuracy: 6578/10000 (65.7800%)
___Train Local_Simple,  epoch  39, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 713/725 (98.3448%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.4892, Accuracy: 5599/10000 (55.9900%)
___Train Local_Simple,  epoch  39, local model 46, internal_epoch   1,  Average loss: 0.0009, Accuracy: 637/650 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 4.0151, Accuracy: 4145/10000 (41.4500%)
___Train Local_Simple,  epoch  39, local model 66, internal_epoch   1,  Average loss: 0.0015, Accuracy: 713/733 (97.2715%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.8941, Accuracy: 4845/10000 (48.4500%)
___Train Local_Simple,  epoch  39, local model 52, internal_epoch   1,  Average loss: 0.0009, Accuracy: 769/789 (97.4651%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 4.6589, Accuracy: 4243/10000 (42.4300%)
___Train Local_Simple,  epoch  39, local model 36, internal_epoch   1,  Average loss: 0.0008, Accuracy: 309/315 (98.0952%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.3416, Accuracy: 8893/10000 (88.9300%)
___Train Local_Simple,  epoch  39, local model 92, internal_epoch   1,  Average loss: 0.0021, Accuracy: 581/611 (95.0900%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.7331, Accuracy: 3851/10000 (38.5100%)
___Train Local_Simple,  epoch  39, local model 96, internal_epoch   1,  Average loss: 0.0016, Accuracy: 516/531 (97.1751%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 4.1073, Accuracy: 4285/10000 (42.8500%)
___Train Local_Simple,  epoch  39, local model 97, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1097/1112 (98.6511%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 5.1394, Accuracy: 3398/10000 (33.9800%)
___Train Local_Simple,  epoch  39, local model 17, internal_epoch   1,  Average loss: 0.0009, Accuracy: 516/527 (97.9127%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.5267, Accuracy: 5143/10000 (51.4300%)
___Train Local_Simple,  epoch  39, local model 26, internal_epoch   1,  Average loss: 0.0008, Accuracy: 513/519 (98.8439%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.7990, Accuracy: 5839/10000 (58.3900%)
___Train Local_Simple,  epoch  39, local model 58, internal_epoch   1,  Average loss: 0.0006, Accuracy: 767/772 (99.3523%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.8179, Accuracy: 6052/10000 (60.5200%)
___Train Local_Simple,  epoch  39, local model 63, internal_epoch   1,  Average loss: 0.0016, Accuracy: 295/303 (97.3597%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.1317, Accuracy: 7355/10000 (73.5500%)
___Train Local_Simple,  epoch  39, local model 38, internal_epoch   1,  Average loss: 0.0008, Accuracy: 467/477 (97.9036%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.7200, Accuracy: 8028/10000 (80.2800%)
___Train Local_Simple,  epoch  39, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 544/561 (96.9697%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.7438, Accuracy: 5922/10000 (59.2200%)
___Train Local_Simple,  epoch  39, local model 30, internal_epoch   1,  Average loss: 0.0012, Accuracy: 436/443 (98.4199%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.8731, Accuracy: 6846/10000 (68.4600%)
___Train Local_Simple,  epoch  39, local model 34, internal_epoch   1,  Average loss: 0.0012, Accuracy: 855/871 (98.1630%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 4.7129, Accuracy: 4277/10000 (42.7700%)
___Train Local_Simple,  epoch  39, local model 59, internal_epoch   1,  Average loss: 0.0008, Accuracy: 635/644 (98.6025%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 3.7480, Accuracy: 4395/10000 (43.9500%)
___Train Local_Simple,  epoch  39, local model 21, internal_epoch   1,  Average loss: 0.0008, Accuracy: 677/687 (98.5444%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 3.3444, Accuracy: 4508/10000 (45.0800%)
___Train Local_Simple,  epoch  39, local model 15, internal_epoch   1,  Average loss: 0.0011, Accuracy: 280/282 (99.2908%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.5652, Accuracy: 8138/10000 (81.3800%)
___Train Local_Simple,  epoch  39, local model 49, internal_epoch   1,  Average loss: 0.0012, Accuracy: 346/355 (97.4648%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.1534, Accuracy: 6488/10000 (64.8800%)
___Train Local_Simple,  epoch  39, local model 1, internal_epoch   1,  Average loss: 0.0005, Accuracy: 533/536 (99.4403%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.5354, Accuracy: 8513/10000 (85.1300%)
___Train Local_Simple,  epoch  39, local model 25, internal_epoch   1,  Average loss: 0.0007, Accuracy: 586/592 (98.9865%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 3.0717, Accuracy: 5665/10000 (56.6500%)
___Train Local_Simple,  epoch  39, local model 0, internal_epoch   1,  Average loss: 0.0008, Accuracy: 430/435 (98.8506%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.3353, Accuracy: 6435/10000 (64.3500%)
___Train Local_Simple,  epoch  39, local model 56, internal_epoch   1,  Average loss: 0.0005, Accuracy: 708/715 (99.0210%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.9988, Accuracy: 5311/10000 (53.1100%)
___Train Local_Simple,  epoch  39, local model 53, internal_epoch   1,  Average loss: 0.0011, Accuracy: 548/561 (97.6827%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 3.2335, Accuracy: 4983/10000 (49.8300%)
___Train Local_Simple,  epoch  39, local model 47, internal_epoch   1,  Average loss: 0.0010, Accuracy: 526/534 (98.5019%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.3878, Accuracy: 5272/10000 (52.7200%)
___Train Local_Simple,  epoch  39, local model 72, internal_epoch   1,  Average loss: 0.0017, Accuracy: 408/423 (96.4539%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.5387, Accuracy: 4452/10000 (44.5200%)
___Train Local_Simple,  epoch  39, local model 37, internal_epoch   1,  Average loss: 0.0007, Accuracy: 452/456 (99.1228%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.1377, Accuracy: 6880/10000 (68.8000%)
___Train Local_Simple,  epoch  39, local model 95, internal_epoch   1,  Average loss: 0.0016, Accuracy: 581/600 (96.8333%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.9443, Accuracy: 5148/10000 (51.4800%)
___Train Local_Simple,  epoch  39, local model 45, internal_epoch   1,  Average loss: 0.0009, Accuracy: 640/647 (98.9181%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.2786, Accuracy: 4844/10000 (48.4400%)
___Train Local_Simple,  epoch  39, local model 28, internal_epoch   1,  Average loss: 0.0007, Accuracy: 600/611 (98.1997%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.7241, Accuracy: 6386/10000 (63.8600%)
___Train Local_Simple,  epoch  39, local model 2, internal_epoch   1,  Average loss: 0.0012, Accuracy: 552/564 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.0540, Accuracy: 5843/10000 (58.4300%)
___Train Local_Simple,  epoch  39, local model 87, internal_epoch   1,  Average loss: 0.0009, Accuracy: 650/663 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.8069, Accuracy: 4972/10000 (49.7200%)
___Train Local_Simple,  epoch  39, local model 78, internal_epoch   1,  Average loss: 0.0035, Accuracy: 572/587 (97.4446%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 6.6050, Accuracy: 2136/10000 (21.3600%)
___Train Local_Simple,  epoch  39, local model 42, internal_epoch   1,  Average loss: 0.0004, Accuracy: 471/473 (99.5772%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.6478, Accuracy: 7885/10000 (78.8500%)
___Train Local_Simple,  epoch  39, local model 86, internal_epoch   1,  Average loss: 0.0004, Accuracy: 688/692 (99.4220%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.1909, Accuracy: 5410/10000 (54.1000%)
___Train Local_Simple,  epoch  39, local model 40, internal_epoch   1,  Average loss: 0.0004, Accuracy: 495/498 (99.3976%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.4830, Accuracy: 6260/10000 (62.6000%)
___Train Local_Simple,  epoch  39, local model 79, internal_epoch   1,  Average loss: 0.0011, Accuracy: 652/661 (98.6384%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.5631, Accuracy: 4453/10000 (44.5300%)
___Train Local_Simple,  epoch  39, local model 94, internal_epoch   1,  Average loss: 0.0008, Accuracy: 660/671 (98.3607%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.7214, Accuracy: 5618/10000 (56.1800%)
___Train Local_Simple,  epoch  39, local model 82, internal_epoch   1,  Average loss: 0.0007, Accuracy: 805/815 (98.7730%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 3.4846, Accuracy: 4186/10000 (41.8600%)
___Train Local_Simple,  epoch  39, local model 24, internal_epoch   1,  Average loss: 0.0016, Accuracy: 465/477 (97.4843%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.9342, Accuracy: 5527/10000 (55.2700%)
___Train Local_Simple,  epoch  39, local model 67, internal_epoch   1,  Average loss: 0.0013, Accuracy: 429/441 (97.2789%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.5352, Accuracy: 5853/10000 (58.5300%)
___Train Local_Simple,  epoch  39, local model 64, internal_epoch   1,  Average loss: 0.0005, Accuracy: 601/608 (98.8487%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 3.6295, Accuracy: 4184/10000 (41.8400%)
___Train Local_Simple,  epoch  39, local model 11, internal_epoch   1,  Average loss: 0.0009, Accuracy: 543/554 (98.0144%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.5369, Accuracy: 6753/10000 (67.5300%)
___Train Local_Simple,  epoch  39, local model 76, internal_epoch   1,  Average loss: 0.0021, Accuracy: 446/459 (97.1678%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.2912, Accuracy: 7490/10000 (74.9000%)
___Train Local_Simple,  epoch  39, local model 31, internal_epoch   1,  Average loss: 0.0010, Accuracy: 584/596 (97.9866%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.7802, Accuracy: 4867/10000 (48.6700%)
___Train Local_Simple,  epoch  39, local model 93, internal_epoch   1,  Average loss: 0.0014, Accuracy: 609/630 (96.6667%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 6.2477, Accuracy: 2995/10000 (29.9500%)
___Train Local_Simple,  epoch  39, local model 27, internal_epoch   1,  Average loss: 0.0008, Accuracy: 732/745 (98.2550%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.3914, Accuracy: 4745/10000 (47.4500%)
___Train Local_Simple,  epoch  39, local model 99, internal_epoch   1,  Average loss: 0.0015, Accuracy: 691/712 (97.0506%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 3.3279, Accuracy: 3729/10000 (37.2900%)
___Train Local_Simple,  epoch  39, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 698/713 (97.8962%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 5.5248, Accuracy: 3116/10000 (31.1600%)
___Train Local_Simple,  epoch  39, local model 8, internal_epoch   1,  Average loss: 0.0006, Accuracy: 700/706 (99.1501%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 3.0712, Accuracy: 4910/10000 (49.1000%)
___Train Local_Simple,  epoch  39, local model 75, internal_epoch   1,  Average loss: 0.0015, Accuracy: 742/763 (97.2477%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 3.7940, Accuracy: 3965/10000 (39.6500%)
___Train Local_Simple,  epoch  39, local model 65, internal_epoch   1,  Average loss: 0.0016, Accuracy: 599/621 (96.4573%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.8256, Accuracy: 4897/10000 (48.9700%)
___Train Local_Simple,  epoch  39, local model 44, internal_epoch   1,  Average loss: 0.0006, Accuracy: 555/561 (98.9305%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 3.3705, Accuracy: 5372/10000 (53.7200%)
___Train Local_Simple,  epoch  39, local model 84, internal_epoch   1,  Average loss: 0.0020, Accuracy: 406/420 (96.6667%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.2130, Accuracy: 7113/10000 (71.1300%)
___Train Local_Simple,  epoch  39, local model 7, internal_epoch   1,  Average loss: 0.0005, Accuracy: 796/802 (99.2519%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.8892, Accuracy: 6278/10000 (62.7800%)
___Train Local_Simple,  epoch  39, local model 85, internal_epoch   1,  Average loss: 0.0014, Accuracy: 781/807 (96.7782%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.0374, Accuracy: 6087/10000 (60.8700%)
___Train Local_Simple,  epoch  39, local model 20, internal_epoch   1,  Average loss: 0.0011, Accuracy: 589/602 (97.8405%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.3434, Accuracy: 5998/10000 (59.9800%)
___Train Local_Simple,  epoch  39, local model 19, internal_epoch   1,  Average loss: 0.0009, Accuracy: 585/598 (97.8261%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 3.0760, Accuracy: 4685/10000 (46.8500%)
___Train Local_Simple,  epoch  39, local model 89, internal_epoch   1,  Average loss: 0.0014, Accuracy: 665/683 (97.3646%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.4310, Accuracy: 5600/10000 (56.0000%)
time spent on training: 373.6962637901306
___Test Target_Simple poisoned: False, epoch: 39: Average loss: 0.1274, Accuracy: 9660/10000 (96.6000%)
___Test Target_Simple poisoned: True, epoch: 39: Average loss: 3.9178, Accuracy: 523/8968 (5.8318%)
saving model
Saving model on epoch 39
Done in 407.0261766910553 sec.
Server Epoch:40 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 0, 8, 15, 57, 39, 11, 86, 71, 63, 36, 92, 47, 19, 81, 91, 24, 13, 59, 12, 1, 58, 20, 32, 14, 35, 76, 99, 83, 87, 44, 95, 94, 65, 89, 30, 61, 5, 79, 77, 40, 9, 25, 4, 22, 16, 80, 26, 98, 27, 54, 93, 60, 78, 72, 90, 48, 10, 21, 38, 23, 52, 70, 96, 7, 43, 68, 75, 34, 37, 31, 50, 28, 67, 64, 6, 42, 46, 84, 56, 17, 82, 49, 45, 53, 97, 85, 66, 69, 55, 2].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   1,  Average loss: 0.0217, Accuracy: 283/569 (49.7364%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   2,  Average loss: 0.0112, Accuracy: 358/569 (62.9174%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   3,  Average loss: 0.0067, Accuracy: 458/569 (80.4921%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   4,  Average loss: 0.0055, Accuracy: 491/569 (86.2917%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   5,  Average loss: 0.0044, Accuracy: 505/569 (88.7522%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   6,  Average loss: 0.0032, Accuracy: 548/569 (96.3093%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   7,  Average loss: 0.0024, Accuracy: 555/569 (97.5395%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   8,  Average loss: 0.0017, Accuracy: 561/569 (98.5940%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch   9,  Average loss: 0.0014, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 41, internal_epoch  10,  Average loss: 0.0014, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Global model norm: 15.435725677701894.
Norm before scaling: 15.652075174729728. Distance: 3.498492052301198
Total norm for 10 adversaries is: 15.652075174729728. distance: 3.498492052301198
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.4761, Accuracy: 6834/8968 (76.2043%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   1,  Average loss: 0.0132, Accuracy: 364/522 (69.7318%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   2,  Average loss: 0.0059, Accuracy: 423/522 (81.0345%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   3,  Average loss: 0.0021, Accuracy: 509/522 (97.5096%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   4,  Average loss: 0.0017, Accuracy: 512/522 (98.0843%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   5,  Average loss: 0.0013, Accuracy: 515/522 (98.6590%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   6,  Average loss: 0.0010, Accuracy: 518/522 (99.2337%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   7,  Average loss: 0.0006, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   8,  Average loss: 0.0007, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   9,  Average loss: 0.0006, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch  10,  Average loss: 0.0006, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Global model norm: 15.435725677701894.
Norm before scaling: 15.568985043607883. Distance: 2.771755772448805
Total norm for 10 adversaries is: 15.568985043607883. distance: 2.771755772448805
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0236, Accuracy: 8881/8968 (99.0299%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   1,  Average loss: 0.0201, Accuracy: 201/385 (52.2078%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   2,  Average loss: 0.0113, Accuracy: 276/385 (71.6883%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   3,  Average loss: 0.0058, Accuracy: 358/385 (92.9870%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   4,  Average loss: 0.0051, Accuracy: 371/385 (96.3636%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   5,  Average loss: 0.0043, Accuracy: 372/385 (96.6234%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   6,  Average loss: 0.0032, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   7,  Average loss: 0.0028, Accuracy: 379/385 (98.4416%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   8,  Average loss: 0.0020, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   9,  Average loss: 0.0018, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch  10,  Average loss: 0.0018, Accuracy: 379/385 (98.4416%), train_poison_data_count: 193
Global model norm: 15.435725677701894.
Norm before scaling: 15.57996243551914. Distance: 2.9548042810884403
Total norm for 10 adversaries is: 15.57996243551914. distance: 2.9548042810884403
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.1340, Accuracy: 8583/8968 (95.7070%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   1,  Average loss: 0.0065, Accuracy: 528/627 (84.2105%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   2,  Average loss: 0.0017, Accuracy: 605/627 (96.4912%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   3,  Average loss: 0.0007, Accuracy: 620/627 (98.8836%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   4,  Average loss: 0.0007, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   5,  Average loss: 0.0011, Accuracy: 613/627 (97.7671%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   6,  Average loss: 0.0011, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   7,  Average loss: 0.0007, Accuracy: 621/627 (99.0431%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   8,  Average loss: 0.0006, Accuracy: 620/627 (98.8836%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch   9,  Average loss: 0.0006, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 74, internal_epoch  10,  Average loss: 0.0005, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Global model norm: 15.435725677701894.
Norm before scaling: 15.615228878399595. Distance: 2.3231196521515827
Total norm for 10 adversaries is: 15.615228878399595. distance: 2.3231196521515827
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0043, Accuracy: 8952/8968 (99.8216%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 3, internal_epoch   1,  Average loss: 0.0253, Accuracy: 250/516 (48.4496%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 3, internal_epoch   2,  Average loss: 0.0133, Accuracy: 298/516 (57.7519%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 3, internal_epoch   3,  Average loss: 0.0097, Accuracy: 333/516 (64.5349%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 3, internal_epoch   4,  Average loss: 0.0075, Accuracy: 450/516 (87.2093%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 3, internal_epoch   5,  Average loss: 0.0054, Accuracy: 467/516 (90.5039%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 3, internal_epoch   6,  Average loss: 0.0039, Accuracy: 483/516 (93.6047%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 3, internal_epoch   7,  Average loss: 0.0026, Accuracy: 501/516 (97.0930%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 3, internal_epoch   8,  Average loss: 0.0016, Accuracy: 511/516 (99.0310%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 3, internal_epoch   9,  Average loss: 0.0015, Accuracy: 511/516 (99.0310%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 3, internal_epoch  10,  Average loss: 0.0016, Accuracy: 510/516 (98.8372%), train_poison_data_count: 260
Global model norm: 15.435725677701894.
Norm before scaling: 15.728807996824697. Distance: 4.200380925660707
Total norm for 10 adversaries is: 15.728807996824697. distance: 4.200380925660707
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.4180, Accuracy: 7276/8968 (81.1329%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 18, internal_epoch   1,  Average loss: 0.0173, Accuracy: 450/759 (59.2885%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 18, internal_epoch   2,  Average loss: 0.0031, Accuracy: 701/759 (92.3584%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 18, internal_epoch   3,  Average loss: 0.0006, Accuracy: 751/759 (98.9460%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 18, internal_epoch   4,  Average loss: 0.0003, Accuracy: 754/759 (99.3412%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 18, internal_epoch   5,  Average loss: 0.0002, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 18, internal_epoch   6,  Average loss: 0.0003, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 18, internal_epoch   7,  Average loss: 0.0002, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 18, internal_epoch   8,  Average loss: 0.0001, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 18, internal_epoch   9,  Average loss: 0.0003, Accuracy: 754/759 (99.3412%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 18, internal_epoch  10,  Average loss: 0.0002, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Global model norm: 15.435725677701894.
Norm before scaling: 15.87617356175255. Distance: 4.12391047105077
Total norm for 10 adversaries is: 15.87617356175255. distance: 4.12391047105077
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0172, Accuracy: 8906/8968 (99.3087%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 29, internal_epoch   1,  Average loss: 0.0181, Accuracy: 312/506 (61.6601%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 29, internal_epoch   2,  Average loss: 0.0049, Accuracy: 467/506 (92.2925%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 29, internal_epoch   3,  Average loss: 0.0012, Accuracy: 496/506 (98.0237%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 29, internal_epoch   4,  Average loss: 0.0010, Accuracy: 499/506 (98.6166%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 29, internal_epoch   5,  Average loss: 0.0008, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 29, internal_epoch   6,  Average loss: 0.0007, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 29, internal_epoch   7,  Average loss: 0.0008, Accuracy: 497/506 (98.2213%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 29, internal_epoch   8,  Average loss: 0.0005, Accuracy: 500/506 (98.8142%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 29, internal_epoch   9,  Average loss: 0.0005, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 29, internal_epoch  10,  Average loss: 0.0003, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Global model norm: 15.435725677701894.
Norm before scaling: 15.744203499944234. Distance: 3.3319405188958524
Total norm for 10 adversaries is: 15.744203499944234. distance: 3.3319405188958524
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.4267, Accuracy: 7569/8968 (84.4001%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 62, internal_epoch   1,  Average loss: 0.0079, Accuracy: 479/580 (82.5862%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 62, internal_epoch   2,  Average loss: 0.0020, Accuracy: 555/580 (95.6897%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 62, internal_epoch   3,  Average loss: 0.0016, Accuracy: 561/580 (96.7241%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 62, internal_epoch   4,  Average loss: 0.0009, Accuracy: 567/580 (97.7586%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 62, internal_epoch   5,  Average loss: 0.0010, Accuracy: 570/580 (98.2759%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 62, internal_epoch   6,  Average loss: 0.0009, Accuracy: 570/580 (98.2759%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 62, internal_epoch   7,  Average loss: 0.0009, Accuracy: 573/580 (98.7931%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 62, internal_epoch   8,  Average loss: 0.0007, Accuracy: 574/580 (98.9655%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 62, internal_epoch   9,  Average loss: 0.0009, Accuracy: 568/580 (97.9310%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 62, internal_epoch  10,  Average loss: 0.0009, Accuracy: 570/580 (98.2759%), train_poison_data_count: 292
Global model norm: 15.435725677701894.
Norm before scaling: 15.662346480972737. Distance: 2.490254672098655
Total norm for 10 adversaries is: 15.662346480972737. distance: 2.490254672098655
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0221, Accuracy: 8886/8968 (99.0856%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 33, internal_epoch   1,  Average loss: 0.0224, Accuracy: 295/587 (50.2555%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 33, internal_epoch   2,  Average loss: 0.0101, Accuracy: 432/587 (73.5945%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 33, internal_epoch   3,  Average loss: 0.0041, Accuracy: 553/587 (94.2078%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 33, internal_epoch   4,  Average loss: 0.0021, Accuracy: 578/587 (98.4668%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 33, internal_epoch   5,  Average loss: 0.0013, Accuracy: 582/587 (99.1482%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 33, internal_epoch   6,  Average loss: 0.0010, Accuracy: 583/587 (99.3186%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 33, internal_epoch   7,  Average loss: 0.0009, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 33, internal_epoch   8,  Average loss: 0.0007, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 33, internal_epoch   9,  Average loss: 0.0006, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 33, internal_epoch  10,  Average loss: 0.0007, Accuracy: 583/587 (99.3186%), train_poison_data_count: 299
Global model norm: 15.435725677701894.
Norm before scaling: 15.760128095077215. Distance: 3.792758295445532
Total norm for 10 adversaries is: 15.760128095077215. distance: 3.792758295445532
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.6771, Accuracy: 6505/8968 (72.5357%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 88, internal_epoch   1,  Average loss: 0.0137, Accuracy: 498/734 (67.8474%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 88, internal_epoch   2,  Average loss: 0.0045, Accuracy: 638/734 (86.9210%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 88, internal_epoch   3,  Average loss: 0.0015, Accuracy: 707/734 (96.3215%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 88, internal_epoch   4,  Average loss: 0.0012, Accuracy: 711/734 (96.8665%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 88, internal_epoch   5,  Average loss: 0.0008, Accuracy: 722/734 (98.3651%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 88, internal_epoch   6,  Average loss: 0.0008, Accuracy: 720/734 (98.0926%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 88, internal_epoch   7,  Average loss: 0.0007, Accuracy: 727/734 (99.0463%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 88, internal_epoch   8,  Average loss: 0.0005, Accuracy: 728/734 (99.1826%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 88, internal_epoch   9,  Average loss: 0.0006, Accuracy: 725/734 (98.7738%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 88, internal_epoch  10,  Average loss: 0.0007, Accuracy: 722/734 (98.3651%), train_poison_data_count: 382
Global model norm: 15.435725677701894.
Norm before scaling: 15.709254769873862. Distance: 3.3146345350785285
Total norm for 10 adversaries is: 15.709254769873862. distance: 3.3146345350785285
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0564, Accuracy: 8784/8968 (97.9483%)
___Train Local_Simple,  epoch  40, local model 0, internal_epoch   1,  Average loss: 0.0009, Accuracy: 428/435 (98.3908%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 2.2687, Accuracy: 5936/10000 (59.3600%)
___Train Local_Simple,  epoch  40, local model 8, internal_epoch   1,  Average loss: 0.0011, Accuracy: 692/706 (98.0170%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 2.4301, Accuracy: 4615/10000 (46.1500%)
___Train Local_Simple,  epoch  40, local model 15, internal_epoch   1,  Average loss: 0.0008, Accuracy: 280/282 (99.2908%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.3885, Accuracy: 8650/10000 (86.5000%)
___Train Local_Simple,  epoch  40, local model 57, internal_epoch   1,  Average loss: 0.0008, Accuracy: 513/523 (98.0880%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 2.0851, Accuracy: 5227/10000 (52.2700%)
___Train Local_Simple,  epoch  40, local model 39, internal_epoch   1,  Average loss: 0.0008, Accuracy: 484/493 (98.1744%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.2130, Accuracy: 6858/10000 (68.5800%)
___Train Local_Simple,  epoch  40, local model 11, internal_epoch   1,  Average loss: 0.0008, Accuracy: 546/554 (98.5560%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.8059, Accuracy: 7829/10000 (78.2900%)
___Train Local_Simple,  epoch  40, local model 86, internal_epoch   1,  Average loss: 0.0007, Accuracy: 683/692 (98.6994%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 4.1491, Accuracy: 3654/10000 (36.5400%)
___Train Local_Simple,  epoch  40, local model 71, internal_epoch   1,  Average loss: 0.0011, Accuracy: 547/561 (97.5045%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.1502, Accuracy: 6624/10000 (66.2400%)
___Train Local_Simple,  epoch  40, local model 63, internal_epoch   1,  Average loss: 0.0016, Accuracy: 292/303 (96.3696%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.9842, Accuracy: 5755/10000 (57.5500%)
___Train Local_Simple,  epoch  40, local model 36, internal_epoch   1,  Average loss: 0.0008, Accuracy: 311/315 (98.7302%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2655, Accuracy: 9096/10000 (90.9600%)
___Train Local_Simple,  epoch  40, local model 92, internal_epoch   1,  Average loss: 0.0025, Accuracy: 578/611 (94.5990%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 4.9094, Accuracy: 2923/10000 (29.2300%)
___Train Local_Simple,  epoch  40, local model 47, internal_epoch   1,  Average loss: 0.0013, Accuracy: 526/534 (98.5019%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 3.2514, Accuracy: 5191/10000 (51.9100%)
___Train Local_Simple,  epoch  40, local model 19, internal_epoch   1,  Average loss: 0.0010, Accuracy: 587/598 (98.1605%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.4144, Accuracy: 6099/10000 (60.9900%)
___Train Local_Simple,  epoch  40, local model 81, internal_epoch   1,  Average loss: 0.0015, Accuracy: 622/636 (97.7987%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 3.1064, Accuracy: 3910/10000 (39.1000%)
___Train Local_Simple,  epoch  40, local model 91, internal_epoch   1,  Average loss: 0.0006, Accuracy: 810/819 (98.9011%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 2.8523, Accuracy: 4979/10000 (49.7900%)
___Train Local_Simple,  epoch  40, local model 24, internal_epoch   1,  Average loss: 0.0013, Accuracy: 466/477 (97.6939%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.9368, Accuracy: 6740/10000 (67.4000%)
___Train Local_Simple,  epoch  40, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 699/713 (98.0365%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 2.3101, Accuracy: 5029/10000 (50.2900%)
___Train Local_Simple,  epoch  40, local model 59, internal_epoch   1,  Average loss: 0.0010, Accuracy: 631/644 (97.9814%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 2.1846, Accuracy: 5324/10000 (53.2400%)
___Train Local_Simple,  epoch  40, local model 12, internal_epoch   1,  Average loss: 0.0009, Accuracy: 717/725 (98.8966%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.9564, Accuracy: 7909/10000 (79.0900%)
___Train Local_Simple,  epoch  40, local model 1, internal_epoch   1,  Average loss: 0.0004, Accuracy: 535/536 (99.8134%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2627, Accuracy: 9152/10000 (91.5200%)
___Train Local_Simple,  epoch  40, local model 58, internal_epoch   1,  Average loss: 0.0007, Accuracy: 761/772 (98.5751%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 2.5423, Accuracy: 5647/10000 (56.4700%)
___Train Local_Simple,  epoch  40, local model 20, internal_epoch   1,  Average loss: 0.0007, Accuracy: 594/602 (98.6711%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.6262, Accuracy: 6134/10000 (61.3400%)
___Train Local_Simple,  epoch  40, local model 32, internal_epoch   1,  Average loss: 0.0010, Accuracy: 582/590 (98.6441%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 3.8033, Accuracy: 5065/10000 (50.6500%)
___Train Local_Simple,  epoch  40, local model 14, internal_epoch   1,  Average loss: 0.0011, Accuracy: 676/692 (97.6879%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.8038, Accuracy: 5492/10000 (54.9200%)
___Train Local_Simple,  epoch  40, local model 35, internal_epoch   1,  Average loss: 0.0011, Accuracy: 617/630 (97.9365%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 4.9502, Accuracy: 3772/10000 (37.7200%)
___Train Local_Simple,  epoch  40, local model 76, internal_epoch   1,  Average loss: 0.0011, Accuracy: 453/459 (98.6928%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.4870, Accuracy: 8409/10000 (84.0900%)
___Train Local_Simple,  epoch  40, local model 99, internal_epoch   1,  Average loss: 0.0022, Accuracy: 681/712 (95.6461%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 3.3373, Accuracy: 3520/10000 (35.2000%)
___Train Local_Simple,  epoch  40, local model 83, internal_epoch   1,  Average loss: 0.0011, Accuracy: 353/360 (98.0556%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.3192, Accuracy: 8979/10000 (89.7900%)
___Train Local_Simple,  epoch  40, local model 87, internal_epoch   1,  Average loss: 0.0011, Accuracy: 652/663 (98.3409%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 5.9437, Accuracy: 3625/10000 (36.2500%)
___Train Local_Simple,  epoch  40, local model 44, internal_epoch   1,  Average loss: 0.0004, Accuracy: 558/561 (99.4652%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.4477, Accuracy: 6867/10000 (68.6700%)
___Train Local_Simple,  epoch  40, local model 95, internal_epoch   1,  Average loss: 0.0019, Accuracy: 576/600 (96.0000%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 5.4369, Accuracy: 3653/10000 (36.5300%)
___Train Local_Simple,  epoch  40, local model 94, internal_epoch   1,  Average loss: 0.0006, Accuracy: 665/671 (99.1058%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 2.6811, Accuracy: 5853/10000 (58.5300%)
___Train Local_Simple,  epoch  40, local model 65, internal_epoch   1,  Average loss: 0.0014, Accuracy: 603/621 (97.1014%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.2325, Accuracy: 5895/10000 (58.9500%)
___Train Local_Simple,  epoch  40, local model 89, internal_epoch   1,  Average loss: 0.0019, Accuracy: 660/683 (96.6325%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 3.5937, Accuracy: 4312/10000 (43.1200%)
___Train Local_Simple,  epoch  40, local model 30, internal_epoch   1,  Average loss: 0.0008, Accuracy: 437/443 (98.6456%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.0211, Accuracy: 7423/10000 (74.2300%)
___Train Local_Simple,  epoch  40, local model 61, internal_epoch   1,  Average loss: 0.0011, Accuracy: 283/287 (98.6063%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.3008, Accuracy: 9038/10000 (90.3800%)
___Train Local_Simple,  epoch  40, local model 5, internal_epoch   1,  Average loss: 0.0009, Accuracy: 566/578 (97.9239%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.1193, Accuracy: 7069/10000 (70.6900%)
___Train Local_Simple,  epoch  40, local model 79, internal_epoch   1,  Average loss: 0.0012, Accuracy: 653/661 (98.7897%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.6971, Accuracy: 5340/10000 (53.4000%)
___Train Local_Simple,  epoch  40, local model 77, internal_epoch   1,  Average loss: 0.0015, Accuracy: 599/618 (96.9256%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 3.5376, Accuracy: 4944/10000 (49.4400%)
___Train Local_Simple,  epoch  40, local model 40, internal_epoch   1,  Average loss: 0.0008, Accuracy: 493/498 (98.9960%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 3.5152, Accuracy: 5524/10000 (55.2400%)
___Train Local_Simple,  epoch  40, local model 9, internal_epoch   1,  Average loss: 0.0011, Accuracy: 499/508 (98.2283%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.2230, Accuracy: 6557/10000 (65.5700%)
___Train Local_Simple,  epoch  40, local model 25, internal_epoch   1,  Average loss: 0.0004, Accuracy: 589/592 (99.4932%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.8764, Accuracy: 7730/10000 (77.3000%)
___Train Local_Simple,  epoch  40, local model 4, internal_epoch   1,  Average loss: 0.0006, Accuracy: 740/748 (98.9305%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.7111, Accuracy: 5948/10000 (59.4800%)
___Train Local_Simple,  epoch  40, local model 22, internal_epoch   1,  Average loss: 0.0005, Accuracy: 261/262 (99.6183%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.3410, Accuracy: 8860/10000 (88.6000%)
___Train Local_Simple,  epoch  40, local model 16, internal_epoch   1,  Average loss: 0.0003, Accuracy: 811/817 (99.2656%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 2.0332, Accuracy: 5910/10000 (59.1000%)
___Train Local_Simple,  epoch  40, local model 80, internal_epoch   1,  Average loss: 0.0020, Accuracy: 512/532 (96.2406%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 3.8259, Accuracy: 3112/10000 (31.1200%)
___Train Local_Simple,  epoch  40, local model 26, internal_epoch   1,  Average loss: 0.0012, Accuracy: 510/519 (98.2659%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 2.8337, Accuracy: 5100/10000 (51.0000%)
___Train Local_Simple,  epoch  40, local model 98, internal_epoch   1,  Average loss: 0.0015, Accuracy: 529/548 (96.5328%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 4.8611, Accuracy: 3452/10000 (34.5200%)
___Train Local_Simple,  epoch  40, local model 27, internal_epoch   1,  Average loss: 0.0029, Accuracy: 717/745 (96.2416%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 5.8533, Accuracy: 2906/10000 (29.0600%)
___Train Local_Simple,  epoch  40, local model 54, internal_epoch   1,  Average loss: 0.0008, Accuracy: 820/832 (98.5577%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 4.1336, Accuracy: 4093/10000 (40.9300%)
___Train Local_Simple,  epoch  40, local model 93, internal_epoch   1,  Average loss: 0.0018, Accuracy: 607/630 (96.3492%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 2.3217, Accuracy: 4163/10000 (41.6300%)
___Train Local_Simple,  epoch  40, local model 60, internal_epoch   1,  Average loss: 0.0014, Accuracy: 553/571 (96.8476%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 4.9107, Accuracy: 3003/10000 (30.0300%)
___Train Local_Simple,  epoch  40, local model 78, internal_epoch   1,  Average loss: 0.0021, Accuracy: 564/587 (96.0818%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 4.3562, Accuracy: 3098/10000 (30.9800%)
___Train Local_Simple,  epoch  40, local model 72, internal_epoch   1,  Average loss: 0.0016, Accuracy: 410/423 (96.9267%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 3.2361, Accuracy: 3127/10000 (31.2700%)
___Train Local_Simple,  epoch  40, local model 90, internal_epoch   1,  Average loss: 0.0010, Accuracy: 602/615 (97.8862%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 2.8664, Accuracy: 5406/10000 (54.0600%)
___Train Local_Simple,  epoch  40, local model 48, internal_epoch   1,  Average loss: 0.0012, Accuracy: 357/363 (98.3471%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.6297, Accuracy: 8079/10000 (80.7900%)
___Train Local_Simple,  epoch  40, local model 10, internal_epoch   1,  Average loss: 0.0011, Accuracy: 561/573 (97.9058%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.6107, Accuracy: 5531/10000 (55.3100%)
___Train Local_Simple,  epoch  40, local model 21, internal_epoch   1,  Average loss: 0.0007, Accuracy: 679/687 (98.8355%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.8372, Accuracy: 6015/10000 (60.1500%)
___Train Local_Simple,  epoch  40, local model 38, internal_epoch   1,  Average loss: 0.0008, Accuracy: 472/477 (98.9518%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.5038, Accuracy: 8466/10000 (84.6600%)
___Train Local_Simple,  epoch  40, local model 23, internal_epoch   1,  Average loss: 0.0013, Accuracy: 530/542 (97.7860%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.9172, Accuracy: 5731/10000 (57.3100%)
___Train Local_Simple,  epoch  40, local model 52, internal_epoch   1,  Average loss: 0.0013, Accuracy: 764/789 (96.8314%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 3.8274, Accuracy: 4869/10000 (48.6900%)
___Train Local_Simple,  epoch  40, local model 70, internal_epoch   1,  Average loss: 0.0016, Accuracy: 555/568 (97.7113%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 3.5668, Accuracy: 3687/10000 (36.8700%)
___Train Local_Simple,  epoch  40, local model 96, internal_epoch   1,  Average loss: 0.0006, Accuracy: 525/531 (98.8701%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 3.9364, Accuracy: 4356/10000 (43.5600%)
___Train Local_Simple,  epoch  40, local model 7, internal_epoch   1,  Average loss: 0.0005, Accuracy: 796/802 (99.2519%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.6426, Accuracy: 5688/10000 (56.8800%)
___Train Local_Simple,  epoch  40, local model 43, internal_epoch   1,  Average loss: 0.0006, Accuracy: 428/431 (99.3039%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.4962, Accuracy: 8333/10000 (83.3300%)
___Train Local_Simple,  epoch  40, local model 68, internal_epoch   1,  Average loss: 0.0015, Accuracy: 531/549 (96.7213%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 2.3492, Accuracy: 4504/10000 (45.0400%)
___Train Local_Simple,  epoch  40, local model 75, internal_epoch   1,  Average loss: 0.0014, Accuracy: 749/763 (98.1651%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 4.7833, Accuracy: 3651/10000 (36.5100%)
___Train Local_Simple,  epoch  40, local model 34, internal_epoch   1,  Average loss: 0.0010, Accuracy: 857/871 (98.3927%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 7.5105, Accuracy: 3066/10000 (30.6600%)
___Train Local_Simple,  epoch  40, local model 37, internal_epoch   1,  Average loss: 0.0024, Accuracy: 446/456 (97.8070%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 2.2660, Accuracy: 5210/10000 (52.1000%)
___Train Local_Simple,  epoch  40, local model 31, internal_epoch   1,  Average loss: 0.0006, Accuracy: 589/596 (98.8255%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.3763, Accuracy: 6317/10000 (63.1700%)
___Train Local_Simple,  epoch  40, local model 50, internal_epoch   1,  Average loss: 0.0010, Accuracy: 465/477 (97.4843%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.2629, Accuracy: 6338/10000 (63.3800%)
___Train Local_Simple,  epoch  40, local model 28, internal_epoch   1,  Average loss: 0.0012, Accuracy: 596/611 (97.5450%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 3.7273, Accuracy: 5227/10000 (52.2700%)
___Train Local_Simple,  epoch  40, local model 67, internal_epoch   1,  Average loss: 0.0017, Accuracy: 427/441 (96.8254%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.5934, Accuracy: 6000/10000 (60.0000%)
___Train Local_Simple,  epoch  40, local model 64, internal_epoch   1,  Average loss: 0.0007, Accuracy: 601/608 (98.8487%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 2.2880, Accuracy: 5350/10000 (53.5000%)
___Train Local_Simple,  epoch  40, local model 6, internal_epoch   1,  Average loss: 0.0008, Accuracy: 429/435 (98.6207%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.8629, Accuracy: 7470/10000 (74.7000%)
___Train Local_Simple,  epoch  40, local model 42, internal_epoch   1,  Average loss: 0.0004, Accuracy: 470/473 (99.3658%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.7976, Accuracy: 7428/10000 (74.2800%)
___Train Local_Simple,  epoch  40, local model 46, internal_epoch   1,  Average loss: 0.0007, Accuracy: 643/650 (98.9231%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 2.8041, Accuracy: 5026/10000 (50.2600%)
___Train Local_Simple,  epoch  40, local model 84, internal_epoch   1,  Average loss: 0.0009, Accuracy: 415/420 (98.8095%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.4373, Accuracy: 8583/10000 (85.8300%)
___Train Local_Simple,  epoch  40, local model 56, internal_epoch   1,  Average loss: 0.0007, Accuracy: 708/715 (99.0210%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.7795, Accuracy: 5679/10000 (56.7900%)
___Train Local_Simple,  epoch  40, local model 17, internal_epoch   1,  Average loss: 0.0005, Accuracy: 522/527 (99.0512%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.8385, Accuracy: 5936/10000 (59.3600%)
___Train Local_Simple,  epoch  40, local model 82, internal_epoch   1,  Average loss: 0.0008, Accuracy: 801/815 (98.2822%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 6.4148, Accuracy: 4027/10000 (40.2700%)
___Train Local_Simple,  epoch  40, local model 49, internal_epoch   1,  Average loss: 0.0015, Accuracy: 346/355 (97.4648%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.0022, Accuracy: 6934/10000 (69.3400%)
___Train Local_Simple,  epoch  40, local model 45, internal_epoch   1,  Average loss: 0.0010, Accuracy: 638/647 (98.6090%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 4.7105, Accuracy: 3516/10000 (35.1600%)
___Train Local_Simple,  epoch  40, local model 53, internal_epoch   1,  Average loss: 0.0007, Accuracy: 553/561 (98.5740%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.6313, Accuracy: 6259/10000 (62.5900%)
___Train Local_Simple,  epoch  40, local model 97, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1104/1112 (99.2806%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 3.4426, Accuracy: 4233/10000 (42.3300%)
___Train Local_Simple,  epoch  40, local model 85, internal_epoch   1,  Average loss: 0.0012, Accuracy: 791/807 (98.0173%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 2.9502, Accuracy: 4522/10000 (45.2200%)
___Train Local_Simple,  epoch  40, local model 66, internal_epoch   1,  Average loss: 0.0025, Accuracy: 701/733 (95.6344%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 3.8576, Accuracy: 4022/10000 (40.2200%)
___Train Local_Simple,  epoch  40, local model 69, internal_epoch   1,  Average loss: 0.0012, Accuracy: 659/671 (98.2116%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 5.4480, Accuracy: 3368/10000 (33.6800%)
___Train Local_Simple,  epoch  40, local model 55, internal_epoch   1,  Average loss: 0.0013, Accuracy: 368/375 (98.1333%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.9221, Accuracy: 7171/10000 (71.7100%)
___Train Local_Simple,  epoch  40, local model 2, internal_epoch   1,  Average loss: 0.0010, Accuracy: 555/564 (98.4043%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 2.5161, Accuracy: 4820/10000 (48.2000%)
time spent on training: 372.0500123500824
___Test Target_Simple poisoned: False, epoch: 40: Average loss: 0.1189, Accuracy: 9674/10000 (96.7400%)
___Test Target_Simple poisoned: True, epoch: 40: Average loss: 3.3781, Accuracy: 848/8968 (9.4558%)
saving model
Saving model on epoch 40
Done in 406.2443678379059 sec.
Server Epoch:41 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 81, 90, 59, 60, 94, 84, 99, 16, 75, 8, 76, 61, 49, 32, 92, 42, 52, 44, 0, 89, 26, 98, 55, 87, 54, 78, 77, 70, 13, 48, 97, 93, 63, 43, 22, 23, 86, 4, 85, 40, 5, 91, 25, 96, 19, 72, 53, 27, 46, 11, 56, 68, 1, 37, 95, 50, 17, 65, 45, 10, 69, 21, 9, 57, 28, 36, 82, 15, 83, 39, 24, 79, 12, 58, 20, 38, 30, 7, 47, 34, 14, 31, 71, 64, 67, 2, 66, 6, 80, 35].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   1,  Average loss: 0.0220, Accuracy: 287/569 (50.4394%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   2,  Average loss: 0.0107, Accuracy: 379/569 (66.6081%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   3,  Average loss: 0.0045, Accuracy: 514/569 (90.3339%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   4,  Average loss: 0.0034, Accuracy: 533/569 (93.6731%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   5,  Average loss: 0.0026, Accuracy: 551/569 (96.8366%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   6,  Average loss: 0.0015, Accuracy: 564/569 (99.1213%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   7,  Average loss: 0.0013, Accuracy: 563/569 (98.9455%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   8,  Average loss: 0.0008, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch   9,  Average loss: 0.0007, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 41, internal_epoch  10,  Average loss: 0.0007, Accuracy: 565/569 (99.2970%), train_poison_data_count: 288
Global model norm: 15.435030226114062.
Norm before scaling: 15.692148196300225. Distance: 3.6672954164740936
Total norm for 10 adversaries is: 15.692148196300225. distance: 3.6672954164740936
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.6766, Accuracy: 6085/8968 (67.8524%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   1,  Average loss: 0.0131, Accuracy: 370/522 (70.8812%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 451/522 (86.3985%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   3,  Average loss: 0.0018, Accuracy: 505/522 (96.7433%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   4,  Average loss: 0.0015, Accuracy: 510/522 (97.7011%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   5,  Average loss: 0.0011, Accuracy: 512/522 (98.0843%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   6,  Average loss: 0.0007, Accuracy: 518/522 (99.2337%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   7,  Average loss: 0.0005, Accuracy: 522/522 (100.0000%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   8,  Average loss: 0.0005, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch   9,  Average loss: 0.0005, Accuracy: 518/522 (99.2337%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 73, internal_epoch  10,  Average loss: 0.0005, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Global model norm: 15.435030226114062.
Norm before scaling: 15.589257458907952. Distance: 2.760918788706182
Total norm for 10 adversaries is: 15.589257458907952. distance: 2.760918788706182
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0226, Accuracy: 8885/8968 (99.0745%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   1,  Average loss: 0.0171, Accuracy: 220/385 (57.1429%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   2,  Average loss: 0.0054, Accuracy: 350/385 (90.9091%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   3,  Average loss: 0.0017, Accuracy: 376/385 (97.6623%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   4,  Average loss: 0.0020, Accuracy: 374/385 (97.1429%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   5,  Average loss: 0.0013, Accuracy: 378/385 (98.1818%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   6,  Average loss: 0.0013, Accuracy: 378/385 (98.1818%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   7,  Average loss: 0.0010, Accuracy: 379/385 (98.4416%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   8,  Average loss: 0.0007, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   9,  Average loss: 0.0006, Accuracy: 383/385 (99.4805%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch  10,  Average loss: 0.0007, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Global model norm: 15.435030226114062.
Norm before scaling: 15.650368078613798. Distance: 2.826525662731991
Total norm for 10 adversaries is: 15.650368078613798. distance: 2.826525662731991
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.1808, Accuracy: 8384/8968 (93.4880%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   1,  Average loss: 0.0054, Accuracy: 543/627 (86.6029%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   2,  Average loss: 0.0020, Accuracy: 606/627 (96.6507%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   3,  Average loss: 0.0010, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   4,  Average loss: 0.0008, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   5,  Average loss: 0.0006, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   6,  Average loss: 0.0008, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   7,  Average loss: 0.0005, Accuracy: 621/627 (99.0431%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   8,  Average loss: 0.0004, Accuracy: 624/627 (99.5215%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch   9,  Average loss: 0.0007, Accuracy: 620/627 (98.8836%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 74, internal_epoch  10,  Average loss: 0.0004, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Global model norm: 15.435030226114062.
Norm before scaling: 15.609703938757585. Distance: 2.3529390380653314
Total norm for 10 adversaries is: 15.609703938757585. distance: 2.3529390380653314
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0072, Accuracy: 8939/8968 (99.6766%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 3, internal_epoch   1,  Average loss: 0.0237, Accuracy: 249/516 (48.2558%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 3, internal_epoch   2,  Average loss: 0.0156, Accuracy: 283/516 (54.8450%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 3, internal_epoch   3,  Average loss: 0.0134, Accuracy: 257/516 (49.8062%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 3, internal_epoch   4,  Average loss: 0.0099, Accuracy: 357/516 (69.1860%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 3, internal_epoch   5,  Average loss: 0.0077, Accuracy: 448/516 (86.8217%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 3, internal_epoch   6,  Average loss: 0.0061, Accuracy: 448/516 (86.8217%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 3, internal_epoch   7,  Average loss: 0.0043, Accuracy: 475/516 (92.0543%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 3, internal_epoch   8,  Average loss: 0.0028, Accuracy: 498/516 (96.5116%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 3, internal_epoch   9,  Average loss: 0.0023, Accuracy: 504/516 (97.6744%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 3, internal_epoch  10,  Average loss: 0.0026, Accuracy: 502/516 (97.2868%), train_poison_data_count: 260
Global model norm: 15.435030226114062.
Norm before scaling: 15.680197425689313. Distance: 3.9433399065811523
Total norm for 10 adversaries is: 15.680197425689313. distance: 3.9433399065811523
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.7475, Accuracy: 6352/8968 (70.8296%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   1,  Average loss: 0.0193, Accuracy: 437/759 (57.5758%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   2,  Average loss: 0.0036, Accuracy: 700/759 (92.2266%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   3,  Average loss: 0.0007, Accuracy: 751/759 (98.9460%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   4,  Average loss: 0.0005, Accuracy: 753/759 (99.2095%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   5,  Average loss: 0.0003, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   6,  Average loss: 0.0004, Accuracy: 752/759 (99.0777%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   7,  Average loss: 0.0002, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   8,  Average loss: 0.0004, Accuracy: 754/759 (99.3412%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   9,  Average loss: 0.0003, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch  10,  Average loss: 0.0002, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Global model norm: 15.435030226114062.
Norm before scaling: 16.00131887722218. Distance: 4.7716816421435455
Total norm for 10 adversaries is: 16.00131887722218. distance: 4.7716816421435455
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.2662, Accuracy: 8309/8968 (92.6517%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   1,  Average loss: 0.0181, Accuracy: 304/506 (60.0791%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   2,  Average loss: 0.0063, Accuracy: 440/506 (86.9565%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   3,  Average loss: 0.0013, Accuracy: 500/506 (98.8142%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   4,  Average loss: 0.0012, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   5,  Average loss: 0.0012, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   6,  Average loss: 0.0009, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   7,  Average loss: 0.0007, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   8,  Average loss: 0.0007, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   9,  Average loss: 0.0006, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch  10,  Average loss: 0.0007, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Global model norm: 15.435030226114062.
Norm before scaling: 15.816803237330781. Distance: 3.5691575868146534
Total norm for 10 adversaries is: 15.816803237330781. distance: 3.5691575868146534
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.6343, Accuracy: 6660/8968 (74.2640%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 62, internal_epoch   1,  Average loss: 0.0063, Accuracy: 496/580 (85.5172%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 62, internal_epoch   2,  Average loss: 0.0019, Accuracy: 561/580 (96.7241%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 62, internal_epoch   3,  Average loss: 0.0009, Accuracy: 569/580 (98.1034%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 62, internal_epoch   4,  Average loss: 0.0008, Accuracy: 571/580 (98.4483%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 62, internal_epoch   5,  Average loss: 0.0009, Accuracy: 567/580 (97.7586%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 62, internal_epoch   6,  Average loss: 0.0008, Accuracy: 569/580 (98.1034%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 62, internal_epoch   7,  Average loss: 0.0007, Accuracy: 573/580 (98.7931%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 62, internal_epoch   8,  Average loss: 0.0009, Accuracy: 571/580 (98.4483%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 62, internal_epoch   9,  Average loss: 0.0007, Accuracy: 572/580 (98.6207%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 62, internal_epoch  10,  Average loss: 0.0007, Accuracy: 572/580 (98.6207%), train_poison_data_count: 292
Global model norm: 15.435030226114062.
Norm before scaling: 15.654053067541525. Distance: 2.420851558894646
Total norm for 10 adversaries is: 15.654053067541525. distance: 2.420851558894646
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0130, Accuracy: 8920/8968 (99.4648%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 33, internal_epoch   1,  Average loss: 0.0212, Accuracy: 305/587 (51.9591%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 33, internal_epoch   2,  Average loss: 0.0077, Accuracy: 458/587 (78.0239%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 33, internal_epoch   3,  Average loss: 0.0020, Accuracy: 574/587 (97.7853%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 33, internal_epoch   4,  Average loss: 0.0008, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 33, internal_epoch   5,  Average loss: 0.0008, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 33, internal_epoch   6,  Average loss: 0.0006, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 33, internal_epoch   7,  Average loss: 0.0007, Accuracy: 581/587 (98.9779%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 33, internal_epoch   8,  Average loss: 0.0005, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 33, internal_epoch   9,  Average loss: 0.0005, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 33, internal_epoch  10,  Average loss: 0.0004, Accuracy: 583/587 (99.3186%), train_poison_data_count: 299
Global model norm: 15.435030226114062.
Norm before scaling: 15.787020816009498. Distance: 3.841403151691856
Total norm for 10 adversaries is: 15.787020816009498. distance: 3.841403151691856
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.8028, Accuracy: 6170/8968 (68.8002%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 88, internal_epoch   1,  Average loss: 0.0141, Accuracy: 496/734 (67.5749%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 88, internal_epoch   2,  Average loss: 0.0036, Accuracy: 661/734 (90.0545%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 88, internal_epoch   3,  Average loss: 0.0012, Accuracy: 711/734 (96.8665%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 88, internal_epoch   4,  Average loss: 0.0010, Accuracy: 718/734 (97.8202%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 88, internal_epoch   5,  Average loss: 0.0007, Accuracy: 721/734 (98.2289%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 88, internal_epoch   6,  Average loss: 0.0007, Accuracy: 724/734 (98.6376%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 88, internal_epoch   7,  Average loss: 0.0008, Accuracy: 720/734 (98.0926%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 88, internal_epoch   8,  Average loss: 0.0007, Accuracy: 722/734 (98.3651%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 88, internal_epoch   9,  Average loss: 0.0006, Accuracy: 727/734 (99.0463%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 88, internal_epoch  10,  Average loss: 0.0006, Accuracy: 726/734 (98.9101%), train_poison_data_count: 382
Global model norm: 15.435030226114062.
Norm before scaling: 15.80700443348316. Distance: 3.750097273518655
Total norm for 10 adversaries is: 15.80700443348316. distance: 3.750097273518655
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0478, Accuracy: 8801/8968 (98.1378%)
___Train Local_Simple,  epoch  41, local model 81, internal_epoch   1,  Average loss: 0.0011, Accuracy: 624/636 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.7115, Accuracy: 5778/10000 (57.7800%)
___Train Local_Simple,  epoch  41, local model 90, internal_epoch   1,  Average loss: 0.0011, Accuracy: 601/615 (97.7236%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.6328, Accuracy: 5599/10000 (55.9900%)
___Train Local_Simple,  epoch  41, local model 59, internal_epoch   1,  Average loss: 0.0008, Accuracy: 635/644 (98.6025%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.4468, Accuracy: 5026/10000 (50.2600%)
___Train Local_Simple,  epoch  41, local model 60, internal_epoch   1,  Average loss: 0.0010, Accuracy: 562/571 (98.4238%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 4.1344, Accuracy: 3914/10000 (39.1400%)
___Train Local_Simple,  epoch  41, local model 94, internal_epoch   1,  Average loss: 0.0009, Accuracy: 660/671 (98.3607%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.7765, Accuracy: 4945/10000 (49.4500%)
___Train Local_Simple,  epoch  41, local model 84, internal_epoch   1,  Average loss: 0.0012, Accuracy: 410/420 (97.6190%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.6708, Accuracy: 7945/10000 (79.4500%)
___Train Local_Simple,  epoch  41, local model 99, internal_epoch   1,  Average loss: 0.0023, Accuracy: 678/712 (95.2247%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.7998, Accuracy: 7502/10000 (75.0200%)
___Train Local_Simple,  epoch  41, local model 16, internal_epoch   1,  Average loss: 0.0007, Accuracy: 808/817 (98.8984%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.6997, Accuracy: 5284/10000 (52.8400%)
___Train Local_Simple,  epoch  41, local model 75, internal_epoch   1,  Average loss: 0.0012, Accuracy: 743/763 (97.3788%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.7160, Accuracy: 5366/10000 (53.6600%)
___Train Local_Simple,  epoch  41, local model 8, internal_epoch   1,  Average loss: 0.0007, Accuracy: 698/706 (98.8669%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.2515, Accuracy: 5424/10000 (54.2400%)
___Train Local_Simple,  epoch  41, local model 76, internal_epoch   1,  Average loss: 0.0014, Accuracy: 452/459 (98.4749%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.8942, Accuracy: 7956/10000 (79.5600%)
___Train Local_Simple,  epoch  41, local model 61, internal_epoch   1,  Average loss: 0.0011, Accuracy: 280/287 (97.5610%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.4863, Accuracy: 8523/10000 (85.2300%)
___Train Local_Simple,  epoch  41, local model 49, internal_epoch   1,  Average loss: 0.0013, Accuracy: 347/355 (97.7465%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.2944, Accuracy: 6157/10000 (61.5700%)
___Train Local_Simple,  epoch  41, local model 32, internal_epoch   1,  Average loss: 0.0006, Accuracy: 583/590 (98.8136%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.7140, Accuracy: 5494/10000 (54.9400%)
___Train Local_Simple,  epoch  41, local model 92, internal_epoch   1,  Average loss: 0.0027, Accuracy: 573/611 (93.7807%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 4.6747, Accuracy: 3776/10000 (37.7600%)
___Train Local_Simple,  epoch  41, local model 42, internal_epoch   1,  Average loss: 0.0005, Accuracy: 469/473 (99.1543%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.7132, Accuracy: 7816/10000 (78.1600%)
___Train Local_Simple,  epoch  41, local model 52, internal_epoch   1,  Average loss: 0.0013, Accuracy: 768/789 (97.3384%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.4398, Accuracy: 4293/10000 (42.9300%)
___Train Local_Simple,  epoch  41, local model 44, internal_epoch   1,  Average loss: 0.0004, Accuracy: 558/561 (99.4652%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.3029, Accuracy: 6376/10000 (63.7600%)
___Train Local_Simple,  epoch  41, local model 0, internal_epoch   1,  Average loss: 0.0007, Accuracy: 431/435 (99.0805%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.7192, Accuracy: 6682/10000 (66.8200%)
___Train Local_Simple,  epoch  41, local model 89, internal_epoch   1,  Average loss: 0.0023, Accuracy: 655/683 (95.9004%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.4115, Accuracy: 5543/10000 (55.4300%)
___Train Local_Simple,  epoch  41, local model 26, internal_epoch   1,  Average loss: 0.0008, Accuracy: 511/519 (98.4586%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.0364, Accuracy: 5817/10000 (58.1700%)
___Train Local_Simple,  epoch  41, local model 98, internal_epoch   1,  Average loss: 0.0010, Accuracy: 536/548 (97.8102%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.1594, Accuracy: 5371/10000 (53.7100%)
___Train Local_Simple,  epoch  41, local model 55, internal_epoch   1,  Average loss: 0.0011, Accuracy: 368/375 (98.1333%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.5858, Accuracy: 6494/10000 (64.9400%)
___Train Local_Simple,  epoch  41, local model 87, internal_epoch   1,  Average loss: 0.0007, Accuracy: 654/663 (98.6425%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.3893, Accuracy: 5138/10000 (51.3800%)
___Train Local_Simple,  epoch  41, local model 54, internal_epoch   1,  Average loss: 0.0005, Accuracy: 823/832 (98.9183%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.8029, Accuracy: 4331/10000 (43.3100%)
___Train Local_Simple,  epoch  41, local model 78, internal_epoch   1,  Average loss: 0.0017, Accuracy: 570/587 (97.1039%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.5174, Accuracy: 4364/10000 (43.6400%)
___Train Local_Simple,  epoch  41, local model 77, internal_epoch   1,  Average loss: 0.0012, Accuracy: 605/618 (97.8964%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.8719, Accuracy: 5873/10000 (58.7300%)
___Train Local_Simple,  epoch  41, local model 70, internal_epoch   1,  Average loss: 0.0010, Accuracy: 558/568 (98.2394%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.3601, Accuracy: 4338/10000 (43.3800%)
___Train Local_Simple,  epoch  41, local model 13, internal_epoch   1,  Average loss: 0.0007, Accuracy: 703/713 (98.5975%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.9330, Accuracy: 5116/10000 (51.1600%)
___Train Local_Simple,  epoch  41, local model 48, internal_epoch   1,  Average loss: 0.0014, Accuracy: 353/363 (97.2452%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.6411, Accuracy: 8141/10000 (81.4100%)
___Train Local_Simple,  epoch  41, local model 97, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1102/1112 (99.1007%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 7.3784, Accuracy: 3648/10000 (36.4800%)
___Train Local_Simple,  epoch  41, local model 93, internal_epoch   1,  Average loss: 0.0015, Accuracy: 606/630 (96.1905%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.8132, Accuracy: 4266/10000 (42.6600%)
___Train Local_Simple,  epoch  41, local model 63, internal_epoch   1,  Average loss: 0.0018, Accuracy: 291/303 (96.0396%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.0206, Accuracy: 5888/10000 (58.8800%)
___Train Local_Simple,  epoch  41, local model 43, internal_epoch   1,  Average loss: 0.0008, Accuracy: 427/431 (99.0719%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.8023, Accuracy: 7723/10000 (77.2300%)
___Train Local_Simple,  epoch  41, local model 22, internal_epoch   1,  Average loss: 0.0009, Accuracy: 258/262 (98.4733%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.6487, Accuracy: 8365/10000 (83.6500%)
___Train Local_Simple,  epoch  41, local model 23, internal_epoch   1,  Average loss: 0.0016, Accuracy: 532/542 (98.1550%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.3564, Accuracy: 3920/10000 (39.2000%)
___Train Local_Simple,  epoch  41, local model 86, internal_epoch   1,  Average loss: 0.0006, Accuracy: 687/692 (99.2775%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.1973, Accuracy: 5348/10000 (53.4800%)
___Train Local_Simple,  epoch  41, local model 4, internal_epoch   1,  Average loss: 0.0006, Accuracy: 741/748 (99.0642%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.0622, Accuracy: 4502/10000 (45.0200%)
___Train Local_Simple,  epoch  41, local model 85, internal_epoch   1,  Average loss: 0.0016, Accuracy: 778/807 (96.4064%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.1971, Accuracy: 5778/10000 (57.7800%)
___Train Local_Simple,  epoch  41, local model 40, internal_epoch   1,  Average loss: 0.0005, Accuracy: 494/498 (99.1968%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.6697, Accuracy: 5273/10000 (52.7300%)
___Train Local_Simple,  epoch  41, local model 5, internal_epoch   1,  Average loss: 0.0008, Accuracy: 569/578 (98.4429%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.9917, Accuracy: 7173/10000 (71.7300%)
___Train Local_Simple,  epoch  41, local model 91, internal_epoch   1,  Average loss: 0.0004, Accuracy: 813/819 (99.2674%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.8729, Accuracy: 4694/10000 (46.9400%)
___Train Local_Simple,  epoch  41, local model 25, internal_epoch   1,  Average loss: 0.0005, Accuracy: 585/592 (98.8176%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.5502, Accuracy: 6688/10000 (66.8800%)
___Train Local_Simple,  epoch  41, local model 96, internal_epoch   1,  Average loss: 0.0007, Accuracy: 522/531 (98.3051%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.7968, Accuracy: 4650/10000 (46.5000%)
___Train Local_Simple,  epoch  41, local model 19, internal_epoch   1,  Average loss: 0.0016, Accuracy: 590/598 (98.6622%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 4.2989, Accuracy: 3623/10000 (36.2300%)
___Train Local_Simple,  epoch  41, local model 72, internal_epoch   1,  Average loss: 0.0015, Accuracy: 409/423 (96.6903%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.5037, Accuracy: 4611/10000 (46.1100%)
___Train Local_Simple,  epoch  41, local model 53, internal_epoch   1,  Average loss: 0.0010, Accuracy: 548/561 (97.6827%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.6161, Accuracy: 5896/10000 (58.9600%)
___Train Local_Simple,  epoch  41, local model 27, internal_epoch   1,  Average loss: 0.0006, Accuracy: 737/745 (98.9262%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.1177, Accuracy: 4501/10000 (45.0100%)
___Train Local_Simple,  epoch  41, local model 46, internal_epoch   1,  Average loss: 0.0007, Accuracy: 642/650 (98.7692%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.9789, Accuracy: 4769/10000 (47.6900%)
___Train Local_Simple,  epoch  41, local model 11, internal_epoch   1,  Average loss: 0.0007, Accuracy: 549/554 (99.0975%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.6999, Accuracy: 6654/10000 (66.5400%)
___Train Local_Simple,  epoch  41, local model 56, internal_epoch   1,  Average loss: 0.0004, Accuracy: 710/715 (99.3007%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.5798, Accuracy: 4956/10000 (49.5600%)
___Train Local_Simple,  epoch  41, local model 68, internal_epoch   1,  Average loss: 0.0016, Accuracy: 535/549 (97.4499%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.4730, Accuracy: 5391/10000 (53.9100%)
___Train Local_Simple,  epoch  41, local model 1, internal_epoch   1,  Average loss: 0.0005, Accuracy: 534/536 (99.6269%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.4003, Accuracy: 8773/10000 (87.7300%)
___Train Local_Simple,  epoch  41, local model 37, internal_epoch   1,  Average loss: 0.0008, Accuracy: 450/456 (98.6842%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.8952, Accuracy: 7381/10000 (73.8100%)
___Train Local_Simple,  epoch  41, local model 95, internal_epoch   1,  Average loss: 0.0014, Accuracy: 585/600 (97.5000%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.6814, Accuracy: 6203/10000 (62.0300%)
___Train Local_Simple,  epoch  41, local model 50, internal_epoch   1,  Average loss: 0.0010, Accuracy: 468/477 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.6703, Accuracy: 5838/10000 (58.3800%)
___Train Local_Simple,  epoch  41, local model 17, internal_epoch   1,  Average loss: 0.0009, Accuracy: 516/527 (97.9127%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.4222, Accuracy: 5131/10000 (51.3100%)
___Train Local_Simple,  epoch  41, local model 65, internal_epoch   1,  Average loss: 0.0014, Accuracy: 603/621 (97.1014%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.6180, Accuracy: 5669/10000 (56.6900%)
___Train Local_Simple,  epoch  41, local model 45, internal_epoch   1,  Average loss: 0.0012, Accuracy: 636/647 (98.2998%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.0584, Accuracy: 4171/10000 (41.7100%)
___Train Local_Simple,  epoch  41, local model 10, internal_epoch   1,  Average loss: 0.0011, Accuracy: 559/573 (97.5567%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.0487, Accuracy: 5400/10000 (54.0000%)
___Train Local_Simple,  epoch  41, local model 69, internal_epoch   1,  Average loss: 0.0014, Accuracy: 651/671 (97.0194%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.8658, Accuracy: 4230/10000 (42.3000%)
___Train Local_Simple,  epoch  41, local model 21, internal_epoch   1,  Average loss: 0.0007, Accuracy: 679/687 (98.8355%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.9380, Accuracy: 5005/10000 (50.0500%)
___Train Local_Simple,  epoch  41, local model 9, internal_epoch   1,  Average loss: 0.0009, Accuracy: 501/508 (98.6220%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.6903, Accuracy: 7702/10000 (77.0200%)
___Train Local_Simple,  epoch  41, local model 57, internal_epoch   1,  Average loss: 0.0007, Accuracy: 514/523 (98.2792%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.3950, Accuracy: 3700/10000 (37.0000%)
___Train Local_Simple,  epoch  41, local model 28, internal_epoch   1,  Average loss: 0.0006, Accuracy: 604/611 (98.8543%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.6282, Accuracy: 6467/10000 (64.6700%)
___Train Local_Simple,  epoch  41, local model 36, internal_epoch   1,  Average loss: 0.0008, Accuracy: 310/315 (98.4127%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2629, Accuracy: 9158/10000 (91.5800%)
___Train Local_Simple,  epoch  41, local model 82, internal_epoch   1,  Average loss: 0.0005, Accuracy: 808/815 (99.1411%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.4269, Accuracy: 4642/10000 (46.4200%)
___Train Local_Simple,  epoch  41, local model 15, internal_epoch   1,  Average loss: 0.0010, Accuracy: 280/282 (99.2908%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.5191, Accuracy: 8347/10000 (83.4700%)
___Train Local_Simple,  epoch  41, local model 83, internal_epoch   1,  Average loss: 0.0011, Accuracy: 350/360 (97.2222%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.6749, Accuracy: 8009/10000 (80.0900%)
___Train Local_Simple,  epoch  41, local model 39, internal_epoch   1,  Average loss: 0.0008, Accuracy: 486/493 (98.5801%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.4897, Accuracy: 6902/10000 (69.0200%)
___Train Local_Simple,  epoch  41, local model 24, internal_epoch   1,  Average loss: 0.0016, Accuracy: 466/477 (97.6939%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.3160, Accuracy: 4705/10000 (47.0500%)
___Train Local_Simple,  epoch  41, local model 79, internal_epoch   1,  Average loss: 0.0011, Accuracy: 653/661 (98.7897%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.2301, Accuracy: 5185/10000 (51.8500%)
___Train Local_Simple,  epoch  41, local model 12, internal_epoch   1,  Average loss: 0.0008, Accuracy: 714/725 (98.4828%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.1461, Accuracy: 5691/10000 (56.9100%)
___Train Local_Simple,  epoch  41, local model 58, internal_epoch   1,  Average loss: 0.0010, Accuracy: 758/772 (98.1865%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.5595, Accuracy: 4130/10000 (41.3000%)
___Train Local_Simple,  epoch  41, local model 20, internal_epoch   1,  Average loss: 0.0010, Accuracy: 590/602 (98.0066%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.8911, Accuracy: 5142/10000 (51.4200%)
___Train Local_Simple,  epoch  41, local model 38, internal_epoch   1,  Average loss: 0.0009, Accuracy: 470/477 (98.5325%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.6312, Accuracy: 8185/10000 (81.8500%)
___Train Local_Simple,  epoch  41, local model 30, internal_epoch   1,  Average loss: 0.0009, Accuracy: 436/443 (98.4199%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.8666, Accuracy: 6523/10000 (65.2300%)
___Train Local_Simple,  epoch  41, local model 7, internal_epoch   1,  Average loss: 0.0004, Accuracy: 796/802 (99.2519%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.7290, Accuracy: 5723/10000 (57.2300%)
___Train Local_Simple,  epoch  41, local model 47, internal_epoch   1,  Average loss: 0.0008, Accuracy: 525/534 (98.3146%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.2060, Accuracy: 5457/10000 (54.5700%)
___Train Local_Simple,  epoch  41, local model 34, internal_epoch   1,  Average loss: 0.0009, Accuracy: 862/871 (98.9667%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.7529, Accuracy: 4834/10000 (48.3400%)
___Train Local_Simple,  epoch  41, local model 14, internal_epoch   1,  Average loss: 0.0010, Accuracy: 674/692 (97.3988%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.9750, Accuracy: 5376/10000 (53.7600%)
___Train Local_Simple,  epoch  41, local model 31, internal_epoch   1,  Average loss: 0.0011, Accuracy: 584/596 (97.9866%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.8700, Accuracy: 5450/10000 (54.5000%)
___Train Local_Simple,  epoch  41, local model 71, internal_epoch   1,  Average loss: 0.0010, Accuracy: 549/561 (97.8610%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.6104, Accuracy: 5942/10000 (59.4200%)
___Train Local_Simple,  epoch  41, local model 64, internal_epoch   1,  Average loss: 0.0012, Accuracy: 598/608 (98.3553%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.8332, Accuracy: 4839/10000 (48.3900%)
___Train Local_Simple,  epoch  41, local model 67, internal_epoch   1,  Average loss: 0.0013, Accuracy: 432/441 (97.9592%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.1376, Accuracy: 6863/10000 (68.6300%)
___Train Local_Simple,  epoch  41, local model 2, internal_epoch   1,  Average loss: 0.0013, Accuracy: 549/564 (97.3404%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.0808, Accuracy: 5609/10000 (56.0900%)
___Train Local_Simple,  epoch  41, local model 66, internal_epoch   1,  Average loss: 0.0020, Accuracy: 697/733 (95.0887%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.5995, Accuracy: 5929/10000 (59.2900%)
___Train Local_Simple,  epoch  41, local model 6, internal_epoch   1,  Average loss: 0.0009, Accuracy: 428/435 (98.3908%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.4480, Accuracy: 5938/10000 (59.3800%)
___Train Local_Simple,  epoch  41, local model 80, internal_epoch   1,  Average loss: 0.0016, Accuracy: 517/532 (97.1805%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.8566, Accuracy: 3973/10000 (39.7300%)
___Train Local_Simple,  epoch  41, local model 35, internal_epoch   1,  Average loss: 0.0012, Accuracy: 613/630 (97.3016%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 6.2108, Accuracy: 3670/10000 (36.7000%)
time spent on training: 372.61413502693176
___Test Target_Simple poisoned: False, epoch: 41: Average loss: 0.1208, Accuracy: 9672/10000 (96.7200%)
___Test Target_Simple poisoned: True, epoch: 41: Average loss: 3.6979, Accuracy: 655/8968 (7.3037%)
saving model
Done in 406.95198369026184 sec.
Server Epoch:42 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 61, 65, 54, 99, 84, 45, 44, 2, 95, 71, 48, 34, 12, 85, 14, 9, 92, 80, 11, 53, 70, 79, 82, 63, 15, 13, 59, 66, 6, 30, 52, 24, 35, 31, 78, 4, 17, 49, 26, 25, 94, 76, 56, 40, 7, 22, 37, 20, 64, 23, 42, 60, 1, 96, 43, 83, 58, 8, 93, 16, 77, 72, 68, 91, 98, 87, 28, 46, 39, 50, 19, 90, 55, 47, 67, 21, 75, 97, 69, 86, 38, 0, 57, 10, 89, 81, 32, 36, 27, 5].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   1,  Average loss: 0.0214, Accuracy: 285/569 (50.0879%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   2,  Average loss: 0.0110, Accuracy: 368/569 (64.6749%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   3,  Average loss: 0.0051, Accuracy: 513/569 (90.1582%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   4,  Average loss: 0.0041, Accuracy: 533/569 (93.6731%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   5,  Average loss: 0.0030, Accuracy: 548/569 (96.3093%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   6,  Average loss: 0.0020, Accuracy: 561/569 (98.5940%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   7,  Average loss: 0.0014, Accuracy: 565/569 (99.2970%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   8,  Average loss: 0.0012, Accuracy: 561/569 (98.5940%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch   9,  Average loss: 0.0007, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 41, internal_epoch  10,  Average loss: 0.0009, Accuracy: 564/569 (99.1213%), train_poison_data_count: 288
Global model norm: 15.436605450739384.
Norm before scaling: 15.64852720892908. Distance: 3.7723423729103103
Total norm for 10 adversaries is: 15.64852720892908. distance: 3.7723423729103103
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.6056, Accuracy: 6404/8968 (71.4095%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   1,  Average loss: 0.0123, Accuracy: 371/522 (71.0728%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   2,  Average loss: 0.0044, Accuracy: 454/522 (86.9732%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   3,  Average loss: 0.0013, Accuracy: 511/522 (97.8927%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   4,  Average loss: 0.0011, Accuracy: 517/522 (99.0421%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   5,  Average loss: 0.0009, Accuracy: 518/522 (99.2337%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   6,  Average loss: 0.0009, Accuracy: 517/522 (99.0421%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   7,  Average loss: 0.0006, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   8,  Average loss: 0.0003, Accuracy: 522/522 (100.0000%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   9,  Average loss: 0.0006, Accuracy: 518/522 (99.2337%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch  10,  Average loss: 0.0005, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Global model norm: 15.436605450739384.
Norm before scaling: 15.551157053987122. Distance: 2.6495813470904896
Total norm for 10 adversaries is: 15.551157053987122. distance: 2.6495813470904896
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0162, Accuracy: 8912/8968 (99.3756%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   1,  Average loss: 0.0184, Accuracy: 216/385 (56.1039%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   2,  Average loss: 0.0101, Accuracy: 279/385 (72.4675%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   3,  Average loss: 0.0055, Accuracy: 345/385 (89.6104%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   4,  Average loss: 0.0049, Accuracy: 354/385 (91.9481%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   5,  Average loss: 0.0039, Accuracy: 365/385 (94.8052%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   6,  Average loss: 0.0031, Accuracy: 373/385 (96.8831%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   7,  Average loss: 0.0024, Accuracy: 377/385 (97.9221%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   8,  Average loss: 0.0017, Accuracy: 378/385 (98.1818%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch   9,  Average loss: 0.0015, Accuracy: 379/385 (98.4416%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 51, internal_epoch  10,  Average loss: 0.0013, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Global model norm: 15.436605450739384.
Norm before scaling: 15.574738986796406. Distance: 3.0060183239528713
Total norm for 10 adversaries is: 15.574738986796406. distance: 3.0060183239528713
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.1943, Accuracy: 8356/8968 (93.1757%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   1,  Average loss: 0.0080, Accuracy: 519/627 (82.7751%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   2,  Average loss: 0.0025, Accuracy: 597/627 (95.2153%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   3,  Average loss: 0.0011, Accuracy: 616/627 (98.2456%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   4,  Average loss: 0.0010, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   5,  Average loss: 0.0008, Accuracy: 616/627 (98.2456%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   6,  Average loss: 0.0006, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   7,  Average loss: 0.0005, Accuracy: 620/627 (98.8836%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   8,  Average loss: 0.0004, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch   9,  Average loss: 0.0004, Accuracy: 624/627 (99.5215%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 74, internal_epoch  10,  Average loss: 0.0007, Accuracy: 621/627 (99.0431%), train_poison_data_count: 320
Global model norm: 15.436605450739384.
Norm before scaling: 15.664363989461428. Distance: 2.6200165446683608
Total norm for 10 adversaries is: 15.664363989461428. distance: 2.6200165446683608
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0066, Accuracy: 8945/8968 (99.7435%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 3, internal_epoch   1,  Average loss: 0.0250, Accuracy: 265/516 (51.3566%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 3, internal_epoch   2,  Average loss: 0.0110, Accuracy: 369/516 (71.5116%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 3, internal_epoch   3,  Average loss: 0.0053, Accuracy: 458/516 (88.7597%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 3, internal_epoch   4,  Average loss: 0.0034, Accuracy: 483/516 (93.6047%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 3, internal_epoch   5,  Average loss: 0.0024, Accuracy: 499/516 (96.7054%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 3, internal_epoch   6,  Average loss: 0.0014, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 3, internal_epoch   7,  Average loss: 0.0012, Accuracy: 513/516 (99.4186%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 3, internal_epoch   8,  Average loss: 0.0008, Accuracy: 516/516 (100.0000%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 3, internal_epoch   9,  Average loss: 0.0007, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 3, internal_epoch  10,  Average loss: 0.0006, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Global model norm: 15.436605450739384.
Norm before scaling: 15.813500655405672. Distance: 4.5034696130770335
Total norm for 10 adversaries is: 15.813500655405672. distance: 4.5034696130770335
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.5503, Accuracy: 7070/8968 (78.8359%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 18, internal_epoch   1,  Average loss: 0.0171, Accuracy: 448/759 (59.0250%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 18, internal_epoch   2,  Average loss: 0.0027, Accuracy: 710/759 (93.5441%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 18, internal_epoch   3,  Average loss: 0.0006, Accuracy: 748/759 (98.5507%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 18, internal_epoch   4,  Average loss: 0.0004, Accuracy: 754/759 (99.3412%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 18, internal_epoch   5,  Average loss: 0.0003, Accuracy: 753/759 (99.2095%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 18, internal_epoch   6,  Average loss: 0.0003, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 18, internal_epoch   7,  Average loss: 0.0002, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 18, internal_epoch   8,  Average loss: 0.0004, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 18, internal_epoch   9,  Average loss: 0.0001, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 18, internal_epoch  10,  Average loss: 0.0002, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Global model norm: 15.436605450739384.
Norm before scaling: 15.880833312493987. Distance: 4.31033381362034
Total norm for 10 adversaries is: 15.880833312493987. distance: 4.31033381362034
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0322, Accuracy: 8853/8968 (98.7177%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   1,  Average loss: 0.0166, Accuracy: 315/506 (62.2530%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   2,  Average loss: 0.0048, Accuracy: 470/506 (92.8854%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   3,  Average loss: 0.0014, Accuracy: 500/506 (98.8142%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   4,  Average loss: 0.0012, Accuracy: 500/506 (98.8142%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   5,  Average loss: 0.0010, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   6,  Average loss: 0.0010, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   7,  Average loss: 0.0006, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   8,  Average loss: 0.0007, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   9,  Average loss: 0.0007, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch  10,  Average loss: 0.0005, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Global model norm: 15.436605450739384.
Norm before scaling: 15.735941107200956. Distance: 3.2114927085664218
Total norm for 10 adversaries is: 15.735941107200956. distance: 3.2114927085664218
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.4697, Accuracy: 7351/8968 (81.9692%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   1,  Average loss: 0.0070, Accuracy: 486/580 (83.7931%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   2,  Average loss: 0.0023, Accuracy: 556/580 (95.8621%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   3,  Average loss: 0.0009, Accuracy: 569/580 (98.1034%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   4,  Average loss: 0.0009, Accuracy: 571/580 (98.4483%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   5,  Average loss: 0.0008, Accuracy: 571/580 (98.4483%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   6,  Average loss: 0.0009, Accuracy: 569/580 (98.1034%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   7,  Average loss: 0.0009, Accuracy: 573/580 (98.7931%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   8,  Average loss: 0.0008, Accuracy: 573/580 (98.7931%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   9,  Average loss: 0.0007, Accuracy: 574/580 (98.9655%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch  10,  Average loss: 0.0012, Accuracy: 571/580 (98.4483%), train_poison_data_count: 292
Global model norm: 15.436605450739384.
Norm before scaling: 15.694468618428715. Distance: 2.550623563183261
Total norm for 10 adversaries is: 15.694468618428715. distance: 2.550623563183261
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0207, Accuracy: 8898/8968 (99.2194%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 33, internal_epoch   1,  Average loss: 0.0215, Accuracy: 312/587 (53.1516%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 33, internal_epoch   2,  Average loss: 0.0081, Accuracy: 468/587 (79.7274%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 33, internal_epoch   3,  Average loss: 0.0018, Accuracy: 582/587 (99.1482%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 33, internal_epoch   4,  Average loss: 0.0014, Accuracy: 581/587 (98.9779%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 33, internal_epoch   5,  Average loss: 0.0011, Accuracy: 582/587 (99.1482%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 33, internal_epoch   6,  Average loss: 0.0007, Accuracy: 585/587 (99.6593%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 33, internal_epoch   7,  Average loss: 0.0006, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 33, internal_epoch   8,  Average loss: 0.0007, Accuracy: 582/587 (99.1482%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 33, internal_epoch   9,  Average loss: 0.0004, Accuracy: 586/587 (99.8296%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 33, internal_epoch  10,  Average loss: 0.0004, Accuracy: 585/587 (99.6593%), train_poison_data_count: 299
Global model norm: 15.436605450739384.
Norm before scaling: 15.798920239601967. Distance: 3.7622508527318903
Total norm for 10 adversaries is: 15.798920239601967. distance: 3.7622508527318903
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.8910, Accuracy: 5882/8968 (65.5888%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 88, internal_epoch   1,  Average loss: 0.0124, Accuracy: 521/734 (70.9809%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 88, internal_epoch   2,  Average loss: 0.0031, Accuracy: 672/734 (91.5531%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 88, internal_epoch   3,  Average loss: 0.0008, Accuracy: 721/734 (98.2289%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 88, internal_epoch   4,  Average loss: 0.0009, Accuracy: 719/734 (97.9564%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 88, internal_epoch   5,  Average loss: 0.0006, Accuracy: 723/734 (98.5014%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 88, internal_epoch   6,  Average loss: 0.0007, Accuracy: 724/734 (98.6376%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 88, internal_epoch   7,  Average loss: 0.0006, Accuracy: 721/734 (98.2289%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 88, internal_epoch   8,  Average loss: 0.0006, Accuracy: 726/734 (98.9101%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 88, internal_epoch   9,  Average loss: 0.0005, Accuracy: 729/734 (99.3188%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 88, internal_epoch  10,  Average loss: 0.0005, Accuracy: 726/734 (98.9101%), train_poison_data_count: 382
Global model norm: 15.436605450739384.
Norm before scaling: 15.737724243214734. Distance: 3.3871940446472433
Total norm for 10 adversaries is: 15.737724243214734. distance: 3.3871940446472433
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0450, Accuracy: 8818/8968 (98.3274%)
___Train Local_Simple,  epoch  42, local model 61, internal_epoch   1,  Average loss: 0.0010, Accuracy: 283/287 (98.6063%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.3226, Accuracy: 9009/10000 (90.0900%)
___Train Local_Simple,  epoch  42, local model 65, internal_epoch   1,  Average loss: 0.0019, Accuracy: 596/621 (95.9742%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.1576, Accuracy: 5852/10000 (58.5200%)
___Train Local_Simple,  epoch  42, local model 54, internal_epoch   1,  Average loss: 0.0007, Accuracy: 821/832 (98.6779%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 3.1973, Accuracy: 4904/10000 (49.0400%)
___Train Local_Simple,  epoch  42, local model 99, internal_epoch   1,  Average loss: 0.0018, Accuracy: 688/712 (96.6292%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 5.1813, Accuracy: 2954/10000 (29.5400%)
___Train Local_Simple,  epoch  42, local model 84, internal_epoch   1,  Average loss: 0.0008, Accuracy: 412/420 (98.0952%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.7006, Accuracy: 8006/10000 (80.0600%)
___Train Local_Simple,  epoch  42, local model 45, internal_epoch   1,  Average loss: 0.0008, Accuracy: 635/647 (98.1453%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 4.2604, Accuracy: 3662/10000 (36.6200%)
___Train Local_Simple,  epoch  42, local model 44, internal_epoch   1,  Average loss: 0.0004, Accuracy: 556/561 (99.1087%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.7392, Accuracy: 7704/10000 (77.0400%)
___Train Local_Simple,  epoch  42, local model 2, internal_epoch   1,  Average loss: 0.0013, Accuracy: 554/564 (98.2270%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.8360, Accuracy: 5492/10000 (54.9200%)
___Train Local_Simple,  epoch  42, local model 95, internal_epoch   1,  Average loss: 0.0025, Accuracy: 568/600 (94.6667%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 3.2856, Accuracy: 4543/10000 (45.4300%)
___Train Local_Simple,  epoch  42, local model 71, internal_epoch   1,  Average loss: 0.0010, Accuracy: 549/561 (97.8610%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.0601, Accuracy: 7025/10000 (70.2500%)
___Train Local_Simple,  epoch  42, local model 48, internal_epoch   1,  Average loss: 0.0010, Accuracy: 355/363 (97.7961%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4970, Accuracy: 8403/10000 (84.0300%)
___Train Local_Simple,  epoch  42, local model 34, internal_epoch   1,  Average loss: 0.0017, Accuracy: 840/871 (96.4409%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 5.2086, Accuracy: 3633/10000 (36.3300%)
___Train Local_Simple,  epoch  42, local model 12, internal_epoch   1,  Average loss: 0.0005, Accuracy: 720/725 (99.3103%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.1771, Accuracy: 7185/10000 (71.8500%)
___Train Local_Simple,  epoch  42, local model 85, internal_epoch   1,  Average loss: 0.0012, Accuracy: 786/807 (97.3978%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 2.8655, Accuracy: 5972/10000 (59.7200%)
___Train Local_Simple,  epoch  42, local model 14, internal_epoch   1,  Average loss: 0.0012, Accuracy: 676/692 (97.6879%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.7908, Accuracy: 5208/10000 (52.0800%)
___Train Local_Simple,  epoch  42, local model 9, internal_epoch   1,  Average loss: 0.0010, Accuracy: 502/508 (98.8189%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.9093, Accuracy: 7123/10000 (71.2300%)
___Train Local_Simple,  epoch  42, local model 92, internal_epoch   1,  Average loss: 0.0024, Accuracy: 581/611 (95.0900%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 3.3285, Accuracy: 3432/10000 (34.3200%)
___Train Local_Simple,  epoch  42, local model 80, internal_epoch   1,  Average loss: 0.0019, Accuracy: 514/532 (96.6165%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 6.5822, Accuracy: 2760/10000 (27.6000%)
___Train Local_Simple,  epoch  42, local model 11, internal_epoch   1,  Average loss: 0.0006, Accuracy: 546/554 (98.5560%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.8057, Accuracy: 7824/10000 (78.2400%)
___Train Local_Simple,  epoch  42, local model 53, internal_epoch   1,  Average loss: 0.0006, Accuracy: 557/561 (99.2870%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.9084, Accuracy: 6288/10000 (62.8800%)
___Train Local_Simple,  epoch  42, local model 70, internal_epoch   1,  Average loss: 0.0013, Accuracy: 556/568 (97.8873%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 3.2426, Accuracy: 4183/10000 (41.8300%)
___Train Local_Simple,  epoch  42, local model 79, internal_epoch   1,  Average loss: 0.0011, Accuracy: 654/661 (98.9410%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.3248, Accuracy: 6253/10000 (62.5300%)
___Train Local_Simple,  epoch  42, local model 82, internal_epoch   1,  Average loss: 0.0008, Accuracy: 802/815 (98.4049%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 4.2712, Accuracy: 3617/10000 (36.1700%)
___Train Local_Simple,  epoch  42, local model 63, internal_epoch   1,  Average loss: 0.0017, Accuracy: 293/303 (96.6997%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 2.5987, Accuracy: 4035/10000 (40.3500%)
___Train Local_Simple,  epoch  42, local model 15, internal_epoch   1,  Average loss: 0.0009, Accuracy: 280/282 (99.2908%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2876, Accuracy: 8995/10000 (89.9500%)
___Train Local_Simple,  epoch  42, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 699/713 (98.0365%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 3.1675, Accuracy: 4149/10000 (41.4900%)
___Train Local_Simple,  epoch  42, local model 59, internal_epoch   1,  Average loss: 0.0012, Accuracy: 630/644 (97.8261%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 2.8913, Accuracy: 4251/10000 (42.5100%)
___Train Local_Simple,  epoch  42, local model 66, internal_epoch   1,  Average loss: 0.0015, Accuracy: 714/733 (97.4079%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 6.0314, Accuracy: 2962/10000 (29.6200%)
___Train Local_Simple,  epoch  42, local model 6, internal_epoch   1,  Average loss: 0.0009, Accuracy: 429/435 (98.6207%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.8231, Accuracy: 7586/10000 (75.8600%)
___Train Local_Simple,  epoch  42, local model 30, internal_epoch   1,  Average loss: 0.0007, Accuracy: 438/443 (98.8713%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.9941, Accuracy: 7595/10000 (75.9500%)
___Train Local_Simple,  epoch  42, local model 52, internal_epoch   1,  Average loss: 0.0020, Accuracy: 769/789 (97.4651%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 5.6823, Accuracy: 3864/10000 (38.6400%)
___Train Local_Simple,  epoch  42, local model 24, internal_epoch   1,  Average loss: 0.0014, Accuracy: 466/477 (97.6939%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.1493, Accuracy: 6294/10000 (62.9400%)
___Train Local_Simple,  epoch  42, local model 35, internal_epoch   1,  Average loss: 0.0011, Accuracy: 615/630 (97.6190%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 3.3686, Accuracy: 4856/10000 (48.5600%)
___Train Local_Simple,  epoch  42, local model 31, internal_epoch   1,  Average loss: 0.0007, Accuracy: 588/596 (98.6577%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.5198, Accuracy: 6017/10000 (60.1700%)
___Train Local_Simple,  epoch  42, local model 78, internal_epoch   1,  Average loss: 0.0024, Accuracy: 565/587 (96.2521%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 3.3995, Accuracy: 4820/10000 (48.2000%)
___Train Local_Simple,  epoch  42, local model 4, internal_epoch   1,  Average loss: 0.0010, Accuracy: 737/748 (98.5294%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 2.6832, Accuracy: 4373/10000 (43.7300%)
___Train Local_Simple,  epoch  42, local model 17, internal_epoch   1,  Average loss: 0.0007, Accuracy: 520/527 (98.6717%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.3485, Accuracy: 6421/10000 (64.2100%)
___Train Local_Simple,  epoch  42, local model 49, internal_epoch   1,  Average loss: 0.0015, Accuracy: 346/355 (97.4648%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.8364, Accuracy: 7294/10000 (72.9400%)
___Train Local_Simple,  epoch  42, local model 26, internal_epoch   1,  Average loss: 0.0012, Accuracy: 504/519 (97.1098%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 2.6694, Accuracy: 5131/10000 (51.3100%)
___Train Local_Simple,  epoch  42, local model 25, internal_epoch   1,  Average loss: 0.0003, Accuracy: 587/592 (99.1554%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.0940, Accuracy: 7375/10000 (73.7500%)
___Train Local_Simple,  epoch  42, local model 94, internal_epoch   1,  Average loss: 0.0006, Accuracy: 661/671 (98.5097%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 3.2295, Accuracy: 5511/10000 (55.1100%)
___Train Local_Simple,  epoch  42, local model 76, internal_epoch   1,  Average loss: 0.0010, Accuracy: 454/459 (98.9107%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4799, Accuracy: 8449/10000 (84.4900%)
___Train Local_Simple,  epoch  42, local model 56, internal_epoch   1,  Average loss: 0.0005, Accuracy: 709/715 (99.1608%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 2.8533, Accuracy: 4614/10000 (46.1400%)
___Train Local_Simple,  epoch  42, local model 40, internal_epoch   1,  Average loss: 0.0005, Accuracy: 493/498 (98.9960%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 4.0060, Accuracy: 4619/10000 (46.1900%)
___Train Local_Simple,  epoch  42, local model 7, internal_epoch   1,  Average loss: 0.0005, Accuracy: 797/802 (99.3766%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.9227, Accuracy: 6003/10000 (60.0300%)
___Train Local_Simple,  epoch  42, local model 22, internal_epoch   1,  Average loss: 0.0005, Accuracy: 260/262 (99.2366%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.3939, Accuracy: 8722/10000 (87.2200%)
___Train Local_Simple,  epoch  42, local model 37, internal_epoch   1,  Average loss: 0.0010, Accuracy: 449/456 (98.4649%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.7690, Accuracy: 6563/10000 (65.6300%)
___Train Local_Simple,  epoch  42, local model 20, internal_epoch   1,  Average loss: 0.0009, Accuracy: 593/602 (98.5050%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 2.4807, Accuracy: 5314/10000 (53.1400%)
___Train Local_Simple,  epoch  42, local model 64, internal_epoch   1,  Average loss: 0.0006, Accuracy: 600/608 (98.6842%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 3.6259, Accuracy: 4423/10000 (44.2300%)
___Train Local_Simple,  epoch  42, local model 23, internal_epoch   1,  Average loss: 0.0018, Accuracy: 526/542 (97.0480%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.3786, Accuracy: 5747/10000 (57.4700%)
___Train Local_Simple,  epoch  42, local model 42, internal_epoch   1,  Average loss: 0.0004, Accuracy: 469/473 (99.1543%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.6016, Accuracy: 8016/10000 (80.1600%)
___Train Local_Simple,  epoch  42, local model 60, internal_epoch   1,  Average loss: 0.0011, Accuracy: 558/571 (97.7233%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 4.5665, Accuracy: 3458/10000 (34.5800%)
___Train Local_Simple,  epoch  42, local model 1, internal_epoch   1,  Average loss: 0.0003, Accuracy: 534/536 (99.6269%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2952, Accuracy: 9040/10000 (90.4000%)
___Train Local_Simple,  epoch  42, local model 96, internal_epoch   1,  Average loss: 0.0009, Accuracy: 525/531 (98.8701%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 2.7905, Accuracy: 4846/10000 (48.4600%)
___Train Local_Simple,  epoch  42, local model 43, internal_epoch   1,  Average loss: 0.0007, Accuracy: 427/431 (99.0719%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.8179, Accuracy: 7461/10000 (74.6100%)
___Train Local_Simple,  epoch  42, local model 83, internal_epoch   1,  Average loss: 0.0015, Accuracy: 348/360 (96.6667%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.3072, Accuracy: 8987/10000 (89.8700%)
___Train Local_Simple,  epoch  42, local model 58, internal_epoch   1,  Average loss: 0.0007, Accuracy: 762/772 (98.7047%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 2.6888, Accuracy: 4866/10000 (48.6600%)
___Train Local_Simple,  epoch  42, local model 8, internal_epoch   1,  Average loss: 0.0008, Accuracy: 695/706 (98.4419%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 3.7777, Accuracy: 3932/10000 (39.3200%)
___Train Local_Simple,  epoch  42, local model 93, internal_epoch   1,  Average loss: 0.0013, Accuracy: 615/630 (97.6190%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 2.5223, Accuracy: 4514/10000 (45.1400%)
___Train Local_Simple,  epoch  42, local model 16, internal_epoch   1,  Average loss: 0.0003, Accuracy: 811/817 (99.2656%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.8866, Accuracy: 6334/10000 (63.3400%)
___Train Local_Simple,  epoch  42, local model 77, internal_epoch   1,  Average loss: 0.0016, Accuracy: 597/618 (96.6019%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 5.9023, Accuracy: 2921/10000 (29.2100%)
___Train Local_Simple,  epoch  42, local model 72, internal_epoch   1,  Average loss: 0.0016, Accuracy: 410/423 (96.9267%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 2.5618, Accuracy: 4097/10000 (40.9700%)
___Train Local_Simple,  epoch  42, local model 68, internal_epoch   1,  Average loss: 0.0014, Accuracy: 533/549 (97.0856%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 3.9761, Accuracy: 3891/10000 (38.9100%)
___Train Local_Simple,  epoch  42, local model 91, internal_epoch   1,  Average loss: 0.0006, Accuracy: 807/819 (98.5348%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 2.9555, Accuracy: 4648/10000 (46.4800%)
___Train Local_Simple,  epoch  42, local model 98, internal_epoch   1,  Average loss: 0.0013, Accuracy: 535/548 (97.6277%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 4.6008, Accuracy: 3699/10000 (36.9900%)
___Train Local_Simple,  epoch  42, local model 87, internal_epoch   1,  Average loss: 0.0010, Accuracy: 647/663 (97.5867%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 4.3785, Accuracy: 3842/10000 (38.4200%)
___Train Local_Simple,  epoch  42, local model 28, internal_epoch   1,  Average loss: 0.0006, Accuracy: 604/611 (98.8543%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 2.5823, Accuracy: 6418/10000 (64.1800%)
___Train Local_Simple,  epoch  42, local model 46, internal_epoch   1,  Average loss: 0.0005, Accuracy: 644/650 (99.0769%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 2.0440, Accuracy: 5746/10000 (57.4600%)
___Train Local_Simple,  epoch  42, local model 39, internal_epoch   1,  Average loss: 0.0006, Accuracy: 486/493 (98.5801%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.6618, Accuracy: 6448/10000 (64.4800%)
___Train Local_Simple,  epoch  42, local model 50, internal_epoch   1,  Average loss: 0.0009, Accuracy: 466/477 (97.6939%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.3629, Accuracy: 6198/10000 (61.9800%)
___Train Local_Simple,  epoch  42, local model 19, internal_epoch   1,  Average loss: 0.0007, Accuracy: 591/598 (98.8294%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.5438, Accuracy: 5742/10000 (57.4200%)
___Train Local_Simple,  epoch  42, local model 90, internal_epoch   1,  Average loss: 0.0031, Accuracy: 575/615 (93.4959%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.1023, Accuracy: 6796/10000 (67.9600%)
___Train Local_Simple,  epoch  42, local model 55, internal_epoch   1,  Average loss: 0.0010, Accuracy: 369/375 (98.4000%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.9197, Accuracy: 7464/10000 (74.6400%)
___Train Local_Simple,  epoch  42, local model 47, internal_epoch   1,  Average loss: 0.0009, Accuracy: 526/534 (98.5019%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 2.9518, Accuracy: 5188/10000 (51.8800%)
___Train Local_Simple,  epoch  42, local model 67, internal_epoch   1,  Average loss: 0.0020, Accuracy: 429/441 (97.2789%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.0941, Accuracy: 6664/10000 (66.6400%)
___Train Local_Simple,  epoch  42, local model 21, internal_epoch   1,  Average loss: 0.0005, Accuracy: 680/687 (98.9811%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 2.3197, Accuracy: 4643/10000 (46.4300%)
___Train Local_Simple,  epoch  42, local model 75, internal_epoch   1,  Average loss: 0.0010, Accuracy: 746/763 (97.7720%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 6.3852, Accuracy: 2813/10000 (28.1300%)
___Train Local_Simple,  epoch  42, local model 97, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1096/1112 (98.5612%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 3.3135, Accuracy: 4412/10000 (44.1200%)
___Train Local_Simple,  epoch  42, local model 69, internal_epoch   1,  Average loss: 0.0012, Accuracy: 658/671 (98.0626%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 4.5115, Accuracy: 3365/10000 (33.6500%)
___Train Local_Simple,  epoch  42, local model 86, internal_epoch   1,  Average loss: 0.0006, Accuracy: 684/692 (98.8439%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 5.8374, Accuracy: 2925/10000 (29.2500%)
___Train Local_Simple,  epoch  42, local model 38, internal_epoch   1,  Average loss: 0.0008, Accuracy: 467/477 (97.9036%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4964, Accuracy: 8461/10000 (84.6100%)
___Train Local_Simple,  epoch  42, local model 0, internal_epoch   1,  Average loss: 0.0009, Accuracy: 428/435 (98.3908%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.7511, Accuracy: 6328/10000 (63.2800%)
___Train Local_Simple,  epoch  42, local model 57, internal_epoch   1,  Average loss: 0.0007, Accuracy: 517/523 (98.8528%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 2.4994, Accuracy: 4490/10000 (44.9000%)
___Train Local_Simple,  epoch  42, local model 10, internal_epoch   1,  Average loss: 0.0011, Accuracy: 561/573 (97.9058%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.7987, Accuracy: 5396/10000 (53.9600%)
___Train Local_Simple,  epoch  42, local model 89, internal_epoch   1,  Average loss: 0.0028, Accuracy: 652/683 (95.4612%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 4.4594, Accuracy: 4582/10000 (45.8200%)
___Train Local_Simple,  epoch  42, local model 81, internal_epoch   1,  Average loss: 0.0010, Accuracy: 624/636 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 2.1852, Accuracy: 4948/10000 (49.4800%)
___Train Local_Simple,  epoch  42, local model 32, internal_epoch   1,  Average loss: 0.0016, Accuracy: 574/590 (97.2881%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 4.5194, Accuracy: 4847/10000 (48.4700%)
___Train Local_Simple,  epoch  42, local model 36, internal_epoch   1,  Average loss: 0.0006, Accuracy: 312/315 (99.0476%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2041, Accuracy: 9325/10000 (93.2500%)
___Train Local_Simple,  epoch  42, local model 27, internal_epoch   1,  Average loss: 0.0007, Accuracy: 737/745 (98.9262%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 2.7732, Accuracy: 5116/10000 (51.1600%)
___Train Local_Simple,  epoch  42, local model 5, internal_epoch   1,  Average loss: 0.0009, Accuracy: 566/578 (97.9239%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.5723, Accuracy: 8293/10000 (82.9300%)
time spent on training: 376.1252384185791
___Test Target_Simple poisoned: False, epoch: 42: Average loss: 0.1181, Accuracy: 9681/10000 (96.8100%)
___Test Target_Simple poisoned: True, epoch: 42: Average loss: 3.0609, Accuracy: 1405/8968 (15.6668%)
saving model
Done in 411.9837784767151 sec.
Server Epoch:43 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 11, 70, 27, 26, 19, 47, 55, 61, 96, 92, 14, 22, 20, 64, 95, 30, 1, 8, 72, 25, 45, 67, 24, 90, 63, 40, 94, 98, 39, 38, 37, 76, 75, 68, 80, 10, 16, 5, 91, 81, 87, 13, 54, 21, 57, 31, 9, 60, 59, 79, 36, 23, 93, 66, 69, 15, 86, 46, 42, 83, 6, 85, 82, 99, 12, 35, 84, 48, 0, 2, 53, 52, 17, 89, 58, 65, 32, 7, 77, 97, 44, 49, 56, 50, 28, 71, 34, 43, 4, 78].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   1,  Average loss: 0.0207, Accuracy: 284/569 (49.9121%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   2,  Average loss: 0.0078, Accuracy: 442/569 (77.6801%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   3,  Average loss: 0.0027, Accuracy: 539/569 (94.7276%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   4,  Average loss: 0.0019, Accuracy: 553/569 (97.1880%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   5,  Average loss: 0.0014, Accuracy: 563/569 (98.9455%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   6,  Average loss: 0.0011, Accuracy: 565/569 (99.2970%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   7,  Average loss: 0.0008, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   8,  Average loss: 0.0005, Accuracy: 569/569 (100.0000%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch   9,  Average loss: 0.0006, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 41, internal_epoch  10,  Average loss: 0.0006, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Global model norm: 15.435656479942693.
Norm before scaling: 15.722321910265036. Distance: 3.5886488826036333
Total norm for 10 adversaries is: 15.722321910265036. distance: 3.5886488826036333
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.6347, Accuracy: 6416/8968 (71.5433%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   1,  Average loss: 0.0115, Accuracy: 373/522 (71.4559%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   2,  Average loss: 0.0037, Accuracy: 468/522 (89.6552%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   3,  Average loss: 0.0012, Accuracy: 509/522 (97.5096%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   4,  Average loss: 0.0007, Accuracy: 518/522 (99.2337%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   5,  Average loss: 0.0006, Accuracy: 517/522 (99.0421%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   6,  Average loss: 0.0006, Accuracy: 518/522 (99.2337%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   7,  Average loss: 0.0004, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   8,  Average loss: 0.0005, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch   9,  Average loss: 0.0005, Accuracy: 518/522 (99.2337%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 73, internal_epoch  10,  Average loss: 0.0004, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Global model norm: 15.435656479942693.
Norm before scaling: 15.562125940691564. Distance: 2.4510405607878956
Total norm for 10 adversaries is: 15.562125940691564. distance: 2.4510405607878956
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0233, Accuracy: 8889/8968 (99.1191%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   1,  Average loss: 0.0176, Accuracy: 211/385 (54.8052%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   2,  Average loss: 0.0057, Accuracy: 353/385 (91.6883%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   3,  Average loss: 0.0024, Accuracy: 373/385 (96.8831%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   4,  Average loss: 0.0018, Accuracy: 378/385 (98.1818%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   5,  Average loss: 0.0015, Accuracy: 378/385 (98.1818%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   6,  Average loss: 0.0011, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   7,  Average loss: 0.0011, Accuracy: 378/385 (98.1818%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   8,  Average loss: 0.0010, Accuracy: 378/385 (98.1818%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch   9,  Average loss: 0.0007, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 51, internal_epoch  10,  Average loss: 0.0008, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Global model norm: 15.435656479942693.
Norm before scaling: 15.64107034908542. Distance: 2.922830027798217
Total norm for 10 adversaries is: 15.64107034908542. distance: 2.922830027798217
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.2096, Accuracy: 8286/8968 (92.3952%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   1,  Average loss: 0.0052, Accuracy: 553/627 (88.1978%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   2,  Average loss: 0.0015, Accuracy: 609/627 (97.1292%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   3,  Average loss: 0.0009, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   4,  Average loss: 0.0008, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   5,  Average loss: 0.0008, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   6,  Average loss: 0.0007, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   7,  Average loss: 0.0004, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   8,  Average loss: 0.0003, Accuracy: 621/627 (99.0431%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch   9,  Average loss: 0.0003, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 74, internal_epoch  10,  Average loss: 0.0005, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Global model norm: 15.435656479942693.
Norm before scaling: 15.600471958943963. Distance: 2.2400969751687985
Total norm for 10 adversaries is: 15.600471958943963. distance: 2.2400969751687985
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0104, Accuracy: 8926/8968 (99.5317%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 3, internal_epoch   1,  Average loss: 0.0213, Accuracy: 285/516 (55.2326%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 3, internal_epoch   2,  Average loss: 0.0117, Accuracy: 366/516 (70.9302%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 3, internal_epoch   3,  Average loss: 0.0038, Accuracy: 494/516 (95.7364%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 3, internal_epoch   4,  Average loss: 0.0026, Accuracy: 503/516 (97.4806%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 3, internal_epoch   5,  Average loss: 0.0018, Accuracy: 511/516 (99.0310%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 3, internal_epoch   6,  Average loss: 0.0014, Accuracy: 511/516 (99.0310%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 3, internal_epoch   7,  Average loss: 0.0009, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 3, internal_epoch   8,  Average loss: 0.0009, Accuracy: 513/516 (99.4186%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 3, internal_epoch   9,  Average loss: 0.0008, Accuracy: 513/516 (99.4186%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 3, internal_epoch  10,  Average loss: 0.0006, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Global model norm: 15.435656479942693.
Norm before scaling: 15.746697458037382. Distance: 3.7907760049126336
Total norm for 10 adversaries is: 15.746697458037382. distance: 3.7907760049126336
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.7790, Accuracy: 6151/8968 (68.5883%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   1,  Average loss: 0.0156, Accuracy: 477/759 (62.8458%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   2,  Average loss: 0.0024, Accuracy: 721/759 (94.9934%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   3,  Average loss: 0.0006, Accuracy: 748/759 (98.5507%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   4,  Average loss: 0.0003, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   5,  Average loss: 0.0003, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   6,  Average loss: 0.0003, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   7,  Average loss: 0.0002, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   8,  Average loss: 0.0003, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   9,  Average loss: 0.0002, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch  10,  Average loss: 0.0002, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Global model norm: 15.435656479942693.
Norm before scaling: 15.882751014391564. Distance: 3.849686295250352
Total norm for 10 adversaries is: 15.882751014391564. distance: 3.849686295250352
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0721, Accuracy: 8738/8968 (97.4353%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 29, internal_epoch   1,  Average loss: 0.0134, Accuracy: 364/506 (71.9368%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 487/506 (96.2451%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 29, internal_epoch   3,  Average loss: 0.0006, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 29, internal_epoch   4,  Average loss: 0.0004, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 29, internal_epoch   5,  Average loss: 0.0003, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 29, internal_epoch   6,  Average loss: 0.0003, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 29, internal_epoch   7,  Average loss: 0.0003, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 29, internal_epoch   8,  Average loss: 0.0004, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 29, internal_epoch   9,  Average loss: 0.0004, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 29, internal_epoch  10,  Average loss: 0.0003, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Global model norm: 15.435656479942693.
Norm before scaling: 15.770124868843183. Distance: 3.087068683597917
Total norm for 10 adversaries is: 15.770124868843183. distance: 3.087068683597917
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.5864, Accuracy: 6777/8968 (75.5687%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 62, internal_epoch   1,  Average loss: 0.0045, Accuracy: 514/580 (88.6207%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 62, internal_epoch   2,  Average loss: 0.0020, Accuracy: 552/580 (95.1724%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 62, internal_epoch   3,  Average loss: 0.0008, Accuracy: 569/580 (98.1034%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 62, internal_epoch   4,  Average loss: 0.0007, Accuracy: 570/580 (98.2759%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 62, internal_epoch   5,  Average loss: 0.0008, Accuracy: 570/580 (98.2759%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 62, internal_epoch   6,  Average loss: 0.0007, Accuracy: 571/580 (98.4483%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 62, internal_epoch   7,  Average loss: 0.0007, Accuracy: 569/580 (98.1034%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 62, internal_epoch   8,  Average loss: 0.0006, Accuracy: 571/580 (98.4483%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 62, internal_epoch   9,  Average loss: 0.0006, Accuracy: 574/580 (98.9655%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 62, internal_epoch  10,  Average loss: 0.0006, Accuracy: 574/580 (98.9655%), train_poison_data_count: 292
Global model norm: 15.435656479942693.
Norm before scaling: 15.559473930821255. Distance: 2.019764161836648
Total norm for 10 adversaries is: 15.559473930821255. distance: 2.019764161836648
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0169, Accuracy: 8910/8968 (99.3533%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 33, internal_epoch   1,  Average loss: 0.0190, Accuracy: 337/587 (57.4106%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 33, internal_epoch   2,  Average loss: 0.0055, Accuracy: 489/587 (83.3049%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 33, internal_epoch   3,  Average loss: 0.0009, Accuracy: 581/587 (98.9779%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 33, internal_epoch   4,  Average loss: 0.0006, Accuracy: 582/587 (99.1482%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 33, internal_epoch   5,  Average loss: 0.0004, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 33, internal_epoch   6,  Average loss: 0.0004, Accuracy: 585/587 (99.6593%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 33, internal_epoch   7,  Average loss: 0.0004, Accuracy: 583/587 (99.3186%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 33, internal_epoch   8,  Average loss: 0.0005, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 33, internal_epoch   9,  Average loss: 0.0002, Accuracy: 586/587 (99.8296%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 33, internal_epoch  10,  Average loss: 0.0005, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Global model norm: 15.435656479942693.
Norm before scaling: 15.821163653800928. Distance: 3.857273533540087
Total norm for 10 adversaries is: 15.821163653800928. distance: 3.857273533540087
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 1.2867, Accuracy: 4978/8968 (55.5085%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 88, internal_epoch   1,  Average loss: 0.0113, Accuracy: 556/734 (75.7493%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 88, internal_epoch   2,  Average loss: 0.0028, Accuracy: 686/734 (93.4605%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 88, internal_epoch   3,  Average loss: 0.0012, Accuracy: 713/734 (97.1390%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 88, internal_epoch   4,  Average loss: 0.0008, Accuracy: 719/734 (97.9564%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 88, internal_epoch   5,  Average loss: 0.0007, Accuracy: 725/734 (98.7738%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 88, internal_epoch   6,  Average loss: 0.0006, Accuracy: 722/734 (98.3651%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 88, internal_epoch   7,  Average loss: 0.0005, Accuracy: 725/734 (98.7738%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 88, internal_epoch   8,  Average loss: 0.0006, Accuracy: 726/734 (98.9101%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 88, internal_epoch   9,  Average loss: 0.0006, Accuracy: 725/734 (98.7738%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 88, internal_epoch  10,  Average loss: 0.0004, Accuracy: 730/734 (99.4550%), train_poison_data_count: 382
Global model norm: 15.435656479942693.
Norm before scaling: 15.786840555247172. Distance: 3.4018594986273136
Total norm for 10 adversaries is: 15.786840555247172. distance: 3.4018594986273136
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0580, Accuracy: 8782/8968 (97.9260%)
___Train Local_Simple,  epoch  43, local model 11, internal_epoch   1,  Average loss: 0.0006, Accuracy: 549/554 (99.0975%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.4487, Accuracy: 7009/10000 (70.0900%)
___Train Local_Simple,  epoch  43, local model 70, internal_epoch   1,  Average loss: 0.0011, Accuracy: 558/568 (98.2394%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.1275, Accuracy: 5371/10000 (53.7100%)
___Train Local_Simple,  epoch  43, local model 27, internal_epoch   1,  Average loss: 0.0009, Accuracy: 731/745 (98.1208%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 4.0347, Accuracy: 3653/10000 (36.5300%)
___Train Local_Simple,  epoch  43, local model 26, internal_epoch   1,  Average loss: 0.0007, Accuracy: 514/519 (99.0366%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.6491, Accuracy: 5233/10000 (52.3300%)
___Train Local_Simple,  epoch  43, local model 19, internal_epoch   1,  Average loss: 0.0007, Accuracy: 593/598 (99.1639%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.4301, Accuracy: 5414/10000 (54.1400%)
___Train Local_Simple,  epoch  43, local model 47, internal_epoch   1,  Average loss: 0.0007, Accuracy: 527/534 (98.6891%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.7036, Accuracy: 5856/10000 (58.5600%)
___Train Local_Simple,  epoch  43, local model 55, internal_epoch   1,  Average loss: 0.0012, Accuracy: 367/375 (97.8667%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.2027, Accuracy: 5813/10000 (58.1300%)
___Train Local_Simple,  epoch  43, local model 61, internal_epoch   1,  Average loss: 0.0010, Accuracy: 283/287 (98.6063%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.3968, Accuracy: 8756/10000 (87.5600%)
___Train Local_Simple,  epoch  43, local model 96, internal_epoch   1,  Average loss: 0.0009, Accuracy: 524/531 (98.6817%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 3.9435, Accuracy: 4591/10000 (45.9100%)
___Train Local_Simple,  epoch  43, local model 92, internal_epoch   1,  Average loss: 0.0041, Accuracy: 570/611 (93.2897%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.8655, Accuracy: 7242/10000 (72.4200%)
___Train Local_Simple,  epoch  43, local model 14, internal_epoch   1,  Average loss: 0.0014, Accuracy: 670/692 (96.8208%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.4735, Accuracy: 6210/10000 (62.1000%)
___Train Local_Simple,  epoch  43, local model 22, internal_epoch   1,  Average loss: 0.0007, Accuracy: 258/262 (98.4733%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.6401, Accuracy: 8396/10000 (83.9600%)
___Train Local_Simple,  epoch  43, local model 20, internal_epoch   1,  Average loss: 0.0008, Accuracy: 594/602 (98.6711%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.1304, Accuracy: 5869/10000 (58.6900%)
___Train Local_Simple,  epoch  43, local model 64, internal_epoch   1,  Average loss: 0.0004, Accuracy: 605/608 (99.5066%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.7246, Accuracy: 5561/10000 (55.6100%)
___Train Local_Simple,  epoch  43, local model 95, internal_epoch   1,  Average loss: 0.0026, Accuracy: 574/600 (95.6667%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.1654, Accuracy: 7041/10000 (70.4100%)
___Train Local_Simple,  epoch  43, local model 30, internal_epoch   1,  Average loss: 0.0012, Accuracy: 436/443 (98.4199%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.9289, Accuracy: 7371/10000 (73.7100%)
___Train Local_Simple,  epoch  43, local model 1, internal_epoch   1,  Average loss: 0.0005, Accuracy: 534/536 (99.6269%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.3754, Accuracy: 8824/10000 (88.2400%)
___Train Local_Simple,  epoch  43, local model 8, internal_epoch   1,  Average loss: 0.0006, Accuracy: 701/706 (99.2918%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.2445, Accuracy: 5254/10000 (52.5400%)
___Train Local_Simple,  epoch  43, local model 72, internal_epoch   1,  Average loss: 0.0016, Accuracy: 410/423 (96.9267%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.9534, Accuracy: 5092/10000 (50.9200%)
___Train Local_Simple,  epoch  43, local model 25, internal_epoch   1,  Average loss: 0.0005, Accuracy: 587/592 (99.1554%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.6709, Accuracy: 6272/10000 (62.7200%)
___Train Local_Simple,  epoch  43, local model 45, internal_epoch   1,  Average loss: 0.0016, Accuracy: 627/647 (96.9088%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.8157, Accuracy: 6339/10000 (63.3900%)
___Train Local_Simple,  epoch  43, local model 67, internal_epoch   1,  Average loss: 0.0011, Accuracy: 434/441 (98.4127%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.4542, Accuracy: 5934/10000 (59.3400%)
___Train Local_Simple,  epoch  43, local model 24, internal_epoch   1,  Average loss: 0.0015, Accuracy: 468/477 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.7366, Accuracy: 6277/10000 (62.7700%)
___Train Local_Simple,  epoch  43, local model 90, internal_epoch   1,  Average loss: 0.0008, Accuracy: 606/615 (98.5366%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.2548, Accuracy: 5699/10000 (56.9900%)
___Train Local_Simple,  epoch  43, local model 63, internal_epoch   1,  Average loss: 0.0011, Accuracy: 296/303 (97.6898%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.2604, Accuracy: 6948/10000 (69.4800%)
___Train Local_Simple,  epoch  43, local model 40, internal_epoch   1,  Average loss: 0.0004, Accuracy: 495/498 (99.3976%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.9580, Accuracy: 5737/10000 (57.3700%)
___Train Local_Simple,  epoch  43, local model 94, internal_epoch   1,  Average loss: 0.0009, Accuracy: 659/671 (98.2116%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.5662, Accuracy: 6086/10000 (60.8600%)
___Train Local_Simple,  epoch  43, local model 98, internal_epoch   1,  Average loss: 0.0011, Accuracy: 537/548 (97.9927%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.9583, Accuracy: 4471/10000 (44.7100%)
___Train Local_Simple,  epoch  43, local model 39, internal_epoch   1,  Average loss: 0.0009, Accuracy: 483/493 (97.9716%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 3.3092, Accuracy: 4855/10000 (48.5500%)
___Train Local_Simple,  epoch  43, local model 38, internal_epoch   1,  Average loss: 0.0008, Accuracy: 470/477 (98.5325%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.7419, Accuracy: 7938/10000 (79.3800%)
___Train Local_Simple,  epoch  43, local model 37, internal_epoch   1,  Average loss: 0.0012, Accuracy: 447/456 (98.0263%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.2131, Accuracy: 6467/10000 (64.6700%)
___Train Local_Simple,  epoch  43, local model 76, internal_epoch   1,  Average loss: 0.0017, Accuracy: 447/459 (97.3856%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.3853, Accuracy: 7542/10000 (75.4200%)
___Train Local_Simple,  epoch  43, local model 75, internal_epoch   1,  Average loss: 0.0011, Accuracy: 745/763 (97.6409%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.7250, Accuracy: 5085/10000 (50.8500%)
___Train Local_Simple,  epoch  43, local model 68, internal_epoch   1,  Average loss: 0.0011, Accuracy: 541/549 (98.5428%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.0131, Accuracy: 5880/10000 (58.8000%)
___Train Local_Simple,  epoch  43, local model 80, internal_epoch   1,  Average loss: 0.0021, Accuracy: 508/532 (95.4887%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 5.2183, Accuracy: 2963/10000 (29.6300%)
___Train Local_Simple,  epoch  43, local model 10, internal_epoch   1,  Average loss: 0.0008, Accuracy: 567/573 (98.9529%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 3.0658, Accuracy: 4332/10000 (43.3200%)
___Train Local_Simple,  epoch  43, local model 16, internal_epoch   1,  Average loss: 0.0003, Accuracy: 815/817 (99.7552%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.9522, Accuracy: 6515/10000 (65.1500%)
___Train Local_Simple,  epoch  43, local model 5, internal_epoch   1,  Average loss: 0.0010, Accuracy: 567/578 (98.0969%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.6307, Accuracy: 8059/10000 (80.5900%)
___Train Local_Simple,  epoch  43, local model 91, internal_epoch   1,  Average loss: 0.0004, Accuracy: 814/819 (99.3895%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.2531, Accuracy: 5038/10000 (50.3800%)
___Train Local_Simple,  epoch  43, local model 81, internal_epoch   1,  Average loss: 0.0009, Accuracy: 628/636 (98.7421%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.6804, Accuracy: 5813/10000 (58.1300%)
___Train Local_Simple,  epoch  43, local model 87, internal_epoch   1,  Average loss: 0.0007, Accuracy: 655/663 (98.7934%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 3.2533, Accuracy: 5235/10000 (52.3500%)
___Train Local_Simple,  epoch  43, local model 13, internal_epoch   1,  Average loss: 0.0007, Accuracy: 702/713 (98.4572%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 3.8271, Accuracy: 4318/10000 (43.1800%)
___Train Local_Simple,  epoch  43, local model 54, internal_epoch   1,  Average loss: 0.0007, Accuracy: 817/832 (98.1971%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 3.8828, Accuracy: 4380/10000 (43.8000%)
___Train Local_Simple,  epoch  43, local model 21, internal_epoch   1,  Average loss: 0.0005, Accuracy: 680/687 (98.9811%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.7297, Accuracy: 5208/10000 (52.0800%)
___Train Local_Simple,  epoch  43, local model 57, internal_epoch   1,  Average loss: 0.0007, Accuracy: 518/523 (99.0440%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.8097, Accuracy: 5411/10000 (54.1100%)
___Train Local_Simple,  epoch  43, local model 31, internal_epoch   1,  Average loss: 0.0006, Accuracy: 588/596 (98.6577%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.6721, Accuracy: 6158/10000 (61.5800%)
___Train Local_Simple,  epoch  43, local model 9, internal_epoch   1,  Average loss: 0.0010, Accuracy: 499/508 (98.2283%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.1033, Accuracy: 6876/10000 (68.7600%)
___Train Local_Simple,  epoch  43, local model 60, internal_epoch   1,  Average loss: 0.0020, Accuracy: 552/571 (96.6725%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.1922, Accuracy: 4623/10000 (46.2300%)
___Train Local_Simple,  epoch  43, local model 59, internal_epoch   1,  Average loss: 0.0007, Accuracy: 635/644 (98.6025%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.6477, Accuracy: 5029/10000 (50.2900%)
___Train Local_Simple,  epoch  43, local model 79, internal_epoch   1,  Average loss: 0.0009, Accuracy: 655/661 (99.0923%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.2339, Accuracy: 7036/10000 (70.3600%)
___Train Local_Simple,  epoch  43, local model 36, internal_epoch   1,  Average loss: 0.0008, Accuracy: 310/315 (98.4127%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.4409, Accuracy: 8711/10000 (87.1100%)
___Train Local_Simple,  epoch  43, local model 23, internal_epoch   1,  Average loss: 0.0013, Accuracy: 532/542 (98.1550%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 3.7490, Accuracy: 4134/10000 (41.3400%)
___Train Local_Simple,  epoch  43, local model 93, internal_epoch   1,  Average loss: 0.0013, Accuracy: 613/630 (97.3016%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.9859, Accuracy: 4411/10000 (44.1100%)
___Train Local_Simple,  epoch  43, local model 66, internal_epoch   1,  Average loss: 0.0022, Accuracy: 713/733 (97.2715%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.5779, Accuracy: 5545/10000 (55.4500%)
___Train Local_Simple,  epoch  43, local model 69, internal_epoch   1,  Average loss: 0.0012, Accuracy: 655/671 (97.6155%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 6.1481, Accuracy: 3340/10000 (33.4000%)
___Train Local_Simple,  epoch  43, local model 15, internal_epoch   1,  Average loss: 0.0012, Accuracy: 279/282 (98.9362%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.7138, Accuracy: 8150/10000 (81.5000%)
___Train Local_Simple,  epoch  43, local model 86, internal_epoch   1,  Average loss: 0.0005, Accuracy: 687/692 (99.2775%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 3.3976, Accuracy: 4224/10000 (42.2400%)
___Train Local_Simple,  epoch  43, local model 46, internal_epoch   1,  Average loss: 0.0008, Accuracy: 640/650 (98.4615%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 3.3169, Accuracy: 4786/10000 (47.8600%)
___Train Local_Simple,  epoch  43, local model 42, internal_epoch   1,  Average loss: 0.0006, Accuracy: 469/473 (99.1543%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.0061, Accuracy: 6969/10000 (69.6900%)
___Train Local_Simple,  epoch  43, local model 83, internal_epoch   1,  Average loss: 0.0010, Accuracy: 354/360 (98.3333%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.4508, Accuracy: 8633/10000 (86.3300%)
___Train Local_Simple,  epoch  43, local model 6, internal_epoch   1,  Average loss: 0.0008, Accuracy: 430/435 (98.8506%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.7787, Accuracy: 7061/10000 (70.6100%)
___Train Local_Simple,  epoch  43, local model 85, internal_epoch   1,  Average loss: 0.0012, Accuracy: 789/807 (97.7695%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.8125, Accuracy: 5708/10000 (57.0800%)
___Train Local_Simple,  epoch  43, local model 82, internal_epoch   1,  Average loss: 0.0007, Accuracy: 803/815 (98.5276%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 3.3060, Accuracy: 4976/10000 (49.7600%)
___Train Local_Simple,  epoch  43, local model 99, internal_epoch   1,  Average loss: 0.0019, Accuracy: 684/712 (96.0674%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.8104, Accuracy: 6427/10000 (64.2700%)
___Train Local_Simple,  epoch  43, local model 12, internal_epoch   1,  Average loss: 0.0007, Accuracy: 716/725 (98.7586%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.5636, Accuracy: 6555/10000 (65.5500%)
___Train Local_Simple,  epoch  43, local model 35, internal_epoch   1,  Average loss: 0.0014, Accuracy: 616/630 (97.7778%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 3.9322, Accuracy: 4318/10000 (43.1800%)
___Train Local_Simple,  epoch  43, local model 84, internal_epoch   1,  Average loss: 0.0009, Accuracy: 412/420 (98.0952%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.6923, Accuracy: 8041/10000 (80.4100%)
___Train Local_Simple,  epoch  43, local model 48, internal_epoch   1,  Average loss: 0.0011, Accuracy: 355/363 (97.7961%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.8574, Accuracy: 7686/10000 (76.8600%)
___Train Local_Simple,  epoch  43, local model 0, internal_epoch   1,  Average loss: 0.0007, Accuracy: 430/435 (98.8506%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.9088, Accuracy: 7296/10000 (72.9600%)
___Train Local_Simple,  epoch  43, local model 2, internal_epoch   1,  Average loss: 0.0013, Accuracy: 551/564 (97.6950%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.7026, Accuracy: 5870/10000 (58.7000%)
___Train Local_Simple,  epoch  43, local model 53, internal_epoch   1,  Average loss: 0.0009, Accuracy: 552/561 (98.3957%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.8853, Accuracy: 5535/10000 (55.3500%)
___Train Local_Simple,  epoch  43, local model 52, internal_epoch   1,  Average loss: 0.0010, Accuracy: 768/789 (97.3384%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 6.1585, Accuracy: 3444/10000 (34.4400%)
___Train Local_Simple,  epoch  43, local model 17, internal_epoch   1,  Average loss: 0.0007, Accuracy: 518/527 (98.2922%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.8912, Accuracy: 4598/10000 (45.9800%)
___Train Local_Simple,  epoch  43, local model 89, internal_epoch   1,  Average loss: 0.0014, Accuracy: 664/683 (97.2182%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.7099, Accuracy: 6415/10000 (64.1500%)
___Train Local_Simple,  epoch  43, local model 58, internal_epoch   1,  Average loss: 0.0009, Accuracy: 760/772 (98.4456%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.5592, Accuracy: 6400/10000 (64.0000%)
___Train Local_Simple,  epoch  43, local model 65, internal_epoch   1,  Average loss: 0.0013, Accuracy: 607/621 (97.7456%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.1133, Accuracy: 4100/10000 (41.0000%)
___Train Local_Simple,  epoch  43, local model 32, internal_epoch   1,  Average loss: 0.0006, Accuracy: 585/590 (99.1525%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.8944, Accuracy: 6310/10000 (63.1000%)
___Train Local_Simple,  epoch  43, local model 7, internal_epoch   1,  Average loss: 0.0005, Accuracy: 796/802 (99.2519%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.9024, Accuracy: 5524/10000 (55.2400%)
___Train Local_Simple,  epoch  43, local model 77, internal_epoch   1,  Average loss: 0.0012, Accuracy: 604/618 (97.7346%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.7965, Accuracy: 6259/10000 (62.5900%)
___Train Local_Simple,  epoch  43, local model 97, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1103/1112 (99.1906%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 4.7103, Accuracy: 4047/10000 (40.4700%)
___Train Local_Simple,  epoch  43, local model 44, internal_epoch   1,  Average loss: 0.0006, Accuracy: 554/561 (98.7522%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 3.0211, Accuracy: 5612/10000 (56.1200%)
___Train Local_Simple,  epoch  43, local model 49, internal_epoch   1,  Average loss: 0.0010, Accuracy: 350/355 (98.5915%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.0245, Accuracy: 7031/10000 (70.3100%)
___Train Local_Simple,  epoch  43, local model 56, internal_epoch   1,  Average loss: 0.0006, Accuracy: 709/715 (99.1608%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.3239, Accuracy: 5359/10000 (53.5900%)
___Train Local_Simple,  epoch  43, local model 50, internal_epoch   1,  Average loss: 0.0009, Accuracy: 469/477 (98.3229%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.3817, Accuracy: 6307/10000 (63.0700%)
___Train Local_Simple,  epoch  43, local model 28, internal_epoch   1,  Average loss: 0.0009, Accuracy: 602/611 (98.5270%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.7391, Accuracy: 6692/10000 (66.9200%)
___Train Local_Simple,  epoch  43, local model 71, internal_epoch   1,  Average loss: 0.0010, Accuracy: 552/561 (98.3957%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.6043, Accuracy: 5959/10000 (59.5900%)
___Train Local_Simple,  epoch  43, local model 34, internal_epoch   1,  Average loss: 0.0011, Accuracy: 854/871 (98.0482%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 4.2582, Accuracy: 4488/10000 (44.8800%)
___Train Local_Simple,  epoch  43, local model 43, internal_epoch   1,  Average loss: 0.0008, Accuracy: 426/431 (98.8399%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.0991, Accuracy: 7022/10000 (70.2200%)
___Train Local_Simple,  epoch  43, local model 4, internal_epoch   1,  Average loss: 0.0008, Accuracy: 735/748 (98.2620%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.7228, Accuracy: 5007/10000 (50.0700%)
___Train Local_Simple,  epoch  43, local model 78, internal_epoch   1,  Average loss: 0.0018, Accuracy: 567/587 (96.5928%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.6622, Accuracy: 4924/10000 (49.2400%)
time spent on training: 410.67225432395935
___Test Target_Simple poisoned: False, epoch: 43: Average loss: 0.1184, Accuracy: 9666/10000 (96.6600%)
___Test Target_Simple poisoned: True, epoch: 43: Average loss: 3.5692, Accuracy: 823/8968 (9.1771%)
saving model
Done in 447.4296362400055 sec.
Server Epoch:44 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 37, 94, 13, 72, 57, 32, 43, 22, 38, 36, 42, 45, 10, 63, 75, 86, 24, 81, 91, 56, 97, 50, 58, 14, 47, 80, 69, 2, 48, 28, 39, 85, 98, 65, 76, 89, 4, 79, 49, 35, 55, 82, 70, 84, 12, 26, 77, 11, 90, 8, 21, 20, 96, 17, 95, 59, 23, 15, 54, 0, 1, 64, 99, 60, 40, 53, 5, 67, 71, 83, 78, 44, 93, 66, 92, 27, 61, 46, 52, 34, 19, 31, 6, 25, 9, 87, 7, 16, 68, 30].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   1,  Average loss: 0.0205, Accuracy: 289/569 (50.7909%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   2,  Average loss: 0.0074, Accuracy: 448/569 (78.7346%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   3,  Average loss: 0.0021, Accuracy: 552/569 (97.0123%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   4,  Average loss: 0.0014, Accuracy: 564/569 (99.1213%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   5,  Average loss: 0.0011, Accuracy: 565/569 (99.2970%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   6,  Average loss: 0.0007, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   7,  Average loss: 0.0006, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   8,  Average loss: 0.0004, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch   9,  Average loss: 0.0004, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 41, internal_epoch  10,  Average loss: 0.0004, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Global model norm: 15.44602378862943.
Norm before scaling: 15.713200281481093. Distance: 3.5498827310454644
Total norm for 10 adversaries is: 15.713200281481093. distance: 3.5498827310454644
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.5446, Accuracy: 6811/8968 (75.9478%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   1,  Average loss: 0.0133, Accuracy: 374/522 (71.6475%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   2,  Average loss: 0.0056, Accuracy: 420/522 (80.4598%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   3,  Average loss: 0.0014, Accuracy: 512/522 (98.0843%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   4,  Average loss: 0.0009, Accuracy: 517/522 (99.0421%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   5,  Average loss: 0.0008, Accuracy: 518/522 (99.2337%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   6,  Average loss: 0.0006, Accuracy: 518/522 (99.2337%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   7,  Average loss: 0.0006, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   8,  Average loss: 0.0006, Accuracy: 518/522 (99.2337%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   9,  Average loss: 0.0006, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch  10,  Average loss: 0.0004, Accuracy: 522/522 (100.0000%), train_poison_data_count: 266
Global model norm: 15.44602378862943.
Norm before scaling: 15.58416098506424. Distance: 2.8703693747661143
Total norm for 10 adversaries is: 15.58416098506424. distance: 2.8703693747661143
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0209, Accuracy: 8892/8968 (99.1525%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   1,  Average loss: 0.0180, Accuracy: 214/385 (55.5844%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   2,  Average loss: 0.0088, Accuracy: 317/385 (82.3377%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   3,  Average loss: 0.0029, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   4,  Average loss: 0.0022, Accuracy: 383/385 (99.4805%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   5,  Average loss: 0.0019, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   6,  Average loss: 0.0015, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   7,  Average loss: 0.0012, Accuracy: 381/385 (98.9610%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   8,  Average loss: 0.0009, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch   9,  Average loss: 0.0007, Accuracy: 384/385 (99.7403%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 51, internal_epoch  10,  Average loss: 0.0010, Accuracy: 381/385 (98.9610%), train_poison_data_count: 193
Global model norm: 15.44602378862943.
Norm before scaling: 15.655238806073681. Distance: 2.743611370920593
Total norm for 10 adversaries is: 15.655238806073681. distance: 2.743611370920593
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.2932, Accuracy: 7951/8968 (88.6597%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   1,  Average loss: 0.0070, Accuracy: 547/627 (87.2408%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   2,  Average loss: 0.0015, Accuracy: 611/627 (97.4482%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   3,  Average loss: 0.0010, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   4,  Average loss: 0.0006, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   5,  Average loss: 0.0009, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   6,  Average loss: 0.0005, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   7,  Average loss: 0.0007, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   8,  Average loss: 0.0007, Accuracy: 616/627 (98.2456%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch   9,  Average loss: 0.0009, Accuracy: 616/627 (98.2456%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 74, internal_epoch  10,  Average loss: 0.0009, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Global model norm: 15.44602378862943.
Norm before scaling: 15.664237841911389. Distance: 2.6282260689369354
Total norm for 10 adversaries is: 15.664237841911389. distance: 2.6282260689369354
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0134, Accuracy: 8923/8968 (99.4982%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 3, internal_epoch   1,  Average loss: 0.0250, Accuracy: 265/516 (51.3566%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 3, internal_epoch   2,  Average loss: 0.0095, Accuracy: 355/516 (68.7984%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 3, internal_epoch   3,  Average loss: 0.0031, Accuracy: 484/516 (93.7984%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 3, internal_epoch   4,  Average loss: 0.0021, Accuracy: 494/516 (95.7364%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 3, internal_epoch   5,  Average loss: 0.0015, Accuracy: 512/516 (99.2248%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 3, internal_epoch   6,  Average loss: 0.0014, Accuracy: 513/516 (99.4186%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 3, internal_epoch   7,  Average loss: 0.0008, Accuracy: 516/516 (100.0000%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 3, internal_epoch   8,  Average loss: 0.0008, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 3, internal_epoch   9,  Average loss: 0.0007, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 3, internal_epoch  10,  Average loss: 0.0008, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Global model norm: 15.44602378862943.
Norm before scaling: 15.79255570431297. Distance: 4.237186638602501
Total norm for 10 adversaries is: 15.79255570431297. distance: 4.237186638602501
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.5164, Accuracy: 7159/8968 (79.8283%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 18, internal_epoch   1,  Average loss: 0.0150, Accuracy: 487/759 (64.1634%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 18, internal_epoch   2,  Average loss: 0.0018, Accuracy: 737/759 (97.1014%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 18, internal_epoch   3,  Average loss: 0.0007, Accuracy: 747/759 (98.4190%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 18, internal_epoch   4,  Average loss: 0.0005, Accuracy: 752/759 (99.0777%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 18, internal_epoch   5,  Average loss: 0.0003, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 18, internal_epoch   6,  Average loss: 0.0003, Accuracy: 754/759 (99.3412%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 18, internal_epoch   7,  Average loss: 0.0003, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 18, internal_epoch   8,  Average loss: 0.0003, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 18, internal_epoch   9,  Average loss: 0.0002, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 18, internal_epoch  10,  Average loss: 0.0002, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Global model norm: 15.44602378862943.
Norm before scaling: 15.922278461828748. Distance: 3.8527512021757517
Total norm for 10 adversaries is: 15.922278461828748. distance: 3.8527512021757517
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0824, Accuracy: 8727/8968 (97.3127%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 29, internal_epoch   1,  Average loss: 0.0172, Accuracy: 329/506 (65.0198%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 29, internal_epoch   2,  Average loss: 0.0048, Accuracy: 484/506 (95.6522%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 29, internal_epoch   3,  Average loss: 0.0013, Accuracy: 499/506 (98.6166%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 29, internal_epoch   4,  Average loss: 0.0010, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 29, internal_epoch   5,  Average loss: 0.0009, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 29, internal_epoch   6,  Average loss: 0.0006, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 29, internal_epoch   7,  Average loss: 0.0008, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 29, internal_epoch   8,  Average loss: 0.0007, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 29, internal_epoch   9,  Average loss: 0.0006, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 29, internal_epoch  10,  Average loss: 0.0006, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Global model norm: 15.44602378862943.
Norm before scaling: 15.823049049585416. Distance: 3.5985162061331923
Total norm for 10 adversaries is: 15.823049049585416. distance: 3.5985162061331923
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 1.2027, Accuracy: 4721/8968 (52.6427%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 62, internal_epoch   1,  Average loss: 0.0065, Accuracy: 486/580 (83.7931%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 62, internal_epoch   2,  Average loss: 0.0022, Accuracy: 556/580 (95.8621%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 62, internal_epoch   3,  Average loss: 0.0012, Accuracy: 562/580 (96.8966%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 62, internal_epoch   4,  Average loss: 0.0007, Accuracy: 569/580 (98.1034%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 62, internal_epoch   5,  Average loss: 0.0008, Accuracy: 570/580 (98.2759%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 62, internal_epoch   6,  Average loss: 0.0007, Accuracy: 570/580 (98.2759%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 62, internal_epoch   7,  Average loss: 0.0007, Accuracy: 572/580 (98.6207%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 62, internal_epoch   8,  Average loss: 0.0005, Accuracy: 574/580 (98.9655%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 62, internal_epoch   9,  Average loss: 0.0006, Accuracy: 572/580 (98.6207%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 62, internal_epoch  10,  Average loss: 0.0008, Accuracy: 572/580 (98.6207%), train_poison_data_count: 292
Global model norm: 15.44602378862943.
Norm before scaling: 15.662528661654491. Distance: 2.452782090633177
Total norm for 10 adversaries is: 15.662528661654491. distance: 2.452782090633177
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0264, Accuracy: 8869/8968 (98.8961%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 33, internal_epoch   1,  Average loss: 0.0214, Accuracy: 330/587 (56.2181%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 33, internal_epoch   2,  Average loss: 0.0102, Accuracy: 417/587 (71.0392%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 33, internal_epoch   3,  Average loss: 0.0032, Accuracy: 566/587 (96.4225%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 33, internal_epoch   4,  Average loss: 0.0026, Accuracy: 571/587 (97.2743%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 33, internal_epoch   5,  Average loss: 0.0015, Accuracy: 581/587 (98.9779%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 33, internal_epoch   6,  Average loss: 0.0013, Accuracy: 573/587 (97.6150%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 33, internal_epoch   7,  Average loss: 0.0013, Accuracy: 576/587 (98.1261%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 33, internal_epoch   8,  Average loss: 0.0009, Accuracy: 581/587 (98.9779%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 33, internal_epoch   9,  Average loss: 0.0006, Accuracy: 583/587 (99.3186%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 33, internal_epoch  10,  Average loss: 0.0007, Accuracy: 582/587 (99.1482%), train_poison_data_count: 299
Global model norm: 15.44602378862943.
Norm before scaling: 15.799106640246556. Distance: 4.434763534761795
Total norm for 10 adversaries is: 15.799106640246556. distance: 4.434763534761795
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 1.2542, Accuracy: 5754/8968 (64.1615%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 88, internal_epoch   1,  Average loss: 0.0111, Accuracy: 538/734 (73.2970%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 88, internal_epoch   2,  Average loss: 0.0025, Accuracy: 701/734 (95.5041%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 88, internal_epoch   3,  Average loss: 0.0009, Accuracy: 720/734 (98.0926%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 88, internal_epoch   4,  Average loss: 0.0006, Accuracy: 724/734 (98.6376%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 88, internal_epoch   5,  Average loss: 0.0008, Accuracy: 721/734 (98.2289%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 88, internal_epoch   6,  Average loss: 0.0006, Accuracy: 727/734 (99.0463%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 88, internal_epoch   7,  Average loss: 0.0005, Accuracy: 725/734 (98.7738%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 88, internal_epoch   8,  Average loss: 0.0005, Accuracy: 728/734 (99.1826%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 88, internal_epoch   9,  Average loss: 0.0005, Accuracy: 725/734 (98.7738%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 88, internal_epoch  10,  Average loss: 0.0004, Accuracy: 729/734 (99.3188%), train_poison_data_count: 382
Global model norm: 15.44602378862943.
Norm before scaling: 15.760497939090818. Distance: 3.31567374723016
Total norm for 10 adversaries is: 15.760497939090818. distance: 3.31567374723016
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0686, Accuracy: 8780/8968 (97.9037%)
___Train Local_Simple,  epoch  44, local model 37, internal_epoch   1,  Average loss: 0.0006, Accuracy: 450/456 (98.6842%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.6162, Accuracy: 6960/10000 (69.6000%)
___Train Local_Simple,  epoch  44, local model 94, internal_epoch   1,  Average loss: 0.0006, Accuracy: 661/671 (98.5097%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 3.2485, Accuracy: 5092/10000 (50.9200%)
___Train Local_Simple,  epoch  44, local model 13, internal_epoch   1,  Average loss: 0.0006, Accuracy: 704/713 (98.7377%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.0657, Accuracy: 5648/10000 (56.4800%)
___Train Local_Simple,  epoch  44, local model 72, internal_epoch   1,  Average loss: 0.0014, Accuracy: 412/423 (97.3995%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.4098, Accuracy: 4015/10000 (40.1500%)
___Train Local_Simple,  epoch  44, local model 57, internal_epoch   1,  Average loss: 0.0005, Accuracy: 519/523 (99.2352%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.4299, Accuracy: 6380/10000 (63.8000%)
___Train Local_Simple,  epoch  44, local model 32, internal_epoch   1,  Average loss: 0.0010, Accuracy: 579/590 (98.1356%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.4367, Accuracy: 5759/10000 (57.5900%)
___Train Local_Simple,  epoch  44, local model 43, internal_epoch   1,  Average loss: 0.0007, Accuracy: 424/431 (98.3759%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.8008, Accuracy: 7738/10000 (77.3800%)
___Train Local_Simple,  epoch  44, local model 22, internal_epoch   1,  Average loss: 0.0004, Accuracy: 260/262 (99.2366%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3669, Accuracy: 8804/10000 (88.0400%)
___Train Local_Simple,  epoch  44, local model 38, internal_epoch   1,  Average loss: 0.0007, Accuracy: 470/477 (98.5325%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.4136, Accuracy: 8684/10000 (86.8400%)
___Train Local_Simple,  epoch  44, local model 36, internal_epoch   1,  Average loss: 0.0007, Accuracy: 311/315 (98.7302%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3092, Accuracy: 8930/10000 (89.3000%)
___Train Local_Simple,  epoch  44, local model 42, internal_epoch   1,  Average loss: 0.0003, Accuracy: 472/473 (99.7886%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.7079, Accuracy: 7752/10000 (77.5200%)
___Train Local_Simple,  epoch  44, local model 45, internal_epoch   1,  Average loss: 0.0006, Accuracy: 639/647 (98.7635%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.8526, Accuracy: 5224/10000 (52.2400%)
___Train Local_Simple,  epoch  44, local model 10, internal_epoch   1,  Average loss: 0.0011, Accuracy: 562/573 (98.0803%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.2111, Accuracy: 5157/10000 (51.5700%)
___Train Local_Simple,  epoch  44, local model 63, internal_epoch   1,  Average loss: 0.0019, Accuracy: 294/303 (97.0297%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.6097, Accuracy: 6199/10000 (61.9900%)
___Train Local_Simple,  epoch  44, local model 75, internal_epoch   1,  Average loss: 0.0023, Accuracy: 732/763 (95.9371%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 5.4364, Accuracy: 2927/10000 (29.2700%)
___Train Local_Simple,  epoch  44, local model 86, internal_epoch   1,  Average loss: 0.0006, Accuracy: 683/692 (98.6994%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 4.9767, Accuracy: 3307/10000 (33.0700%)
___Train Local_Simple,  epoch  44, local model 24, internal_epoch   1,  Average loss: 0.0013, Accuracy: 467/477 (97.9036%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.9149, Accuracy: 6964/10000 (69.6400%)
___Train Local_Simple,  epoch  44, local model 81, internal_epoch   1,  Average loss: 0.0009, Accuracy: 626/636 (98.4277%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.5947, Accuracy: 4812/10000 (48.1200%)
___Train Local_Simple,  epoch  44, local model 91, internal_epoch   1,  Average loss: 0.0005, Accuracy: 811/819 (99.0232%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.6129, Accuracy: 4883/10000 (48.8300%)
___Train Local_Simple,  epoch  44, local model 56, internal_epoch   1,  Average loss: 0.0005, Accuracy: 707/715 (98.8811%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.6159, Accuracy: 6231/10000 (62.3100%)
___Train Local_Simple,  epoch  44, local model 97, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1105/1112 (99.3705%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 4.3033, Accuracy: 3995/10000 (39.9500%)
___Train Local_Simple,  epoch  44, local model 50, internal_epoch   1,  Average loss: 0.0008, Accuracy: 469/477 (98.3229%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.2337, Accuracy: 6867/10000 (68.6700%)
___Train Local_Simple,  epoch  44, local model 58, internal_epoch   1,  Average loss: 0.0007, Accuracy: 764/772 (98.9637%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.5036, Accuracy: 5330/10000 (53.3000%)
___Train Local_Simple,  epoch  44, local model 14, internal_epoch   1,  Average loss: 0.0010, Accuracy: 675/692 (97.5434%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.1618, Accuracy: 6782/10000 (67.8200%)
___Train Local_Simple,  epoch  44, local model 47, internal_epoch   1,  Average loss: 0.0009, Accuracy: 525/534 (98.3146%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 3.4176, Accuracy: 4941/10000 (49.4100%)
___Train Local_Simple,  epoch  44, local model 80, internal_epoch   1,  Average loss: 0.0018, Accuracy: 512/532 (96.2406%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 6.1886, Accuracy: 2829/10000 (28.2900%)
___Train Local_Simple,  epoch  44, local model 69, internal_epoch   1,  Average loss: 0.0012, Accuracy: 652/671 (97.1684%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 6.0738, Accuracy: 2909/10000 (29.0900%)
___Train Local_Simple,  epoch  44, local model 2, internal_epoch   1,  Average loss: 0.0008, Accuracy: 556/564 (98.5816%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.5749, Accuracy: 5018/10000 (50.1800%)
___Train Local_Simple,  epoch  44, local model 48, internal_epoch   1,  Average loss: 0.0011, Accuracy: 359/363 (98.8981%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3697, Accuracy: 8750/10000 (87.5000%)
___Train Local_Simple,  epoch  44, local model 28, internal_epoch   1,  Average loss: 0.0014, Accuracy: 597/611 (97.7087%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.9105, Accuracy: 6391/10000 (63.9100%)
___Train Local_Simple,  epoch  44, local model 39, internal_epoch   1,  Average loss: 0.0007, Accuracy: 484/493 (98.1744%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.1097, Accuracy: 7263/10000 (72.6300%)
___Train Local_Simple,  epoch  44, local model 85, internal_epoch   1,  Average loss: 0.0014, Accuracy: 784/807 (97.1499%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 3.4206, Accuracy: 4959/10000 (49.5900%)
___Train Local_Simple,  epoch  44, local model 98, internal_epoch   1,  Average loss: 0.0011, Accuracy: 540/548 (98.5401%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 3.5402, Accuracy: 4113/10000 (41.1300%)
___Train Local_Simple,  epoch  44, local model 65, internal_epoch   1,  Average loss: 0.0014, Accuracy: 604/621 (97.2625%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.0671, Accuracy: 7286/10000 (72.8600%)
___Train Local_Simple,  epoch  44, local model 76, internal_epoch   1,  Average loss: 0.0011, Accuracy: 453/459 (98.6928%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.5060, Accuracy: 8389/10000 (83.8900%)
___Train Local_Simple,  epoch  44, local model 89, internal_epoch   1,  Average loss: 0.0012, Accuracy: 661/683 (96.7789%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 4.6538, Accuracy: 4178/10000 (41.7800%)
___Train Local_Simple,  epoch  44, local model 4, internal_epoch   1,  Average loss: 0.0006, Accuracy: 737/748 (98.5294%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.2982, Accuracy: 4701/10000 (47.0100%)
___Train Local_Simple,  epoch  44, local model 79, internal_epoch   1,  Average loss: 0.0011, Accuracy: 652/661 (98.6384%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.4959, Accuracy: 5758/10000 (57.5800%)
___Train Local_Simple,  epoch  44, local model 49, internal_epoch   1,  Average loss: 0.0009, Accuracy: 350/355 (98.5915%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.2444, Accuracy: 4999/10000 (49.9900%)
___Train Local_Simple,  epoch  44, local model 35, internal_epoch   1,  Average loss: 0.0014, Accuracy: 616/630 (97.7778%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.3055, Accuracy: 5466/10000 (54.6600%)
___Train Local_Simple,  epoch  44, local model 55, internal_epoch   1,  Average loss: 0.0020, Accuracy: 356/375 (94.9333%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.9859, Accuracy: 7580/10000 (75.8000%)
___Train Local_Simple,  epoch  44, local model 82, internal_epoch   1,  Average loss: 0.0009, Accuracy: 801/815 (98.2822%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 3.8561, Accuracy: 3583/10000 (35.8300%)
___Train Local_Simple,  epoch  44, local model 70, internal_epoch   1,  Average loss: 0.0014, Accuracy: 553/568 (97.3592%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.7249, Accuracy: 4257/10000 (42.5700%)
___Train Local_Simple,  epoch  44, local model 84, internal_epoch   1,  Average loss: 0.0006, Accuracy: 412/420 (98.0952%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.8006, Accuracy: 7866/10000 (78.6600%)
___Train Local_Simple,  epoch  44, local model 12, internal_epoch   1,  Average loss: 0.0006, Accuracy: 717/725 (98.8966%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.7329, Accuracy: 6506/10000 (65.0600%)
___Train Local_Simple,  epoch  44, local model 26, internal_epoch   1,  Average loss: 0.0009, Accuracy: 510/519 (98.2659%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 3.1897, Accuracy: 4857/10000 (48.5700%)
___Train Local_Simple,  epoch  44, local model 77, internal_epoch   1,  Average loss: 0.0015, Accuracy: 598/618 (96.7638%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 3.3191, Accuracy: 4421/10000 (44.2100%)
___Train Local_Simple,  epoch  44, local model 11, internal_epoch   1,  Average loss: 0.0006, Accuracy: 550/554 (99.2780%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.8516, Accuracy: 7838/10000 (78.3800%)
___Train Local_Simple,  epoch  44, local model 90, internal_epoch   1,  Average loss: 0.0024, Accuracy: 580/615 (94.3089%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.0495, Accuracy: 7338/10000 (73.3800%)
___Train Local_Simple,  epoch  44, local model 8, internal_epoch   1,  Average loss: 0.0007, Accuracy: 697/706 (98.7252%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 3.2002, Accuracy: 3725/10000 (37.2500%)
___Train Local_Simple,  epoch  44, local model 21, internal_epoch   1,  Average loss: 0.0004, Accuracy: 682/687 (99.2722%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.8020, Accuracy: 5685/10000 (56.8500%)
___Train Local_Simple,  epoch  44, local model 20, internal_epoch   1,  Average loss: 0.0009, Accuracy: 592/602 (98.3389%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.6493, Accuracy: 6319/10000 (63.1900%)
___Train Local_Simple,  epoch  44, local model 96, internal_epoch   1,  Average loss: 0.0009, Accuracy: 521/531 (98.1168%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 5.5306, Accuracy: 3231/10000 (32.3100%)
___Train Local_Simple,  epoch  44, local model 17, internal_epoch   1,  Average loss: 0.0005, Accuracy: 522/527 (99.0512%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.9923, Accuracy: 7066/10000 (70.6600%)
___Train Local_Simple,  epoch  44, local model 95, internal_epoch   1,  Average loss: 0.0026, Accuracy: 575/600 (95.8333%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.4715, Accuracy: 5821/10000 (58.2100%)
___Train Local_Simple,  epoch  44, local model 59, internal_epoch   1,  Average loss: 0.0009, Accuracy: 631/644 (97.9814%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.0553, Accuracy: 5953/10000 (59.5300%)
___Train Local_Simple,  epoch  44, local model 23, internal_epoch   1,  Average loss: 0.0014, Accuracy: 526/542 (97.0480%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.8547, Accuracy: 5096/10000 (50.9600%)
___Train Local_Simple,  epoch  44, local model 15, internal_epoch   1,  Average loss: 0.0007, Accuracy: 280/282 (99.2908%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.2601, Accuracy: 9095/10000 (90.9500%)
___Train Local_Simple,  epoch  44, local model 54, internal_epoch   1,  Average loss: 0.0006, Accuracy: 820/832 (98.5577%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 3.4906, Accuracy: 5046/10000 (50.4600%)
___Train Local_Simple,  epoch  44, local model 0, internal_epoch   1,  Average loss: 0.0008, Accuracy: 430/435 (98.8506%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.7199, Accuracy: 6021/10000 (60.2100%)
___Train Local_Simple,  epoch  44, local model 1, internal_epoch   1,  Average loss: 0.0004, Accuracy: 534/536 (99.6269%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.2146, Accuracy: 9296/10000 (92.9600%)
___Train Local_Simple,  epoch  44, local model 64, internal_epoch   1,  Average loss: 0.0007, Accuracy: 602/608 (99.0132%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.3278, Accuracy: 5066/10000 (50.6600%)
___Train Local_Simple,  epoch  44, local model 99, internal_epoch   1,  Average loss: 0.0021, Accuracy: 685/712 (96.2079%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 3.1226, Accuracy: 3443/10000 (34.4300%)
___Train Local_Simple,  epoch  44, local model 60, internal_epoch   1,  Average loss: 0.0012, Accuracy: 556/571 (97.3730%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 3.5161, Accuracy: 4007/10000 (40.0700%)
___Train Local_Simple,  epoch  44, local model 40, internal_epoch   1,  Average loss: 0.0005, Accuracy: 494/498 (99.1968%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.2350, Accuracy: 6029/10000 (60.2900%)
___Train Local_Simple,  epoch  44, local model 53, internal_epoch   1,  Average loss: 0.0005, Accuracy: 556/561 (99.1087%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.3655, Accuracy: 6934/10000 (69.3400%)
___Train Local_Simple,  epoch  44, local model 5, internal_epoch   1,  Average loss: 0.0007, Accuracy: 570/578 (98.6159%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.4791, Accuracy: 8514/10000 (85.1400%)
___Train Local_Simple,  epoch  44, local model 67, internal_epoch   1,  Average loss: 0.0014, Accuracy: 431/441 (97.7324%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.7178, Accuracy: 4987/10000 (49.8700%)
___Train Local_Simple,  epoch  44, local model 71, internal_epoch   1,  Average loss: 0.0011, Accuracy: 547/561 (97.5045%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.9101, Accuracy: 7179/10000 (71.7900%)
___Train Local_Simple,  epoch  44, local model 83, internal_epoch   1,  Average loss: 0.0011, Accuracy: 353/360 (98.0556%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.2918, Accuracy: 9109/10000 (91.0900%)
___Train Local_Simple,  epoch  44, local model 78, internal_epoch   1,  Average loss: 0.0022, Accuracy: 567/587 (96.5928%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 7.9375, Accuracy: 2223/10000 (22.2300%)
___Train Local_Simple,  epoch  44, local model 44, internal_epoch   1,  Average loss: 0.0004, Accuracy: 557/561 (99.2870%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.0542, Accuracy: 7506/10000 (75.0600%)
___Train Local_Simple,  epoch  44, local model 93, internal_epoch   1,  Average loss: 0.0012, Accuracy: 613/630 (97.3016%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.1616, Accuracy: 5505/10000 (55.0500%)
___Train Local_Simple,  epoch  44, local model 66, internal_epoch   1,  Average loss: 0.0013, Accuracy: 711/733 (96.9986%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 6.0048, Accuracy: 3099/10000 (30.9900%)
___Train Local_Simple,  epoch  44, local model 92, internal_epoch   1,  Average loss: 0.0035, Accuracy: 575/611 (94.1080%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 5.7034, Accuracy: 2484/10000 (24.8400%)
___Train Local_Simple,  epoch  44, local model 27, internal_epoch   1,  Average loss: 0.0008, Accuracy: 737/745 (98.9262%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 4.9719, Accuracy: 3423/10000 (34.2300%)
___Train Local_Simple,  epoch  44, local model 61, internal_epoch   1,  Average loss: 0.0011, Accuracy: 282/287 (98.2578%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3057, Accuracy: 9051/10000 (90.5100%)
___Train Local_Simple,  epoch  44, local model 46, internal_epoch   1,  Average loss: 0.0005, Accuracy: 643/650 (98.9231%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 3.3583, Accuracy: 4697/10000 (46.9700%)
___Train Local_Simple,  epoch  44, local model 52, internal_epoch   1,  Average loss: 0.0009, Accuracy: 774/789 (98.0989%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 4.9145, Accuracy: 4535/10000 (45.3500%)
___Train Local_Simple,  epoch  44, local model 34, internal_epoch   1,  Average loss: 0.0025, Accuracy: 822/871 (94.3743%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.2143, Accuracy: 5466/10000 (54.6600%)
___Train Local_Simple,  epoch  44, local model 19, internal_epoch   1,  Average loss: 0.0006, Accuracy: 591/598 (98.8294%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.4962, Accuracy: 4477/10000 (44.7700%)
___Train Local_Simple,  epoch  44, local model 31, internal_epoch   1,  Average loss: 0.0006, Accuracy: 589/596 (98.8255%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.2869, Accuracy: 6384/10000 (63.8400%)
___Train Local_Simple,  epoch  44, local model 6, internal_epoch   1,  Average loss: 0.0008, Accuracy: 430/435 (98.8506%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.8337, Accuracy: 7731/10000 (77.3100%)
___Train Local_Simple,  epoch  44, local model 25, internal_epoch   1,  Average loss: 0.0003, Accuracy: 588/592 (99.3243%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.2315, Accuracy: 7709/10000 (77.0900%)
___Train Local_Simple,  epoch  44, local model 9, internal_epoch   1,  Average loss: 0.0009, Accuracy: 502/508 (98.8189%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.2978, Accuracy: 6514/10000 (65.1400%)
___Train Local_Simple,  epoch  44, local model 87, internal_epoch   1,  Average loss: 0.0008, Accuracy: 652/663 (98.3409%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 4.0981, Accuracy: 4406/10000 (44.0600%)
___Train Local_Simple,  epoch  44, local model 7, internal_epoch   1,  Average loss: 0.0004, Accuracy: 795/802 (99.1272%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.7314, Accuracy: 4559/10000 (45.5900%)
___Train Local_Simple,  epoch  44, local model 16, internal_epoch   1,  Average loss: 0.0003, Accuracy: 813/817 (99.5104%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.7513, Accuracy: 5639/10000 (56.3900%)
___Train Local_Simple,  epoch  44, local model 68, internal_epoch   1,  Average loss: 0.0013, Accuracy: 535/549 (97.4499%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 3.0956, Accuracy: 4197/10000 (41.9700%)
___Train Local_Simple,  epoch  44, local model 30, internal_epoch   1,  Average loss: 0.0009, Accuracy: 438/443 (98.8713%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.9844, Accuracy: 7514/10000 (75.1400%)
time spent on training: 402.85979676246643
___Test Target_Simple poisoned: False, epoch: 44: Average loss: 0.1120, Accuracy: 9702/10000 (97.0200%)
___Test Target_Simple poisoned: True, epoch: 44: Average loss: 2.9620, Accuracy: 1932/8968 (21.5433%)
saving model
Done in 435.4287323951721 sec.
Server Epoch:45 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 87, 0, 43, 17, 61, 70, 36, 16, 52, 94, 50, 14, 5, 72, 80, 71, 40, 54, 48, 21, 58, 68, 79, 91, 78, 76, 28, 84, 93, 56, 1, 53, 81, 77, 42, 83, 30, 19, 11, 23, 20, 9, 37, 60, 35, 46, 10, 57, 69, 26, 44, 49, 96, 82, 55, 22, 8, 39, 12, 66, 90, 45, 59, 64, 65, 86, 7, 47, 2, 38, 24, 92, 98, 75, 27, 6, 89, 95, 13, 99, 34, 85, 31, 4, 32, 15, 25, 97, 67, 63].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   1,  Average loss: 0.0201, Accuracy: 321/569 (56.4148%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   2,  Average loss: 0.0068, Accuracy: 470/569 (82.6011%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   3,  Average loss: 0.0014, Accuracy: 561/569 (98.5940%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   4,  Average loss: 0.0009, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   5,  Average loss: 0.0006, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   6,  Average loss: 0.0005, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   7,  Average loss: 0.0004, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   8,  Average loss: 0.0003, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch   9,  Average loss: 0.0004, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 41, internal_epoch  10,  Average loss: 0.0003, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Global model norm: 15.44757714887703.
Norm before scaling: 15.75485881155001. Distance: 3.9713642791452535
Total norm for 10 adversaries is: 15.75485881155001. distance: 3.9713642791452535
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 1.1860, Accuracy: 5048/8968 (56.2890%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   1,  Average loss: 0.0111, Accuracy: 381/522 (72.9885%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   2,  Average loss: 0.0028, Accuracy: 497/522 (95.2107%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   3,  Average loss: 0.0011, Accuracy: 510/522 (97.7011%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   4,  Average loss: 0.0008, Accuracy: 512/522 (98.0843%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   5,  Average loss: 0.0005, Accuracy: 515/522 (98.6590%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   6,  Average loss: 0.0005, Accuracy: 516/522 (98.8506%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   7,  Average loss: 0.0004, Accuracy: 518/522 (99.2337%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   8,  Average loss: 0.0003, Accuracy: 518/522 (99.2337%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch   9,  Average loss: 0.0004, Accuracy: 517/522 (99.0421%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 73, internal_epoch  10,  Average loss: 0.0003, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Global model norm: 15.44757714887703.
Norm before scaling: 15.595584127011573. Distance: 2.55804269695066
Total norm for 10 adversaries is: 15.595584127011573. distance: 2.55804269695066
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0237, Accuracy: 8887/8968 (99.0968%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   1,  Average loss: 0.0151, Accuracy: 241/385 (62.5974%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   2,  Average loss: 0.0038, Accuracy: 369/385 (95.8442%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   3,  Average loss: 0.0012, Accuracy: 378/385 (98.1818%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   4,  Average loss: 0.0008, Accuracy: 379/385 (98.4416%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   5,  Average loss: 0.0007, Accuracy: 381/385 (98.9610%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   6,  Average loss: 0.0006, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   7,  Average loss: 0.0004, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   8,  Average loss: 0.0005, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   9,  Average loss: 0.0004, Accuracy: 383/385 (99.4805%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch  10,  Average loss: 0.0004, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Global model norm: 15.44757714887703.
Norm before scaling: 15.670533264473445. Distance: 2.821487646881323
Total norm for 10 adversaries is: 15.670533264473445. distance: 2.821487646881323
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.1877, Accuracy: 8373/8968 (93.3653%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   1,  Average loss: 0.0052, Accuracy: 557/627 (88.8357%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   2,  Average loss: 0.0016, Accuracy: 606/627 (96.6507%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   3,  Average loss: 0.0014, Accuracy: 610/627 (97.2887%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   4,  Average loss: 0.0008, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   5,  Average loss: 0.0006, Accuracy: 620/627 (98.8836%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   6,  Average loss: 0.0007, Accuracy: 621/627 (99.0431%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   7,  Average loss: 0.0006, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   8,  Average loss: 0.0004, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch   9,  Average loss: 0.0005, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 74, internal_epoch  10,  Average loss: 0.0003, Accuracy: 625/627 (99.6810%), train_poison_data_count: 320
Global model norm: 15.44757714887703.
Norm before scaling: 15.62609224698014. Distance: 2.340418571465507
Total norm for 10 adversaries is: 15.62609224698014. distance: 2.340418571465507
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0110, Accuracy: 8925/8968 (99.5205%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 3, internal_epoch   1,  Average loss: 0.0188, Accuracy: 296/516 (57.3643%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 3, internal_epoch   2,  Average loss: 0.0101, Accuracy: 388/516 (75.1938%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 3, internal_epoch   3,  Average loss: 0.0027, Accuracy: 499/516 (96.7054%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 3, internal_epoch   4,  Average loss: 0.0017, Accuracy: 507/516 (98.2558%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 3, internal_epoch   5,  Average loss: 0.0011, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 3, internal_epoch   6,  Average loss: 0.0008, Accuracy: 513/516 (99.4186%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 3, internal_epoch   7,  Average loss: 0.0007, Accuracy: 516/516 (100.0000%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 3, internal_epoch   8,  Average loss: 0.0005, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 3, internal_epoch   9,  Average loss: 0.0005, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 3, internal_epoch  10,  Average loss: 0.0004, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Global model norm: 15.44757714887703.
Norm before scaling: 15.77381622177215. Distance: 3.69832702652226
Total norm for 10 adversaries is: 15.77381622177215. distance: 3.69832702652226
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.4138, Accuracy: 7602/8968 (84.7681%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 18, internal_epoch   1,  Average loss: 0.0139, Accuracy: 540/759 (71.1462%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 18, internal_epoch   2,  Average loss: 0.0011, Accuracy: 745/759 (98.1555%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 18, internal_epoch   3,  Average loss: 0.0005, Accuracy: 753/759 (99.2095%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 18, internal_epoch   4,  Average loss: 0.0004, Accuracy: 751/759 (98.9460%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 18, internal_epoch   5,  Average loss: 0.0003, Accuracy: 752/759 (99.0777%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 18, internal_epoch   6,  Average loss: 0.0003, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 18, internal_epoch   7,  Average loss: 0.0001, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 18, internal_epoch   8,  Average loss: 0.0003, Accuracy: 754/759 (99.3412%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 18, internal_epoch   9,  Average loss: 0.0002, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 18, internal_epoch  10,  Average loss: 0.0002, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Global model norm: 15.44757714887703.
Norm before scaling: 16.009476716200393. Distance: 4.05964818773784
Total norm for 10 adversaries is: 16.009476716200393. distance: 4.05964818773784
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.2232, Accuracy: 8400/8968 (93.6664%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   1,  Average loss: 0.0152, Accuracy: 352/506 (69.5652%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   2,  Average loss: 0.0029, Accuracy: 494/506 (97.6285%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   3,  Average loss: 0.0007, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   4,  Average loss: 0.0005, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   5,  Average loss: 0.0005, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   6,  Average loss: 0.0006, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   7,  Average loss: 0.0003, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   8,  Average loss: 0.0003, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   9,  Average loss: 0.0002, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch  10,  Average loss: 0.0004, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Global model norm: 15.44757714887703.
Norm before scaling: 15.868121241297459. Distance: 3.626376055288883
Total norm for 10 adversaries is: 15.868121241297459. distance: 3.626376055288883
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 1.3602, Accuracy: 4726/8968 (52.6985%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 62, internal_epoch   1,  Average loss: 0.0051, Accuracy: 508/580 (87.5862%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 62, internal_epoch   2,  Average loss: 0.0021, Accuracy: 558/580 (96.2069%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 62, internal_epoch   3,  Average loss: 0.0007, Accuracy: 571/580 (98.4483%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 62, internal_epoch   4,  Average loss: 0.0009, Accuracy: 568/580 (97.9310%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 62, internal_epoch   5,  Average loss: 0.0006, Accuracy: 573/580 (98.7931%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 62, internal_epoch   6,  Average loss: 0.0008, Accuracy: 572/580 (98.6207%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 62, internal_epoch   7,  Average loss: 0.0006, Accuracy: 576/580 (99.3103%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 62, internal_epoch   8,  Average loss: 0.0007, Accuracy: 573/580 (98.7931%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 62, internal_epoch   9,  Average loss: 0.0006, Accuracy: 574/580 (98.9655%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 62, internal_epoch  10,  Average loss: 0.0014, Accuracy: 573/580 (98.7931%), train_poison_data_count: 292
Global model norm: 15.44757714887703.
Norm before scaling: 15.589728255335155. Distance: 2.16347520481586
Total norm for 10 adversaries is: 15.589728255335155. distance: 2.16347520481586
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0239, Accuracy: 8873/8968 (98.9407%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 33, internal_epoch   1,  Average loss: 0.0174, Accuracy: 339/587 (57.7513%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 535/587 (91.1414%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 33, internal_epoch   3,  Average loss: 0.0016, Accuracy: 567/587 (96.5928%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 33, internal_epoch   4,  Average loss: 0.0004, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 33, internal_epoch   5,  Average loss: 0.0005, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 33, internal_epoch   6,  Average loss: 0.0005, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 33, internal_epoch   7,  Average loss: 0.0004, Accuracy: 585/587 (99.6593%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 33, internal_epoch   8,  Average loss: 0.0003, Accuracy: 585/587 (99.6593%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 33, internal_epoch   9,  Average loss: 0.0003, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 33, internal_epoch  10,  Average loss: 0.0003, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Global model norm: 15.44757714887703.
Norm before scaling: 15.84834611127895. Distance: 3.821830338773125
Total norm for 10 adversaries is: 15.84834611127895. distance: 3.821830338773125
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.6280, Accuracy: 6979/8968 (77.8211%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 88, internal_epoch   1,  Average loss: 0.0120, Accuracy: 556/734 (75.7493%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 88, internal_epoch   2,  Average loss: 0.0026, Accuracy: 685/734 (93.3243%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 88, internal_epoch   3,  Average loss: 0.0009, Accuracy: 720/734 (98.0926%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 88, internal_epoch   4,  Average loss: 0.0007, Accuracy: 720/734 (98.0926%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 88, internal_epoch   5,  Average loss: 0.0007, Accuracy: 723/734 (98.5014%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 88, internal_epoch   6,  Average loss: 0.0004, Accuracy: 728/734 (99.1826%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 88, internal_epoch   7,  Average loss: 0.0005, Accuracy: 725/734 (98.7738%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 88, internal_epoch   8,  Average loss: 0.0005, Accuracy: 726/734 (98.9101%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 88, internal_epoch   9,  Average loss: 0.0005, Accuracy: 727/734 (99.0463%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 88, internal_epoch  10,  Average loss: 0.0005, Accuracy: 725/734 (98.7738%), train_poison_data_count: 382
Global model norm: 15.44757714887703.
Norm before scaling: 15.79660550122488. Distance: 3.5036629174495837
Total norm for 10 adversaries is: 15.79660550122488. distance: 3.5036629174495837
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0621, Accuracy: 8766/8968 (97.7475%)
___Train Local_Simple,  epoch  45, local model 87, internal_epoch   1,  Average loss: 0.0012, Accuracy: 652/663 (98.3409%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.6649, Accuracy: 5533/10000 (55.3300%)
___Train Local_Simple,  epoch  45, local model 0, internal_epoch   1,  Average loss: 0.0010, Accuracy: 425/435 (97.7011%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.8019, Accuracy: 6417/10000 (64.1700%)
___Train Local_Simple,  epoch  45, local model 43, internal_epoch   1,  Average loss: 0.0008, Accuracy: 427/431 (99.0719%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.5097, Accuracy: 8355/10000 (83.5500%)
___Train Local_Simple,  epoch  45, local model 17, internal_epoch   1,  Average loss: 0.0006, Accuracy: 522/527 (99.0512%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.4292, Accuracy: 5144/10000 (51.4400%)
___Train Local_Simple,  epoch  45, local model 61, internal_epoch   1,  Average loss: 0.0011, Accuracy: 283/287 (98.6063%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.3840, Accuracy: 8803/10000 (88.0300%)
___Train Local_Simple,  epoch  45, local model 70, internal_epoch   1,  Average loss: 0.0008, Accuracy: 559/568 (98.4155%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 3.2994, Accuracy: 4450/10000 (44.5000%)
___Train Local_Simple,  epoch  45, local model 36, internal_epoch   1,  Average loss: 0.0007, Accuracy: 312/315 (99.0476%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.3910, Accuracy: 8881/10000 (88.8100%)
___Train Local_Simple,  epoch  45, local model 16, internal_epoch   1,  Average loss: 0.0003, Accuracy: 810/817 (99.1432%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.9741, Accuracy: 6248/10000 (62.4800%)
___Train Local_Simple,  epoch  45, local model 52, internal_epoch   1,  Average loss: 0.0033, Accuracy: 736/789 (93.2826%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 4.3888, Accuracy: 4010/10000 (40.1000%)
___Train Local_Simple,  epoch  45, local model 94, internal_epoch   1,  Average loss: 0.0007, Accuracy: 663/671 (98.8077%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 3.1771, Accuracy: 5652/10000 (56.5200%)
___Train Local_Simple,  epoch  45, local model 50, internal_epoch   1,  Average loss: 0.0009, Accuracy: 467/477 (97.9036%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.4333, Accuracy: 6205/10000 (62.0500%)
___Train Local_Simple,  epoch  45, local model 14, internal_epoch   1,  Average loss: 0.0013, Accuracy: 673/692 (97.2543%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.0924, Accuracy: 7104/10000 (71.0400%)
___Train Local_Simple,  epoch  45, local model 5, internal_epoch   1,  Average loss: 0.0008, Accuracy: 569/578 (98.4429%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.1814, Accuracy: 6919/10000 (69.1900%)
___Train Local_Simple,  epoch  45, local model 72, internal_epoch   1,  Average loss: 0.0017, Accuracy: 407/423 (96.2175%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.3487, Accuracy: 4991/10000 (49.9100%)
___Train Local_Simple,  epoch  45, local model 80, internal_epoch   1,  Average loss: 0.0013, Accuracy: 520/532 (97.7444%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 4.8550, Accuracy: 3113/10000 (31.1300%)
___Train Local_Simple,  epoch  45, local model 71, internal_epoch   1,  Average loss: 0.0012, Accuracy: 547/561 (97.5045%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.5836, Accuracy: 6119/10000 (61.1900%)
___Train Local_Simple,  epoch  45, local model 40, internal_epoch   1,  Average loss: 0.0004, Accuracy: 494/498 (99.1968%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 3.4644, Accuracy: 4564/10000 (45.6400%)
___Train Local_Simple,  epoch  45, local model 54, internal_epoch   1,  Average loss: 0.0005, Accuracy: 825/832 (99.1587%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 3.0214, Accuracy: 5089/10000 (50.8900%)
___Train Local_Simple,  epoch  45, local model 48, internal_epoch   1,  Average loss: 0.0012, Accuracy: 354/363 (97.5207%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.7524, Accuracy: 7914/10000 (79.1400%)
___Train Local_Simple,  epoch  45, local model 21, internal_epoch   1,  Average loss: 0.0005, Accuracy: 682/687 (99.2722%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.5094, Accuracy: 5102/10000 (51.0200%)
___Train Local_Simple,  epoch  45, local model 58, internal_epoch   1,  Average loss: 0.0008, Accuracy: 762/772 (98.7047%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.2818, Accuracy: 5229/10000 (52.2900%)
___Train Local_Simple,  epoch  45, local model 68, internal_epoch   1,  Average loss: 0.0016, Accuracy: 534/549 (97.2678%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.9292, Accuracy: 5233/10000 (52.3300%)
___Train Local_Simple,  epoch  45, local model 79, internal_epoch   1,  Average loss: 0.0020, Accuracy: 650/661 (98.3359%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.7955, Accuracy: 6004/10000 (60.0400%)
___Train Local_Simple,  epoch  45, local model 91, internal_epoch   1,  Average loss: 0.0004, Accuracy: 815/819 (99.5116%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.5848, Accuracy: 4779/10000 (47.7900%)
___Train Local_Simple,  epoch  45, local model 78, internal_epoch   1,  Average loss: 0.0020, Accuracy: 567/587 (96.5928%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.4825, Accuracy: 6224/10000 (62.2400%)
___Train Local_Simple,  epoch  45, local model 76, internal_epoch   1,  Average loss: 0.0012, Accuracy: 453/459 (98.6928%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.8911, Accuracy: 7937/10000 (79.3700%)
___Train Local_Simple,  epoch  45, local model 28, internal_epoch   1,  Average loss: 0.0008, Accuracy: 599/611 (98.0360%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.9887, Accuracy: 6022/10000 (60.2200%)
___Train Local_Simple,  epoch  45, local model 84, internal_epoch   1,  Average loss: 0.0011, Accuracy: 410/420 (97.6190%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.7585, Accuracy: 7825/10000 (78.2500%)
___Train Local_Simple,  epoch  45, local model 93, internal_epoch   1,  Average loss: 0.0013, Accuracy: 612/630 (97.1429%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 3.5857, Accuracy: 4115/10000 (41.1500%)
___Train Local_Simple,  epoch  45, local model 56, internal_epoch   1,  Average loss: 0.0007, Accuracy: 707/715 (98.8811%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.6941, Accuracy: 5761/10000 (57.6100%)
___Train Local_Simple,  epoch  45, local model 1, internal_epoch   1,  Average loss: 0.0004, Accuracy: 535/536 (99.8134%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.4563, Accuracy: 8697/10000 (86.9700%)
___Train Local_Simple,  epoch  45, local model 53, internal_epoch   1,  Average loss: 0.0009, Accuracy: 549/561 (97.8610%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.7432, Accuracy: 5296/10000 (52.9600%)
___Train Local_Simple,  epoch  45, local model 81, internal_epoch   1,  Average loss: 0.0010, Accuracy: 628/636 (98.7421%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 3.3153, Accuracy: 3735/10000 (37.3500%)
___Train Local_Simple,  epoch  45, local model 77, internal_epoch   1,  Average loss: 0.0010, Accuracy: 607/618 (98.2201%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.3057, Accuracy: 5372/10000 (53.7200%)
___Train Local_Simple,  epoch  45, local model 42, internal_epoch   1,  Average loss: 0.0004, Accuracy: 470/473 (99.3658%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.5487, Accuracy: 8208/10000 (82.0800%)
___Train Local_Simple,  epoch  45, local model 83, internal_epoch   1,  Average loss: 0.0010, Accuracy: 351/360 (97.5000%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.7699, Accuracy: 7865/10000 (78.6500%)
___Train Local_Simple,  epoch  45, local model 30, internal_epoch   1,  Average loss: 0.0009, Accuracy: 435/443 (98.1941%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.2039, Accuracy: 7268/10000 (72.6800%)
___Train Local_Simple,  epoch  45, local model 19, internal_epoch   1,  Average loss: 0.0008, Accuracy: 589/598 (98.4950%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.6745, Accuracy: 5376/10000 (53.7600%)
___Train Local_Simple,  epoch  45, local model 11, internal_epoch   1,  Average loss: 0.0007, Accuracy: 546/554 (98.5560%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.5336, Accuracy: 6650/10000 (66.5000%)
___Train Local_Simple,  epoch  45, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 534/542 (98.5240%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.5721, Accuracy: 5294/10000 (52.9400%)
___Train Local_Simple,  epoch  45, local model 20, internal_epoch   1,  Average loss: 0.0007, Accuracy: 595/602 (98.8372%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.2464, Accuracy: 5616/10000 (56.1600%)
___Train Local_Simple,  epoch  45, local model 9, internal_epoch   1,  Average loss: 0.0008, Accuracy: 501/508 (98.6220%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.9416, Accuracy: 7356/10000 (73.5600%)
___Train Local_Simple,  epoch  45, local model 37, internal_epoch   1,  Average loss: 0.0009, Accuracy: 451/456 (98.9035%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.7486, Accuracy: 7578/10000 (75.7800%)
___Train Local_Simple,  epoch  45, local model 60, internal_epoch   1,  Average loss: 0.0009, Accuracy: 561/571 (98.2487%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.7279, Accuracy: 5050/10000 (50.5000%)
___Train Local_Simple,  epoch  45, local model 35, internal_epoch   1,  Average loss: 0.0016, Accuracy: 612/630 (97.1429%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.6836, Accuracy: 6088/10000 (60.8800%)
___Train Local_Simple,  epoch  45, local model 46, internal_epoch   1,  Average loss: 0.0016, Accuracy: 641/650 (98.6154%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.5506, Accuracy: 5638/10000 (56.3800%)
___Train Local_Simple,  epoch  45, local model 10, internal_epoch   1,  Average loss: 0.0010, Accuracy: 562/573 (98.0803%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.3055, Accuracy: 6610/10000 (66.1000%)
___Train Local_Simple,  epoch  45, local model 57, internal_epoch   1,  Average loss: 0.0007, Accuracy: 517/523 (98.8528%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.7994, Accuracy: 4548/10000 (45.4800%)
___Train Local_Simple,  epoch  45, local model 69, internal_epoch   1,  Average loss: 0.0011, Accuracy: 655/671 (97.6155%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 4.1347, Accuracy: 3798/10000 (37.9800%)
___Train Local_Simple,  epoch  45, local model 26, internal_epoch   1,  Average loss: 0.0008, Accuracy: 513/519 (98.8439%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.5376, Accuracy: 6017/10000 (60.1700%)
___Train Local_Simple,  epoch  45, local model 44, internal_epoch   1,  Average loss: 0.0004, Accuracy: 557/561 (99.2870%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.5321, Accuracy: 6161/10000 (61.6100%)
___Train Local_Simple,  epoch  45, local model 49, internal_epoch   1,  Average loss: 0.0010, Accuracy: 347/355 (97.7465%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.8662, Accuracy: 7436/10000 (74.3600%)
___Train Local_Simple,  epoch  45, local model 96, internal_epoch   1,  Average loss: 0.0007, Accuracy: 524/531 (98.6817%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 3.3301, Accuracy: 4812/10000 (48.1200%)
___Train Local_Simple,  epoch  45, local model 82, internal_epoch   1,  Average loss: 0.0006, Accuracy: 804/815 (98.6503%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 4.2440, Accuracy: 4549/10000 (45.4900%)
___Train Local_Simple,  epoch  45, local model 55, internal_epoch   1,  Average loss: 0.0009, Accuracy: 368/375 (98.1333%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.4584, Accuracy: 6760/10000 (67.6000%)
___Train Local_Simple,  epoch  45, local model 22, internal_epoch   1,  Average loss: 0.0007, Accuracy: 259/262 (98.8550%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.7993, Accuracy: 8482/10000 (84.8200%)
___Train Local_Simple,  epoch  45, local model 8, internal_epoch   1,  Average loss: 0.0006, Accuracy: 700/706 (99.1501%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.7416, Accuracy: 4640/10000 (46.4000%)
___Train Local_Simple,  epoch  45, local model 39, internal_epoch   1,  Average loss: 0.0016, Accuracy: 479/493 (97.1602%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.5980, Accuracy: 5451/10000 (54.5100%)
___Train Local_Simple,  epoch  45, local model 12, internal_epoch   1,  Average loss: 0.0007, Accuracy: 718/725 (99.0345%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.3596, Accuracy: 5561/10000 (55.6100%)
___Train Local_Simple,  epoch  45, local model 66, internal_epoch   1,  Average loss: 0.0015, Accuracy: 711/733 (96.9986%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.5489, Accuracy: 5509/10000 (55.0900%)
___Train Local_Simple,  epoch  45, local model 90, internal_epoch   1,  Average loss: 0.0014, Accuracy: 599/615 (97.3984%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.2638, Accuracy: 5781/10000 (57.8100%)
___Train Local_Simple,  epoch  45, local model 45, internal_epoch   1,  Average loss: 0.0009, Accuracy: 637/647 (98.4544%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 3.7019, Accuracy: 3938/10000 (39.3800%)
___Train Local_Simple,  epoch  45, local model 59, internal_epoch   1,  Average loss: 0.0007, Accuracy: 637/644 (98.9130%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 3.2862, Accuracy: 4478/10000 (44.7800%)
___Train Local_Simple,  epoch  45, local model 64, internal_epoch   1,  Average loss: 0.0003, Accuracy: 606/608 (99.6711%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.7902, Accuracy: 6102/10000 (61.0200%)
___Train Local_Simple,  epoch  45, local model 65, internal_epoch   1,  Average loss: 0.0014, Accuracy: 605/621 (97.4235%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.9018, Accuracy: 5828/10000 (58.2800%)
___Train Local_Simple,  epoch  45, local model 86, internal_epoch   1,  Average loss: 0.0004, Accuracy: 686/692 (99.1329%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 3.0338, Accuracy: 4838/10000 (48.3800%)
___Train Local_Simple,  epoch  45, local model 7, internal_epoch   1,  Average loss: 0.0005, Accuracy: 796/802 (99.2519%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.9002, Accuracy: 6088/10000 (60.8800%)
___Train Local_Simple,  epoch  45, local model 47, internal_epoch   1,  Average loss: 0.0008, Accuracy: 525/534 (98.3146%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.2159, Accuracy: 5684/10000 (56.8400%)
___Train Local_Simple,  epoch  45, local model 2, internal_epoch   1,  Average loss: 0.0008, Accuracy: 555/564 (98.4043%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.1993, Accuracy: 5179/10000 (51.7900%)
___Train Local_Simple,  epoch  45, local model 38, internal_epoch   1,  Average loss: 0.0009, Accuracy: 470/477 (98.5325%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.5759, Accuracy: 8337/10000 (83.3700%)
___Train Local_Simple,  epoch  45, local model 24, internal_epoch   1,  Average loss: 0.0014, Accuracy: 467/477 (97.9036%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.5659, Accuracy: 6181/10000 (61.8100%)
___Train Local_Simple,  epoch  45, local model 92, internal_epoch   1,  Average loss: 0.0015, Accuracy: 593/611 (97.0540%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.9551, Accuracy: 4260/10000 (42.6000%)
___Train Local_Simple,  epoch  45, local model 98, internal_epoch   1,  Average loss: 0.0012, Accuracy: 538/548 (98.1752%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 3.0066, Accuracy: 4856/10000 (48.5600%)
___Train Local_Simple,  epoch  45, local model 75, internal_epoch   1,  Average loss: 0.0008, Accuracy: 751/763 (98.4273%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.3860, Accuracy: 5401/10000 (54.0100%)
___Train Local_Simple,  epoch  45, local model 27, internal_epoch   1,  Average loss: 0.0006, Accuracy: 737/745 (98.9262%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.1742, Accuracy: 5752/10000 (57.5200%)
___Train Local_Simple,  epoch  45, local model 6, internal_epoch   1,  Average loss: 0.0008, Accuracy: 430/435 (98.8506%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.1069, Accuracy: 6123/10000 (61.2300%)
___Train Local_Simple,  epoch  45, local model 89, internal_epoch   1,  Average loss: 0.0011, Accuracy: 667/683 (97.6574%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.7588, Accuracy: 6275/10000 (62.7500%)
___Train Local_Simple,  epoch  45, local model 95, internal_epoch   1,  Average loss: 0.0019, Accuracy: 576/600 (96.0000%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.5893, Accuracy: 6439/10000 (64.3900%)
___Train Local_Simple,  epoch  45, local model 13, internal_epoch   1,  Average loss: 0.0007, Accuracy: 704/713 (98.7377%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 3.5250, Accuracy: 4666/10000 (46.6600%)
___Train Local_Simple,  epoch  45, local model 99, internal_epoch   1,  Average loss: 0.0015, Accuracy: 690/712 (96.9101%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.7145, Accuracy: 4941/10000 (49.4100%)
___Train Local_Simple,  epoch  45, local model 34, internal_epoch   1,  Average loss: 0.0012, Accuracy: 850/871 (97.5890%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 3.4655, Accuracy: 4554/10000 (45.5400%)
___Train Local_Simple,  epoch  45, local model 85, internal_epoch   1,  Average loss: 0.0011, Accuracy: 790/807 (97.8934%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.3374, Accuracy: 5905/10000 (59.0500%)
___Train Local_Simple,  epoch  45, local model 31, internal_epoch   1,  Average loss: 0.0008, Accuracy: 587/596 (98.4899%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.6874, Accuracy: 5714/10000 (57.1400%)
___Train Local_Simple,  epoch  45, local model 4, internal_epoch   1,  Average loss: 0.0007, Accuracy: 736/748 (98.3957%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 3.5382, Accuracy: 3769/10000 (37.6900%)
___Train Local_Simple,  epoch  45, local model 32, internal_epoch   1,  Average loss: 0.0005, Accuracy: 586/590 (99.3220%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.2215, Accuracy: 5927/10000 (59.2700%)
___Train Local_Simple,  epoch  45, local model 15, internal_epoch   1,  Average loss: 0.0009, Accuracy: 280/282 (99.2908%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.4136, Accuracy: 8668/10000 (86.6800%)
___Train Local_Simple,  epoch  45, local model 25, internal_epoch   1,  Average loss: 0.0005, Accuracy: 587/592 (99.1554%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.0420, Accuracy: 7179/10000 (71.7900%)
___Train Local_Simple,  epoch  45, local model 97, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1103/1112 (99.1906%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 5.9822, Accuracy: 3767/10000 (37.6700%)
___Train Local_Simple,  epoch  45, local model 67, internal_epoch   1,  Average loss: 0.0011, Accuracy: 434/441 (98.4127%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.3797, Accuracy: 6376/10000 (63.7600%)
___Train Local_Simple,  epoch  45, local model 63, internal_epoch   1,  Average loss: 0.0011, Accuracy: 298/303 (98.3498%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.2930, Accuracy: 6784/10000 (67.8400%)
time spent on training: 378.501017332077
___Test Target_Simple poisoned: False, epoch: 45: Average loss: 0.1137, Accuracy: 9674/10000 (96.7400%)
___Test Target_Simple poisoned: True, epoch: 45: Average loss: 3.3586, Accuracy: 1061/8968 (11.8310%)
saving model
Done in 408.03259086608887 sec.
Server Epoch:46 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 25, 85, 56, 30, 38, 53, 98, 42, 96, 48, 19, 55, 71, 39, 95, 79, 99, 27, 10, 68, 40, 35, 97, 20, 34, 91, 2, 36, 65, 8, 1, 54, 21, 5, 16, 45, 80, 89, 76, 69, 0, 58, 77, 12, 82, 86, 7, 92, 70, 60, 83, 14, 4, 75, 63, 50, 23, 52, 49, 26, 84, 81, 31, 11, 22, 24, 17, 32, 78, 59, 87, 47, 46, 9, 37, 13, 66, 90, 67, 44, 43, 93, 15, 94, 64, 57, 61, 72, 28, 6].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   1,  Average loss: 0.0196, Accuracy: 332/569 (58.3480%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   2,  Average loss: 0.0078, Accuracy: 444/569 (78.0316%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   3,  Average loss: 0.0028, Accuracy: 549/569 (96.4851%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   4,  Average loss: 0.0022, Accuracy: 558/569 (98.0668%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   5,  Average loss: 0.0017, Accuracy: 560/569 (98.4183%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   6,  Average loss: 0.0014, Accuracy: 561/569 (98.5940%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   7,  Average loss: 0.0011, Accuracy: 563/569 (98.9455%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   8,  Average loss: 0.0008, Accuracy: 565/569 (99.2970%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch   9,  Average loss: 0.0007, Accuracy: 564/569 (99.1213%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 41, internal_epoch  10,  Average loss: 0.0007, Accuracy: 565/569 (99.2970%), train_poison_data_count: 288
Global model norm: 15.45531495162445.
Norm before scaling: 15.707435373127485. Distance: 3.8177028237893325
Total norm for 10 adversaries is: 15.707435373127485. distance: 3.8177028237893325
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.8925, Accuracy: 5774/8968 (64.3845%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   1,  Average loss: 0.0106, Accuracy: 390/522 (74.7126%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 503/522 (96.3602%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   3,  Average loss: 0.0012, Accuracy: 511/522 (97.8927%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   4,  Average loss: 0.0012, Accuracy: 513/522 (98.2759%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   5,  Average loss: 0.0007, Accuracy: 515/522 (98.6590%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   6,  Average loss: 0.0005, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   7,  Average loss: 0.0005, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   8,  Average loss: 0.0004, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch   9,  Average loss: 0.0005, Accuracy: 518/522 (99.2337%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 73, internal_epoch  10,  Average loss: 0.0003, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Global model norm: 15.45531495162445.
Norm before scaling: 15.64012256466971. Distance: 2.654740746263297
Total norm for 10 adversaries is: 15.64012256466971. distance: 2.654740746263297
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0298, Accuracy: 8861/8968 (98.8069%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   1,  Average loss: 0.0158, Accuracy: 232/385 (60.2597%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   2,  Average loss: 0.0050, Accuracy: 366/385 (95.0649%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   3,  Average loss: 0.0025, Accuracy: 374/385 (97.1429%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   4,  Average loss: 0.0019, Accuracy: 377/385 (97.9221%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   5,  Average loss: 0.0018, Accuracy: 374/385 (97.1429%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   6,  Average loss: 0.0011, Accuracy: 378/385 (98.1818%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   7,  Average loss: 0.0010, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   8,  Average loss: 0.0010, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch   9,  Average loss: 0.0009, Accuracy: 381/385 (98.9610%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 51, internal_epoch  10,  Average loss: 0.0006, Accuracy: 383/385 (99.4805%), train_poison_data_count: 193
Global model norm: 15.45531495162445.
Norm before scaling: 15.684807413345885. Distance: 2.7219120798311636
Total norm for 10 adversaries is: 15.684807413345885. distance: 2.7219120798311636
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.4162, Accuracy: 7292/8968 (81.3113%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   1,  Average loss: 0.0054, Accuracy: 552/627 (88.0383%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   2,  Average loss: 0.0013, Accuracy: 614/627 (97.9266%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   3,  Average loss: 0.0012, Accuracy: 611/627 (97.4482%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   4,  Average loss: 0.0010, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   5,  Average loss: 0.0009, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   6,  Average loss: 0.0006, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   7,  Average loss: 0.0005, Accuracy: 621/627 (99.0431%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   8,  Average loss: 0.0005, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch   9,  Average loss: 0.0006, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 74, internal_epoch  10,  Average loss: 0.0005, Accuracy: 621/627 (99.0431%), train_poison_data_count: 320
Global model norm: 15.45531495162445.
Norm before scaling: 15.626250926488353. Distance: 2.3089735619116416
Total norm for 10 adversaries is: 15.626250926488353. distance: 2.3089735619116416
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0076, Accuracy: 8942/8968 (99.7101%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 3, internal_epoch   1,  Average loss: 0.0221, Accuracy: 297/516 (57.5581%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 3, internal_epoch   2,  Average loss: 0.0055, Accuracy: 462/516 (89.5349%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 3, internal_epoch   3,  Average loss: 0.0011, Accuracy: 511/516 (99.0310%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 3, internal_epoch   4,  Average loss: 0.0008, Accuracy: 513/516 (99.4186%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 3, internal_epoch   5,  Average loss: 0.0006, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 3, internal_epoch   6,  Average loss: 0.0007, Accuracy: 513/516 (99.4186%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 3, internal_epoch   7,  Average loss: 0.0005, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 3, internal_epoch   8,  Average loss: 0.0005, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 3, internal_epoch   9,  Average loss: 0.0004, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 3, internal_epoch  10,  Average loss: 0.0004, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Global model norm: 15.45531495162445.
Norm before scaling: 15.816512371525931. Distance: 4.077867989461839
Total norm for 10 adversaries is: 15.816512371525931. distance: 4.077867989461839
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.5141, Accuracy: 7406/8968 (82.5825%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 18, internal_epoch   1,  Average loss: 0.0140, Accuracy: 562/759 (74.0448%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 18, internal_epoch   2,  Average loss: 0.0012, Accuracy: 746/759 (98.2872%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 18, internal_epoch   3,  Average loss: 0.0010, Accuracy: 747/759 (98.4190%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 18, internal_epoch   4,  Average loss: 0.0005, Accuracy: 751/759 (98.9460%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 18, internal_epoch   5,  Average loss: 0.0005, Accuracy: 753/759 (99.2095%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 18, internal_epoch   6,  Average loss: 0.0004, Accuracy: 754/759 (99.3412%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 18, internal_epoch   7,  Average loss: 0.0005, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 18, internal_epoch   8,  Average loss: 0.0003, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 18, internal_epoch   9,  Average loss: 0.0002, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 18, internal_epoch  10,  Average loss: 0.0004, Accuracy: 753/759 (99.2095%), train_poison_data_count: 384
Global model norm: 15.45531495162445.
Norm before scaling: 15.977322242785387. Distance: 4.074872236062669
Total norm for 10 adversaries is: 15.977322242785387. distance: 4.074872236062669
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0372, Accuracy: 8841/8968 (98.5839%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 29, internal_epoch   1,  Average loss: 0.0153, Accuracy: 352/506 (69.5652%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 29, internal_epoch   2,  Average loss: 0.0050, Accuracy: 472/506 (93.2806%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 29, internal_epoch   3,  Average loss: 0.0010, Accuracy: 499/506 (98.6166%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 29, internal_epoch   4,  Average loss: 0.0005, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 29, internal_epoch   5,  Average loss: 0.0011, Accuracy: 497/506 (98.2213%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 29, internal_epoch   6,  Average loss: 0.0008, Accuracy: 499/506 (98.6166%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 29, internal_epoch   7,  Average loss: 0.0005, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 29, internal_epoch   8,  Average loss: 0.0006, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 29, internal_epoch   9,  Average loss: 0.0008, Accuracy: 498/506 (98.4190%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 29, internal_epoch  10,  Average loss: 0.0004, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Global model norm: 15.45531495162445.
Norm before scaling: 15.821456362968375. Distance: 3.711791379969123
Total norm for 10 adversaries is: 15.821456362968375. distance: 3.711791379969123
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 1.5223, Accuracy: 4740/8968 (52.8546%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 62, internal_epoch   1,  Average loss: 0.0063, Accuracy: 495/580 (85.3448%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 62, internal_epoch   2,  Average loss: 0.0015, Accuracy: 566/580 (97.5862%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 62, internal_epoch   3,  Average loss: 0.0010, Accuracy: 561/580 (96.7241%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 62, internal_epoch   4,  Average loss: 0.0007, Accuracy: 572/580 (98.6207%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 62, internal_epoch   5,  Average loss: 0.0006, Accuracy: 576/580 (99.3103%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 62, internal_epoch   6,  Average loss: 0.0006, Accuracy: 576/580 (99.3103%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 62, internal_epoch   7,  Average loss: 0.0008, Accuracy: 573/580 (98.7931%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 62, internal_epoch   8,  Average loss: 0.0005, Accuracy: 576/580 (99.3103%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 62, internal_epoch   9,  Average loss: 0.0006, Accuracy: 575/580 (99.1379%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 62, internal_epoch  10,  Average loss: 0.0005, Accuracy: 575/580 (99.1379%), train_poison_data_count: 292
Global model norm: 15.45531495162445.
Norm before scaling: 15.616198204502423. Distance: 2.16116281963465
Total norm for 10 adversaries is: 15.616198204502423. distance: 2.16116281963465
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0156, Accuracy: 8908/8968 (99.3310%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 33, internal_epoch   1,  Average loss: 0.0199, Accuracy: 315/587 (53.6627%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 33, internal_epoch   2,  Average loss: 0.0055, Accuracy: 542/587 (92.3339%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 33, internal_epoch   3,  Average loss: 0.0012, Accuracy: 574/587 (97.7853%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 33, internal_epoch   4,  Average loss: 0.0007, Accuracy: 582/587 (99.1482%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 33, internal_epoch   5,  Average loss: 0.0008, Accuracy: 582/587 (99.1482%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 33, internal_epoch   6,  Average loss: 0.0005, Accuracy: 583/587 (99.3186%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 33, internal_epoch   7,  Average loss: 0.0005, Accuracy: 581/587 (98.9779%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 33, internal_epoch   8,  Average loss: 0.0004, Accuracy: 583/587 (99.3186%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 33, internal_epoch   9,  Average loss: 0.0003, Accuracy: 585/587 (99.6593%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 33, internal_epoch  10,  Average loss: 0.0004, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Global model norm: 15.45531495162445.
Norm before scaling: 15.858651942415031. Distance: 4.000928532594004
Total norm for 10 adversaries is: 15.858651942415031. distance: 4.000928532594004
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.8527, Accuracy: 6388/8968 (71.2310%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 88, internal_epoch   1,  Average loss: 0.0097, Accuracy: 573/734 (78.0654%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 88, internal_epoch   2,  Average loss: 0.0025, Accuracy: 699/734 (95.2316%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 88, internal_epoch   3,  Average loss: 0.0008, Accuracy: 717/734 (97.6839%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 88, internal_epoch   4,  Average loss: 0.0006, Accuracy: 723/734 (98.5014%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 88, internal_epoch   5,  Average loss: 0.0006, Accuracy: 724/734 (98.6376%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 88, internal_epoch   6,  Average loss: 0.0005, Accuracy: 728/734 (99.1826%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 88, internal_epoch   7,  Average loss: 0.0005, Accuracy: 727/734 (99.0463%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 88, internal_epoch   8,  Average loss: 0.0004, Accuracy: 727/734 (99.0463%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 88, internal_epoch   9,  Average loss: 0.0004, Accuracy: 728/734 (99.1826%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 88, internal_epoch  10,  Average loss: 0.0005, Accuracy: 727/734 (99.0463%), train_poison_data_count: 382
Global model norm: 15.45531495162445.
Norm before scaling: 15.752288167740305. Distance: 3.1615197030677735
Total norm for 10 adversaries is: 15.752288167740305. distance: 3.1615197030677735
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0486, Accuracy: 8813/8968 (98.2716%)
___Train Local_Simple,  epoch  46, local model 25, internal_epoch   1,  Average loss: 0.0003, Accuracy: 588/592 (99.3243%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.8880, Accuracy: 7757/10000 (77.5700%)
___Train Local_Simple,  epoch  46, local model 85, internal_epoch   1,  Average loss: 0.0012, Accuracy: 786/807 (97.3978%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 2.7108, Accuracy: 5637/10000 (56.3700%)
___Train Local_Simple,  epoch  46, local model 56, internal_epoch   1,  Average loss: 0.0004, Accuracy: 710/715 (99.3007%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 2.3386, Accuracy: 5392/10000 (53.9200%)
___Train Local_Simple,  epoch  46, local model 30, internal_epoch   1,  Average loss: 0.0006, Accuracy: 437/443 (98.6456%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.1182, Accuracy: 7288/10000 (72.8800%)
___Train Local_Simple,  epoch  46, local model 38, internal_epoch   1,  Average loss: 0.0006, Accuracy: 472/477 (98.9518%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.3398, Accuracy: 8893/10000 (88.9300%)
___Train Local_Simple,  epoch  46, local model 53, internal_epoch   1,  Average loss: 0.0005, Accuracy: 555/561 (98.9305%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.4421, Accuracy: 6635/10000 (66.3500%)
___Train Local_Simple,  epoch  46, local model 98, internal_epoch   1,  Average loss: 0.0014, Accuracy: 535/548 (97.6277%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 3.5408, Accuracy: 3943/10000 (39.4300%)
___Train Local_Simple,  epoch  46, local model 42, internal_epoch   1,  Average loss: 0.0003, Accuracy: 471/473 (99.5772%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.5234, Accuracy: 8242/10000 (82.4200%)
___Train Local_Simple,  epoch  46, local model 96, internal_epoch   1,  Average loss: 0.0007, Accuracy: 520/531 (97.9284%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 4.5554, Accuracy: 3828/10000 (38.2800%)
___Train Local_Simple,  epoch  46, local model 48, internal_epoch   1,  Average loss: 0.0008, Accuracy: 357/363 (98.3471%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.4094, Accuracy: 8673/10000 (86.7300%)
___Train Local_Simple,  epoch  46, local model 19, internal_epoch   1,  Average loss: 0.0008, Accuracy: 589/598 (98.4950%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.9648, Accuracy: 5460/10000 (54.6000%)
___Train Local_Simple,  epoch  46, local model 55, internal_epoch   1,  Average loss: 0.0014, Accuracy: 364/375 (97.0667%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.9409, Accuracy: 7223/10000 (72.2300%)
___Train Local_Simple,  epoch  46, local model 71, internal_epoch   1,  Average loss: 0.0010, Accuracy: 551/561 (98.2175%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.1735, Accuracy: 6537/10000 (65.3700%)
___Train Local_Simple,  epoch  46, local model 39, internal_epoch   1,  Average loss: 0.0007, Accuracy: 485/493 (98.3773%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.5749, Accuracy: 6801/10000 (68.0100%)
___Train Local_Simple,  epoch  46, local model 95, internal_epoch   1,  Average loss: 0.0017, Accuracy: 576/600 (96.0000%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 3.4528, Accuracy: 5289/10000 (52.8900%)
___Train Local_Simple,  epoch  46, local model 79, internal_epoch   1,  Average loss: 0.0010, Accuracy: 654/661 (98.9410%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.7841, Accuracy: 5121/10000 (51.2100%)
___Train Local_Simple,  epoch  46, local model 99, internal_epoch   1,  Average loss: 0.0018, Accuracy: 681/712 (95.6461%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 2.5470, Accuracy: 5177/10000 (51.7700%)
___Train Local_Simple,  epoch  46, local model 27, internal_epoch   1,  Average loss: 0.0007, Accuracy: 735/745 (98.6577%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 5.0654, Accuracy: 3620/10000 (36.2000%)
___Train Local_Simple,  epoch  46, local model 10, internal_epoch   1,  Average loss: 0.0012, Accuracy: 562/573 (98.0803%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 2.6226, Accuracy: 4191/10000 (41.9100%)
___Train Local_Simple,  epoch  46, local model 68, internal_epoch   1,  Average loss: 0.0015, Accuracy: 535/549 (97.4499%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 3.5797, Accuracy: 3897/10000 (38.9700%)
___Train Local_Simple,  epoch  46, local model 40, internal_epoch   1,  Average loss: 0.0004, Accuracy: 495/498 (99.3976%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.8153, Accuracy: 6102/10000 (61.0200%)
___Train Local_Simple,  epoch  46, local model 35, internal_epoch   1,  Average loss: 0.0013, Accuracy: 613/630 (97.3016%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 2.9265, Accuracy: 4975/10000 (49.7500%)
___Train Local_Simple,  epoch  46, local model 97, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1106/1112 (99.4604%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 4.8093, Accuracy: 3206/10000 (32.0600%)
___Train Local_Simple,  epoch  46, local model 20, internal_epoch   1,  Average loss: 0.0007, Accuracy: 594/602 (98.6711%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 2.1164, Accuracy: 5331/10000 (53.3100%)
___Train Local_Simple,  epoch  46, local model 34, internal_epoch   1,  Average loss: 0.0013, Accuracy: 847/871 (97.2445%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 3.9152, Accuracy: 4885/10000 (48.8500%)
___Train Local_Simple,  epoch  46, local model 91, internal_epoch   1,  Average loss: 0.0005, Accuracy: 808/819 (98.6569%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 4.2648, Accuracy: 4298/10000 (42.9800%)
___Train Local_Simple,  epoch  46, local model 2, internal_epoch   1,  Average loss: 0.0010, Accuracy: 552/564 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 2.0351, Accuracy: 5342/10000 (53.4200%)
___Train Local_Simple,  epoch  46, local model 36, internal_epoch   1,  Average loss: 0.0008, Accuracy: 309/315 (98.0952%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.6213, Accuracy: 8283/10000 (82.8300%)
___Train Local_Simple,  epoch  46, local model 65, internal_epoch   1,  Average loss: 0.0015, Accuracy: 603/621 (97.1014%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.5067, Accuracy: 5814/10000 (58.1400%)
___Train Local_Simple,  epoch  46, local model 8, internal_epoch   1,  Average loss: 0.0008, Accuracy: 699/706 (99.0085%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 2.0668, Accuracy: 5654/10000 (56.5400%)
___Train Local_Simple,  epoch  46, local model 1, internal_epoch   1,  Average loss: 0.0003, Accuracy: 535/536 (99.8134%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2374, Accuracy: 9237/10000 (92.3700%)
___Train Local_Simple,  epoch  46, local model 54, internal_epoch   1,  Average loss: 0.0004, Accuracy: 825/832 (99.1587%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 2.1362, Accuracy: 5540/10000 (55.4000%)
___Train Local_Simple,  epoch  46, local model 21, internal_epoch   1,  Average loss: 0.0005, Accuracy: 684/687 (99.5633%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.9436, Accuracy: 6278/10000 (62.7800%)
___Train Local_Simple,  epoch  46, local model 5, internal_epoch   1,  Average loss: 0.0007, Accuracy: 568/578 (98.2699%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.6199, Accuracy: 8253/10000 (82.5300%)
___Train Local_Simple,  epoch  46, local model 16, internal_epoch   1,  Average loss: 0.0003, Accuracy: 813/817 (99.5104%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 2.1480, Accuracy: 6039/10000 (60.3900%)
___Train Local_Simple,  epoch  46, local model 45, internal_epoch   1,  Average loss: 0.0008, Accuracy: 638/647 (98.6090%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 2.1593, Accuracy: 5401/10000 (54.0100%)
___Train Local_Simple,  epoch  46, local model 80, internal_epoch   1,  Average loss: 0.0018, Accuracy: 509/532 (95.6767%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 6.0377, Accuracy: 2991/10000 (29.9100%)
___Train Local_Simple,  epoch  46, local model 89, internal_epoch   1,  Average loss: 0.0014, Accuracy: 663/683 (97.0717%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 3.5062, Accuracy: 4626/10000 (46.2600%)
___Train Local_Simple,  epoch  46, local model 76, internal_epoch   1,  Average loss: 0.0009, Accuracy: 455/459 (99.1285%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.4390, Accuracy: 8582/10000 (85.8200%)
___Train Local_Simple,  epoch  46, local model 69, internal_epoch   1,  Average loss: 0.0011, Accuracy: 654/671 (97.4665%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 4.4219, Accuracy: 3472/10000 (34.7200%)
___Train Local_Simple,  epoch  46, local model 0, internal_epoch   1,  Average loss: 0.0006, Accuracy: 428/435 (98.3908%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 2.0413, Accuracy: 6157/10000 (61.5700%)
___Train Local_Simple,  epoch  46, local model 58, internal_epoch   1,  Average loss: 0.0009, Accuracy: 761/772 (98.5751%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 6.1343, Accuracy: 2995/10000 (29.9500%)
___Train Local_Simple,  epoch  46, local model 77, internal_epoch   1,  Average loss: 0.0014, Accuracy: 604/618 (97.7346%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 3.0244, Accuracy: 5452/10000 (54.5200%)
___Train Local_Simple,  epoch  46, local model 12, internal_epoch   1,  Average loss: 0.0006, Accuracy: 717/725 (98.8966%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.4843, Accuracy: 6586/10000 (65.8600%)
___Train Local_Simple,  epoch  46, local model 82, internal_epoch   1,  Average loss: 0.0005, Accuracy: 809/815 (99.2638%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 3.0611, Accuracy: 5003/10000 (50.0300%)
___Train Local_Simple,  epoch  46, local model 86, internal_epoch   1,  Average loss: 0.0004, Accuracy: 688/692 (99.4220%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 3.2991, Accuracy: 4754/10000 (47.5400%)
___Train Local_Simple,  epoch  46, local model 7, internal_epoch   1,  Average loss: 0.0006, Accuracy: 794/802 (99.0025%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.1773, Accuracy: 6993/10000 (69.9300%)
___Train Local_Simple,  epoch  46, local model 92, internal_epoch   1,  Average loss: 0.0045, Accuracy: 573/611 (93.7807%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 2.4265, Accuracy: 4823/10000 (48.2300%)
___Train Local_Simple,  epoch  46, local model 70, internal_epoch   1,  Average loss: 0.0014, Accuracy: 550/568 (96.8310%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 3.5961, Accuracy: 3511/10000 (35.1100%)
___Train Local_Simple,  epoch  46, local model 60, internal_epoch   1,  Average loss: 0.0013, Accuracy: 558/571 (97.7233%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 4.7691, Accuracy: 3610/10000 (36.1000%)
___Train Local_Simple,  epoch  46, local model 83, internal_epoch   1,  Average loss: 0.0011, Accuracy: 352/360 (97.7778%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.3250, Accuracy: 8969/10000 (89.6900%)
___Train Local_Simple,  epoch  46, local model 14, internal_epoch   1,  Average loss: 0.0010, Accuracy: 681/692 (98.4104%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.5305, Accuracy: 6137/10000 (61.3700%)
___Train Local_Simple,  epoch  46, local model 4, internal_epoch   1,  Average loss: 0.0006, Accuracy: 739/748 (98.7968%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.4962, Accuracy: 6052/10000 (60.5200%)
___Train Local_Simple,  epoch  46, local model 75, internal_epoch   1,  Average loss: 0.0012, Accuracy: 741/763 (97.1166%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 7.0089, Accuracy: 2595/10000 (25.9500%)
___Train Local_Simple,  epoch  46, local model 63, internal_epoch   1,  Average loss: 0.0013, Accuracy: 295/303 (97.3597%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.6692, Accuracy: 5956/10000 (59.5600%)
___Train Local_Simple,  epoch  46, local model 50, internal_epoch   1,  Average loss: 0.0010, Accuracy: 466/477 (97.6939%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.4951, Accuracy: 6339/10000 (63.3900%)
___Train Local_Simple,  epoch  46, local model 23, internal_epoch   1,  Average loss: 0.0012, Accuracy: 530/542 (97.7860%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.3488, Accuracy: 5984/10000 (59.8400%)
___Train Local_Simple,  epoch  46, local model 52, internal_epoch   1,  Average loss: 0.0019, Accuracy: 755/789 (95.6907%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 2.2041, Accuracy: 6151/10000 (61.5100%)
___Train Local_Simple,  epoch  46, local model 49, internal_epoch   1,  Average loss: 0.0015, Accuracy: 343/355 (96.6197%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.8756, Accuracy: 5294/10000 (52.9400%)
___Train Local_Simple,  epoch  46, local model 26, internal_epoch   1,  Average loss: 0.0015, Accuracy: 502/519 (96.7245%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 2.1490, Accuracy: 5690/10000 (56.9000%)
___Train Local_Simple,  epoch  46, local model 84, internal_epoch   1,  Average loss: 0.0007, Accuracy: 412/420 (98.0952%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.9764, Accuracy: 7673/10000 (76.7300%)
___Train Local_Simple,  epoch  46, local model 81, internal_epoch   1,  Average loss: 0.0009, Accuracy: 631/636 (99.2138%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.7087, Accuracy: 5764/10000 (57.6400%)
___Train Local_Simple,  epoch  46, local model 31, internal_epoch   1,  Average loss: 0.0005, Accuracy: 591/596 (99.1611%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.1850, Accuracy: 6814/10000 (68.1400%)
___Train Local_Simple,  epoch  46, local model 11, internal_epoch   1,  Average loss: 0.0009, Accuracy: 548/554 (98.9170%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.8046, Accuracy: 8009/10000 (80.0900%)
___Train Local_Simple,  epoch  46, local model 22, internal_epoch   1,  Average loss: 0.0004, Accuracy: 260/262 (99.2366%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.4003, Accuracy: 8739/10000 (87.3900%)
___Train Local_Simple,  epoch  46, local model 24, internal_epoch   1,  Average loss: 0.0014, Accuracy: 465/477 (97.4843%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.8398, Accuracy: 6964/10000 (69.6400%)
___Train Local_Simple,  epoch  46, local model 17, internal_epoch   1,  Average loss: 0.0007, Accuracy: 523/527 (99.2410%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.5055, Accuracy: 6171/10000 (61.7100%)
___Train Local_Simple,  epoch  46, local model 32, internal_epoch   1,  Average loss: 0.0013, Accuracy: 573/590 (97.1186%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 3.0407, Accuracy: 5344/10000 (53.4400%)
___Train Local_Simple,  epoch  46, local model 78, internal_epoch   1,  Average loss: 0.0090, Accuracy: 559/587 (95.2300%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 4.7741, Accuracy: 2535/10000 (25.3500%)
___Train Local_Simple,  epoch  46, local model 59, internal_epoch   1,  Average loss: 0.0009, Accuracy: 635/644 (98.6025%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.9380, Accuracy: 5876/10000 (58.7600%)
___Train Local_Simple,  epoch  46, local model 87, internal_epoch   1,  Average loss: 0.0010, Accuracy: 649/663 (97.8884%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 2.6027, Accuracy: 5148/10000 (51.4800%)
___Train Local_Simple,  epoch  46, local model 47, internal_epoch   1,  Average loss: 0.0009, Accuracy: 525/534 (98.3146%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 2.4748, Accuracy: 5306/10000 (53.0600%)
___Train Local_Simple,  epoch  46, local model 46, internal_epoch   1,  Average loss: 0.0007, Accuracy: 642/650 (98.7692%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 2.5260, Accuracy: 5561/10000 (55.6100%)
___Train Local_Simple,  epoch  46, local model 9, internal_epoch   1,  Average loss: 0.0008, Accuracy: 501/508 (98.6220%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.5181, Accuracy: 6464/10000 (64.6400%)
___Train Local_Simple,  epoch  46, local model 37, internal_epoch   1,  Average loss: 0.0007, Accuracy: 451/456 (98.9035%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.9230, Accuracy: 7470/10000 (74.7000%)
___Train Local_Simple,  epoch  46, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 699/713 (98.0365%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.9444, Accuracy: 5839/10000 (58.3900%)
___Train Local_Simple,  epoch  46, local model 66, internal_epoch   1,  Average loss: 0.0018, Accuracy: 707/733 (96.4529%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 4.6544, Accuracy: 3352/10000 (33.5200%)
___Train Local_Simple,  epoch  46, local model 90, internal_epoch   1,  Average loss: 0.0020, Accuracy: 590/615 (95.9350%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 2.1243, Accuracy: 5960/10000 (59.6000%)
___Train Local_Simple,  epoch  46, local model 67, internal_epoch   1,  Average loss: 0.0015, Accuracy: 428/441 (97.0522%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.9230, Accuracy: 4943/10000 (49.4300%)
___Train Local_Simple,  epoch  46, local model 44, internal_epoch   1,  Average loss: 0.0003, Accuracy: 558/561 (99.4652%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.9557, Accuracy: 7772/10000 (77.7200%)
___Train Local_Simple,  epoch  46, local model 43, internal_epoch   1,  Average loss: 0.0008, Accuracy: 426/431 (98.8399%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.6362, Accuracy: 8102/10000 (81.0200%)
___Train Local_Simple,  epoch  46, local model 93, internal_epoch   1,  Average loss: 0.0013, Accuracy: 611/630 (96.9841%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 2.4297, Accuracy: 4511/10000 (45.1100%)
___Train Local_Simple,  epoch  46, local model 15, internal_epoch   1,  Average loss: 0.0008, Accuracy: 280/282 (99.2908%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2912, Accuracy: 8994/10000 (89.9400%)
___Train Local_Simple,  epoch  46, local model 94, internal_epoch   1,  Average loss: 0.0006, Accuracy: 664/671 (98.9568%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 3.1037, Accuracy: 5464/10000 (54.6400%)
___Train Local_Simple,  epoch  46, local model 64, internal_epoch   1,  Average loss: 0.0004, Accuracy: 605/608 (99.5066%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.8733, Accuracy: 5979/10000 (59.7900%)
___Train Local_Simple,  epoch  46, local model 57, internal_epoch   1,  Average loss: 0.0006, Accuracy: 517/523 (98.8528%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.9481, Accuracy: 5595/10000 (55.9500%)
___Train Local_Simple,  epoch  46, local model 61, internal_epoch   1,  Average loss: 0.0011, Accuracy: 283/287 (98.6063%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.3102, Accuracy: 9057/10000 (90.5700%)
___Train Local_Simple,  epoch  46, local model 72, internal_epoch   1,  Average loss: 0.0016, Accuracy: 407/423 (96.2175%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 3.4493, Accuracy: 3451/10000 (34.5100%)
___Train Local_Simple,  epoch  46, local model 28, internal_epoch   1,  Average loss: 0.0006, Accuracy: 602/611 (98.5270%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 2.3539, Accuracy: 6446/10000 (64.4600%)
___Train Local_Simple,  epoch  46, local model 6, internal_epoch   1,  Average loss: 0.0009, Accuracy: 430/435 (98.8506%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.6582, Accuracy: 8034/10000 (80.3400%)
time spent on training: 361.0158586502075
___Test Target_Simple poisoned: False, epoch: 46: Average loss: 0.1082, Accuracy: 9711/10000 (97.1100%)
___Test Target_Simple poisoned: True, epoch: 46: Average loss: 2.9011, Accuracy: 2146/8968 (23.9295%)
saving model
Done in 394.91662764549255 sec.
Server Epoch:47 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 68, 69, 85, 5, 57, 16, 99, 70, 10, 45, 1, 32, 55, 89, 94, 97, 44, 22, 28, 42, 24, 34, 8, 65, 31, 67, 20, 63, 12, 83, 71, 82, 30, 66, 98, 4, 87, 95, 78, 25, 72, 92, 79, 46, 39, 53, 36, 35, 13, 14, 49, 0, 84, 38, 40, 75, 80, 43, 9, 2, 59, 60, 50, 11, 19, 15, 86, 56, 61, 91, 23, 96, 21, 81, 58, 17, 37, 54, 77, 26, 76, 6, 27, 64, 93, 48, 47, 7, 52, 90].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   1,  Average loss: 0.0187, Accuracy: 329/569 (57.8207%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   2,  Average loss: 0.0052, Accuracy: 527/569 (92.6186%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   3,  Average loss: 0.0009, Accuracy: 565/569 (99.2970%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   4,  Average loss: 0.0007, Accuracy: 565/569 (99.2970%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   5,  Average loss: 0.0007, Accuracy: 565/569 (99.2970%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   6,  Average loss: 0.0005, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   7,  Average loss: 0.0003, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   8,  Average loss: 0.0005, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch   9,  Average loss: 0.0003, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 41, internal_epoch  10,  Average loss: 0.0004, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Global model norm: 15.457156620669224.
Norm before scaling: 15.737085769934453. Distance: 3.8731169278287094
Total norm for 10 adversaries is: 15.737085769934453. distance: 3.8731169278287094
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.7898, Accuracy: 6313/8968 (70.3947%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   1,  Average loss: 0.0087, Accuracy: 422/522 (80.8429%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   2,  Average loss: 0.0020, Accuracy: 508/522 (97.3180%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   3,  Average loss: 0.0009, Accuracy: 511/522 (97.8927%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   4,  Average loss: 0.0008, Accuracy: 511/522 (97.8927%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   5,  Average loss: 0.0007, Accuracy: 515/522 (98.6590%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   6,  Average loss: 0.0004, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   7,  Average loss: 0.0003, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   8,  Average loss: 0.0002, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch   9,  Average loss: 0.0002, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 73, internal_epoch  10,  Average loss: 0.0003, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Global model norm: 15.457156620669224.
Norm before scaling: 15.644605863586117. Distance: 2.465249779293003
Total norm for 10 adversaries is: 15.644605863586117. distance: 2.465249779293003
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0244, Accuracy: 8886/8968 (99.0856%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   1,  Average loss: 0.0156, Accuracy: 249/385 (64.6753%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   2,  Average loss: 0.0045, Accuracy: 364/385 (94.5455%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   3,  Average loss: 0.0015, Accuracy: 377/385 (97.9221%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   4,  Average loss: 0.0010, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   5,  Average loss: 0.0010, Accuracy: 379/385 (98.4416%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   6,  Average loss: 0.0007, Accuracy: 381/385 (98.9610%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   7,  Average loss: 0.0006, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   8,  Average loss: 0.0005, Accuracy: 383/385 (99.4805%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch   9,  Average loss: 0.0005, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 51, internal_epoch  10,  Average loss: 0.0004, Accuracy: 383/385 (99.4805%), train_poison_data_count: 193
Global model norm: 15.457156620669224.
Norm before scaling: 15.697906568389392. Distance: 3.0190873109638856
Total norm for 10 adversaries is: 15.697906568389392. distance: 3.0190873109638856
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.1493, Accuracy: 8471/8968 (94.4581%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   1,  Average loss: 0.0045, Accuracy: 559/627 (89.1547%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   2,  Average loss: 0.0011, Accuracy: 615/627 (98.0861%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   3,  Average loss: 0.0009, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   4,  Average loss: 0.0004, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   5,  Average loss: 0.0005, Accuracy: 624/627 (99.5215%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   6,  Average loss: 0.0006, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   7,  Average loss: 0.0004, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   8,  Average loss: 0.0005, Accuracy: 621/627 (99.0431%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch   9,  Average loss: 0.0007, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 74, internal_epoch  10,  Average loss: 0.0003, Accuracy: 626/627 (99.8405%), train_poison_data_count: 320
Global model norm: 15.457156620669224.
Norm before scaling: 15.595369365753953. Distance: 2.0740544888098986
Total norm for 10 adversaries is: 15.595369365753953. distance: 2.0740544888098986
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0072, Accuracy: 8945/8968 (99.7435%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 3, internal_epoch   1,  Average loss: 0.0208, Accuracy: 317/516 (61.4341%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 3, internal_epoch   2,  Average loss: 0.0081, Accuracy: 406/516 (78.6822%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 3, internal_epoch   3,  Average loss: 0.0027, Accuracy: 503/516 (97.4806%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 3, internal_epoch   4,  Average loss: 0.0014, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 3, internal_epoch   5,  Average loss: 0.0008, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 3, internal_epoch   6,  Average loss: 0.0007, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 3, internal_epoch   7,  Average loss: 0.0007, Accuracy: 512/516 (99.2248%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 3, internal_epoch   8,  Average loss: 0.0005, Accuracy: 512/516 (99.2248%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 3, internal_epoch   9,  Average loss: 0.0004, Accuracy: 513/516 (99.4186%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 3, internal_epoch  10,  Average loss: 0.0005, Accuracy: 513/516 (99.4186%), train_poison_data_count: 260
Global model norm: 15.457156620669224.
Norm before scaling: 15.872921785106035. Distance: 4.299621370190863
Total norm for 10 adversaries is: 15.872921785106035. distance: 4.299621370190863
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.6279, Accuracy: 6863/8968 (76.5277%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 18, internal_epoch   1,  Average loss: 0.0107, Accuracy: 618/759 (81.4229%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 18, internal_epoch   2,  Average loss: 0.0007, Accuracy: 750/759 (98.8142%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 18, internal_epoch   3,  Average loss: 0.0002, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 18, internal_epoch   4,  Average loss: 0.0003, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 18, internal_epoch   5,  Average loss: 0.0004, Accuracy: 753/759 (99.2095%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 18, internal_epoch   6,  Average loss: 0.0003, Accuracy: 753/759 (99.2095%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 18, internal_epoch   7,  Average loss: 0.0001, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 18, internal_epoch   8,  Average loss: 0.0002, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 18, internal_epoch   9,  Average loss: 0.0002, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 18, internal_epoch  10,  Average loss: 0.0002, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Global model norm: 15.457156620669224.
Norm before scaling: 15.965143860342922. Distance: 3.851789549041139
Total norm for 10 adversaries is: 15.965143860342922. distance: 3.851789549041139
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.1556, Accuracy: 8527/8968 (95.0825%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 29, internal_epoch   1,  Average loss: 0.0113, Accuracy: 381/506 (75.2964%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 29, internal_epoch   2,  Average loss: 0.0021, Accuracy: 500/506 (98.8142%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 29, internal_epoch   3,  Average loss: 0.0005, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 29, internal_epoch   4,  Average loss: 0.0005, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 29, internal_epoch   5,  Average loss: 0.0003, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 29, internal_epoch   6,  Average loss: 0.0003, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 29, internal_epoch   7,  Average loss: 0.0003, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 29, internal_epoch   8,  Average loss: 0.0003, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 29, internal_epoch   9,  Average loss: 0.0003, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 29, internal_epoch  10,  Average loss: 0.0003, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Global model norm: 15.457156620669224.
Norm before scaling: 15.791037728996589. Distance: 3.0927381305708876
Total norm for 10 adversaries is: 15.791037728996589. distance: 3.0927381305708876
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 1.3185, Accuracy: 5128/8968 (57.1811%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 62, internal_epoch   1,  Average loss: 0.0050, Accuracy: 513/580 (88.4483%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 62, internal_epoch   2,  Average loss: 0.0018, Accuracy: 557/580 (96.0345%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 62, internal_epoch   3,  Average loss: 0.0010, Accuracy: 566/580 (97.5862%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 62, internal_epoch   4,  Average loss: 0.0007, Accuracy: 571/580 (98.4483%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 62, internal_epoch   5,  Average loss: 0.0006, Accuracy: 571/580 (98.4483%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 62, internal_epoch   6,  Average loss: 0.0007, Accuracy: 570/580 (98.2759%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 62, internal_epoch   7,  Average loss: 0.0005, Accuracy: 574/580 (98.9655%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 62, internal_epoch   8,  Average loss: 0.0005, Accuracy: 574/580 (98.9655%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 62, internal_epoch   9,  Average loss: 0.0005, Accuracy: 573/580 (98.7931%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 62, internal_epoch  10,  Average loss: 0.0004, Accuracy: 574/580 (98.9655%), train_poison_data_count: 292
Global model norm: 15.457156620669224.
Norm before scaling: 15.623562922195086. Distance: 2.172551331083767
Total norm for 10 adversaries is: 15.623562922195086. distance: 2.172551331083767
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0205, Accuracy: 8888/8968 (99.1079%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 33, internal_epoch   1,  Average loss: 0.0161, Accuracy: 370/587 (63.0324%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 33, internal_epoch   2,  Average loss: 0.0033, Accuracy: 543/587 (92.5043%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 33, internal_epoch   3,  Average loss: 0.0008, Accuracy: 577/587 (98.2964%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 33, internal_epoch   4,  Average loss: 0.0004, Accuracy: 582/587 (99.1482%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 33, internal_epoch   5,  Average loss: 0.0006, Accuracy: 583/587 (99.3186%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 33, internal_epoch   6,  Average loss: 0.0006, Accuracy: 581/587 (98.9779%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 33, internal_epoch   7,  Average loss: 0.0003, Accuracy: 583/587 (99.3186%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 33, internal_epoch   8,  Average loss: 0.0004, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 33, internal_epoch   9,  Average loss: 0.0003, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 33, internal_epoch  10,  Average loss: 0.0004, Accuracy: 582/587 (99.1482%), train_poison_data_count: 299
Global model norm: 15.457156620669224.
Norm before scaling: 15.886954544752474. Distance: 3.911532439009466
Total norm for 10 adversaries is: 15.886954544752474. distance: 3.911532439009466
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 1.0071, Accuracy: 6063/8968 (67.6070%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 88, internal_epoch   1,  Average loss: 0.0095, Accuracy: 601/734 (81.8801%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 88, internal_epoch   2,  Average loss: 0.0018, Accuracy: 708/734 (96.4578%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 88, internal_epoch   3,  Average loss: 0.0012, Accuracy: 713/734 (97.1390%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 88, internal_epoch   4,  Average loss: 0.0008, Accuracy: 722/734 (98.3651%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 88, internal_epoch   5,  Average loss: 0.0009, Accuracy: 720/734 (98.0926%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 88, internal_epoch   6,  Average loss: 0.0006, Accuracy: 724/734 (98.6376%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 88, internal_epoch   7,  Average loss: 0.0004, Accuracy: 727/734 (99.0463%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 88, internal_epoch   8,  Average loss: 0.0006, Accuracy: 725/734 (98.7738%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 88, internal_epoch   9,  Average loss: 0.0004, Accuracy: 728/734 (99.1826%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 88, internal_epoch  10,  Average loss: 0.0005, Accuracy: 727/734 (99.0463%), train_poison_data_count: 382
Global model norm: 15.457156620669224.
Norm before scaling: 15.786059079291539. Distance: 3.311255023127339
Total norm for 10 adversaries is: 15.786059079291539. distance: 3.311255023127339
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0403, Accuracy: 8841/8968 (98.5839%)
___Train Local_Simple,  epoch  47, local model 68, internal_epoch   1,  Average loss: 0.0012, Accuracy: 540/549 (98.3607%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 2.8313, Accuracy: 5413/10000 (54.1300%)
___Train Local_Simple,  epoch  47, local model 69, internal_epoch   1,  Average loss: 0.0015, Accuracy: 653/671 (97.3174%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 3.7104, Accuracy: 4523/10000 (45.2300%)
___Train Local_Simple,  epoch  47, local model 85, internal_epoch   1,  Average loss: 0.0014, Accuracy: 785/807 (97.2739%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 4.5707, Accuracy: 5150/10000 (51.5000%)
___Train Local_Simple,  epoch  47, local model 5, internal_epoch   1,  Average loss: 0.0008, Accuracy: 570/578 (98.6159%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.0004, Accuracy: 7287/10000 (72.8700%)
___Train Local_Simple,  epoch  47, local model 57, internal_epoch   1,  Average loss: 0.0009, Accuracy: 513/523 (98.0880%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 2.8960, Accuracy: 4124/10000 (41.2400%)
___Train Local_Simple,  epoch  47, local model 16, internal_epoch   1,  Average loss: 0.0005, Accuracy: 809/817 (99.0208%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.3316, Accuracy: 6739/10000 (67.3900%)
___Train Local_Simple,  epoch  47, local model 99, internal_epoch   1,  Average loss: 0.0010, Accuracy: 698/712 (98.0337%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 2.1357, Accuracy: 5599/10000 (55.9900%)
___Train Local_Simple,  epoch  47, local model 70, internal_epoch   1,  Average loss: 0.0011, Accuracy: 557/568 (98.0634%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.8867, Accuracy: 6090/10000 (60.9000%)
___Train Local_Simple,  epoch  47, local model 10, internal_epoch   1,  Average loss: 0.0008, Accuracy: 563/573 (98.2548%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.6699, Accuracy: 5739/10000 (57.3900%)
___Train Local_Simple,  epoch  47, local model 45, internal_epoch   1,  Average loss: 0.0012, Accuracy: 635/647 (98.1453%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 2.8666, Accuracy: 4577/10000 (45.7700%)
___Train Local_Simple,  epoch  47, local model 1, internal_epoch   1,  Average loss: 0.0004, Accuracy: 535/536 (99.8134%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3278, Accuracy: 8977/10000 (89.7700%)
___Train Local_Simple,  epoch  47, local model 32, internal_epoch   1,  Average loss: 0.0005, Accuracy: 586/590 (99.3220%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.9110, Accuracy: 6274/10000 (62.7400%)
___Train Local_Simple,  epoch  47, local model 55, internal_epoch   1,  Average loss: 0.0010, Accuracy: 370/375 (98.6667%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.7294, Accuracy: 6213/10000 (62.1300%)
___Train Local_Simple,  epoch  47, local model 89, internal_epoch   1,  Average loss: 0.0011, Accuracy: 673/683 (98.5359%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.2029, Accuracy: 7013/10000 (70.1300%)
___Train Local_Simple,  epoch  47, local model 94, internal_epoch   1,  Average loss: 0.0007, Accuracy: 663/671 (98.8077%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 2.7741, Accuracy: 5947/10000 (59.4700%)
___Train Local_Simple,  epoch  47, local model 97, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1105/1112 (99.3705%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 3.7135, Accuracy: 4192/10000 (41.9200%)
___Train Local_Simple,  epoch  47, local model 44, internal_epoch   1,  Average loss: 0.0004, Accuracy: 557/561 (99.2870%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.2844, Accuracy: 7381/10000 (73.8100%)
___Train Local_Simple,  epoch  47, local model 22, internal_epoch   1,  Average loss: 0.0007, Accuracy: 259/262 (98.8550%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3962, Accuracy: 8732/10000 (87.3200%)
___Train Local_Simple,  epoch  47, local model 28, internal_epoch   1,  Average loss: 0.0007, Accuracy: 600/611 (98.1997%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.4765, Accuracy: 6828/10000 (68.2800%)
___Train Local_Simple,  epoch  47, local model 42, internal_epoch   1,  Average loss: 0.0004, Accuracy: 469/473 (99.1543%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.6803, Accuracy: 7854/10000 (78.5400%)
___Train Local_Simple,  epoch  47, local model 24, internal_epoch   1,  Average loss: 0.0017, Accuracy: 467/477 (97.9036%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 2.1374, Accuracy: 5405/10000 (54.0500%)
___Train Local_Simple,  epoch  47, local model 34, internal_epoch   1,  Average loss: 0.0007, Accuracy: 860/871 (98.7371%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 3.7087, Accuracy: 4726/10000 (47.2600%)
___Train Local_Simple,  epoch  47, local model 8, internal_epoch   1,  Average loss: 0.0009, Accuracy: 696/706 (98.5836%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 3.5669, Accuracy: 3707/10000 (37.0700%)
___Train Local_Simple,  epoch  47, local model 65, internal_epoch   1,  Average loss: 0.0014, Accuracy: 604/621 (97.2625%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.3386, Accuracy: 6808/10000 (68.0800%)
___Train Local_Simple,  epoch  47, local model 31, internal_epoch   1,  Average loss: 0.0008, Accuracy: 585/596 (98.1544%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 2.1685, Accuracy: 5113/10000 (51.1300%)
___Train Local_Simple,  epoch  47, local model 67, internal_epoch   1,  Average loss: 0.0013, Accuracy: 431/441 (97.7324%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.2398, Accuracy: 6464/10000 (64.6400%)
___Train Local_Simple,  epoch  47, local model 20, internal_epoch   1,  Average loss: 0.0008, Accuracy: 593/602 (98.5050%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.4323, Accuracy: 6539/10000 (65.3900%)
___Train Local_Simple,  epoch  47, local model 63, internal_epoch   1,  Average loss: 0.0013, Accuracy: 296/303 (97.6898%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.8280, Accuracy: 7856/10000 (78.5600%)
___Train Local_Simple,  epoch  47, local model 12, internal_epoch   1,  Average loss: 0.0011, Accuracy: 716/725 (98.7586%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.8707, Accuracy: 6314/10000 (63.1400%)
___Train Local_Simple,  epoch  47, local model 83, internal_epoch   1,  Average loss: 0.0010, Accuracy: 353/360 (98.0556%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3418, Accuracy: 8911/10000 (89.1100%)
___Train Local_Simple,  epoch  47, local model 71, internal_epoch   1,  Average loss: 0.0009, Accuracy: 553/561 (98.5740%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.9254, Accuracy: 7430/10000 (74.3000%)
___Train Local_Simple,  epoch  47, local model 82, internal_epoch   1,  Average loss: 0.0005, Accuracy: 803/815 (98.5276%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 4.6002, Accuracy: 4453/10000 (44.5300%)
___Train Local_Simple,  epoch  47, local model 30, internal_epoch   1,  Average loss: 0.0008, Accuracy: 436/443 (98.4199%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.5144, Accuracy: 7230/10000 (72.3000%)
___Train Local_Simple,  epoch  47, local model 66, internal_epoch   1,  Average loss: 0.0028, Accuracy: 708/733 (96.5894%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.1423, Accuracy: 7197/10000 (71.9700%)
___Train Local_Simple,  epoch  47, local model 98, internal_epoch   1,  Average loss: 0.0012, Accuracy: 534/548 (97.4453%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 2.9798, Accuracy: 4685/10000 (46.8500%)
___Train Local_Simple,  epoch  47, local model 4, internal_epoch   1,  Average loss: 0.0006, Accuracy: 738/748 (98.6631%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 2.6556, Accuracy: 4813/10000 (48.1300%)
___Train Local_Simple,  epoch  47, local model 87, internal_epoch   1,  Average loss: 0.0007, Accuracy: 657/663 (99.0950%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 3.1596, Accuracy: 5287/10000 (52.8700%)
___Train Local_Simple,  epoch  47, local model 95, internal_epoch   1,  Average loss: 0.0015, Accuracy: 588/600 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.7127, Accuracy: 6475/10000 (64.7500%)
___Train Local_Simple,  epoch  47, local model 78, internal_epoch   1,  Average loss: 0.0021, Accuracy: 563/587 (95.9114%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 2.7189, Accuracy: 4570/10000 (45.7000%)
___Train Local_Simple,  epoch  47, local model 25, internal_epoch   1,  Average loss: 0.0003, Accuracy: 590/592 (99.6622%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.2710, Accuracy: 7589/10000 (75.8900%)
___Train Local_Simple,  epoch  47, local model 72, internal_epoch   1,  Average loss: 0.0016, Accuracy: 411/423 (97.1631%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 2.6780, Accuracy: 4768/10000 (47.6800%)
___Train Local_Simple,  epoch  47, local model 92, internal_epoch   1,  Average loss: 0.0043, Accuracy: 565/611 (92.4714%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.0446, Accuracy: 6895/10000 (68.9500%)
___Train Local_Simple,  epoch  47, local model 79, internal_epoch   1,  Average loss: 0.0009, Accuracy: 654/661 (98.9410%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 2.2299, Accuracy: 5454/10000 (54.5400%)
___Train Local_Simple,  epoch  47, local model 46, internal_epoch   1,  Average loss: 0.0006, Accuracy: 643/650 (98.9231%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.9949, Accuracy: 5856/10000 (58.5600%)
___Train Local_Simple,  epoch  47, local model 39, internal_epoch   1,  Average loss: 0.0009, Accuracy: 484/493 (98.1744%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.7957, Accuracy: 6342/10000 (63.4200%)
___Train Local_Simple,  epoch  47, local model 53, internal_epoch   1,  Average loss: 0.0008, Accuracy: 552/561 (98.3957%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 2.6823, Accuracy: 5478/10000 (54.7800%)
___Train Local_Simple,  epoch  47, local model 36, internal_epoch   1,  Average loss: 0.0005, Accuracy: 313/315 (99.3651%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3072, Accuracy: 9058/10000 (90.5800%)
___Train Local_Simple,  epoch  47, local model 35, internal_epoch   1,  Average loss: 0.0010, Accuracy: 621/630 (98.5714%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 3.4161, Accuracy: 4458/10000 (44.5800%)
___Train Local_Simple,  epoch  47, local model 13, internal_epoch   1,  Average loss: 0.0007, Accuracy: 707/713 (99.1585%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 3.2043, Accuracy: 4678/10000 (46.7800%)
___Train Local_Simple,  epoch  47, local model 14, internal_epoch   1,  Average loss: 0.0009, Accuracy: 681/692 (98.4104%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.0870, Accuracy: 7069/10000 (70.6900%)
___Train Local_Simple,  epoch  47, local model 49, internal_epoch   1,  Average loss: 0.0009, Accuracy: 348/355 (98.0282%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.9522, Accuracy: 6926/10000 (69.2600%)
___Train Local_Simple,  epoch  47, local model 0, internal_epoch   1,  Average loss: 0.0008, Accuracy: 430/435 (98.8506%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.8743, Accuracy: 6205/10000 (62.0500%)
___Train Local_Simple,  epoch  47, local model 84, internal_epoch   1,  Average loss: 0.0010, Accuracy: 411/420 (97.8571%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.9937, Accuracy: 7633/10000 (76.3300%)
___Train Local_Simple,  epoch  47, local model 38, internal_epoch   1,  Average loss: 0.0007, Accuracy: 471/477 (98.7421%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.8239, Accuracy: 7738/10000 (77.3800%)
___Train Local_Simple,  epoch  47, local model 40, internal_epoch   1,  Average loss: 0.0007, Accuracy: 494/498 (99.1968%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 3.4765, Accuracy: 4438/10000 (44.3800%)
___Train Local_Simple,  epoch  47, local model 75, internal_epoch   1,  Average loss: 0.0011, Accuracy: 746/763 (97.7720%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 3.9170, Accuracy: 4524/10000 (45.2400%)
___Train Local_Simple,  epoch  47, local model 80, internal_epoch   1,  Average loss: 0.0018, Accuracy: 514/532 (96.6165%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 4.5985, Accuracy: 3037/10000 (30.3700%)
___Train Local_Simple,  epoch  47, local model 43, internal_epoch   1,  Average loss: 0.0009, Accuracy: 424/431 (98.3759%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.1996, Accuracy: 7110/10000 (71.1000%)
___Train Local_Simple,  epoch  47, local model 9, internal_epoch   1,  Average loss: 0.0008, Accuracy: 502/508 (98.8189%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.5923, Accuracy: 7979/10000 (79.7900%)
___Train Local_Simple,  epoch  47, local model 2, internal_epoch   1,  Average loss: 0.0010, Accuracy: 554/564 (98.2270%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.2795, Accuracy: 6720/10000 (67.2000%)
___Train Local_Simple,  epoch  47, local model 59, internal_epoch   1,  Average loss: 0.0008, Accuracy: 636/644 (98.7578%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.9849, Accuracy: 5841/10000 (58.4100%)
___Train Local_Simple,  epoch  47, local model 60, internal_epoch   1,  Average loss: 0.0011, Accuracy: 560/571 (98.0736%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 3.1497, Accuracy: 4527/10000 (45.2700%)
___Train Local_Simple,  epoch  47, local model 50, internal_epoch   1,  Average loss: 0.0010, Accuracy: 467/477 (97.9036%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.3058, Accuracy: 6346/10000 (63.4600%)
___Train Local_Simple,  epoch  47, local model 11, internal_epoch   1,  Average loss: 0.0006, Accuracy: 547/554 (98.7365%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.9006, Accuracy: 7720/10000 (77.2000%)
___Train Local_Simple,  epoch  47, local model 19, internal_epoch   1,  Average loss: 0.0006, Accuracy: 593/598 (99.1639%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.7041, Accuracy: 6273/10000 (62.7300%)
___Train Local_Simple,  epoch  47, local model 15, internal_epoch   1,  Average loss: 0.0009, Accuracy: 278/282 (98.5816%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3538, Accuracy: 8769/10000 (87.6900%)
___Train Local_Simple,  epoch  47, local model 86, internal_epoch   1,  Average loss: 0.0005, Accuracy: 688/692 (99.4220%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 2.7710, Accuracy: 4837/10000 (48.3700%)
___Train Local_Simple,  epoch  47, local model 56, internal_epoch   1,  Average loss: 0.0005, Accuracy: 708/715 (99.0210%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 2.6679, Accuracy: 4815/10000 (48.1500%)
___Train Local_Simple,  epoch  47, local model 61, internal_epoch   1,  Average loss: 0.0012, Accuracy: 279/287 (97.2125%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.6375, Accuracy: 8253/10000 (82.5300%)
___Train Local_Simple,  epoch  47, local model 91, internal_epoch   1,  Average loss: 0.0003, Accuracy: 815/819 (99.5116%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 2.0983, Accuracy: 5330/10000 (53.3000%)
___Train Local_Simple,  epoch  47, local model 23, internal_epoch   1,  Average loss: 0.0018, Accuracy: 531/542 (97.9705%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.5554, Accuracy: 6137/10000 (61.3700%)
___Train Local_Simple,  epoch  47, local model 96, internal_epoch   1,  Average loss: 0.0007, Accuracy: 521/531 (98.1168%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 3.2338, Accuracy: 4896/10000 (48.9600%)
___Train Local_Simple,  epoch  47, local model 21, internal_epoch   1,  Average loss: 0.0004, Accuracy: 683/687 (99.4178%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.8786, Accuracy: 6087/10000 (60.8700%)
___Train Local_Simple,  epoch  47, local model 81, internal_epoch   1,  Average loss: 0.0009, Accuracy: 629/636 (98.8994%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.6745, Accuracy: 5833/10000 (58.3300%)
___Train Local_Simple,  epoch  47, local model 58, internal_epoch   1,  Average loss: 0.0006, Accuracy: 766/772 (99.2228%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 2.5449, Accuracy: 5444/10000 (54.4400%)
___Train Local_Simple,  epoch  47, local model 17, internal_epoch   1,  Average loss: 0.0006, Accuracy: 522/527 (99.0512%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.5081, Accuracy: 6546/10000 (65.4600%)
___Train Local_Simple,  epoch  47, local model 37, internal_epoch   1,  Average loss: 0.0008, Accuracy: 449/456 (98.4649%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.7055, Accuracy: 7803/10000 (78.0300%)
___Train Local_Simple,  epoch  47, local model 54, internal_epoch   1,  Average loss: 0.0004, Accuracy: 827/832 (99.3990%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 2.9032, Accuracy: 5558/10000 (55.5800%)
___Train Local_Simple,  epoch  47, local model 77, internal_epoch   1,  Average loss: 0.0012, Accuracy: 603/618 (97.5728%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.3448, Accuracy: 6784/10000 (67.8400%)
___Train Local_Simple,  epoch  47, local model 26, internal_epoch   1,  Average loss: 0.0007, Accuracy: 511/519 (98.4586%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.9624, Accuracy: 5746/10000 (57.4600%)
___Train Local_Simple,  epoch  47, local model 76, internal_epoch   1,  Average loss: 0.0011, Accuracy: 452/459 (98.4749%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.0635, Accuracy: 8074/10000 (80.7400%)
___Train Local_Simple,  epoch  47, local model 6, internal_epoch   1,  Average loss: 0.0008, Accuracy: 429/435 (98.6207%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.5709, Accuracy: 7321/10000 (73.2100%)
___Train Local_Simple,  epoch  47, local model 27, internal_epoch   1,  Average loss: 0.0005, Accuracy: 739/745 (99.1946%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 2.6498, Accuracy: 5020/10000 (50.2000%)
___Train Local_Simple,  epoch  47, local model 64, internal_epoch   1,  Average loss: 0.0004, Accuracy: 607/608 (99.8355%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.5176, Accuracy: 6705/10000 (67.0500%)
___Train Local_Simple,  epoch  47, local model 93, internal_epoch   1,  Average loss: 0.0012, Accuracy: 617/630 (97.9365%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.8997, Accuracy: 5737/10000 (57.3700%)
___Train Local_Simple,  epoch  47, local model 48, internal_epoch   1,  Average loss: 0.0012, Accuracy: 358/363 (98.6226%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.5728, Accuracy: 8181/10000 (81.8100%)
___Train Local_Simple,  epoch  47, local model 47, internal_epoch   1,  Average loss: 0.0006, Accuracy: 527/534 (98.6891%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.6630, Accuracy: 5995/10000 (59.9500%)
___Train Local_Simple,  epoch  47, local model 7, internal_epoch   1,  Average loss: 0.0004, Accuracy: 796/802 (99.2519%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 2.3913, Accuracy: 5212/10000 (52.1200%)
___Train Local_Simple,  epoch  47, local model 52, internal_epoch   1,  Average loss: 0.0012, Accuracy: 770/789 (97.5919%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 5.8098, Accuracy: 3701/10000 (37.0100%)
___Train Local_Simple,  epoch  47, local model 90, internal_epoch   1,  Average loss: 0.0012, Accuracy: 598/615 (97.2358%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 2.1214, Accuracy: 6353/10000 (63.5300%)
time spent on training: 363.98151302337646
___Test Target_Simple poisoned: False, epoch: 47: Average loss: 0.1152, Accuracy: 9671/10000 (96.7100%)
___Test Target_Simple poisoned: True, epoch: 47: Average loss: 3.1569, Accuracy: 1228/8968 (13.6931%)
saving model
Done in 397.04264998435974 sec.
Server Epoch:48 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 42, 4, 82, 87, 16, 19, 11, 85, 83, 63, 15, 12, 59, 75, 5, 60, 56, 13, 2, 47, 68, 95, 91, 57, 66, 79, 76, 49, 71, 46, 98, 90, 92, 0, 86, 84, 20, 38, 65, 25, 17, 96, 36, 26, 70, 8, 22, 14, 89, 97, 37, 64, 80, 94, 43, 10, 58, 35, 34, 32, 69, 1, 39, 50, 6, 9, 45, 44, 52, 93, 77, 55, 28, 24, 31, 30, 23, 21, 53, 61, 7, 78, 99, 81, 72, 67, 48, 40, 54, 27].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   1,  Average loss: 0.0190, Accuracy: 309/569 (54.3058%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   2,  Average loss: 0.0069, Accuracy: 465/569 (81.7223%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   3,  Average loss: 0.0021, Accuracy: 553/569 (97.1880%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   4,  Average loss: 0.0014, Accuracy: 561/569 (98.5940%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   5,  Average loss: 0.0011, Accuracy: 563/569 (98.9455%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   6,  Average loss: 0.0009, Accuracy: 563/569 (98.9455%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   7,  Average loss: 0.0010, Accuracy: 564/569 (99.1213%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   8,  Average loss: 0.0008, Accuracy: 564/569 (99.1213%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch   9,  Average loss: 0.0005, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 41, internal_epoch  10,  Average loss: 0.0005, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Global model norm: 15.465360759544264.
Norm before scaling: 15.76449838021139. Distance: 3.7626901166668643
Total norm for 10 adversaries is: 15.76449838021139. distance: 3.7626901166668643
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.5499, Accuracy: 6854/8968 (76.4273%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   1,  Average loss: 0.0094, Accuracy: 415/522 (79.5019%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   2,  Average loss: 0.0027, Accuracy: 501/522 (95.9770%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   3,  Average loss: 0.0010, Accuracy: 513/522 (98.2759%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   4,  Average loss: 0.0006, Accuracy: 517/522 (99.0421%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   5,  Average loss: 0.0006, Accuracy: 517/522 (99.0421%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   6,  Average loss: 0.0006, Accuracy: 518/522 (99.2337%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   7,  Average loss: 0.0003, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   8,  Average loss: 0.0002, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch   9,  Average loss: 0.0004, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 73, internal_epoch  10,  Average loss: 0.0004, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Global model norm: 15.465360759544264.
Norm before scaling: 15.649880581238671. Distance: 2.7758045679772327
Total norm for 10 adversaries is: 15.649880581238671. distance: 2.7758045679772327
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0169, Accuracy: 8914/8968 (99.3979%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   1,  Average loss: 0.0165, Accuracy: 239/385 (62.0779%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   2,  Average loss: 0.0051, Accuracy: 358/385 (92.9870%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   3,  Average loss: 0.0016, Accuracy: 373/385 (96.8831%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   4,  Average loss: 0.0015, Accuracy: 375/385 (97.4026%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   5,  Average loss: 0.0015, Accuracy: 378/385 (98.1818%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   6,  Average loss: 0.0012, Accuracy: 379/385 (98.4416%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   7,  Average loss: 0.0010, Accuracy: 379/385 (98.4416%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   8,  Average loss: 0.0010, Accuracy: 378/385 (98.1818%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch   9,  Average loss: 0.0008, Accuracy: 381/385 (98.9610%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 51, internal_epoch  10,  Average loss: 0.0007, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Global model norm: 15.465360759544264.
Norm before scaling: 15.742867444217744. Distance: 2.891967461705015
Total norm for 10 adversaries is: 15.742867444217744. distance: 2.891967461705015
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.1940, Accuracy: 8301/8968 (92.5624%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   1,  Average loss: 0.0057, Accuracy: 544/627 (86.7624%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   2,  Average loss: 0.0015, Accuracy: 611/627 (97.4482%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   3,  Average loss: 0.0016, Accuracy: 614/627 (97.9266%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   4,  Average loss: 0.0011, Accuracy: 613/627 (97.7671%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   5,  Average loss: 0.0008, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   6,  Average loss: 0.0007, Accuracy: 621/627 (99.0431%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   7,  Average loss: 0.0007, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   8,  Average loss: 0.0004, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   9,  Average loss: 0.0005, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch  10,  Average loss: 0.0006, Accuracy: 621/627 (99.0431%), train_poison_data_count: 320
Global model norm: 15.465360759544264.
Norm before scaling: 15.664925065870438. Distance: 2.4633492414126863
Total norm for 10 adversaries is: 15.664925065870438. distance: 2.4633492414126863
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0053, Accuracy: 8951/8968 (99.8104%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 3, internal_epoch   1,  Average loss: 0.0217, Accuracy: 295/516 (57.1705%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 3, internal_epoch   2,  Average loss: 0.0077, Accuracy: 437/516 (84.6899%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 3, internal_epoch   3,  Average loss: 0.0018, Accuracy: 507/516 (98.2558%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 3, internal_epoch   4,  Average loss: 0.0014, Accuracy: 512/516 (99.2248%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 3, internal_epoch   5,  Average loss: 0.0010, Accuracy: 511/516 (99.0310%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 3, internal_epoch   6,  Average loss: 0.0008, Accuracy: 513/516 (99.4186%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 3, internal_epoch   7,  Average loss: 0.0005, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 3, internal_epoch   8,  Average loss: 0.0006, Accuracy: 512/516 (99.2248%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 3, internal_epoch   9,  Average loss: 0.0005, Accuracy: 513/516 (99.4186%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 3, internal_epoch  10,  Average loss: 0.0004, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Global model norm: 15.465360759544264.
Norm before scaling: 15.8644422131192. Distance: 4.13173980348605
Total norm for 10 adversaries is: 15.8644422131192. distance: 4.13173980348605
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.7544, Accuracy: 6704/8968 (74.7547%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 18, internal_epoch   1,  Average loss: 0.0111, Accuracy: 596/759 (78.5244%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 18, internal_epoch   2,  Average loss: 0.0011, Accuracy: 744/759 (98.0237%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 18, internal_epoch   3,  Average loss: 0.0002, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 18, internal_epoch   4,  Average loss: 0.0003, Accuracy: 752/759 (99.0777%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 18, internal_epoch   5,  Average loss: 0.0003, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 18, internal_epoch   6,  Average loss: 0.0003, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 18, internal_epoch   7,  Average loss: 0.0001, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 18, internal_epoch   8,  Average loss: 0.0001, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 18, internal_epoch   9,  Average loss: 0.0002, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 18, internal_epoch  10,  Average loss: 0.0001, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Global model norm: 15.465360759544264.
Norm before scaling: 15.991583517844727. Distance: 3.870487662252955
Total norm for 10 adversaries is: 15.991583517844727. distance: 3.870487662252955
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0079, Accuracy: 8941/8968 (99.6989%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 29, internal_epoch   1,  Average loss: 0.0141, Accuracy: 377/506 (74.5059%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 29, internal_epoch   2,  Average loss: 0.0025, Accuracy: 491/506 (97.0356%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 29, internal_epoch   3,  Average loss: 0.0006, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 29, internal_epoch   4,  Average loss: 0.0006, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 29, internal_epoch   5,  Average loss: 0.0005, Accuracy: 498/506 (98.4190%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 29, internal_epoch   6,  Average loss: 0.0008, Accuracy: 498/506 (98.4190%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 29, internal_epoch   7,  Average loss: 0.0006, Accuracy: 500/506 (98.8142%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 29, internal_epoch   8,  Average loss: 0.0003, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 29, internal_epoch   9,  Average loss: 0.0003, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 29, internal_epoch  10,  Average loss: 0.0004, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Global model norm: 15.465360759544264.
Norm before scaling: 15.794231974739228. Distance: 3.5285572148792994
Total norm for 10 adversaries is: 15.794231974739228. distance: 3.5285572148792994
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.9191, Accuracy: 5964/8968 (66.5031%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 62, internal_epoch   1,  Average loss: 0.0061, Accuracy: 520/580 (89.6552%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 62, internal_epoch   2,  Average loss: 0.0042, Accuracy: 522/580 (90.0000%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 62, internal_epoch   3,  Average loss: 0.0016, Accuracy: 563/580 (97.0690%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 62, internal_epoch   4,  Average loss: 0.0012, Accuracy: 566/580 (97.5862%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 62, internal_epoch   5,  Average loss: 0.0011, Accuracy: 566/580 (97.5862%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 62, internal_epoch   6,  Average loss: 0.0009, Accuracy: 570/580 (98.2759%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 62, internal_epoch   7,  Average loss: 0.0009, Accuracy: 566/580 (97.5862%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 62, internal_epoch   8,  Average loss: 0.0008, Accuracy: 570/580 (98.2759%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 62, internal_epoch   9,  Average loss: 0.0008, Accuracy: 568/580 (97.9310%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 62, internal_epoch  10,  Average loss: 0.0006, Accuracy: 574/580 (98.9655%), train_poison_data_count: 292
Global model norm: 15.465360759544264.
Norm before scaling: 15.88273708402533. Distance: 3.5618823670503357
Total norm for 10 adversaries is: 15.88273708402533. distance: 3.5618823670503357
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0274, Accuracy: 8884/8968 (99.0633%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 33, internal_epoch   1,  Average loss: 0.0174, Accuracy: 370/587 (63.0324%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 562/587 (95.7411%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 33, internal_epoch   3,  Average loss: 0.0008, Accuracy: 579/587 (98.6371%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 33, internal_epoch   4,  Average loss: 0.0005, Accuracy: 581/587 (98.9779%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 33, internal_epoch   5,  Average loss: 0.0005, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 33, internal_epoch   6,  Average loss: 0.0006, Accuracy: 582/587 (99.1482%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 33, internal_epoch   7,  Average loss: 0.0005, Accuracy: 583/587 (99.3186%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 33, internal_epoch   8,  Average loss: 0.0004, Accuracy: 586/587 (99.8296%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 33, internal_epoch   9,  Average loss: 0.0003, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 33, internal_epoch  10,  Average loss: 0.0004, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Global model norm: 15.465360759544264.
Norm before scaling: 15.842852866149977. Distance: 3.755855566251969
Total norm for 10 adversaries is: 15.842852866149977. distance: 3.755855566251969
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.8799, Accuracy: 6362/8968 (70.9411%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 88, internal_epoch   1,  Average loss: 0.0076, Accuracy: 610/734 (83.1063%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 88, internal_epoch   2,  Average loss: 0.0015, Accuracy: 713/734 (97.1390%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 88, internal_epoch   3,  Average loss: 0.0003, Accuracy: 732/734 (99.7275%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 88, internal_epoch   4,  Average loss: 0.0006, Accuracy: 723/734 (98.5014%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 88, internal_epoch   5,  Average loss: 0.0005, Accuracy: 725/734 (98.7738%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 88, internal_epoch   6,  Average loss: 0.0003, Accuracy: 728/734 (99.1826%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 88, internal_epoch   7,  Average loss: 0.0004, Accuracy: 729/734 (99.3188%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 88, internal_epoch   8,  Average loss: 0.0004, Accuracy: 728/734 (99.1826%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 88, internal_epoch   9,  Average loss: 0.0004, Accuracy: 729/734 (99.3188%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 88, internal_epoch  10,  Average loss: 0.0004, Accuracy: 728/734 (99.1826%), train_poison_data_count: 382
Global model norm: 15.465360759544264.
Norm before scaling: 15.799840148889759. Distance: 2.9818288117259457
Total norm for 10 adversaries is: 15.799840148889759. distance: 2.9818288117259457
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0385, Accuracy: 8852/8968 (98.7065%)
___Train Local_Simple,  epoch  48, local model 42, internal_epoch   1,  Average loss: 0.0002, Accuracy: 473/473 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.3188, Accuracy: 8832/10000 (88.3200%)
___Train Local_Simple,  epoch  48, local model 4, internal_epoch   1,  Average loss: 0.0004, Accuracy: 741/748 (99.0642%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.5077, Accuracy: 4703/10000 (47.0300%)
___Train Local_Simple,  epoch  48, local model 82, internal_epoch   1,  Average loss: 0.0006, Accuracy: 804/815 (98.6503%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 3.6248, Accuracy: 3742/10000 (37.4200%)
___Train Local_Simple,  epoch  48, local model 87, internal_epoch   1,  Average loss: 0.0011, Accuracy: 653/663 (98.4917%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.7119, Accuracy: 4648/10000 (46.4800%)
___Train Local_Simple,  epoch  48, local model 16, internal_epoch   1,  Average loss: 0.0003, Accuracy: 814/817 (99.6328%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.7483, Accuracy: 6459/10000 (64.5900%)
___Train Local_Simple,  epoch  48, local model 19, internal_epoch   1,  Average loss: 0.0006, Accuracy: 591/598 (98.8294%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.3393, Accuracy: 4895/10000 (48.9500%)
___Train Local_Simple,  epoch  48, local model 11, internal_epoch   1,  Average loss: 0.0005, Accuracy: 550/554 (99.2780%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.7731, Accuracy: 7912/10000 (79.1200%)
___Train Local_Simple,  epoch  48, local model 85, internal_epoch   1,  Average loss: 0.0022, Accuracy: 769/807 (95.2912%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.9423, Accuracy: 5605/10000 (56.0500%)
___Train Local_Simple,  epoch  48, local model 83, internal_epoch   1,  Average loss: 0.0011, Accuracy: 354/360 (98.3333%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2261, Accuracy: 9299/10000 (92.9900%)
___Train Local_Simple,  epoch  48, local model 63, internal_epoch   1,  Average loss: 0.0021, Accuracy: 292/303 (96.3696%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.8588, Accuracy: 5762/10000 (57.6200%)
___Train Local_Simple,  epoch  48, local model 15, internal_epoch   1,  Average loss: 0.0007, Accuracy: 281/282 (99.6454%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.3459, Accuracy: 8792/10000 (87.9200%)
___Train Local_Simple,  epoch  48, local model 12, internal_epoch   1,  Average loss: 0.0005, Accuracy: 718/725 (99.0345%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.5596, Accuracy: 5867/10000 (58.6700%)
___Train Local_Simple,  epoch  48, local model 59, internal_epoch   1,  Average loss: 0.0008, Accuracy: 635/644 (98.6025%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.7105, Accuracy: 5884/10000 (58.8400%)
___Train Local_Simple,  epoch  48, local model 75, internal_epoch   1,  Average loss: 0.0013, Accuracy: 746/763 (97.7720%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 4.1052, Accuracy: 3622/10000 (36.2200%)
___Train Local_Simple,  epoch  48, local model 5, internal_epoch   1,  Average loss: 0.0006, Accuracy: 571/578 (98.7889%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.7708, Accuracy: 7997/10000 (79.9700%)
___Train Local_Simple,  epoch  48, local model 60, internal_epoch   1,  Average loss: 0.0013, Accuracy: 554/571 (97.0228%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.6714, Accuracy: 4674/10000 (46.7400%)
___Train Local_Simple,  epoch  48, local model 56, internal_epoch   1,  Average loss: 0.0004, Accuracy: 709/715 (99.1608%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.9320, Accuracy: 5232/10000 (52.3200%)
___Train Local_Simple,  epoch  48, local model 13, internal_epoch   1,  Average loss: 0.0007, Accuracy: 701/713 (98.3170%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 3.5986, Accuracy: 4057/10000 (40.5700%)
___Train Local_Simple,  epoch  48, local model 2, internal_epoch   1,  Average loss: 0.0008, Accuracy: 556/564 (98.5816%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.5145, Accuracy: 4873/10000 (48.7300%)
___Train Local_Simple,  epoch  48, local model 47, internal_epoch   1,  Average loss: 0.0015, Accuracy: 523/534 (97.9401%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 3.3443, Accuracy: 4950/10000 (49.5000%)
___Train Local_Simple,  epoch  48, local model 68, internal_epoch   1,  Average loss: 0.0013, Accuracy: 535/549 (97.4499%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.6798, Accuracy: 4826/10000 (48.2600%)
___Train Local_Simple,  epoch  48, local model 95, internal_epoch   1,  Average loss: 0.0017, Accuracy: 579/600 (96.5000%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 3.2131, Accuracy: 4723/10000 (47.2300%)
___Train Local_Simple,  epoch  48, local model 91, internal_epoch   1,  Average loss: 0.0004, Accuracy: 813/819 (99.2674%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.3667, Accuracy: 5067/10000 (50.6700%)
___Train Local_Simple,  epoch  48, local model 57, internal_epoch   1,  Average loss: 0.0006, Accuracy: 520/523 (99.4264%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.2877, Accuracy: 6356/10000 (63.5600%)
___Train Local_Simple,  epoch  48, local model 66, internal_epoch   1,  Average loss: 0.0020, Accuracy: 707/733 (96.4529%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 3.5721, Accuracy: 4275/10000 (42.7500%)
___Train Local_Simple,  epoch  48, local model 79, internal_epoch   1,  Average loss: 0.0011, Accuracy: 651/661 (98.4871%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.2689, Accuracy: 6558/10000 (65.5800%)
___Train Local_Simple,  epoch  48, local model 76, internal_epoch   1,  Average loss: 0.0009, Accuracy: 455/459 (99.1285%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.4783, Accuracy: 8570/10000 (85.7000%)
___Train Local_Simple,  epoch  48, local model 49, internal_epoch   1,  Average loss: 0.0016, Accuracy: 343/355 (96.6197%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.6646, Accuracy: 4621/10000 (46.2100%)
___Train Local_Simple,  epoch  48, local model 71, internal_epoch   1,  Average loss: 0.0009, Accuracy: 553/561 (98.5740%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.8105, Accuracy: 7692/10000 (76.9200%)
___Train Local_Simple,  epoch  48, local model 46, internal_epoch   1,  Average loss: 0.0008, Accuracy: 641/650 (98.6154%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.7727, Accuracy: 6353/10000 (63.5300%)
___Train Local_Simple,  epoch  48, local model 98, internal_epoch   1,  Average loss: 0.0017, Accuracy: 530/548 (96.7153%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.6731, Accuracy: 5428/10000 (54.2800%)
___Train Local_Simple,  epoch  48, local model 90, internal_epoch   1,  Average loss: 0.0019, Accuracy: 590/615 (95.9350%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.5381, Accuracy: 5635/10000 (56.3500%)
___Train Local_Simple,  epoch  48, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 575/611 (94.1080%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.7821, Accuracy: 4135/10000 (41.3500%)
___Train Local_Simple,  epoch  48, local model 0, internal_epoch   1,  Average loss: 0.0006, Accuracy: 430/435 (98.8506%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.1876, Accuracy: 7249/10000 (72.4900%)
___Train Local_Simple,  epoch  48, local model 86, internal_epoch   1,  Average loss: 0.0005, Accuracy: 685/692 (98.9884%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 3.9300, Accuracy: 4131/10000 (41.3100%)
___Train Local_Simple,  epoch  48, local model 84, internal_epoch   1,  Average loss: 0.0007, Accuracy: 414/420 (98.5714%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.5014, Accuracy: 8473/10000 (84.7300%)
___Train Local_Simple,  epoch  48, local model 20, internal_epoch   1,  Average loss: 0.0010, Accuracy: 590/602 (98.0066%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.2594, Accuracy: 5768/10000 (57.6800%)
___Train Local_Simple,  epoch  48, local model 38, internal_epoch   1,  Average loss: 0.0005, Accuracy: 473/477 (99.1614%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.3283, Accuracy: 8948/10000 (89.4800%)
___Train Local_Simple,  epoch  48, local model 65, internal_epoch   1,  Average loss: 0.0016, Accuracy: 607/621 (97.7456%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.4843, Accuracy: 5704/10000 (57.0400%)
___Train Local_Simple,  epoch  48, local model 25, internal_epoch   1,  Average loss: 0.0003, Accuracy: 590/592 (99.6622%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.0872, Accuracy: 7734/10000 (77.3400%)
___Train Local_Simple,  epoch  48, local model 17, internal_epoch   1,  Average loss: 0.0005, Accuracy: 522/527 (99.0512%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.3733, Accuracy: 6356/10000 (63.5600%)
___Train Local_Simple,  epoch  48, local model 96, internal_epoch   1,  Average loss: 0.0013, Accuracy: 514/531 (96.7985%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 5.0392, Accuracy: 3540/10000 (35.4000%)
___Train Local_Simple,  epoch  48, local model 36, internal_epoch   1,  Average loss: 0.0006, Accuracy: 311/315 (98.7302%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1861, Accuracy: 9367/10000 (93.6700%)
___Train Local_Simple,  epoch  48, local model 26, internal_epoch   1,  Average loss: 0.0014, Accuracy: 505/519 (97.3025%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 3.0584, Accuracy: 4966/10000 (49.6600%)
___Train Local_Simple,  epoch  48, local model 70, internal_epoch   1,  Average loss: 0.0016, Accuracy: 554/568 (97.5352%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 3.4884, Accuracy: 3690/10000 (36.9000%)
___Train Local_Simple,  epoch  48, local model 8, internal_epoch   1,  Average loss: 0.0008, Accuracy: 697/706 (98.7252%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.9207, Accuracy: 4237/10000 (42.3700%)
___Train Local_Simple,  epoch  48, local model 22, internal_epoch   1,  Average loss: 0.0004, Accuracy: 260/262 (99.2366%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.4275, Accuracy: 8706/10000 (87.0600%)
___Train Local_Simple,  epoch  48, local model 14, internal_epoch   1,  Average loss: 0.0008, Accuracy: 682/692 (98.5549%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.5948, Accuracy: 5782/10000 (57.8200%)
___Train Local_Simple,  epoch  48, local model 89, internal_epoch   1,  Average loss: 0.0023, Accuracy: 656/683 (96.0469%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 3.6326, Accuracy: 5236/10000 (52.3600%)
___Train Local_Simple,  epoch  48, local model 97, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1103/1112 (99.1906%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 3.0406, Accuracy: 4589/10000 (45.8900%)
___Train Local_Simple,  epoch  48, local model 37, internal_epoch   1,  Average loss: 0.0008, Accuracy: 450/456 (98.6842%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.4163, Accuracy: 6970/10000 (69.7000%)
___Train Local_Simple,  epoch  48, local model 64, internal_epoch   1,  Average loss: 0.0007, Accuracy: 600/608 (98.6842%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.8059, Accuracy: 5031/10000 (50.3100%)
___Train Local_Simple,  epoch  48, local model 80, internal_epoch   1,  Average loss: 0.0015, Accuracy: 515/532 (96.8045%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 4.3720, Accuracy: 2967/10000 (29.6700%)
___Train Local_Simple,  epoch  48, local model 94, internal_epoch   1,  Average loss: 0.0010, Accuracy: 657/671 (97.9136%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 3.8463, Accuracy: 5235/10000 (52.3500%)
___Train Local_Simple,  epoch  48, local model 43, internal_epoch   1,  Average loss: 0.0007, Accuracy: 426/431 (98.8399%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.8871, Accuracy: 7402/10000 (74.0200%)
___Train Local_Simple,  epoch  48, local model 10, internal_epoch   1,  Average loss: 0.0013, Accuracy: 560/573 (97.7312%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.8999, Accuracy: 5435/10000 (54.3500%)
___Train Local_Simple,  epoch  48, local model 58, internal_epoch   1,  Average loss: 0.0008, Accuracy: 757/772 (98.0570%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.0525, Accuracy: 5758/10000 (57.5800%)
___Train Local_Simple,  epoch  48, local model 35, internal_epoch   1,  Average loss: 0.0013, Accuracy: 615/630 (97.6190%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.0932, Accuracy: 5857/10000 (58.5700%)
___Train Local_Simple,  epoch  48, local model 34, internal_epoch   1,  Average loss: 0.0019, Accuracy: 838/871 (96.2113%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.7691, Accuracy: 4864/10000 (48.6400%)
___Train Local_Simple,  epoch  48, local model 32, internal_epoch   1,  Average loss: 0.0018, Accuracy: 571/590 (96.7797%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.9719, Accuracy: 5436/10000 (54.3600%)
___Train Local_Simple,  epoch  48, local model 69, internal_epoch   1,  Average loss: 0.0011, Accuracy: 663/671 (98.8077%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 5.3471, Accuracy: 3081/10000 (30.8100%)
___Train Local_Simple,  epoch  48, local model 1, internal_epoch   1,  Average loss: 0.0004, Accuracy: 535/536 (99.8134%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2701, Accuracy: 9073/10000 (90.7300%)
___Train Local_Simple,  epoch  48, local model 39, internal_epoch   1,  Average loss: 0.0005, Accuracy: 490/493 (99.3915%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.6413, Accuracy: 8090/10000 (80.9000%)
___Train Local_Simple,  epoch  48, local model 50, internal_epoch   1,  Average loss: 0.0006, Accuracy: 468/477 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.3276, Accuracy: 6653/10000 (66.5300%)
___Train Local_Simple,  epoch  48, local model 6, internal_epoch   1,  Average loss: 0.0008, Accuracy: 428/435 (98.3908%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.8088, Accuracy: 7740/10000 (77.4000%)
___Train Local_Simple,  epoch  48, local model 9, internal_epoch   1,  Average loss: 0.0011, Accuracy: 496/508 (97.6378%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.3251, Accuracy: 6891/10000 (68.9100%)
___Train Local_Simple,  epoch  48, local model 45, internal_epoch   1,  Average loss: 0.0007, Accuracy: 639/647 (98.7635%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.3286, Accuracy: 5258/10000 (52.5800%)
___Train Local_Simple,  epoch  48, local model 44, internal_epoch   1,  Average loss: 0.0003, Accuracy: 557/561 (99.2870%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.3253, Accuracy: 7213/10000 (72.1300%)
___Train Local_Simple,  epoch  48, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 779/789 (98.7326%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 4.5811, Accuracy: 4550/10000 (45.5000%)
___Train Local_Simple,  epoch  48, local model 93, internal_epoch   1,  Average loss: 0.0018, Accuracy: 606/630 (96.1905%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.9181, Accuracy: 5835/10000 (58.3500%)
___Train Local_Simple,  epoch  48, local model 77, internal_epoch   1,  Average loss: 0.0014, Accuracy: 600/618 (97.0874%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 4.3859, Accuracy: 4161/10000 (41.6100%)
___Train Local_Simple,  epoch  48, local model 55, internal_epoch   1,  Average loss: 0.0013, Accuracy: 364/375 (97.0667%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.5263, Accuracy: 8191/10000 (81.9100%)
___Train Local_Simple,  epoch  48, local model 28, internal_epoch   1,  Average loss: 0.0008, Accuracy: 601/611 (98.3633%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.3252, Accuracy: 6378/10000 (63.7800%)
___Train Local_Simple,  epoch  48, local model 24, internal_epoch   1,  Average loss: 0.0012, Accuracy: 468/477 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.0137, Accuracy: 6700/10000 (67.0000%)
___Train Local_Simple,  epoch  48, local model 31, internal_epoch   1,  Average loss: 0.0005, Accuracy: 587/596 (98.4899%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.1061, Accuracy: 6787/10000 (67.8700%)
___Train Local_Simple,  epoch  48, local model 30, internal_epoch   1,  Average loss: 0.0008, Accuracy: 437/443 (98.6456%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.5514, Accuracy: 6667/10000 (66.6700%)
___Train Local_Simple,  epoch  48, local model 23, internal_epoch   1,  Average loss: 0.0010, Accuracy: 534/542 (98.5240%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.8489, Accuracy: 5870/10000 (58.7000%)
___Train Local_Simple,  epoch  48, local model 21, internal_epoch   1,  Average loss: 0.0004, Accuracy: 684/687 (99.5633%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.3190, Accuracy: 6514/10000 (65.1400%)
___Train Local_Simple,  epoch  48, local model 53, internal_epoch   1,  Average loss: 0.0006, Accuracy: 555/561 (98.9305%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.1927, Accuracy: 7407/10000 (74.0700%)
___Train Local_Simple,  epoch  48, local model 61, internal_epoch   1,  Average loss: 0.0010, Accuracy: 283/287 (98.6063%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2469, Accuracy: 9250/10000 (92.5000%)
___Train Local_Simple,  epoch  48, local model 7, internal_epoch   1,  Average loss: 0.0005, Accuracy: 795/802 (99.1272%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.1919, Accuracy: 7023/10000 (70.2300%)
___Train Local_Simple,  epoch  48, local model 78, internal_epoch   1,  Average loss: 0.0022, Accuracy: 564/587 (96.0818%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 5.1964, Accuracy: 3073/10000 (30.7300%)
___Train Local_Simple,  epoch  48, local model 99, internal_epoch   1,  Average loss: 0.0022, Accuracy: 681/712 (95.6461%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 3.0306, Accuracy: 4261/10000 (42.6100%)
___Train Local_Simple,  epoch  48, local model 81, internal_epoch   1,  Average loss: 0.0013, Accuracy: 625/636 (98.2704%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.3731, Accuracy: 4098/10000 (40.9800%)
___Train Local_Simple,  epoch  48, local model 72, internal_epoch   1,  Average loss: 0.0015, Accuracy: 407/423 (96.2175%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.7790, Accuracy: 3591/10000 (35.9100%)
___Train Local_Simple,  epoch  48, local model 67, internal_epoch   1,  Average loss: 0.0016, Accuracy: 433/441 (98.1859%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.0953, Accuracy: 6488/10000 (64.8800%)
___Train Local_Simple,  epoch  48, local model 48, internal_epoch   1,  Average loss: 0.0010, Accuracy: 356/363 (98.0716%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.4102, Accuracy: 8695/10000 (86.9500%)
___Train Local_Simple,  epoch  48, local model 40, internal_epoch   1,  Average loss: 0.0003, Accuracy: 495/498 (99.3976%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.4633, Accuracy: 6993/10000 (69.9300%)
___Train Local_Simple,  epoch  48, local model 54, internal_epoch   1,  Average loss: 0.0006, Accuracy: 823/832 (98.9183%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.0940, Accuracy: 6223/10000 (62.2300%)
___Train Local_Simple,  epoch  48, local model 27, internal_epoch   1,  Average loss: 0.0011, Accuracy: 728/745 (97.7181%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 4.8324, Accuracy: 3131/10000 (31.3100%)
time spent on training: 366.0813658237457
___Test Target_Simple poisoned: False, epoch: 48: Average loss: 0.1018, Accuracy: 9727/10000 (97.2700%)
___Test Target_Simple poisoned: True, epoch: 48: Average loss: 2.8050, Accuracy: 2450/8968 (27.3194%)
saving model
Done in 397.29102778434753 sec.
Server Epoch:49 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 24, 28, 81, 19, 85, 12, 45, 22, 20, 1, 21, 69, 15, 79, 4, 67, 59, 2, 31, 44, 63, 27, 97, 5, 40, 56, 82, 10, 91, 11, 95, 25, 89, 84, 13, 14, 94, 54, 75, 34, 98, 61, 26, 47, 17, 42, 48, 70, 52, 9, 32, 83, 16, 93, 58, 76, 72, 60, 38, 90, 57, 86, 96, 23, 78, 7, 68, 55, 37, 65, 64, 87, 30, 35, 39, 71, 50, 77, 80, 8, 0, 66, 92, 43, 49, 36, 6, 46, 99, 53].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   1,  Average loss: 0.0163, Accuracy: 360/569 (63.2689%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 546/569 (95.9578%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   3,  Average loss: 0.0012, Accuracy: 560/569 (98.4183%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   4,  Average loss: 0.0007, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   5,  Average loss: 0.0006, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   6,  Average loss: 0.0004, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   7,  Average loss: 0.0004, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   8,  Average loss: 0.0003, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch   9,  Average loss: 0.0003, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 41, internal_epoch  10,  Average loss: 0.0003, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Global model norm: 15.470185677536676.
Norm before scaling: 15.758795810141782. Distance: 3.464872375163604
Total norm for 10 adversaries is: 15.758795810141782. distance: 3.464872375163604
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.6948, Accuracy: 6579/8968 (73.3608%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   1,  Average loss: 0.0076, Accuracy: 434/522 (83.1418%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   2,  Average loss: 0.0016, Accuracy: 514/522 (98.4674%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   3,  Average loss: 0.0011, Accuracy: 508/522 (97.3180%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   4,  Average loss: 0.0007, Accuracy: 513/522 (98.2759%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   5,  Average loss: 0.0005, Accuracy: 516/522 (98.8506%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   6,  Average loss: 0.0006, Accuracy: 517/522 (99.0421%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   7,  Average loss: 0.0003, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   8,  Average loss: 0.0002, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   9,  Average loss: 0.0003, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch  10,  Average loss: 0.0003, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Global model norm: 15.470185677536676.
Norm before scaling: 15.653781597297774. Distance: 2.401380789440178
Total norm for 10 adversaries is: 15.653781597297774. distance: 2.401380789440178
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0514, Accuracy: 8817/8968 (98.3162%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   1,  Average loss: 0.0143, Accuracy: 266/385 (69.0909%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   2,  Average loss: 0.0034, Accuracy: 371/385 (96.3636%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   3,  Average loss: 0.0015, Accuracy: 376/385 (97.6623%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   4,  Average loss: 0.0009, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   5,  Average loss: 0.0007, Accuracy: 383/385 (99.4805%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   6,  Average loss: 0.0010, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   7,  Average loss: 0.0006, Accuracy: 381/385 (98.9610%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   8,  Average loss: 0.0008, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch   9,  Average loss: 0.0027, Accuracy: 379/385 (98.4416%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 51, internal_epoch  10,  Average loss: 0.0007, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Global model norm: 15.470185677536676.
Norm before scaling: 15.74505343794272. Distance: 3.026819826135625
Total norm for 10 adversaries is: 15.74505343794272. distance: 3.026819826135625
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.1772, Accuracy: 8438/8968 (94.0901%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   1,  Average loss: 0.0037, Accuracy: 574/627 (91.5470%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   2,  Average loss: 0.0009, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   3,  Average loss: 0.0008, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   4,  Average loss: 0.0010, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   5,  Average loss: 0.0004, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   6,  Average loss: 0.0006, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   7,  Average loss: 0.0004, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   8,  Average loss: 0.0005, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   9,  Average loss: 0.0005, Accuracy: 621/627 (99.0431%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch  10,  Average loss: 0.0003, Accuracy: 624/627 (99.5215%), train_poison_data_count: 320
Global model norm: 15.470185677536676.
Norm before scaling: 15.56972988357412. Distance: 1.8669255922893058
Total norm for 10 adversaries is: 15.56972988357412. distance: 1.8669255922893058
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0048, Accuracy: 8953/8968 (99.8327%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 3, internal_epoch   1,  Average loss: 0.0172, Accuracy: 336/516 (65.1163%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 3, internal_epoch   2,  Average loss: 0.0057, Accuracy: 440/516 (85.2713%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 3, internal_epoch   3,  Average loss: 0.0006, Accuracy: 513/516 (99.4186%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 3, internal_epoch   4,  Average loss: 0.0005, Accuracy: 512/516 (99.2248%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 3, internal_epoch   5,  Average loss: 0.0003, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 3, internal_epoch   6,  Average loss: 0.0004, Accuracy: 511/516 (99.0310%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 3, internal_epoch   7,  Average loss: 0.0004, Accuracy: 512/516 (99.2248%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 3, internal_epoch   8,  Average loss: 0.0003, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 3, internal_epoch   9,  Average loss: 0.0002, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 3, internal_epoch  10,  Average loss: 0.0002, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Global model norm: 15.470185677536676.
Norm before scaling: 15.858139576265323. Distance: 3.8128963326988963
Total norm for 10 adversaries is: 15.858139576265323. distance: 3.8128963326988963
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 1.0255, Accuracy: 6417/8968 (71.5544%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 18, internal_epoch   1,  Average loss: 0.0104, Accuracy: 582/759 (76.6798%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 18, internal_epoch   2,  Average loss: 0.0016, Accuracy: 743/759 (97.8920%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 18, internal_epoch   3,  Average loss: 0.0004, Accuracy: 753/759 (99.2095%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 18, internal_epoch   4,  Average loss: 0.0004, Accuracy: 754/759 (99.3412%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 18, internal_epoch   5,  Average loss: 0.0003, Accuracy: 754/759 (99.3412%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 18, internal_epoch   6,  Average loss: 0.0003, Accuracy: 754/759 (99.3412%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 18, internal_epoch   7,  Average loss: 0.0003, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 18, internal_epoch   8,  Average loss: 0.0003, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 18, internal_epoch   9,  Average loss: 0.0003, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 18, internal_epoch  10,  Average loss: 0.0002, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Global model norm: 15.470185677536676.
Norm before scaling: 15.978752333115589. Distance: 3.741592901532167
Total norm for 10 adversaries is: 15.978752333115589. distance: 3.741592901532167
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.1901, Accuracy: 8435/8968 (94.0566%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 29, internal_epoch   1,  Average loss: 0.0114, Accuracy: 393/506 (77.6680%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 29, internal_epoch   2,  Average loss: 0.0025, Accuracy: 499/506 (98.6166%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 29, internal_epoch   3,  Average loss: 0.0005, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 29, internal_epoch   4,  Average loss: 0.0006, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 29, internal_epoch   5,  Average loss: 0.0004, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 29, internal_epoch   6,  Average loss: 0.0005, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 29, internal_epoch   7,  Average loss: 0.0005, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 29, internal_epoch   8,  Average loss: 0.0004, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 29, internal_epoch   9,  Average loss: 0.0003, Accuracy: 506/506 (100.0000%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 29, internal_epoch  10,  Average loss: 0.0004, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Global model norm: 15.470185677536676.
Norm before scaling: 15.786677207255925. Distance: 2.8606606183325574
Total norm for 10 adversaries is: 15.786677207255925. distance: 2.8606606183325574
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.7435, Accuracy: 6370/8968 (71.0303%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 62, internal_epoch   1,  Average loss: 0.0042, Accuracy: 527/580 (90.8621%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 62, internal_epoch   2,  Average loss: 0.0019, Accuracy: 558/580 (96.2069%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 62, internal_epoch   3,  Average loss: 0.0008, Accuracy: 569/580 (98.1034%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 62, internal_epoch   4,  Average loss: 0.0007, Accuracy: 572/580 (98.6207%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 62, internal_epoch   5,  Average loss: 0.0006, Accuracy: 574/580 (98.9655%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 62, internal_epoch   6,  Average loss: 0.0006, Accuracy: 572/580 (98.6207%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 62, internal_epoch   7,  Average loss: 0.0007, Accuracy: 571/580 (98.4483%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 62, internal_epoch   8,  Average loss: 0.0005, Accuracy: 574/580 (98.9655%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 62, internal_epoch   9,  Average loss: 0.0006, Accuracy: 573/580 (98.7931%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 62, internal_epoch  10,  Average loss: 0.0005, Accuracy: 573/580 (98.7931%), train_poison_data_count: 292
Global model norm: 15.470185677536676.
Norm before scaling: 15.601445625031685. Distance: 1.9162221130412254
Total norm for 10 adversaries is: 15.601445625031685. distance: 1.9162221130412254
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0153, Accuracy: 8906/8968 (99.3087%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 33, internal_epoch   1,  Average loss: 0.0136, Accuracy: 407/587 (69.3356%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 33, internal_epoch   2,  Average loss: 0.0027, Accuracy: 562/587 (95.7411%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 33, internal_epoch   3,  Average loss: 0.0008, Accuracy: 576/587 (98.1261%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 33, internal_epoch   4,  Average loss: 0.0004, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 33, internal_epoch   5,  Average loss: 0.0005, Accuracy: 579/587 (98.6371%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 33, internal_epoch   6,  Average loss: 0.0006, Accuracy: 581/587 (98.9779%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 33, internal_epoch   7,  Average loss: 0.0003, Accuracy: 585/587 (99.6593%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 33, internal_epoch   8,  Average loss: 0.0004, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 33, internal_epoch   9,  Average loss: 0.0004, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 33, internal_epoch  10,  Average loss: 0.0004, Accuracy: 583/587 (99.3186%), train_poison_data_count: 299
Global model norm: 15.470185677536676.
Norm before scaling: 15.870297193430641. Distance: 3.5610347210616937
Total norm for 10 adversaries is: 15.870297193430641. distance: 3.5610347210616937
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.9657, Accuracy: 6265/8968 (69.8595%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 88, internal_epoch   1,  Average loss: 0.0084, Accuracy: 602/734 (82.0163%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 88, internal_epoch   2,  Average loss: 0.0018, Accuracy: 705/734 (96.0490%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 88, internal_epoch   3,  Average loss: 0.0009, Accuracy: 721/734 (98.2289%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 88, internal_epoch   4,  Average loss: 0.0007, Accuracy: 723/734 (98.5014%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 88, internal_epoch   5,  Average loss: 0.0006, Accuracy: 725/734 (98.7738%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 88, internal_epoch   6,  Average loss: 0.0005, Accuracy: 724/734 (98.6376%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 88, internal_epoch   7,  Average loss: 0.0005, Accuracy: 723/734 (98.5014%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 88, internal_epoch   8,  Average loss: 0.0005, Accuracy: 726/734 (98.9101%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 88, internal_epoch   9,  Average loss: 0.0004, Accuracy: 730/734 (99.4550%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 88, internal_epoch  10,  Average loss: 0.0005, Accuracy: 725/734 (98.7738%), train_poison_data_count: 382
Global model norm: 15.470185677536676.
Norm before scaling: 15.835442707027141. Distance: 3.412556680620808
Total norm for 10 adversaries is: 15.835442707027141. distance: 3.412556680620808
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0448, Accuracy: 8831/8968 (98.4723%)
___Train Local_Simple,  epoch  49, local model 24, internal_epoch   1,  Average loss: 0.0014, Accuracy: 469/477 (98.3229%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.9908, Accuracy: 7164/10000 (71.6400%)
___Train Local_Simple,  epoch  49, local model 28, internal_epoch   1,  Average loss: 0.0008, Accuracy: 600/611 (98.1997%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.6870, Accuracy: 5613/10000 (56.1300%)
___Train Local_Simple,  epoch  49, local model 81, internal_epoch   1,  Average loss: 0.0008, Accuracy: 629/636 (98.8994%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.6564, Accuracy: 6234/10000 (62.3400%)
___Train Local_Simple,  epoch  49, local model 19, internal_epoch   1,  Average loss: 0.0007, Accuracy: 589/598 (98.4950%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.1425, Accuracy: 5617/10000 (56.1700%)
___Train Local_Simple,  epoch  49, local model 85, internal_epoch   1,  Average loss: 0.0016, Accuracy: 786/807 (97.3978%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.5526, Accuracy: 5951/10000 (59.5100%)
___Train Local_Simple,  epoch  49, local model 12, internal_epoch   1,  Average loss: 0.0006, Accuracy: 719/725 (99.1724%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.3712, Accuracy: 5984/10000 (59.8400%)
___Train Local_Simple,  epoch  49, local model 45, internal_epoch   1,  Average loss: 0.0009, Accuracy: 635/647 (98.1453%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 4.9128, Accuracy: 3621/10000 (36.2100%)
___Train Local_Simple,  epoch  49, local model 22, internal_epoch   1,  Average loss: 0.0006, Accuracy: 258/262 (98.4733%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.4223, Accuracy: 8739/10000 (87.3900%)
___Train Local_Simple,  epoch  49, local model 20, internal_epoch   1,  Average loss: 0.0009, Accuracy: 591/602 (98.1728%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.7532, Accuracy: 5229/10000 (52.2900%)
___Train Local_Simple,  epoch  49, local model 1, internal_epoch   1,  Average loss: 0.0004, Accuracy: 534/536 (99.6269%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.4538, Accuracy: 8687/10000 (86.8700%)
___Train Local_Simple,  epoch  49, local model 21, internal_epoch   1,  Average loss: 0.0006, Accuracy: 683/687 (99.4178%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.6927, Accuracy: 5965/10000 (59.6500%)
___Train Local_Simple,  epoch  49, local model 69, internal_epoch   1,  Average loss: 0.0011, Accuracy: 662/671 (98.6587%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.8702, Accuracy: 4884/10000 (48.8400%)
___Train Local_Simple,  epoch  49, local model 15, internal_epoch   1,  Average loss: 0.0009, Accuracy: 279/282 (98.9362%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2872, Accuracy: 9017/10000 (90.1700%)
___Train Local_Simple,  epoch  49, local model 79, internal_epoch   1,  Average loss: 0.0011, Accuracy: 653/661 (98.7897%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.5968, Accuracy: 6141/10000 (61.4100%)
___Train Local_Simple,  epoch  49, local model 4, internal_epoch   1,  Average loss: 0.0007, Accuracy: 739/748 (98.7968%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 3.0032, Accuracy: 4456/10000 (44.5600%)
___Train Local_Simple,  epoch  49, local model 67, internal_epoch   1,  Average loss: 0.0011, Accuracy: 432/441 (97.9592%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.5986, Accuracy: 5875/10000 (58.7500%)
___Train Local_Simple,  epoch  49, local model 59, internal_epoch   1,  Average loss: 0.0010, Accuracy: 632/644 (98.1366%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.0574, Accuracy: 6856/10000 (68.5600%)
___Train Local_Simple,  epoch  49, local model 2, internal_epoch   1,  Average loss: 0.0007, Accuracy: 559/564 (99.1135%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.1635, Accuracy: 6669/10000 (66.6900%)
___Train Local_Simple,  epoch  49, local model 31, internal_epoch   1,  Average loss: 0.0006, Accuracy: 588/596 (98.6577%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.3109, Accuracy: 6377/10000 (63.7700%)
___Train Local_Simple,  epoch  49, local model 44, internal_epoch   1,  Average loss: 0.0004, Accuracy: 558/561 (99.4652%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.9852, Accuracy: 6308/10000 (63.0800%)
___Train Local_Simple,  epoch  49, local model 63, internal_epoch   1,  Average loss: 0.0011, Accuracy: 299/303 (98.6799%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.7225, Accuracy: 6443/10000 (64.4300%)
___Train Local_Simple,  epoch  49, local model 27, internal_epoch   1,  Average loss: 0.0007, Accuracy: 737/745 (98.9262%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 3.2978, Accuracy: 4308/10000 (43.0800%)
___Train Local_Simple,  epoch  49, local model 97, internal_epoch   1,  Average loss: 0.0003, Accuracy: 1105/1112 (99.3705%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 3.8398, Accuracy: 4082/10000 (40.8200%)
___Train Local_Simple,  epoch  49, local model 5, internal_epoch   1,  Average loss: 0.0006, Accuracy: 571/578 (98.7889%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.6236, Accuracy: 8195/10000 (81.9500%)
___Train Local_Simple,  epoch  49, local model 40, internal_epoch   1,  Average loss: 0.0005, Accuracy: 494/498 (99.1968%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.7107, Accuracy: 6193/10000 (61.9300%)
___Train Local_Simple,  epoch  49, local model 56, internal_epoch   1,  Average loss: 0.0005, Accuracy: 709/715 (99.1608%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.0803, Accuracy: 7073/10000 (70.7300%)
___Train Local_Simple,  epoch  49, local model 82, internal_epoch   1,  Average loss: 0.0005, Accuracy: 810/815 (99.3865%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 3.2930, Accuracy: 5058/10000 (50.5800%)
___Train Local_Simple,  epoch  49, local model 10, internal_epoch   1,  Average loss: 0.0008, Accuracy: 563/573 (98.2548%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.8553, Accuracy: 5919/10000 (59.1900%)
___Train Local_Simple,  epoch  49, local model 91, internal_epoch   1,  Average loss: 0.0004, Accuracy: 814/819 (99.3895%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.5980, Accuracy: 5957/10000 (59.5700%)
___Train Local_Simple,  epoch  49, local model 11, internal_epoch   1,  Average loss: 0.0006, Accuracy: 548/554 (98.9170%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.4022, Accuracy: 6971/10000 (69.7100%)
___Train Local_Simple,  epoch  49, local model 95, internal_epoch   1,  Average loss: 0.0017, Accuracy: 579/600 (96.5000%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.3320, Accuracy: 6445/10000 (64.4500%)
___Train Local_Simple,  epoch  49, local model 25, internal_epoch   1,  Average loss: 0.0003, Accuracy: 591/592 (99.8311%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.3351, Accuracy: 7814/10000 (78.1400%)
___Train Local_Simple,  epoch  49, local model 89, internal_epoch   1,  Average loss: 0.0012, Accuracy: 669/683 (97.9502%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.3542, Accuracy: 6737/10000 (67.3700%)
___Train Local_Simple,  epoch  49, local model 84, internal_epoch   1,  Average loss: 0.0007, Accuracy: 413/420 (98.3333%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.6319, Accuracy: 8117/10000 (81.1700%)
___Train Local_Simple,  epoch  49, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 704/713 (98.7377%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.2412, Accuracy: 5758/10000 (57.5800%)
___Train Local_Simple,  epoch  49, local model 14, internal_epoch   1,  Average loss: 0.0009, Accuracy: 682/692 (98.5549%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.2107, Accuracy: 6817/10000 (68.1700%)
___Train Local_Simple,  epoch  49, local model 94, internal_epoch   1,  Average loss: 0.0005, Accuracy: 666/671 (99.2548%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.7996, Accuracy: 6908/10000 (69.0800%)
___Train Local_Simple,  epoch  49, local model 54, internal_epoch   1,  Average loss: 0.0005, Accuracy: 826/832 (99.2788%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 3.0295, Accuracy: 5219/10000 (52.1900%)
___Train Local_Simple,  epoch  49, local model 75, internal_epoch   1,  Average loss: 0.0008, Accuracy: 752/763 (98.5583%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 3.0448, Accuracy: 4960/10000 (49.6000%)
___Train Local_Simple,  epoch  49, local model 34, internal_epoch   1,  Average loss: 0.0007, Accuracy: 860/871 (98.7371%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 4.7493, Accuracy: 3479/10000 (34.7900%)
___Train Local_Simple,  epoch  49, local model 98, internal_epoch   1,  Average loss: 0.0011, Accuracy: 539/548 (98.3577%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.6499, Accuracy: 4970/10000 (49.7000%)
___Train Local_Simple,  epoch  49, local model 61, internal_epoch   1,  Average loss: 0.0010, Accuracy: 283/287 (98.6063%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2235, Accuracy: 9334/10000 (93.3400%)
___Train Local_Simple,  epoch  49, local model 26, internal_epoch   1,  Average loss: 0.0008, Accuracy: 513/519 (98.8439%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.8678, Accuracy: 5972/10000 (59.7200%)
___Train Local_Simple,  epoch  49, local model 47, internal_epoch   1,  Average loss: 0.0006, Accuracy: 527/534 (98.6891%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.6676, Accuracy: 6056/10000 (60.5600%)
___Train Local_Simple,  epoch  49, local model 17, internal_epoch   1,  Average loss: 0.0005, Accuracy: 521/527 (98.8615%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.1699, Accuracy: 5758/10000 (57.5800%)
___Train Local_Simple,  epoch  49, local model 42, internal_epoch   1,  Average loss: 0.0004, Accuracy: 470/473 (99.3658%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.5989, Accuracy: 7996/10000 (79.9600%)
___Train Local_Simple,  epoch  49, local model 48, internal_epoch   1,  Average loss: 0.0010, Accuracy: 357/363 (98.3471%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.4784, Accuracy: 8420/10000 (84.2000%)
___Train Local_Simple,  epoch  49, local model 70, internal_epoch   1,  Average loss: 0.0011, Accuracy: 557/568 (98.0634%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.1460, Accuracy: 5512/10000 (55.1200%)
___Train Local_Simple,  epoch  49, local model 52, internal_epoch   1,  Average loss: 0.0009, Accuracy: 773/789 (97.9721%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.6340, Accuracy: 5114/10000 (51.1400%)
___Train Local_Simple,  epoch  49, local model 9, internal_epoch   1,  Average loss: 0.0008, Accuracy: 502/508 (98.8189%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.5504, Accuracy: 8184/10000 (81.8400%)
___Train Local_Simple,  epoch  49, local model 32, internal_epoch   1,  Average loss: 0.0006, Accuracy: 583/590 (98.8136%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.3247, Accuracy: 6892/10000 (68.9200%)
___Train Local_Simple,  epoch  49, local model 83, internal_epoch   1,  Average loss: 0.0012, Accuracy: 352/360 (97.7778%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2970, Accuracy: 9059/10000 (90.5900%)
___Train Local_Simple,  epoch  49, local model 16, internal_epoch   1,  Average loss: 0.0004, Accuracy: 812/817 (99.3880%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.3909, Accuracy: 6814/10000 (68.1400%)
___Train Local_Simple,  epoch  49, local model 93, internal_epoch   1,  Average loss: 0.0010, Accuracy: 617/630 (97.9365%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 3.9820, Accuracy: 4095/10000 (40.9500%)
___Train Local_Simple,  epoch  49, local model 58, internal_epoch   1,  Average loss: 0.0006, Accuracy: 763/772 (98.8342%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.5623, Accuracy: 6480/10000 (64.8000%)
___Train Local_Simple,  epoch  49, local model 76, internal_epoch   1,  Average loss: 0.0012, Accuracy: 452/459 (98.4749%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.0565, Accuracy: 7607/10000 (76.0700%)
___Train Local_Simple,  epoch  49, local model 72, internal_epoch   1,  Average loss: 0.0015, Accuracy: 413/423 (97.6359%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.8156, Accuracy: 6210/10000 (62.1000%)
___Train Local_Simple,  epoch  49, local model 60, internal_epoch   1,  Average loss: 0.0011, Accuracy: 560/571 (98.0736%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.8839, Accuracy: 4433/10000 (44.3300%)
___Train Local_Simple,  epoch  49, local model 38, internal_epoch   1,  Average loss: 0.0006, Accuracy: 471/477 (98.7421%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3138, Accuracy: 9002/10000 (90.0200%)
___Train Local_Simple,  epoch  49, local model 90, internal_epoch   1,  Average loss: 0.0015, Accuracy: 598/615 (97.2358%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.9558, Accuracy: 7348/10000 (73.4800%)
___Train Local_Simple,  epoch  49, local model 57, internal_epoch   1,  Average loss: 0.0006, Accuracy: 517/523 (98.8528%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.3260, Accuracy: 6276/10000 (62.7600%)
___Train Local_Simple,  epoch  49, local model 86, internal_epoch   1,  Average loss: 0.0007, Accuracy: 687/692 (99.2775%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 4.2760, Accuracy: 3748/10000 (37.4800%)
___Train Local_Simple,  epoch  49, local model 96, internal_epoch   1,  Average loss: 0.0009, Accuracy: 522/531 (98.3051%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.6307, Accuracy: 5378/10000 (53.7800%)
___Train Local_Simple,  epoch  49, local model 23, internal_epoch   1,  Average loss: 0.0009, Accuracy: 535/542 (98.7085%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.7925, Accuracy: 5839/10000 (58.3900%)
___Train Local_Simple,  epoch  49, local model 78, internal_epoch   1,  Average loss: 0.0016, Accuracy: 572/587 (97.4446%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.7831, Accuracy: 5019/10000 (50.1900%)
___Train Local_Simple,  epoch  49, local model 7, internal_epoch   1,  Average loss: 0.0004, Accuracy: 797/802 (99.3766%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.1994, Accuracy: 5489/10000 (54.8900%)
___Train Local_Simple,  epoch  49, local model 68, internal_epoch   1,  Average loss: 0.0011, Accuracy: 538/549 (97.9964%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 3.2940, Accuracy: 4981/10000 (49.8100%)
___Train Local_Simple,  epoch  49, local model 55, internal_epoch   1,  Average loss: 0.0009, Accuracy: 370/375 (98.6667%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.9109, Accuracy: 7309/10000 (73.0900%)
___Train Local_Simple,  epoch  49, local model 37, internal_epoch   1,  Average loss: 0.0007, Accuracy: 450/456 (98.6842%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.5480, Accuracy: 8172/10000 (81.7200%)
___Train Local_Simple,  epoch  49, local model 65, internal_epoch   1,  Average loss: 0.0013, Accuracy: 603/621 (97.1014%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.4344, Accuracy: 5969/10000 (59.6900%)
___Train Local_Simple,  epoch  49, local model 64, internal_epoch   1,  Average loss: 0.0003, Accuracy: 606/608 (99.6711%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.1365, Accuracy: 7173/10000 (71.7300%)
___Train Local_Simple,  epoch  49, local model 87, internal_epoch   1,  Average loss: 0.0006, Accuracy: 658/663 (99.2459%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 3.9755, Accuracy: 4926/10000 (49.2600%)
___Train Local_Simple,  epoch  49, local model 30, internal_epoch   1,  Average loss: 0.0008, Accuracy: 438/443 (98.8713%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.6695, Accuracy: 8074/10000 (80.7400%)
___Train Local_Simple,  epoch  49, local model 35, internal_epoch   1,  Average loss: 0.0010, Accuracy: 618/630 (98.0952%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 3.6505, Accuracy: 4758/10000 (47.5800%)
___Train Local_Simple,  epoch  49, local model 39, internal_epoch   1,  Average loss: 0.0008, Accuracy: 481/493 (97.5659%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.3551, Accuracy: 6668/10000 (66.6800%)
___Train Local_Simple,  epoch  49, local model 71, internal_epoch   1,  Average loss: 0.0010, Accuracy: 550/561 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.2049, Accuracy: 6884/10000 (68.8400%)
___Train Local_Simple,  epoch  49, local model 50, internal_epoch   1,  Average loss: 0.0009, Accuracy: 469/477 (98.3229%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.2340, Accuracy: 6581/10000 (65.8100%)
___Train Local_Simple,  epoch  49, local model 77, internal_epoch   1,  Average loss: 0.0012, Accuracy: 604/618 (97.7346%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.4272, Accuracy: 6555/10000 (65.5500%)
___Train Local_Simple,  epoch  49, local model 80, internal_epoch   1,  Average loss: 0.0019, Accuracy: 511/532 (96.0526%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 3.9593, Accuracy: 3730/10000 (37.3000%)
___Train Local_Simple,  epoch  49, local model 8, internal_epoch   1,  Average loss: 0.0006, Accuracy: 696/706 (98.5836%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.2194, Accuracy: 4890/10000 (48.9000%)
___Train Local_Simple,  epoch  49, local model 0, internal_epoch   1,  Average loss: 0.0005, Accuracy: 434/435 (99.7701%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.2692, Accuracy: 7031/10000 (70.3100%)
___Train Local_Simple,  epoch  49, local model 66, internal_epoch   1,  Average loss: 0.0012, Accuracy: 722/733 (98.4993%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.6120, Accuracy: 5333/10000 (53.3300%)
___Train Local_Simple,  epoch  49, local model 92, internal_epoch   1,  Average loss: 0.0018, Accuracy: 581/611 (95.0900%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.5541, Accuracy: 4448/10000 (44.4800%)
___Train Local_Simple,  epoch  49, local model 43, internal_epoch   1,  Average loss: 0.0008, Accuracy: 426/431 (98.8399%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.9808, Accuracy: 7374/10000 (73.7400%)
___Train Local_Simple,  epoch  49, local model 49, internal_epoch   1,  Average loss: 0.0008, Accuracy: 351/355 (98.8732%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.5947, Accuracy: 7955/10000 (79.5500%)
___Train Local_Simple,  epoch  49, local model 36, internal_epoch   1,  Average loss: 0.0009, Accuracy: 310/315 (98.4127%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2829, Accuracy: 9089/10000 (90.8900%)
___Train Local_Simple,  epoch  49, local model 6, internal_epoch   1,  Average loss: 0.0009, Accuracy: 430/435 (98.8506%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.0608, Accuracy: 7474/10000 (74.7400%)
___Train Local_Simple,  epoch  49, local model 46, internal_epoch   1,  Average loss: 0.0007, Accuracy: 643/650 (98.9231%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.5733, Accuracy: 5619/10000 (56.1900%)
___Train Local_Simple,  epoch  49, local model 99, internal_epoch   1,  Average loss: 0.0011, Accuracy: 697/712 (97.8933%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.2940, Accuracy: 5487/10000 (54.8700%)
___Train Local_Simple,  epoch  49, local model 53, internal_epoch   1,  Average loss: 0.0009, Accuracy: 552/561 (98.3957%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.2692, Accuracy: 6255/10000 (62.5500%)
time spent on training: 367.51866269111633
___Test Target_Simple poisoned: False, epoch: 49: Average loss: 0.1037, Accuracy: 9699/10000 (96.9900%)
___Test Target_Simple poisoned: True, epoch: 49: Average loss: 3.0728, Accuracy: 1577/8968 (17.5847%)
saving model
Done in 397.3608646392822 sec.
Server Epoch:50 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 87, 85, 55, 25, 48, 17, 80, 31, 54, 60, 34, 82, 65, 30, 68, 76, 96, 46, 66, 79, 72, 56, 7, 8, 58, 45, 12, 26, 52, 84, 4, 27, 93, 86, 38, 14, 44, 59, 92, 90, 43, 6, 16, 24, 35, 78, 15, 94, 81, 77, 36, 95, 42, 40, 71, 89, 69, 0, 32, 37, 91, 63, 20, 13, 28, 53, 21, 83, 64, 98, 97, 9, 49, 1, 2, 5, 61, 47, 99, 57, 22, 75, 10, 19, 50, 67, 39, 23, 70, 11].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   1,  Average loss: 0.0192, Accuracy: 322/569 (56.5905%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   2,  Average loss: 0.0064, Accuracy: 494/569 (86.8190%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   3,  Average loss: 0.0012, Accuracy: 562/569 (98.7698%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   4,  Average loss: 0.0008, Accuracy: 564/569 (99.1213%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   5,  Average loss: 0.0007, Accuracy: 564/569 (99.1213%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   6,  Average loss: 0.0007, Accuracy: 564/569 (99.1213%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   7,  Average loss: 0.0006, Accuracy: 564/569 (99.1213%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   8,  Average loss: 0.0005, Accuracy: 565/569 (99.2970%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch   9,  Average loss: 0.0005, Accuracy: 565/569 (99.2970%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 41, internal_epoch  10,  Average loss: 0.0003, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Global model norm: 15.481996971470101.
Norm before scaling: 15.784660831900222. Distance: 3.8441403818765165
Total norm for 10 adversaries is: 15.784660831900222. distance: 3.8441403818765165
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.7700, Accuracy: 6698/8968 (74.6878%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   1,  Average loss: 0.0089, Accuracy: 413/522 (79.1188%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   2,  Average loss: 0.0017, Accuracy: 510/522 (97.7011%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   3,  Average loss: 0.0007, Accuracy: 515/522 (98.6590%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   4,  Average loss: 0.0006, Accuracy: 518/522 (99.2337%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   5,  Average loss: 0.0003, Accuracy: 522/522 (100.0000%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   6,  Average loss: 0.0005, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   7,  Average loss: 0.0004, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   8,  Average loss: 0.0005, Accuracy: 517/522 (99.0421%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch   9,  Average loss: 0.0003, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 73, internal_epoch  10,  Average loss: 0.0004, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Global model norm: 15.481996971470101.
Norm before scaling: 15.669752804498913. Distance: 2.5187618056557812
Total norm for 10 adversaries is: 15.669752804498913. distance: 2.5187618056557812
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0467, Accuracy: 8822/8968 (98.3720%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   1,  Average loss: 0.0142, Accuracy: 263/385 (68.3117%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   2,  Average loss: 0.0037, Accuracy: 367/385 (95.3247%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   3,  Average loss: 0.0017, Accuracy: 377/385 (97.9221%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   4,  Average loss: 0.0014, Accuracy: 376/385 (97.6623%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   5,  Average loss: 0.0009, Accuracy: 379/385 (98.4416%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   6,  Average loss: 0.0010, Accuracy: 378/385 (98.1818%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   7,  Average loss: 0.0006, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   8,  Average loss: 0.0009, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   9,  Average loss: 0.0009, Accuracy: 381/385 (98.9610%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch  10,  Average loss: 0.0007, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Global model norm: 15.481996971470101.
Norm before scaling: 15.757084781938419. Distance: 2.7879094323508293
Total norm for 10 adversaries is: 15.757084781938419. distance: 2.7879094323508293
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.2223, Accuracy: 8183/8968 (91.2467%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   1,  Average loss: 0.0052, Accuracy: 558/627 (88.9952%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   2,  Average loss: 0.0012, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   3,  Average loss: 0.0014, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   4,  Average loss: 0.0010, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   5,  Average loss: 0.0011, Accuracy: 616/627 (98.2456%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   6,  Average loss: 0.0009, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   7,  Average loss: 0.0007, Accuracy: 621/627 (99.0431%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   8,  Average loss: 0.0005, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch   9,  Average loss: 0.0008, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 74, internal_epoch  10,  Average loss: 0.0004, Accuracy: 624/627 (99.5215%), train_poison_data_count: 320
Global model norm: 15.481996971470101.
Norm before scaling: 15.635418401621045. Distance: 2.3303215366560215
Total norm for 10 adversaries is: 15.635418401621045. distance: 2.3303215366560215
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0043, Accuracy: 8954/8968 (99.8439%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 3, internal_epoch   1,  Average loss: 0.0203, Accuracy: 326/516 (63.1783%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 3, internal_epoch   2,  Average loss: 0.0052, Accuracy: 485/516 (93.9922%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 3, internal_epoch   3,  Average loss: 0.0019, Accuracy: 495/516 (95.9302%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 3, internal_epoch   4,  Average loss: 0.0011, Accuracy: 512/516 (99.2248%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 3, internal_epoch   5,  Average loss: 0.0006, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 3, internal_epoch   6,  Average loss: 0.0004, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 3, internal_epoch   7,  Average loss: 0.0003, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 3, internal_epoch   8,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 3, internal_epoch   9,  Average loss: 0.0004, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 3, internal_epoch  10,  Average loss: 0.0003, Accuracy: 513/516 (99.4186%), train_poison_data_count: 260
Global model norm: 15.481996971470101.
Norm before scaling: 15.898955285640774. Distance: 4.077291703134114
Total norm for 10 adversaries is: 15.898955285640774. distance: 4.077291703134114
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.6695, Accuracy: 7405/8968 (82.5714%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 18, internal_epoch   1,  Average loss: 0.0101, Accuracy: 620/759 (81.6864%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 18, internal_epoch   2,  Average loss: 0.0008, Accuracy: 748/759 (98.5507%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 18, internal_epoch   3,  Average loss: 0.0003, Accuracy: 754/759 (99.3412%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 18, internal_epoch   4,  Average loss: 0.0004, Accuracy: 752/759 (99.0777%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 18, internal_epoch   5,  Average loss: 0.0002, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 18, internal_epoch   6,  Average loss: 0.0005, Accuracy: 750/759 (98.8142%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 18, internal_epoch   7,  Average loss: 0.0002, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 18, internal_epoch   8,  Average loss: 0.0002, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 18, internal_epoch   9,  Average loss: 0.0001, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 18, internal_epoch  10,  Average loss: 0.0002, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Global model norm: 15.481996971470101.
Norm before scaling: 16.00412506333816. Distance: 3.9883302691190567
Total norm for 10 adversaries is: 16.00412506333816. distance: 3.9883302691190567
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0420, Accuracy: 8832/8968 (98.4835%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   1,  Average loss: 0.0122, Accuracy: 377/506 (74.5059%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 491/506 (97.0356%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   3,  Average loss: 0.0008, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   4,  Average loss: 0.0007, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   5,  Average loss: 0.0006, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   6,  Average loss: 0.0005, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   7,  Average loss: 0.0006, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   8,  Average loss: 0.0004, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   9,  Average loss: 0.0005, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch  10,  Average loss: 0.0003, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Global model norm: 15.481996971470101.
Norm before scaling: 15.955532269710266. Distance: 3.4624762634124764
Total norm for 10 adversaries is: 15.955532269710266. distance: 3.4624762634124764
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.8749, Accuracy: 6242/8968 (69.6030%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 62, internal_epoch   1,  Average loss: 0.0050, Accuracy: 516/580 (88.9655%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 62, internal_epoch   2,  Average loss: 0.0018, Accuracy: 564/580 (97.2414%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 62, internal_epoch   3,  Average loss: 0.0004, Accuracy: 575/580 (99.1379%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 62, internal_epoch   4,  Average loss: 0.0007, Accuracy: 573/580 (98.7931%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 62, internal_epoch   5,  Average loss: 0.0008, Accuracy: 570/580 (98.2759%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 62, internal_epoch   6,  Average loss: 0.0007, Accuracy: 575/580 (99.1379%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 62, internal_epoch   7,  Average loss: 0.0005, Accuracy: 577/580 (99.4828%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 62, internal_epoch   8,  Average loss: 0.0005, Accuracy: 575/580 (99.1379%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 62, internal_epoch   9,  Average loss: 0.0004, Accuracy: 575/580 (99.1379%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 62, internal_epoch  10,  Average loss: 0.0006, Accuracy: 575/580 (99.1379%), train_poison_data_count: 292
Global model norm: 15.481996971470101.
Norm before scaling: 15.593508793068102. Distance: 1.898780069722091
Total norm for 10 adversaries is: 15.593508793068102. distance: 1.898780069722091
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0205, Accuracy: 8889/8968 (99.1191%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 33, internal_epoch   1,  Average loss: 0.0159, Accuracy: 370/587 (63.0324%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 33, internal_epoch   2,  Average loss: 0.0037, Accuracy: 573/587 (97.6150%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 33, internal_epoch   3,  Average loss: 0.0006, Accuracy: 582/587 (99.1482%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 33, internal_epoch   4,  Average loss: 0.0003, Accuracy: 585/587 (99.6593%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 33, internal_epoch   5,  Average loss: 0.0005, Accuracy: 582/587 (99.1482%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 33, internal_epoch   6,  Average loss: 0.0003, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 33, internal_epoch   7,  Average loss: 0.0004, Accuracy: 583/587 (99.3186%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 33, internal_epoch   8,  Average loss: 0.0003, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 33, internal_epoch   9,  Average loss: 0.0002, Accuracy: 586/587 (99.8296%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 33, internal_epoch  10,  Average loss: 0.0003, Accuracy: 585/587 (99.6593%), train_poison_data_count: 299
Global model norm: 15.481996971470101.
Norm before scaling: 15.928274558781371. Distance: 3.723849862748627
Total norm for 10 adversaries is: 15.928274558781371. distance: 3.723849862748627
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.6596, Accuracy: 7016/8968 (78.2337%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 88, internal_epoch   1,  Average loss: 0.0071, Accuracy: 632/734 (86.1035%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 88, internal_epoch   2,  Average loss: 0.0015, Accuracy: 712/734 (97.0027%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 88, internal_epoch   3,  Average loss: 0.0009, Accuracy: 718/734 (97.8202%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 88, internal_epoch   4,  Average loss: 0.0006, Accuracy: 723/734 (98.5014%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 88, internal_epoch   5,  Average loss: 0.0006, Accuracy: 726/734 (98.9101%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 88, internal_epoch   6,  Average loss: 0.0005, Accuracy: 727/734 (99.0463%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 88, internal_epoch   7,  Average loss: 0.0005, Accuracy: 726/734 (98.9101%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 88, internal_epoch   8,  Average loss: 0.0004, Accuracy: 729/734 (99.3188%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 88, internal_epoch   9,  Average loss: 0.0003, Accuracy: 730/734 (99.4550%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 88, internal_epoch  10,  Average loss: 0.0003, Accuracy: 732/734 (99.7275%), train_poison_data_count: 382
Global model norm: 15.481996971470101.
Norm before scaling: 15.778966515642201. Distance: 2.955799647539813
Total norm for 10 adversaries is: 15.778966515642201. distance: 2.955799647539813
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0563, Accuracy: 8807/8968 (98.2047%)
___Train Local_Simple,  epoch  50, local model 87, internal_epoch   1,  Average loss: 0.0014, Accuracy: 650/663 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 2.9003, Accuracy: 3889/10000 (38.8900%)
___Train Local_Simple,  epoch  50, local model 85, internal_epoch   1,  Average loss: 0.0009, Accuracy: 788/807 (97.6456%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 2.2551, Accuracy: 5907/10000 (59.0700%)
___Train Local_Simple,  epoch  50, local model 55, internal_epoch   1,  Average loss: 0.0012, Accuracy: 365/375 (97.3333%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.5386, Accuracy: 8149/10000 (81.4900%)
___Train Local_Simple,  epoch  50, local model 25, internal_epoch   1,  Average loss: 0.0003, Accuracy: 589/592 (99.4932%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.3173, Accuracy: 7635/10000 (76.3500%)
___Train Local_Simple,  epoch  50, local model 48, internal_epoch   1,  Average loss: 0.0009, Accuracy: 357/363 (98.3471%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.3665, Accuracy: 8768/10000 (87.6800%)
___Train Local_Simple,  epoch  50, local model 17, internal_epoch   1,  Average loss: 0.0005, Accuracy: 521/527 (98.8615%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.0870, Accuracy: 6825/10000 (68.2500%)
___Train Local_Simple,  epoch  50, local model 80, internal_epoch   1,  Average loss: 0.0014, Accuracy: 518/532 (97.3684%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 4.5414, Accuracy: 3041/10000 (30.4100%)
___Train Local_Simple,  epoch  50, local model 31, internal_epoch   1,  Average loss: 0.0006, Accuracy: 591/596 (99.1611%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.1363, Accuracy: 6643/10000 (66.4300%)
___Train Local_Simple,  epoch  50, local model 54, internal_epoch   1,  Average loss: 0.0004, Accuracy: 825/832 (99.1587%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 2.6387, Accuracy: 5410/10000 (54.1000%)
___Train Local_Simple,  epoch  50, local model 60, internal_epoch   1,  Average loss: 0.0011, Accuracy: 559/571 (97.8984%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 4.4876, Accuracy: 3651/10000 (36.5100%)
___Train Local_Simple,  epoch  50, local model 34, internal_epoch   1,  Average loss: 0.0016, Accuracy: 842/871 (96.6705%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 4.9777, Accuracy: 4096/10000 (40.9600%)
___Train Local_Simple,  epoch  50, local model 82, internal_epoch   1,  Average loss: 0.0004, Accuracy: 808/815 (99.1411%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 2.9944, Accuracy: 4994/10000 (49.9400%)
___Train Local_Simple,  epoch  50, local model 65, internal_epoch   1,  Average loss: 0.0019, Accuracy: 602/621 (96.9404%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.8357, Accuracy: 5321/10000 (53.2100%)
___Train Local_Simple,  epoch  50, local model 30, internal_epoch   1,  Average loss: 0.0006, Accuracy: 440/443 (99.3228%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.8734, Accuracy: 7598/10000 (75.9800%)
___Train Local_Simple,  epoch  50, local model 68, internal_epoch   1,  Average loss: 0.0011, Accuracy: 538/549 (97.9964%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 2.3455, Accuracy: 5493/10000 (54.9300%)
___Train Local_Simple,  epoch  50, local model 76, internal_epoch   1,  Average loss: 0.0011, Accuracy: 453/459 (98.6928%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.5113, Accuracy: 8478/10000 (84.7800%)
___Train Local_Simple,  epoch  50, local model 96, internal_epoch   1,  Average loss: 0.0010, Accuracy: 525/531 (98.8701%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 3.2582, Accuracy: 5066/10000 (50.6600%)
___Train Local_Simple,  epoch  50, local model 46, internal_epoch   1,  Average loss: 0.0006, Accuracy: 643/650 (98.9231%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 2.0388, Accuracy: 6201/10000 (62.0100%)
___Train Local_Simple,  epoch  50, local model 66, internal_epoch   1,  Average loss: 0.0016, Accuracy: 711/733 (96.9986%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 5.2622, Accuracy: 2983/10000 (29.8300%)
___Train Local_Simple,  epoch  50, local model 79, internal_epoch   1,  Average loss: 0.0009, Accuracy: 655/661 (99.0923%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.7306, Accuracy: 5429/10000 (54.2900%)
___Train Local_Simple,  epoch  50, local model 72, internal_epoch   1,  Average loss: 0.0015, Accuracy: 413/423 (97.6359%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 3.2511, Accuracy: 3372/10000 (33.7200%)
___Train Local_Simple,  epoch  50, local model 56, internal_epoch   1,  Average loss: 0.0004, Accuracy: 711/715 (99.4406%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 2.2195, Accuracy: 5371/10000 (53.7100%)
___Train Local_Simple,  epoch  50, local model 7, internal_epoch   1,  Average loss: 0.0005, Accuracy: 796/802 (99.2519%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 2.1285, Accuracy: 5534/10000 (55.3400%)
___Train Local_Simple,  epoch  50, local model 8, internal_epoch   1,  Average loss: 0.0009, Accuracy: 697/706 (98.7252%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 2.1091, Accuracy: 5294/10000 (52.9400%)
___Train Local_Simple,  epoch  50, local model 58, internal_epoch   1,  Average loss: 0.0005, Accuracy: 765/772 (99.0933%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.0812, Accuracy: 7142/10000 (71.4200%)
___Train Local_Simple,  epoch  50, local model 45, internal_epoch   1,  Average loss: 0.0007, Accuracy: 641/647 (99.0726%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 3.7756, Accuracy: 4175/10000 (41.7500%)
___Train Local_Simple,  epoch  50, local model 12, internal_epoch   1,  Average loss: 0.0004, Accuracy: 719/725 (99.1724%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.1431, Accuracy: 7434/10000 (74.3400%)
___Train Local_Simple,  epoch  50, local model 26, internal_epoch   1,  Average loss: 0.0007, Accuracy: 512/519 (98.6513%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 2.1367, Accuracy: 5629/10000 (56.2900%)
___Train Local_Simple,  epoch  50, local model 52, internal_epoch   1,  Average loss: 0.0013, Accuracy: 766/789 (97.0849%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.9932, Accuracy: 6231/10000 (62.3100%)
___Train Local_Simple,  epoch  50, local model 84, internal_epoch   1,  Average loss: 0.0008, Accuracy: 411/420 (97.8571%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.9426, Accuracy: 7971/10000 (79.7100%)
___Train Local_Simple,  epoch  50, local model 4, internal_epoch   1,  Average loss: 0.0004, Accuracy: 738/748 (98.6631%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.8003, Accuracy: 5726/10000 (57.2600%)
___Train Local_Simple,  epoch  50, local model 27, internal_epoch   1,  Average loss: 0.0013, Accuracy: 732/745 (98.2550%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 2.8504, Accuracy: 4827/10000 (48.2700%)
___Train Local_Simple,  epoch  50, local model 93, internal_epoch   1,  Average loss: 0.0015, Accuracy: 613/630 (97.3016%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 3.4507, Accuracy: 3703/10000 (37.0300%)
___Train Local_Simple,  epoch  50, local model 86, internal_epoch   1,  Average loss: 0.0004, Accuracy: 688/692 (99.4220%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 3.8263, Accuracy: 4011/10000 (40.1100%)
___Train Local_Simple,  epoch  50, local model 38, internal_epoch   1,  Average loss: 0.0007, Accuracy: 470/477 (98.5325%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2937, Accuracy: 9035/10000 (90.3500%)
___Train Local_Simple,  epoch  50, local model 14, internal_epoch   1,  Average loss: 0.0008, Accuracy: 682/692 (98.5549%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.7761, Accuracy: 5969/10000 (59.6900%)
___Train Local_Simple,  epoch  50, local model 44, internal_epoch   1,  Average loss: 0.0003, Accuracy: 558/561 (99.4652%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.8668, Accuracy: 7707/10000 (77.0700%)
___Train Local_Simple,  epoch  50, local model 59, internal_epoch   1,  Average loss: 0.0006, Accuracy: 636/644 (98.7578%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.8166, Accuracy: 6339/10000 (63.3900%)
___Train Local_Simple,  epoch  50, local model 92, internal_epoch   1,  Average loss: 0.0018, Accuracy: 587/611 (96.0720%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 3.4202, Accuracy: 3742/10000 (37.4200%)
___Train Local_Simple,  epoch  50, local model 90, internal_epoch   1,  Average loss: 0.0012, Accuracy: 598/615 (97.2358%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 2.5454, Accuracy: 5337/10000 (53.3700%)
___Train Local_Simple,  epoch  50, local model 43, internal_epoch   1,  Average loss: 0.0006, Accuracy: 427/431 (99.0719%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.5553, Accuracy: 8232/10000 (82.3200%)
___Train Local_Simple,  epoch  50, local model 6, internal_epoch   1,  Average loss: 0.0006, Accuracy: 430/435 (98.8506%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.6995, Accuracy: 7915/10000 (79.1500%)
___Train Local_Simple,  epoch  50, local model 16, internal_epoch   1,  Average loss: 0.0003, Accuracy: 813/817 (99.5104%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.5256, Accuracy: 7019/10000 (70.1900%)
___Train Local_Simple,  epoch  50, local model 24, internal_epoch   1,  Average loss: 0.0011, Accuracy: 468/477 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.0187, Accuracy: 6868/10000 (68.6800%)
___Train Local_Simple,  epoch  50, local model 35, internal_epoch   1,  Average loss: 0.0009, Accuracy: 617/630 (97.9365%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 2.1725, Accuracy: 5960/10000 (59.6000%)
___Train Local_Simple,  epoch  50, local model 78, internal_epoch   1,  Average loss: 0.0030, Accuracy: 563/587 (95.9114%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.4676, Accuracy: 5781/10000 (57.8100%)
___Train Local_Simple,  epoch  50, local model 15, internal_epoch   1,  Average loss: 0.0006, Accuracy: 281/282 (99.6454%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2178, Accuracy: 9254/10000 (92.5400%)
___Train Local_Simple,  epoch  50, local model 94, internal_epoch   1,  Average loss: 0.0013, Accuracy: 655/671 (97.6155%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 2.6547, Accuracy: 5863/10000 (58.6300%)
___Train Local_Simple,  epoch  50, local model 81, internal_epoch   1,  Average loss: 0.0008, Accuracy: 628/636 (98.7421%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 2.2875, Accuracy: 4368/10000 (43.6800%)
___Train Local_Simple,  epoch  50, local model 77, internal_epoch   1,  Average loss: 0.0013, Accuracy: 599/618 (96.9256%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 3.0037, Accuracy: 5312/10000 (53.1200%)
___Train Local_Simple,  epoch  50, local model 36, internal_epoch   1,  Average loss: 0.0007, Accuracy: 312/315 (99.0476%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1880, Accuracy: 9360/10000 (93.6000%)
___Train Local_Simple,  epoch  50, local model 95, internal_epoch   1,  Average loss: 0.0018, Accuracy: 581/600 (96.8333%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 3.1864, Accuracy: 4664/10000 (46.6400%)
___Train Local_Simple,  epoch  50, local model 42, internal_epoch   1,  Average loss: 0.0003, Accuracy: 472/473 (99.7886%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.6003, Accuracy: 7990/10000 (79.9000%)
___Train Local_Simple,  epoch  50, local model 40, internal_epoch   1,  Average loss: 0.0004, Accuracy: 494/498 (99.1968%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.2435, Accuracy: 7076/10000 (70.7600%)
___Train Local_Simple,  epoch  50, local model 71, internal_epoch   1,  Average loss: 0.0012, Accuracy: 546/561 (97.3262%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.6982, Accuracy: 7868/10000 (78.6800%)
___Train Local_Simple,  epoch  50, local model 89, internal_epoch   1,  Average loss: 0.0010, Accuracy: 670/683 (98.0966%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 2.3126, Accuracy: 5715/10000 (57.1500%)
___Train Local_Simple,  epoch  50, local model 69, internal_epoch   1,  Average loss: 0.0017, Accuracy: 651/671 (97.0194%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 4.3443, Accuracy: 3534/10000 (35.3400%)
___Train Local_Simple,  epoch  50, local model 0, internal_epoch   1,  Average loss: 0.0007, Accuracy: 428/435 (98.3908%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.9888, Accuracy: 6300/10000 (63.0000%)
___Train Local_Simple,  epoch  50, local model 32, internal_epoch   1,  Average loss: 0.0008, Accuracy: 582/590 (98.6441%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.6570, Accuracy: 6092/10000 (60.9200%)
___Train Local_Simple,  epoch  50, local model 37, internal_epoch   1,  Average loss: 0.0007, Accuracy: 449/456 (98.4649%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.5854, Accuracy: 6878/10000 (68.7800%)
___Train Local_Simple,  epoch  50, local model 91, internal_epoch   1,  Average loss: 0.0008, Accuracy: 803/819 (98.0464%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 2.0318, Accuracy: 5676/10000 (56.7600%)
___Train Local_Simple,  epoch  50, local model 63, internal_epoch   1,  Average loss: 0.0014, Accuracy: 295/303 (97.3597%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.8640, Accuracy: 5401/10000 (54.0100%)
___Train Local_Simple,  epoch  50, local model 20, internal_epoch   1,  Average loss: 0.0008, Accuracy: 592/602 (98.3389%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.8825, Accuracy: 5968/10000 (59.6800%)
___Train Local_Simple,  epoch  50, local model 13, internal_epoch   1,  Average loss: 0.0005, Accuracy: 708/713 (99.2987%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.7564, Accuracy: 6386/10000 (63.8600%)
___Train Local_Simple,  epoch  50, local model 28, internal_epoch   1,  Average loss: 0.0007, Accuracy: 606/611 (99.1817%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.7176, Accuracy: 6526/10000 (65.2600%)
___Train Local_Simple,  epoch  50, local model 53, internal_epoch   1,  Average loss: 0.0006, Accuracy: 555/561 (98.9305%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.0763, Accuracy: 7504/10000 (75.0400%)
___Train Local_Simple,  epoch  50, local model 21, internal_epoch   1,  Average loss: 0.0004, Accuracy: 684/687 (99.5633%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.2368, Accuracy: 7061/10000 (70.6100%)
___Train Local_Simple,  epoch  50, local model 83, internal_epoch   1,  Average loss: 0.0016, Accuracy: 348/360 (96.6667%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2143, Accuracy: 9301/10000 (93.0100%)
___Train Local_Simple,  epoch  50, local model 64, internal_epoch   1,  Average loss: 0.0004, Accuracy: 603/608 (99.1776%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 2.5165, Accuracy: 5434/10000 (54.3400%)
___Train Local_Simple,  epoch  50, local model 98, internal_epoch   1,  Average loss: 0.0014, Accuracy: 530/548 (96.7153%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 2.7774, Accuracy: 4962/10000 (49.6200%)
___Train Local_Simple,  epoch  50, local model 97, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1097/1112 (98.6511%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 4.0614, Accuracy: 3910/10000 (39.1000%)
___Train Local_Simple,  epoch  50, local model 9, internal_epoch   1,  Average loss: 0.0010, Accuracy: 501/508 (98.6220%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.6185, Accuracy: 7882/10000 (78.8200%)
___Train Local_Simple,  epoch  50, local model 49, internal_epoch   1,  Average loss: 0.0013, Accuracy: 346/355 (97.4648%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.5192, Accuracy: 5881/10000 (58.8100%)
___Train Local_Simple,  epoch  50, local model 1, internal_epoch   1,  Average loss: 0.0003, Accuracy: 534/536 (99.6269%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1746, Accuracy: 9402/10000 (94.0200%)
___Train Local_Simple,  epoch  50, local model 2, internal_epoch   1,  Average loss: 0.0006, Accuracy: 556/564 (98.5816%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.8457, Accuracy: 7395/10000 (73.9500%)
___Train Local_Simple,  epoch  50, local model 5, internal_epoch   1,  Average loss: 0.0007, Accuracy: 568/578 (98.2699%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.9890, Accuracy: 7485/10000 (74.8500%)
___Train Local_Simple,  epoch  50, local model 61, internal_epoch   1,  Average loss: 0.0011, Accuracy: 280/287 (97.5610%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2677, Accuracy: 9169/10000 (91.6900%)
___Train Local_Simple,  epoch  50, local model 47, internal_epoch   1,  Average loss: 0.0008, Accuracy: 528/534 (98.8764%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.3986, Accuracy: 6290/10000 (62.9000%)
___Train Local_Simple,  epoch  50, local model 99, internal_epoch   1,  Average loss: 0.0015, Accuracy: 691/712 (97.0506%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 3.0320, Accuracy: 4832/10000 (48.3200%)
___Train Local_Simple,  epoch  50, local model 57, internal_epoch   1,  Average loss: 0.0006, Accuracy: 520/523 (99.4264%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.0756, Accuracy: 6752/10000 (67.5200%)
___Train Local_Simple,  epoch  50, local model 22, internal_epoch   1,  Average loss: 0.0004, Accuracy: 260/262 (99.2366%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2903, Accuracy: 9024/10000 (90.2400%)
___Train Local_Simple,  epoch  50, local model 75, internal_epoch   1,  Average loss: 0.0010, Accuracy: 747/763 (97.9030%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 3.0271, Accuracy: 4273/10000 (42.7300%)
___Train Local_Simple,  epoch  50, local model 10, internal_epoch   1,  Average loss: 0.0011, Accuracy: 563/573 (98.2548%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 3.1939, Accuracy: 4053/10000 (40.5300%)
___Train Local_Simple,  epoch  50, local model 19, internal_epoch   1,  Average loss: 0.0006, Accuracy: 592/598 (98.9967%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.0588, Accuracy: 6961/10000 (69.6100%)
___Train Local_Simple,  epoch  50, local model 50, internal_epoch   1,  Average loss: 0.0007, Accuracy: 469/477 (98.3229%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.3917, Accuracy: 6366/10000 (63.6600%)
___Train Local_Simple,  epoch  50, local model 67, internal_epoch   1,  Average loss: 0.0013, Accuracy: 433/441 (98.1859%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.8044, Accuracy: 6041/10000 (60.4100%)
___Train Local_Simple,  epoch  50, local model 39, internal_epoch   1,  Average loss: 0.0007, Accuracy: 488/493 (98.9858%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.7488, Accuracy: 7677/10000 (76.7700%)
___Train Local_Simple,  epoch  50, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 533/542 (98.3395%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.7782, Accuracy: 7277/10000 (72.7700%)
___Train Local_Simple,  epoch  50, local model 70, internal_epoch   1,  Average loss: 0.0016, Accuracy: 551/568 (97.0070%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 2.8249, Accuracy: 3537/10000 (35.3700%)
___Train Local_Simple,  epoch  50, local model 11, internal_epoch   1,  Average loss: 0.0005, Accuracy: 548/554 (98.9170%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.7948, Accuracy: 7898/10000 (78.9800%)
time spent on training: 370.81256914138794
___Test Target_Simple poisoned: False, epoch: 50: Average loss: 0.0964, Accuracy: 9733/10000 (97.3300%)
___Test Target_Simple poisoned: True, epoch: 50: Average loss: 2.7912, Accuracy: 2720/8968 (30.3301%)
saving model
Done in 404.8157904148102 sec.
Server Epoch:51 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 68, 65, 44, 59, 80, 21, 0, 92, 75, 84, 1, 93, 55, 11, 22, 89, 28, 45, 47, 66, 99, 83, 5, 30, 87, 57, 39, 6, 15, 78, 25, 36, 85, 9, 31, 64, 34, 54, 10, 56, 13, 82, 79, 7, 52, 96, 97, 72, 76, 43, 16, 77, 32, 8, 2, 61, 4, 58, 19, 42, 12, 98, 94, 24, 23, 67, 27, 91, 37, 69, 50, 49, 71, 38, 81, 40, 90, 60, 53, 95, 26, 35, 17, 48, 86, 20, 46, 14, 70, 63].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   1,  Average loss: 0.0160, Accuracy: 372/569 (65.3779%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   2,  Average loss: 0.0047, Accuracy: 541/569 (95.0791%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   3,  Average loss: 0.0007, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   4,  Average loss: 0.0007, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   5,  Average loss: 0.0005, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   6,  Average loss: 0.0004, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   7,  Average loss: 0.0003, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   8,  Average loss: 0.0004, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch   9,  Average loss: 0.0004, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 41, internal_epoch  10,  Average loss: 0.0004, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Global model norm: 15.486629502876829.
Norm before scaling: 15.80269321713989. Distance: 3.6025047807311
Total norm for 10 adversaries is: 15.80269321713989. distance: 3.6025047807311
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.7145, Accuracy: 6823/8968 (76.0816%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   1,  Average loss: 0.0075, Accuracy: 443/522 (84.8659%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   2,  Average loss: 0.0015, Accuracy: 509/522 (97.5096%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   3,  Average loss: 0.0005, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   4,  Average loss: 0.0005, Accuracy: 517/522 (99.0421%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   5,  Average loss: 0.0005, Accuracy: 518/522 (99.2337%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   6,  Average loss: 0.0003, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   7,  Average loss: 0.0003, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   8,  Average loss: 0.0003, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch   9,  Average loss: 0.0002, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 73, internal_epoch  10,  Average loss: 0.0003, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Global model norm: 15.486629502876829.
Norm before scaling: 15.718406840345901. Distance: 2.562472645683362
Total norm for 10 adversaries is: 15.718406840345901. distance: 2.562472645683362
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0350, Accuracy: 8860/8968 (98.7957%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   1,  Average loss: 0.0115, Accuracy: 289/385 (75.0649%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   2,  Average loss: 0.0026, Accuracy: 370/385 (96.1039%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   3,  Average loss: 0.0010, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   4,  Average loss: 0.0009, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   5,  Average loss: 0.0005, Accuracy: 384/385 (99.7403%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   6,  Average loss: 0.0007, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   7,  Average loss: 0.0006, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   8,  Average loss: 0.0006, Accuracy: 381/385 (98.9610%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   9,  Average loss: 0.0005, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch  10,  Average loss: 0.0005, Accuracy: 384/385 (99.7403%), train_poison_data_count: 193
Global model norm: 15.486629502876829.
Norm before scaling: 15.734639746096926. Distance: 2.781950615922424
Total norm for 10 adversaries is: 15.734639746096926. distance: 2.781950615922424
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.1872, Accuracy: 8337/8968 (92.9639%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   1,  Average loss: 0.0032, Accuracy: 584/627 (93.1419%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   2,  Average loss: 0.0007, Accuracy: 620/627 (98.8836%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   3,  Average loss: 0.0008, Accuracy: 617/627 (98.4051%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 626/627 (99.8405%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   5,  Average loss: 0.0004, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   6,  Average loss: 0.0004, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   7,  Average loss: 0.0005, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   8,  Average loss: 0.0004, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch   9,  Average loss: 0.0006, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 74, internal_epoch  10,  Average loss: 0.0003, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Global model norm: 15.486629502876829.
Norm before scaling: 15.573049378440928. Distance: 1.783014460900287
Total norm for 10 adversaries is: 15.573049378440928. distance: 1.783014460900287
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0033, Accuracy: 8954/8968 (99.8439%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 3, internal_epoch   1,  Average loss: 0.0160, Accuracy: 369/516 (71.5116%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 3, internal_epoch   2,  Average loss: 0.0031, Accuracy: 495/516 (95.9302%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 3, internal_epoch   3,  Average loss: 0.0006, Accuracy: 512/516 (99.2248%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 3, internal_epoch   4,  Average loss: 0.0004, Accuracy: 513/516 (99.4186%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 3, internal_epoch   5,  Average loss: 0.0003, Accuracy: 512/516 (99.2248%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 3, internal_epoch   6,  Average loss: 0.0005, Accuracy: 510/516 (98.8372%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 3, internal_epoch   7,  Average loss: 0.0003, Accuracy: 513/516 (99.4186%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 3, internal_epoch   8,  Average loss: 0.0002, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 3, internal_epoch   9,  Average loss: 0.0003, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 3, internal_epoch  10,  Average loss: 0.0002, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Global model norm: 15.486629502876829.
Norm before scaling: 15.88060895698671. Distance: 3.657180015766876
Total norm for 10 adversaries is: 15.88060895698671. distance: 3.657180015766876
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.7628, Accuracy: 6857/8968 (76.4607%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 18, internal_epoch   1,  Average loss: 0.0094, Accuracy: 631/759 (83.1357%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 18, internal_epoch   2,  Average loss: 0.0008, Accuracy: 749/759 (98.6825%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 18, internal_epoch   3,  Average loss: 0.0004, Accuracy: 753/759 (99.2095%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 18, internal_epoch   4,  Average loss: 0.0004, Accuracy: 752/759 (99.0777%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 18, internal_epoch   5,  Average loss: 0.0002, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 18, internal_epoch   6,  Average loss: 0.0001, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 18, internal_epoch   7,  Average loss: 0.0001, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 18, internal_epoch   8,  Average loss: 0.0002, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 18, internal_epoch   9,  Average loss: 0.0001, Accuracy: 759/759 (100.0000%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 18, internal_epoch  10,  Average loss: 0.0001, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Global model norm: 15.486629502876829.
Norm before scaling: 15.968894763745734. Distance: 3.591357687090092
Total norm for 10 adversaries is: 15.968894763745734. distance: 3.591357687090092
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.1301, Accuracy: 8599/8968 (95.8854%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 29, internal_epoch   1,  Average loss: 0.0093, Accuracy: 407/506 (80.4348%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 29, internal_epoch   2,  Average loss: 0.0013, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 29, internal_epoch   3,  Average loss: 0.0005, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 29, internal_epoch   4,  Average loss: 0.0004, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 29, internal_epoch   5,  Average loss: 0.0003, Accuracy: 506/506 (100.0000%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 29, internal_epoch   6,  Average loss: 0.0004, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 29, internal_epoch   7,  Average loss: 0.0004, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 29, internal_epoch   8,  Average loss: 0.0003, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 29, internal_epoch   9,  Average loss: 0.0002, Accuracy: 506/506 (100.0000%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 29, internal_epoch  10,  Average loss: 0.0002, Accuracy: 506/506 (100.0000%), train_poison_data_count: 256
Global model norm: 15.486629502876829.
Norm before scaling: 15.812933271299734. Distance: 2.915292924980257
Total norm for 10 adversaries is: 15.812933271299734. distance: 2.915292924980257
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 1.2137, Accuracy: 5508/8968 (61.4184%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 62, internal_epoch   1,  Average loss: 0.0049, Accuracy: 521/580 (89.8276%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 62, internal_epoch   2,  Average loss: 0.0039, Accuracy: 541/580 (93.2759%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 62, internal_epoch   3,  Average loss: 0.0017, Accuracy: 566/580 (97.5862%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 62, internal_epoch   4,  Average loss: 0.0019, Accuracy: 564/580 (97.2414%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 62, internal_epoch   5,  Average loss: 0.0016, Accuracy: 564/580 (97.2414%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 62, internal_epoch   6,  Average loss: 0.0017, Accuracy: 564/580 (97.2414%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 62, internal_epoch   7,  Average loss: 0.0015, Accuracy: 569/580 (98.1034%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 62, internal_epoch   8,  Average loss: 0.0010, Accuracy: 568/580 (97.9310%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 62, internal_epoch   9,  Average loss: 0.0006, Accuracy: 574/580 (98.9655%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 62, internal_epoch  10,  Average loss: 0.0012, Accuracy: 569/580 (98.1034%), train_poison_data_count: 292
Global model norm: 15.486629502876829.
Norm before scaling: 15.660036889199647. Distance: 2.486790088968958
Total norm for 10 adversaries is: 15.660036889199647. distance: 2.486790088968958
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0151, Accuracy: 8926/8968 (99.5317%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 33, internal_epoch   1,  Average loss: 0.0114, Accuracy: 447/587 (76.1499%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 33, internal_epoch   2,  Average loss: 0.0017, Accuracy: 567/587 (96.5928%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 33, internal_epoch   3,  Average loss: 0.0007, Accuracy: 578/587 (98.4668%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 33, internal_epoch   4,  Average loss: 0.0007, Accuracy: 580/587 (98.8075%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 33, internal_epoch   5,  Average loss: 0.0005, Accuracy: 581/587 (98.9779%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 33, internal_epoch   6,  Average loss: 0.0005, Accuracy: 580/587 (98.8075%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 33, internal_epoch   7,  Average loss: 0.0005, Accuracy: 581/587 (98.9779%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 33, internal_epoch   8,  Average loss: 0.0004, Accuracy: 581/587 (98.9779%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 33, internal_epoch   9,  Average loss: 0.0004, Accuracy: 583/587 (99.3186%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 33, internal_epoch  10,  Average loss: 0.0003, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Global model norm: 15.486629502876829.
Norm before scaling: 15.872847283451986. Distance: 3.4870503508310513
Total norm for 10 adversaries is: 15.872847283451986. distance: 3.4870503508310513
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.8585, Accuracy: 6361/8968 (70.9300%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 88, internal_epoch   1,  Average loss: 0.0074, Accuracy: 621/734 (84.6049%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 88, internal_epoch   2,  Average loss: 0.0018, Accuracy: 708/734 (96.4578%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 88, internal_epoch   3,  Average loss: 0.0008, Accuracy: 723/734 (98.5014%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 88, internal_epoch   4,  Average loss: 0.0005, Accuracy: 725/734 (98.7738%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 88, internal_epoch   5,  Average loss: 0.0004, Accuracy: 730/734 (99.4550%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 88, internal_epoch   6,  Average loss: 0.0006, Accuracy: 724/734 (98.6376%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 88, internal_epoch   7,  Average loss: 0.0005, Accuracy: 727/734 (99.0463%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 88, internal_epoch   8,  Average loss: 0.0005, Accuracy: 730/734 (99.4550%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 88, internal_epoch   9,  Average loss: 0.0005, Accuracy: 729/734 (99.3188%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 88, internal_epoch  10,  Average loss: 0.0004, Accuracy: 725/734 (98.7738%), train_poison_data_count: 382
Global model norm: 15.486629502876829.
Norm before scaling: 15.834229507515662. Distance: 3.1993984968392337
Total norm for 10 adversaries is: 15.834229507515662. distance: 3.1993984968392337
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0540, Accuracy: 8816/8968 (98.3051%)
___Train Local_Simple,  epoch  51, local model 68, internal_epoch   1,  Average loss: 0.0012, Accuracy: 540/549 (98.3607%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 2.5131, Accuracy: 5417/10000 (54.1700%)
___Train Local_Simple,  epoch  51, local model 65, internal_epoch   1,  Average loss: 0.0013, Accuracy: 608/621 (97.9066%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 2.3018, Accuracy: 4017/10000 (40.1700%)
___Train Local_Simple,  epoch  51, local model 44, internal_epoch   1,  Average loss: 0.0004, Accuracy: 556/561 (99.1087%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.7462, Accuracy: 6963/10000 (69.6300%)
___Train Local_Simple,  epoch  51, local model 59, internal_epoch   1,  Average loss: 0.0010, Accuracy: 630/644 (97.8261%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.7350, Accuracy: 6051/10000 (60.5100%)
___Train Local_Simple,  epoch  51, local model 80, internal_epoch   1,  Average loss: 0.0014, Accuracy: 519/532 (97.5564%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 4.0457, Accuracy: 3452/10000 (34.5200%)
___Train Local_Simple,  epoch  51, local model 21, internal_epoch   1,  Average loss: 0.0004, Accuracy: 683/687 (99.4178%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.3808, Accuracy: 6586/10000 (65.8600%)
___Train Local_Simple,  epoch  51, local model 0, internal_epoch   1,  Average loss: 0.0008, Accuracy: 430/435 (98.8506%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.9519, Accuracy: 7439/10000 (74.3900%)
___Train Local_Simple,  epoch  51, local model 92, internal_epoch   1,  Average loss: 0.0017, Accuracy: 590/611 (96.5630%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 2.5378, Accuracy: 4671/10000 (46.7100%)
___Train Local_Simple,  epoch  51, local model 75, internal_epoch   1,  Average loss: 0.0007, Accuracy: 754/763 (98.8204%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 3.9512, Accuracy: 4347/10000 (43.4700%)
___Train Local_Simple,  epoch  51, local model 84, internal_epoch   1,  Average loss: 0.0010, Accuracy: 414/420 (98.5714%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.6833, Accuracy: 8051/10000 (80.5100%)
___Train Local_Simple,  epoch  51, local model 1, internal_epoch   1,  Average loss: 0.0003, Accuracy: 534/536 (99.6269%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.2422, Accuracy: 9200/10000 (92.0000%)
___Train Local_Simple,  epoch  51, local model 93, internal_epoch   1,  Average loss: 0.0014, Accuracy: 613/630 (97.3016%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 3.0557, Accuracy: 4536/10000 (45.3600%)
___Train Local_Simple,  epoch  51, local model 55, internal_epoch   1,  Average loss: 0.0010, Accuracy: 366/375 (97.6000%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.0975, Accuracy: 7083/10000 (70.8300%)
___Train Local_Simple,  epoch  51, local model 11, internal_epoch   1,  Average loss: 0.0006, Accuracy: 545/554 (98.3755%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.0468, Accuracy: 7519/10000 (75.1900%)
___Train Local_Simple,  epoch  51, local model 22, internal_epoch   1,  Average loss: 0.0007, Accuracy: 259/262 (98.8550%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.4819, Accuracy: 8643/10000 (86.4300%)
___Train Local_Simple,  epoch  51, local model 89, internal_epoch   1,  Average loss: 0.0010, Accuracy: 671/683 (98.2430%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 2.0928, Accuracy: 6120/10000 (61.2000%)
___Train Local_Simple,  epoch  51, local model 28, internal_epoch   1,  Average loss: 0.0006, Accuracy: 605/611 (99.0180%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.7282, Accuracy: 6667/10000 (66.6700%)
___Train Local_Simple,  epoch  51, local model 45, internal_epoch   1,  Average loss: 0.0008, Accuracy: 639/647 (98.7635%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 2.6468, Accuracy: 4490/10000 (44.9000%)
___Train Local_Simple,  epoch  51, local model 47, internal_epoch   1,  Average loss: 0.0007, Accuracy: 526/534 (98.5019%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.7716, Accuracy: 5699/10000 (56.9900%)
___Train Local_Simple,  epoch  51, local model 66, internal_epoch   1,  Average loss: 0.0016, Accuracy: 713/733 (97.2715%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 2.7157, Accuracy: 5802/10000 (58.0200%)
___Train Local_Simple,  epoch  51, local model 99, internal_epoch   1,  Average loss: 0.0025, Accuracy: 691/712 (97.0506%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.7623, Accuracy: 7771/10000 (77.7100%)
___Train Local_Simple,  epoch  51, local model 83, internal_epoch   1,  Average loss: 0.0012, Accuracy: 351/360 (97.5000%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.4527, Accuracy: 8598/10000 (85.9800%)
___Train Local_Simple,  epoch  51, local model 5, internal_epoch   1,  Average loss: 0.0008, Accuracy: 571/578 (98.7889%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.7637, Accuracy: 7804/10000 (78.0400%)
___Train Local_Simple,  epoch  51, local model 30, internal_epoch   1,  Average loss: 0.0010, Accuracy: 439/443 (99.0971%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.3802, Accuracy: 7339/10000 (73.3900%)
___Train Local_Simple,  epoch  51, local model 87, internal_epoch   1,  Average loss: 0.0006, Accuracy: 656/663 (98.9442%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 3.5490, Accuracy: 4778/10000 (47.7800%)
___Train Local_Simple,  epoch  51, local model 57, internal_epoch   1,  Average loss: 0.0007, Accuracy: 515/523 (98.4704%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.5332, Accuracy: 5996/10000 (59.9600%)
___Train Local_Simple,  epoch  51, local model 39, internal_epoch   1,  Average loss: 0.0008, Accuracy: 483/493 (97.9716%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.3406, Accuracy: 7161/10000 (71.6100%)
___Train Local_Simple,  epoch  51, local model 6, internal_epoch   1,  Average loss: 0.0009, Accuracy: 430/435 (98.8506%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.3956, Accuracy: 7181/10000 (71.8100%)
___Train Local_Simple,  epoch  51, local model 15, internal_epoch   1,  Average loss: 0.0007, Accuracy: 279/282 (98.9362%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.2968, Accuracy: 8978/10000 (89.7800%)
___Train Local_Simple,  epoch  51, local model 78, internal_epoch   1,  Average loss: 0.0017, Accuracy: 570/587 (97.1039%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 4.1890, Accuracy: 4439/10000 (44.3900%)
___Train Local_Simple,  epoch  51, local model 25, internal_epoch   1,  Average loss: 0.0004, Accuracy: 589/592 (99.4932%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.9059, Accuracy: 7362/10000 (73.6200%)
___Train Local_Simple,  epoch  51, local model 36, internal_epoch   1,  Average loss: 0.0005, Accuracy: 310/315 (98.4127%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.2627, Accuracy: 9175/10000 (91.7500%)
___Train Local_Simple,  epoch  51, local model 85, internal_epoch   1,  Average loss: 0.0010, Accuracy: 790/807 (97.8934%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 2.8967, Accuracy: 5793/10000 (57.9300%)
___Train Local_Simple,  epoch  51, local model 9, internal_epoch   1,  Average loss: 0.0008, Accuracy: 502/508 (98.8189%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.5572, Accuracy: 8170/10000 (81.7000%)
___Train Local_Simple,  epoch  51, local model 31, internal_epoch   1,  Average loss: 0.0006, Accuracy: 590/596 (98.9933%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.7967, Accuracy: 6037/10000 (60.3700%)
___Train Local_Simple,  epoch  51, local model 64, internal_epoch   1,  Average loss: 0.0004, Accuracy: 604/608 (99.3421%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.5212, Accuracy: 6861/10000 (68.6100%)
___Train Local_Simple,  epoch  51, local model 34, internal_epoch   1,  Average loss: 0.0008, Accuracy: 862/871 (98.9667%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 4.3381, Accuracy: 4123/10000 (41.2300%)
___Train Local_Simple,  epoch  51, local model 54, internal_epoch   1,  Average loss: 0.0007, Accuracy: 821/832 (98.6779%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 2.8250, Accuracy: 5560/10000 (55.6000%)
___Train Local_Simple,  epoch  51, local model 10, internal_epoch   1,  Average loss: 0.0008, Accuracy: 563/573 (98.2548%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 2.2460, Accuracy: 5161/10000 (51.6100%)
___Train Local_Simple,  epoch  51, local model 56, internal_epoch   1,  Average loss: 0.0004, Accuracy: 710/715 (99.3007%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.8757, Accuracy: 5823/10000 (58.2300%)
___Train Local_Simple,  epoch  51, local model 13, internal_epoch   1,  Average loss: 0.0010, Accuracy: 700/713 (98.1767%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 2.0610, Accuracy: 5971/10000 (59.7100%)
___Train Local_Simple,  epoch  51, local model 82, internal_epoch   1,  Average loss: 0.0005, Accuracy: 809/815 (99.2638%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 2.6754, Accuracy: 5357/10000 (53.5700%)
___Train Local_Simple,  epoch  51, local model 79, internal_epoch   1,  Average loss: 0.0010, Accuracy: 654/661 (98.9410%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 2.1356, Accuracy: 5348/10000 (53.4800%)
___Train Local_Simple,  epoch  51, local model 7, internal_epoch   1,  Average loss: 0.0004, Accuracy: 796/802 (99.2519%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.2186, Accuracy: 7225/10000 (72.2500%)
___Train Local_Simple,  epoch  51, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 778/789 (98.6058%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 2.9406, Accuracy: 5214/10000 (52.1400%)
___Train Local_Simple,  epoch  51, local model 96, internal_epoch   1,  Average loss: 0.0005, Accuracy: 528/531 (99.4350%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.9189, Accuracy: 6468/10000 (64.6800%)
___Train Local_Simple,  epoch  51, local model 97, internal_epoch   1,  Average loss: 0.0003, Accuracy: 1108/1112 (99.6403%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 2.6565, Accuracy: 4916/10000 (49.1600%)
___Train Local_Simple,  epoch  51, local model 72, internal_epoch   1,  Average loss: 0.0016, Accuracy: 411/423 (97.1631%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 3.1096, Accuracy: 4220/10000 (42.2000%)
___Train Local_Simple,  epoch  51, local model 76, internal_epoch   1,  Average loss: 0.0011, Accuracy: 451/459 (98.2571%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.7376, Accuracy: 8207/10000 (82.0700%)
___Train Local_Simple,  epoch  51, local model 43, internal_epoch   1,  Average loss: 0.0006, Accuracy: 425/431 (98.6079%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.6413, Accuracy: 8005/10000 (80.0500%)
___Train Local_Simple,  epoch  51, local model 16, internal_epoch   1,  Average loss: 0.0005, Accuracy: 813/817 (99.5104%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.6117, Accuracy: 6402/10000 (64.0200%)
___Train Local_Simple,  epoch  51, local model 77, internal_epoch   1,  Average loss: 0.0010, Accuracy: 605/618 (97.8964%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 2.4156, Accuracy: 5460/10000 (54.6000%)
___Train Local_Simple,  epoch  51, local model 32, internal_epoch   1,  Average loss: 0.0004, Accuracy: 587/590 (99.4915%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 2.1121, Accuracy: 6003/10000 (60.0300%)
___Train Local_Simple,  epoch  51, local model 8, internal_epoch   1,  Average loss: 0.0010, Accuracy: 697/706 (98.7252%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 3.9617, Accuracy: 4604/10000 (46.0400%)
___Train Local_Simple,  epoch  51, local model 2, internal_epoch   1,  Average loss: 0.0008, Accuracy: 558/564 (98.9362%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.9713, Accuracy: 7183/10000 (71.8300%)
___Train Local_Simple,  epoch  51, local model 61, internal_epoch   1,  Average loss: 0.0010, Accuracy: 281/287 (97.9094%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.2193, Accuracy: 9337/10000 (93.3700%)
___Train Local_Simple,  epoch  51, local model 4, internal_epoch   1,  Average loss: 0.0006, Accuracy: 736/748 (98.3957%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 2.7674, Accuracy: 4840/10000 (48.4000%)
___Train Local_Simple,  epoch  51, local model 58, internal_epoch   1,  Average loss: 0.0006, Accuracy: 763/772 (98.8342%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.8431, Accuracy: 6197/10000 (61.9700%)
___Train Local_Simple,  epoch  51, local model 19, internal_epoch   1,  Average loss: 0.0006, Accuracy: 593/598 (99.1639%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.9632, Accuracy: 5578/10000 (55.7800%)
___Train Local_Simple,  epoch  51, local model 42, internal_epoch   1,  Average loss: 0.0003, Accuracy: 471/473 (99.5772%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.4773, Accuracy: 8394/10000 (83.9400%)
___Train Local_Simple,  epoch  51, local model 12, internal_epoch   1,  Average loss: 0.0005, Accuracy: 720/725 (99.3103%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.9147, Accuracy: 6441/10000 (64.4100%)
___Train Local_Simple,  epoch  51, local model 98, internal_epoch   1,  Average loss: 0.0011, Accuracy: 538/548 (98.1752%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.6292, Accuracy: 6138/10000 (61.3800%)
___Train Local_Simple,  epoch  51, local model 94, internal_epoch   1,  Average loss: 0.0004, Accuracy: 667/671 (99.4039%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.6377, Accuracy: 6551/10000 (65.5100%)
___Train Local_Simple,  epoch  51, local model 24, internal_epoch   1,  Average loss: 0.0016, Accuracy: 468/477 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.1200, Accuracy: 6859/10000 (68.5900%)
___Train Local_Simple,  epoch  51, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 537/542 (99.0775%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.5180, Accuracy: 6388/10000 (63.8800%)
___Train Local_Simple,  epoch  51, local model 67, internal_epoch   1,  Average loss: 0.0013, Accuracy: 429/441 (97.2789%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.3093, Accuracy: 6494/10000 (64.9400%)
___Train Local_Simple,  epoch  51, local model 27, internal_epoch   1,  Average loss: 0.0006, Accuracy: 737/745 (98.9262%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.7056, Accuracy: 6126/10000 (61.2600%)
___Train Local_Simple,  epoch  51, local model 91, internal_epoch   1,  Average loss: 0.0004, Accuracy: 812/819 (99.1453%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 2.7791, Accuracy: 5159/10000 (51.5900%)
___Train Local_Simple,  epoch  51, local model 37, internal_epoch   1,  Average loss: 0.0006, Accuracy: 451/456 (98.9035%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.8688, Accuracy: 7489/10000 (74.8900%)
___Train Local_Simple,  epoch  51, local model 69, internal_epoch   1,  Average loss: 0.0017, Accuracy: 650/671 (96.8703%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.9728, Accuracy: 5680/10000 (56.8000%)
___Train Local_Simple,  epoch  51, local model 50, internal_epoch   1,  Average loss: 0.0008, Accuracy: 469/477 (98.3229%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.8124, Accuracy: 7445/10000 (74.4500%)
___Train Local_Simple,  epoch  51, local model 49, internal_epoch   1,  Average loss: 0.0009, Accuracy: 349/355 (98.3099%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.8340, Accuracy: 7322/10000 (73.2200%)
___Train Local_Simple,  epoch  51, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 544/561 (96.9697%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.4343, Accuracy: 6560/10000 (65.6000%)
___Train Local_Simple,  epoch  51, local model 38, internal_epoch   1,  Average loss: 0.0006, Accuracy: 470/477 (98.5325%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.5950, Accuracy: 8323/10000 (83.2300%)
___Train Local_Simple,  epoch  51, local model 81, internal_epoch   1,  Average loss: 0.0009, Accuracy: 630/636 (99.0566%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.9583, Accuracy: 5790/10000 (57.9000%)
___Train Local_Simple,  epoch  51, local model 40, internal_epoch   1,  Average loss: 0.0004, Accuracy: 494/498 (99.1968%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.6905, Accuracy: 6472/10000 (64.7200%)
___Train Local_Simple,  epoch  51, local model 90, internal_epoch   1,  Average loss: 0.0012, Accuracy: 601/615 (97.7236%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.3021, Accuracy: 7089/10000 (70.8900%)
___Train Local_Simple,  epoch  51, local model 60, internal_epoch   1,  Average loss: 0.0010, Accuracy: 559/571 (97.8984%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 3.5118, Accuracy: 3533/10000 (35.3300%)
___Train Local_Simple,  epoch  51, local model 53, internal_epoch   1,  Average loss: 0.0007, Accuracy: 556/561 (99.1087%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 2.0337, Accuracy: 6477/10000 (64.7700%)
___Train Local_Simple,  epoch  51, local model 95, internal_epoch   1,  Average loss: 0.0013, Accuracy: 589/600 (98.1667%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.7911, Accuracy: 6507/10000 (65.0700%)
___Train Local_Simple,  epoch  51, local model 26, internal_epoch   1,  Average loss: 0.0010, Accuracy: 510/519 (98.2659%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.3683, Accuracy: 6349/10000 (63.4900%)
___Train Local_Simple,  epoch  51, local model 35, internal_epoch   1,  Average loss: 0.0008, Accuracy: 620/630 (98.4127%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 3.4858, Accuracy: 4857/10000 (48.5700%)
___Train Local_Simple,  epoch  51, local model 17, internal_epoch   1,  Average loss: 0.0007, Accuracy: 520/527 (98.6717%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.6466, Accuracy: 6265/10000 (62.6500%)
___Train Local_Simple,  epoch  51, local model 48, internal_epoch   1,  Average loss: 0.0011, Accuracy: 357/363 (98.3471%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.4395, Accuracy: 8579/10000 (85.7900%)
___Train Local_Simple,  epoch  51, local model 86, internal_epoch   1,  Average loss: 0.0005, Accuracy: 687/692 (99.2775%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 2.6594, Accuracy: 4960/10000 (49.6000%)
___Train Local_Simple,  epoch  51, local model 20, internal_epoch   1,  Average loss: 0.0008, Accuracy: 593/602 (98.5050%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.9575, Accuracy: 6103/10000 (61.0300%)
___Train Local_Simple,  epoch  51, local model 46, internal_epoch   1,  Average loss: 0.0008, Accuracy: 640/650 (98.4615%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 2.5842, Accuracy: 5529/10000 (55.2900%)
___Train Local_Simple,  epoch  51, local model 14, internal_epoch   1,  Average loss: 0.0009, Accuracy: 678/692 (97.9769%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 2.2806, Accuracy: 5297/10000 (52.9700%)
___Train Local_Simple,  epoch  51, local model 70, internal_epoch   1,  Average loss: 0.0012, Accuracy: 557/568 (98.0634%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 2.2541, Accuracy: 5271/10000 (52.7100%)
___Train Local_Simple,  epoch  51, local model 63, internal_epoch   1,  Average loss: 0.0012, Accuracy: 296/303 (97.6898%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.1142, Accuracy: 7231/10000 (72.3100%)
time spent on training: 375.21261501312256
___Test Target_Simple poisoned: False, epoch: 51: Average loss: 0.1014, Accuracy: 9713/10000 (97.1300%)
___Test Target_Simple poisoned: True, epoch: 51: Average loss: 2.9016, Accuracy: 2491/8968 (27.7765%)
saving model
Done in 407.88382840156555 sec.
Server Epoch:52 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 59, 19, 12, 43, 4, 14, 90, 28, 2, 48, 70, 45, 8, 50, 89, 0, 5, 37, 23, 46, 96, 61, 92, 53, 24, 40, 60, 30, 86, 66, 6, 47, 38, 99, 1, 80, 77, 95, 27, 22, 15, 31, 54, 72, 39, 26, 97, 68, 21, 75, 65, 32, 44, 34, 10, 64, 82, 76, 85, 57, 42, 52, 36, 16, 7, 71, 11, 20, 58, 81, 94, 25, 93, 87, 63, 17, 35, 91, 55, 67, 56, 78, 13, 84, 79, 9, 98, 83, 69, 49].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   1,  Average loss: 0.0157, Accuracy: 384/569 (67.4868%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   2,  Average loss: 0.0027, Accuracy: 558/569 (98.0668%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   3,  Average loss: 0.0007, Accuracy: 565/569 (99.2970%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   4,  Average loss: 0.0007, Accuracy: 564/569 (99.1213%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   5,  Average loss: 0.0006, Accuracy: 565/569 (99.2970%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   6,  Average loss: 0.0004, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   7,  Average loss: 0.0007, Accuracy: 563/569 (98.9455%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   8,  Average loss: 0.0004, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch   9,  Average loss: 0.0003, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 41, internal_epoch  10,  Average loss: 0.0005, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Global model norm: 15.49627296184498.
Norm before scaling: 15.856747684930687. Distance: 3.8546772524137323
Total norm for 10 adversaries is: 15.856747684930687. distance: 3.8546772524137323
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 1.3387, Accuracy: 5388/8968 (60.0803%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   1,  Average loss: 0.0056, Accuracy: 457/522 (87.5479%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   2,  Average loss: 0.0013, Accuracy: 511/522 (97.8927%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   3,  Average loss: 0.0005, Accuracy: 517/522 (99.0421%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   4,  Average loss: 0.0006, Accuracy: 516/522 (98.8506%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   5,  Average loss: 0.0003, Accuracy: 522/522 (100.0000%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   6,  Average loss: 0.0003, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   7,  Average loss: 0.0002, Accuracy: 522/522 (100.0000%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   8,  Average loss: 0.0002, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   9,  Average loss: 0.0003, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Global model norm: 15.49627296184498.
Norm before scaling: 15.711855276835845. Distance: 2.277864949437248
Total norm for 10 adversaries is: 15.711855276835845. distance: 2.277864949437248
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0174, Accuracy: 8905/8968 (99.2975%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   1,  Average loss: 0.0119, Accuracy: 278/385 (72.2078%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   2,  Average loss: 0.0021, Accuracy: 372/385 (96.6234%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   3,  Average loss: 0.0014, Accuracy: 373/385 (96.8831%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   4,  Average loss: 0.0011, Accuracy: 376/385 (97.6623%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   5,  Average loss: 0.0008, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   6,  Average loss: 0.0009, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   7,  Average loss: 0.0008, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   8,  Average loss: 0.0007, Accuracy: 381/385 (98.9610%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch   9,  Average loss: 0.0006, Accuracy: 381/385 (98.9610%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 51, internal_epoch  10,  Average loss: 0.0006, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Global model norm: 15.49627296184498.
Norm before scaling: 15.750923250779719. Distance: 2.6204067188263567
Total norm for 10 adversaries is: 15.750923250779719. distance: 2.6204067188263567
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.3031, Accuracy: 7839/8968 (87.4108%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   1,  Average loss: 0.0046, Accuracy: 570/627 (90.9091%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   2,  Average loss: 0.0014, Accuracy: 612/627 (97.6077%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   3,  Average loss: 0.0011, Accuracy: 616/627 (98.2456%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   4,  Average loss: 0.0008, Accuracy: 620/627 (98.8836%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   5,  Average loss: 0.0008, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   6,  Average loss: 0.0007, Accuracy: 620/627 (98.8836%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   7,  Average loss: 0.0006, Accuracy: 621/627 (99.0431%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   8,  Average loss: 0.0006, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch   9,  Average loss: 0.0006, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 74, internal_epoch  10,  Average loss: 0.0007, Accuracy: 620/627 (98.8836%), train_poison_data_count: 320
Global model norm: 15.49627296184498.
Norm before scaling: 15.650692743441402. Distance: 2.191487084732102
Total norm for 10 adversaries is: 15.650692743441402. distance: 2.191487084732102
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0059, Accuracy: 8943/8968 (99.7212%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 3, internal_epoch   1,  Average loss: 0.0140, Accuracy: 383/516 (74.2248%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 3, internal_epoch   2,  Average loss: 0.0023, Accuracy: 502/516 (97.2868%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 3, internal_epoch   3,  Average loss: 0.0008, Accuracy: 509/516 (98.6434%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 3, internal_epoch   4,  Average loss: 0.0004, Accuracy: 513/516 (99.4186%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 3, internal_epoch   5,  Average loss: 0.0004, Accuracy: 511/516 (99.0310%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 3, internal_epoch   6,  Average loss: 0.0002, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 3, internal_epoch   7,  Average loss: 0.0003, Accuracy: 513/516 (99.4186%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 3, internal_epoch   8,  Average loss: 0.0002, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 3, internal_epoch   9,  Average loss: 0.0001, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 3, internal_epoch  10,  Average loss: 0.0001, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Global model norm: 15.49627296184498.
Norm before scaling: 15.884768866999854. Distance: 3.646395714391489
Total norm for 10 adversaries is: 15.884768866999854. distance: 3.646395714391489
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.5964, Accuracy: 7751/8968 (86.4295%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 18, internal_epoch   1,  Average loss: 0.0080, Accuracy: 648/759 (85.3755%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 18, internal_epoch   2,  Average loss: 0.0011, Accuracy: 742/759 (97.7602%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 18, internal_epoch   3,  Average loss: 0.0004, Accuracy: 754/759 (99.3412%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 18, internal_epoch   4,  Average loss: 0.0004, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 18, internal_epoch   5,  Average loss: 0.0002, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 18, internal_epoch   6,  Average loss: 0.0002, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 18, internal_epoch   7,  Average loss: 0.0002, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 18, internal_epoch   8,  Average loss: 0.0003, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 18, internal_epoch   9,  Average loss: 0.0002, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 18, internal_epoch  10,  Average loss: 0.0002, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Global model norm: 15.49627296184498.
Norm before scaling: 16.011718273511825. Distance: 3.797809124859324
Total norm for 10 adversaries is: 16.011718273511825. distance: 3.797809124859324
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0610, Accuracy: 8773/8968 (97.8256%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 29, internal_epoch   1,  Average loss: 0.0083, Accuracy: 417/506 (82.4111%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 29, internal_epoch   2,  Average loss: 0.0013, Accuracy: 495/506 (97.8261%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 29, internal_epoch   3,  Average loss: 0.0004, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 29, internal_epoch   4,  Average loss: 0.0006, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 29, internal_epoch   5,  Average loss: 0.0004, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 29, internal_epoch   6,  Average loss: 0.0004, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 29, internal_epoch   7,  Average loss: 0.0002, Accuracy: 506/506 (100.0000%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 29, internal_epoch   8,  Average loss: 0.0003, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 29, internal_epoch   9,  Average loss: 0.0004, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 29, internal_epoch  10,  Average loss: 0.0002, Accuracy: 506/506 (100.0000%), train_poison_data_count: 256
Global model norm: 15.49627296184498.
Norm before scaling: 15.775318927231213. Distance: 2.6684768215328583
Total norm for 10 adversaries is: 15.775318927231213. distance: 2.6684768215328583
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.2675, Accuracy: 7992/8968 (89.1169%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 62, internal_epoch   1,  Average loss: 0.0041, Accuracy: 527/580 (90.8621%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 62, internal_epoch   2,  Average loss: 0.0013, Accuracy: 565/580 (97.4138%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 62, internal_epoch   3,  Average loss: 0.0008, Accuracy: 571/580 (98.4483%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 62, internal_epoch   4,  Average loss: 0.0004, Accuracy: 575/580 (99.1379%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 62, internal_epoch   5,  Average loss: 0.0009, Accuracy: 570/580 (98.2759%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 62, internal_epoch   6,  Average loss: 0.0005, Accuracy: 575/580 (99.1379%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 62, internal_epoch   7,  Average loss: 0.0004, Accuracy: 576/580 (99.3103%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 62, internal_epoch   8,  Average loss: 0.0006, Accuracy: 572/580 (98.6207%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 62, internal_epoch   9,  Average loss: 0.0004, Accuracy: 574/580 (98.9655%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 62, internal_epoch  10,  Average loss: 0.0005, Accuracy: 575/580 (99.1379%), train_poison_data_count: 292
Global model norm: 15.49627296184498.
Norm before scaling: 15.573197820500623. Distance: 1.6789574034412518
Total norm for 10 adversaries is: 15.573197820500623. distance: 1.6789574034412518
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0292, Accuracy: 8863/8968 (98.8292%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 33, internal_epoch   1,  Average loss: 0.0139, Accuracy: 415/587 (70.6985%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 33, internal_epoch   2,  Average loss: 0.0028, Accuracy: 569/587 (96.9336%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 33, internal_epoch   3,  Average loss: 0.0008, Accuracy: 576/587 (98.1261%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 33, internal_epoch   4,  Average loss: 0.0007, Accuracy: 581/587 (98.9779%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 33, internal_epoch   5,  Average loss: 0.0005, Accuracy: 581/587 (98.9779%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 33, internal_epoch   6,  Average loss: 0.0006, Accuracy: 581/587 (98.9779%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 33, internal_epoch   7,  Average loss: 0.0006, Accuracy: 581/587 (98.9779%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 33, internal_epoch   8,  Average loss: 0.0004, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 33, internal_epoch   9,  Average loss: 0.0004, Accuracy: 585/587 (99.6593%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 33, internal_epoch  10,  Average loss: 0.0005, Accuracy: 582/587 (99.1482%), train_poison_data_count: 299
Global model norm: 15.49627296184498.
Norm before scaling: 15.934790766203845. Distance: 3.735536147400091
Total norm for 10 adversaries is: 15.934790766203845. distance: 3.735536147400091
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 1.3154, Accuracy: 4935/8968 (55.0290%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 88, internal_epoch   1,  Average loss: 0.0057, Accuracy: 646/734 (88.0109%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 88, internal_epoch   2,  Average loss: 0.0015, Accuracy: 712/734 (97.0027%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 88, internal_epoch   3,  Average loss: 0.0007, Accuracy: 723/734 (98.5014%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 88, internal_epoch   4,  Average loss: 0.0005, Accuracy: 726/734 (98.9101%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 88, internal_epoch   5,  Average loss: 0.0004, Accuracy: 729/734 (99.3188%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 88, internal_epoch   6,  Average loss: 0.0004, Accuracy: 727/734 (99.0463%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 88, internal_epoch   7,  Average loss: 0.0004, Accuracy: 728/734 (99.1826%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 88, internal_epoch   8,  Average loss: 0.0002, Accuracy: 733/734 (99.8638%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 88, internal_epoch   9,  Average loss: 0.0002, Accuracy: 732/734 (99.7275%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 88, internal_epoch  10,  Average loss: 0.0003, Accuracy: 730/734 (99.4550%), train_poison_data_count: 382
Global model norm: 15.49627296184498.
Norm before scaling: 15.790737691779505. Distance: 2.7753945766047696
Total norm for 10 adversaries is: 15.790737691779505. distance: 2.7753945766047696
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0667, Accuracy: 8767/8968 (97.7587%)
___Train Local_Simple,  epoch  52, local model 59, internal_epoch   1,  Average loss: 0.0008, Accuracy: 636/644 (98.7578%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.0220, Accuracy: 7471/10000 (74.7100%)
___Train Local_Simple,  epoch  52, local model 19, internal_epoch   1,  Average loss: 0.0010, Accuracy: 594/598 (99.3311%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.5426, Accuracy: 5794/10000 (57.9400%)
___Train Local_Simple,  epoch  52, local model 12, internal_epoch   1,  Average loss: 0.0005, Accuracy: 719/725 (99.1724%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.9586, Accuracy: 6500/10000 (65.0000%)
___Train Local_Simple,  epoch  52, local model 43, internal_epoch   1,  Average loss: 0.0006, Accuracy: 428/431 (99.3039%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.6085, Accuracy: 7985/10000 (79.8500%)
___Train Local_Simple,  epoch  52, local model 4, internal_epoch   1,  Average loss: 0.0004, Accuracy: 742/748 (99.1979%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.6257, Accuracy: 6077/10000 (60.7700%)
___Train Local_Simple,  epoch  52, local model 14, internal_epoch   1,  Average loss: 0.0010, Accuracy: 681/692 (98.4104%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.7945, Accuracy: 7714/10000 (77.1400%)
___Train Local_Simple,  epoch  52, local model 90, internal_epoch   1,  Average loss: 0.0013, Accuracy: 597/615 (97.0732%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 4.6532, Accuracy: 3598/10000 (35.9800%)
___Train Local_Simple,  epoch  52, local model 28, internal_epoch   1,  Average loss: 0.0006, Accuracy: 604/611 (98.8543%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.2377, Accuracy: 7238/10000 (72.3800%)
___Train Local_Simple,  epoch  52, local model 2, internal_epoch   1,  Average loss: 0.0007, Accuracy: 557/564 (98.7589%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.2635, Accuracy: 6372/10000 (63.7200%)
___Train Local_Simple,  epoch  52, local model 48, internal_epoch   1,  Average loss: 0.0009, Accuracy: 357/363 (98.3471%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.3006, Accuracy: 9000/10000 (90.0000%)
___Train Local_Simple,  epoch  52, local model 70, internal_epoch   1,  Average loss: 0.0011, Accuracy: 558/568 (98.2394%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 2.6193, Accuracy: 4347/10000 (43.4700%)
___Train Local_Simple,  epoch  52, local model 45, internal_epoch   1,  Average loss: 0.0006, Accuracy: 641/647 (99.0726%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.7963, Accuracy: 5712/10000 (57.1200%)
___Train Local_Simple,  epoch  52, local model 8, internal_epoch   1,  Average loss: 0.0007, Accuracy: 694/706 (98.3003%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 2.7248, Accuracy: 4825/10000 (48.2500%)
___Train Local_Simple,  epoch  52, local model 50, internal_epoch   1,  Average loss: 0.0010, Accuracy: 469/477 (98.3229%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.7888, Accuracy: 7471/10000 (74.7100%)
___Train Local_Simple,  epoch  52, local model 89, internal_epoch   1,  Average loss: 0.0012, Accuracy: 666/683 (97.5110%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 3.1900, Accuracy: 4735/10000 (47.3500%)
___Train Local_Simple,  epoch  52, local model 0, internal_epoch   1,  Average loss: 0.0005, Accuracy: 433/435 (99.5402%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.8930, Accuracy: 7577/10000 (75.7700%)
___Train Local_Simple,  epoch  52, local model 5, internal_epoch   1,  Average loss: 0.0006, Accuracy: 570/578 (98.6159%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.7081, Accuracy: 8085/10000 (80.8500%)
___Train Local_Simple,  epoch  52, local model 37, internal_epoch   1,  Average loss: 0.0006, Accuracy: 451/456 (98.9035%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.1791, Accuracy: 7106/10000 (71.0600%)
___Train Local_Simple,  epoch  52, local model 23, internal_epoch   1,  Average loss: 0.0009, Accuracy: 530/542 (97.7860%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.6213, Accuracy: 7984/10000 (79.8400%)
___Train Local_Simple,  epoch  52, local model 46, internal_epoch   1,  Average loss: 0.0005, Accuracy: 644/650 (99.0769%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 2.3131, Accuracy: 5640/10000 (56.4000%)
___Train Local_Simple,  epoch  52, local model 96, internal_epoch   1,  Average loss: 0.0007, Accuracy: 523/531 (98.4934%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 4.7056, Accuracy: 3714/10000 (37.1400%)
___Train Local_Simple,  epoch  52, local model 61, internal_epoch   1,  Average loss: 0.0010, Accuracy: 285/287 (99.3031%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1563, Accuracy: 9543/10000 (95.4300%)
___Train Local_Simple,  epoch  52, local model 92, internal_epoch   1,  Average loss: 0.0023, Accuracy: 586/611 (95.9083%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 6.9282, Accuracy: 2268/10000 (22.6800%)
___Train Local_Simple,  epoch  52, local model 53, internal_epoch   1,  Average loss: 0.0005, Accuracy: 555/561 (98.9305%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.4149, Accuracy: 7038/10000 (70.3800%)
___Train Local_Simple,  epoch  52, local model 24, internal_epoch   1,  Average loss: 0.0014, Accuracy: 468/477 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.8893, Accuracy: 7042/10000 (70.4200%)
___Train Local_Simple,  epoch  52, local model 40, internal_epoch   1,  Average loss: 0.0005, Accuracy: 494/498 (99.1968%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.9252, Accuracy: 6229/10000 (62.2900%)
___Train Local_Simple,  epoch  52, local model 60, internal_epoch   1,  Average loss: 0.0012, Accuracy: 557/571 (97.5482%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 2.5526, Accuracy: 5014/10000 (50.1400%)
___Train Local_Simple,  epoch  52, local model 30, internal_epoch   1,  Average loss: 0.0008, Accuracy: 437/443 (98.6456%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.6688, Accuracy: 7891/10000 (78.9100%)
___Train Local_Simple,  epoch  52, local model 86, internal_epoch   1,  Average loss: 0.0006, Accuracy: 683/692 (98.6994%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 3.5862, Accuracy: 4449/10000 (44.4900%)
___Train Local_Simple,  epoch  52, local model 66, internal_epoch   1,  Average loss: 0.0012, Accuracy: 715/733 (97.5443%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 5.0821, Accuracy: 3101/10000 (31.0100%)
___Train Local_Simple,  epoch  52, local model 6, internal_epoch   1,  Average loss: 0.0007, Accuracy: 429/435 (98.6207%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.7479, Accuracy: 7864/10000 (78.6400%)
___Train Local_Simple,  epoch  52, local model 47, internal_epoch   1,  Average loss: 0.0008, Accuracy: 526/534 (98.5019%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 2.4440, Accuracy: 5270/10000 (52.7000%)
___Train Local_Simple,  epoch  52, local model 38, internal_epoch   1,  Average loss: 0.0008, Accuracy: 470/477 (98.5325%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.2493, Accuracy: 9196/10000 (91.9600%)
___Train Local_Simple,  epoch  52, local model 99, internal_epoch   1,  Average loss: 0.0016, Accuracy: 687/712 (96.4888%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 4.2234, Accuracy: 3247/10000 (32.4700%)
___Train Local_Simple,  epoch  52, local model 1, internal_epoch   1,  Average loss: 0.0003, Accuracy: 535/536 (99.8134%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1804, Accuracy: 9407/10000 (94.0700%)
___Train Local_Simple,  epoch  52, local model 80, internal_epoch   1,  Average loss: 0.0018, Accuracy: 519/532 (97.5564%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 4.4767, Accuracy: 3118/10000 (31.1800%)
___Train Local_Simple,  epoch  52, local model 77, internal_epoch   1,  Average loss: 0.0012, Accuracy: 603/618 (97.5728%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 2.9718, Accuracy: 4821/10000 (48.2100%)
___Train Local_Simple,  epoch  52, local model 95, internal_epoch   1,  Average loss: 0.0017, Accuracy: 579/600 (96.5000%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 4.0254, Accuracy: 3863/10000 (38.6300%)
___Train Local_Simple,  epoch  52, local model 27, internal_epoch   1,  Average loss: 0.0005, Accuracy: 739/745 (99.1946%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 4.2283, Accuracy: 4208/10000 (42.0800%)
___Train Local_Simple,  epoch  52, local model 22, internal_epoch   1,  Average loss: 0.0004, Accuracy: 260/262 (99.2366%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.2525, Accuracy: 9140/10000 (91.4000%)
___Train Local_Simple,  epoch  52, local model 15, internal_epoch   1,  Average loss: 0.0006, Accuracy: 281/282 (99.6454%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.2335, Accuracy: 9181/10000 (91.8100%)
___Train Local_Simple,  epoch  52, local model 31, internal_epoch   1,  Average loss: 0.0005, Accuracy: 590/596 (98.9933%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.0677, Accuracy: 6904/10000 (69.0400%)
___Train Local_Simple,  epoch  52, local model 54, internal_epoch   1,  Average loss: 0.0004, Accuracy: 826/832 (99.2788%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 3.3332, Accuracy: 5350/10000 (53.5000%)
___Train Local_Simple,  epoch  52, local model 72, internal_epoch   1,  Average loss: 0.0016, Accuracy: 409/423 (96.6903%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 3.3027, Accuracy: 3293/10000 (32.9300%)
___Train Local_Simple,  epoch  52, local model 39, internal_epoch   1,  Average loss: 0.0008, Accuracy: 487/493 (98.7830%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.6328, Accuracy: 8100/10000 (81.0000%)
___Train Local_Simple,  epoch  52, local model 26, internal_epoch   1,  Average loss: 0.0009, Accuracy: 511/519 (98.4586%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 2.3393, Accuracy: 5230/10000 (52.3000%)
___Train Local_Simple,  epoch  52, local model 97, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1104/1112 (99.2806%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 4.6818, Accuracy: 3937/10000 (39.3700%)
___Train Local_Simple,  epoch  52, local model 68, internal_epoch   1,  Average loss: 0.0012, Accuracy: 539/549 (98.1785%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 2.6960, Accuracy: 4414/10000 (44.1400%)
___Train Local_Simple,  epoch  52, local model 21, internal_epoch   1,  Average loss: 0.0003, Accuracy: 686/687 (99.8544%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.7167, Accuracy: 6443/10000 (64.4300%)
___Train Local_Simple,  epoch  52, local model 75, internal_epoch   1,  Average loss: 0.0009, Accuracy: 748/763 (98.0341%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 4.3121, Accuracy: 3717/10000 (37.1700%)
___Train Local_Simple,  epoch  52, local model 65, internal_epoch   1,  Average loss: 0.0018, Accuracy: 599/621 (96.4573%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.4988, Accuracy: 5387/10000 (53.8700%)
___Train Local_Simple,  epoch  52, local model 32, internal_epoch   1,  Average loss: 0.0005, Accuracy: 585/590 (99.1525%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.9734, Accuracy: 6013/10000 (60.1300%)
___Train Local_Simple,  epoch  52, local model 44, internal_epoch   1,  Average loss: 0.0002, Accuracy: 558/561 (99.4652%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.7531, Accuracy: 7979/10000 (79.7900%)
___Train Local_Simple,  epoch  52, local model 34, internal_epoch   1,  Average loss: 0.0008, Accuracy: 857/871 (98.3927%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 2.6861, Accuracy: 5323/10000 (53.2300%)
___Train Local_Simple,  epoch  52, local model 10, internal_epoch   1,  Average loss: 0.0013, Accuracy: 558/573 (97.3822%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.6216, Accuracy: 6217/10000 (62.1700%)
___Train Local_Simple,  epoch  52, local model 64, internal_epoch   1,  Average loss: 0.0004, Accuracy: 604/608 (99.3421%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 2.4058, Accuracy: 5529/10000 (55.2900%)
___Train Local_Simple,  epoch  52, local model 82, internal_epoch   1,  Average loss: 0.0006, Accuracy: 806/815 (98.8957%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 2.9940, Accuracy: 4967/10000 (49.6700%)
___Train Local_Simple,  epoch  52, local model 76, internal_epoch   1,  Average loss: 0.0010, Accuracy: 455/459 (99.1285%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.3837, Accuracy: 8814/10000 (88.1400%)
___Train Local_Simple,  epoch  52, local model 85, internal_epoch   1,  Average loss: 0.0012, Accuracy: 781/807 (96.7782%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 3.4451, Accuracy: 4676/10000 (46.7600%)
___Train Local_Simple,  epoch  52, local model 57, internal_epoch   1,  Average loss: 0.0009, Accuracy: 516/523 (98.6616%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 2.3440, Accuracy: 4869/10000 (48.6900%)
___Train Local_Simple,  epoch  52, local model 42, internal_epoch   1,  Average loss: 0.0002, Accuracy: 473/473 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.3433, Accuracy: 8752/10000 (87.5200%)
___Train Local_Simple,  epoch  52, local model 52, internal_epoch   1,  Average loss: 0.0012, Accuracy: 773/789 (97.9721%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 2.6310, Accuracy: 5284/10000 (52.8400%)
___Train Local_Simple,  epoch  52, local model 36, internal_epoch   1,  Average loss: 0.0006, Accuracy: 310/315 (98.4127%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1530, Accuracy: 9488/10000 (94.8800%)
___Train Local_Simple,  epoch  52, local model 16, internal_epoch   1,  Average loss: 0.0002, Accuracy: 815/817 (99.7552%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.4628, Accuracy: 7304/10000 (73.0400%)
___Train Local_Simple,  epoch  52, local model 7, internal_epoch   1,  Average loss: 0.0005, Accuracy: 795/802 (99.1272%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.6399, Accuracy: 6310/10000 (63.1000%)
___Train Local_Simple,  epoch  52, local model 71, internal_epoch   1,  Average loss: 0.0011, Accuracy: 550/561 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.0171, Accuracy: 7091/10000 (70.9100%)
___Train Local_Simple,  epoch  52, local model 11, internal_epoch   1,  Average loss: 0.0005, Accuracy: 549/554 (99.0975%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.2400, Accuracy: 7084/10000 (70.8400%)
___Train Local_Simple,  epoch  52, local model 20, internal_epoch   1,  Average loss: 0.0007, Accuracy: 594/602 (98.6711%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 2.7389, Accuracy: 5400/10000 (54.0000%)
___Train Local_Simple,  epoch  52, local model 58, internal_epoch   1,  Average loss: 0.0009, Accuracy: 758/772 (98.1865%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.5146, Accuracy: 6166/10000 (61.6600%)
___Train Local_Simple,  epoch  52, local model 81, internal_epoch   1,  Average loss: 0.0010, Accuracy: 621/636 (97.6415%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 3.1209, Accuracy: 4485/10000 (44.8500%)
___Train Local_Simple,  epoch  52, local model 94, internal_epoch   1,  Average loss: 0.0006, Accuracy: 665/671 (99.1058%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 3.4132, Accuracy: 5757/10000 (57.5700%)
___Train Local_Simple,  epoch  52, local model 25, internal_epoch   1,  Average loss: 0.0002, Accuracy: 591/592 (99.8311%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.2776, Accuracy: 7480/10000 (74.8000%)
___Train Local_Simple,  epoch  52, local model 93, internal_epoch   1,  Average loss: 0.0012, Accuracy: 614/630 (97.4603%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 2.4328, Accuracy: 4881/10000 (48.8100%)
___Train Local_Simple,  epoch  52, local model 87, internal_epoch   1,  Average loss: 0.0006, Accuracy: 652/663 (98.3409%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 4.1862, Accuracy: 4144/10000 (41.4400%)
___Train Local_Simple,  epoch  52, local model 63, internal_epoch   1,  Average loss: 0.0013, Accuracy: 294/303 (97.0297%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 2.6397, Accuracy: 5068/10000 (50.6800%)
___Train Local_Simple,  epoch  52, local model 17, internal_epoch   1,  Average loss: 0.0005, Accuracy: 522/527 (99.0512%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.1158, Accuracy: 6851/10000 (68.5100%)
___Train Local_Simple,  epoch  52, local model 35, internal_epoch   1,  Average loss: 0.0008, Accuracy: 620/630 (98.4127%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.8544, Accuracy: 6101/10000 (61.0100%)
___Train Local_Simple,  epoch  52, local model 91, internal_epoch   1,  Average loss: 0.0004, Accuracy: 815/819 (99.5116%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 2.2181, Accuracy: 5228/10000 (52.2800%)
___Train Local_Simple,  epoch  52, local model 55, internal_epoch   1,  Average loss: 0.0013, Accuracy: 366/375 (97.6000%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.4504, Accuracy: 8372/10000 (83.7200%)
___Train Local_Simple,  epoch  52, local model 67, internal_epoch   1,  Average loss: 0.0015, Accuracy: 429/441 (97.2789%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.0778, Accuracy: 6783/10000 (67.8300%)
___Train Local_Simple,  epoch  52, local model 56, internal_epoch   1,  Average loss: 0.0004, Accuracy: 707/715 (98.8811%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 2.1454, Accuracy: 5343/10000 (53.4300%)
___Train Local_Simple,  epoch  52, local model 78, internal_epoch   1,  Average loss: 0.0015, Accuracy: 574/587 (97.7853%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 3.4666, Accuracy: 4675/10000 (46.7500%)
___Train Local_Simple,  epoch  52, local model 13, internal_epoch   1,  Average loss: 0.0006, Accuracy: 703/713 (98.5975%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 2.3716, Accuracy: 5623/10000 (56.2300%)
___Train Local_Simple,  epoch  52, local model 84, internal_epoch   1,  Average loss: 0.0008, Accuracy: 412/420 (98.0952%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.7778, Accuracy: 8286/10000 (82.8600%)
___Train Local_Simple,  epoch  52, local model 79, internal_epoch   1,  Average loss: 0.0008, Accuracy: 656/661 (99.2436%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.3364, Accuracy: 6243/10000 (62.4300%)
___Train Local_Simple,  epoch  52, local model 9, internal_epoch   1,  Average loss: 0.0011, Accuracy: 500/508 (98.4252%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.9616, Accuracy: 7152/10000 (71.5200%)
___Train Local_Simple,  epoch  52, local model 98, internal_epoch   1,  Average loss: 0.0014, Accuracy: 533/548 (97.2628%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 4.5873, Accuracy: 3810/10000 (38.1000%)
___Train Local_Simple,  epoch  52, local model 83, internal_epoch   1,  Average loss: 0.0015, Accuracy: 348/360 (96.6667%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.3137, Accuracy: 9019/10000 (90.1900%)
___Train Local_Simple,  epoch  52, local model 69, internal_epoch   1,  Average loss: 0.0012, Accuracy: 661/671 (98.5097%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 4.5488, Accuracy: 3757/10000 (37.5700%)
___Train Local_Simple,  epoch  52, local model 49, internal_epoch   1,  Average loss: 0.0012, Accuracy: 348/355 (98.0282%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.7328, Accuracy: 5691/10000 (56.9100%)
time spent on training: 372.3179371356964
___Test Target_Simple poisoned: False, epoch: 52: Average loss: 0.0917, Accuracy: 9734/10000 (97.3400%)
___Test Target_Simple poisoned: True, epoch: 52: Average loss: 2.7195, Accuracy: 3107/8968 (34.6454%)
saving model
Done in 405.43884563446045 sec.
Server Epoch:53 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 4, 75, 43, 80, 1, 31, 16, 36, 94, 10, 92, 67, 93, 57, 98, 72, 27, 97, 87, 15, 17, 23, 55, 46, 54, 76, 19, 20, 99, 37, 96, 14, 66, 53, 82, 25, 70, 91, 50, 45, 52, 79, 78, 81, 11, 7, 0, 63, 42, 5, 68, 90, 47, 30, 58, 44, 64, 84, 83, 9, 12, 59, 24, 61, 40, 95, 32, 26, 56, 28, 65, 89, 49, 38, 8, 35, 21, 60, 86, 34, 85, 22, 6, 39, 2, 71, 77, 48, 69, 13].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   1,  Average loss: 0.0125, Accuracy: 429/569 (75.3954%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   2,  Average loss: 0.0023, Accuracy: 554/569 (97.3638%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   3,  Average loss: 0.0006, Accuracy: 565/569 (99.2970%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   4,  Average loss: 0.0004, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   5,  Average loss: 0.0004, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   6,  Average loss: 0.0002, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   8,  Average loss: 0.0002, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch   9,  Average loss: 0.0002, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 41, internal_epoch  10,  Average loss: 0.0003, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Global model norm: 15.502256659849609.
Norm before scaling: 15.8283857679963. Distance: 3.402683035294954
Total norm for 10 adversaries is: 15.8283857679963. distance: 3.402683035294954
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.9867, Accuracy: 6725/8968 (74.9888%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   1,  Average loss: 0.0055, Accuracy: 456/522 (87.3563%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   2,  Average loss: 0.0015, Accuracy: 513/522 (98.2759%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   3,  Average loss: 0.0004, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   4,  Average loss: 0.0005, Accuracy: 517/522 (99.0421%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   5,  Average loss: 0.0004, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   6,  Average loss: 0.0003, Accuracy: 522/522 (100.0000%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   7,  Average loss: 0.0003, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   8,  Average loss: 0.0003, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch   9,  Average loss: 0.0002, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 73, internal_epoch  10,  Average loss: 0.0003, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Global model norm: 15.502256659849609.
Norm before scaling: 15.733885741369198. Distance: 2.326966375031785
Total norm for 10 adversaries is: 15.733885741369198. distance: 2.326966375031785
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0336, Accuracy: 8854/8968 (98.7288%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   1,  Average loss: 0.0103, Accuracy: 302/385 (78.4416%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   2,  Average loss: 0.0019, Accuracy: 373/385 (96.8831%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   3,  Average loss: 0.0007, Accuracy: 381/385 (98.9610%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   4,  Average loss: 0.0006, Accuracy: 381/385 (98.9610%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   5,  Average loss: 0.0006, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   6,  Average loss: 0.0005, Accuracy: 383/385 (99.4805%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   7,  Average loss: 0.0003, Accuracy: 385/385 (100.0000%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   8,  Average loss: 0.0005, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch   9,  Average loss: 0.0004, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 51, internal_epoch  10,  Average loss: 0.0003, Accuracy: 384/385 (99.7403%), train_poison_data_count: 193
Global model norm: 15.502256659849609.
Norm before scaling: 15.689829376051526. Distance: 2.5444498509993254
Total norm for 10 adversaries is: 15.689829376051526. distance: 2.5444498509993254
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.2416, Accuracy: 8097/8968 (90.2877%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   1,  Average loss: 0.0042, Accuracy: 570/627 (90.9091%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   2,  Average loss: 0.0009, Accuracy: 620/627 (98.8836%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   3,  Average loss: 0.0005, Accuracy: 620/627 (98.8836%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   4,  Average loss: 0.0006, Accuracy: 621/627 (99.0431%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   5,  Average loss: 0.0003, Accuracy: 624/627 (99.5215%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   6,  Average loss: 0.0004, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   7,  Average loss: 0.0004, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   8,  Average loss: 0.0004, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 626/627 (99.8405%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 74, internal_epoch  10,  Average loss: 0.0003, Accuracy: 624/627 (99.5215%), train_poison_data_count: 320
Global model norm: 15.502256659849609.
Norm before scaling: 15.613467423677367. Distance: 2.0088033049750327
Total norm for 10 adversaries is: 15.613467423677367. distance: 2.0088033049750327
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0044, Accuracy: 8948/8968 (99.7770%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 3, internal_epoch   1,  Average loss: 0.0140, Accuracy: 376/516 (72.8682%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 3, internal_epoch   2,  Average loss: 0.0024, Accuracy: 495/516 (95.9302%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 3, internal_epoch   3,  Average loss: 0.0004, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 3, internal_epoch   4,  Average loss: 0.0005, Accuracy: 510/516 (98.8372%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 3, internal_epoch   5,  Average loss: 0.0002, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 3, internal_epoch   6,  Average loss: 0.0004, Accuracy: 511/516 (99.0310%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 3, internal_epoch   7,  Average loss: 0.0003, Accuracy: 512/516 (99.2248%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 3, internal_epoch   8,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 3, internal_epoch   9,  Average loss: 0.0002, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 3, internal_epoch  10,  Average loss: 0.0002, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Global model norm: 15.502256659849609.
Norm before scaling: 15.929872370494197. Distance: 3.761988866818963
Total norm for 10 adversaries is: 15.929872370494197. distance: 3.761988866818963
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.8758, Accuracy: 7073/8968 (78.8693%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 18, internal_epoch   1,  Average loss: 0.0068, Accuracy: 675/759 (88.9328%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 18, internal_epoch   2,  Average loss: 0.0009, Accuracy: 744/759 (98.0237%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 18, internal_epoch   3,  Average loss: 0.0006, Accuracy: 748/759 (98.5507%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 18, internal_epoch   4,  Average loss: 0.0003, Accuracy: 754/759 (99.3412%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 18, internal_epoch   5,  Average loss: 0.0003, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 18, internal_epoch   6,  Average loss: 0.0002, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 18, internal_epoch   7,  Average loss: 0.0001, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 18, internal_epoch   8,  Average loss: 0.0002, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 18, internal_epoch   9,  Average loss: 0.0001, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 18, internal_epoch  10,  Average loss: 0.0002, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Global model norm: 15.502256659849609.
Norm before scaling: 16.048618834775354. Distance: 3.7510316065588305
Total norm for 10 adversaries is: 16.048618834775354. distance: 3.7510316065588305
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.1363, Accuracy: 8609/8968 (95.9969%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 29, internal_epoch   1,  Average loss: 0.0073, Accuracy: 430/506 (84.9802%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 29, internal_epoch   2,  Average loss: 0.0018, Accuracy: 495/506 (97.8261%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 29, internal_epoch   3,  Average loss: 0.0005, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 29, internal_epoch   4,  Average loss: 0.0004, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 29, internal_epoch   5,  Average loss: 0.0003, Accuracy: 506/506 (100.0000%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 29, internal_epoch   6,  Average loss: 0.0003, Accuracy: 506/506 (100.0000%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 29, internal_epoch   7,  Average loss: 0.0002, Accuracy: 506/506 (100.0000%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 29, internal_epoch   8,  Average loss: 0.0003, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 29, internal_epoch   9,  Average loss: 0.0003, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 29, internal_epoch  10,  Average loss: 0.0003, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Global model norm: 15.502256659849609.
Norm before scaling: 15.790971537701289. Distance: 2.687451118202121
Total norm for 10 adversaries is: 15.790971537701289. distance: 2.687451118202121
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 1.1109, Accuracy: 6309/8968 (70.3501%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 62, internal_epoch   1,  Average loss: 0.0031, Accuracy: 541/580 (93.2759%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 62, internal_epoch   2,  Average loss: 0.0014, Accuracy: 569/580 (98.1034%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 62, internal_epoch   3,  Average loss: 0.0007, Accuracy: 574/580 (98.9655%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 62, internal_epoch   4,  Average loss: 0.0006, Accuracy: 573/580 (98.7931%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 62, internal_epoch   5,  Average loss: 0.0007, Accuracy: 574/580 (98.9655%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 62, internal_epoch   6,  Average loss: 0.0006, Accuracy: 573/580 (98.7931%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 62, internal_epoch   7,  Average loss: 0.0005, Accuracy: 575/580 (99.1379%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 62, internal_epoch   8,  Average loss: 0.0006, Accuracy: 573/580 (98.7931%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 62, internal_epoch   9,  Average loss: 0.0003, Accuracy: 577/580 (99.4828%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 62, internal_epoch  10,  Average loss: 0.0002, Accuracy: 578/580 (99.6552%), train_poison_data_count: 292
Global model norm: 15.502256659849609.
Norm before scaling: 15.5738567293954. Distance: 1.6617184458285306
Total norm for 10 adversaries is: 15.5738567293954. distance: 1.6617184458285306
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0234, Accuracy: 8896/8968 (99.1971%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 33, internal_epoch   1,  Average loss: 0.0096, Accuracy: 471/587 (80.2385%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 33, internal_epoch   2,  Average loss: 0.0010, Accuracy: 573/587 (97.6150%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 33, internal_epoch   3,  Average loss: 0.0008, Accuracy: 580/587 (98.8075%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 33, internal_epoch   4,  Average loss: 0.0005, Accuracy: 583/587 (99.3186%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 33, internal_epoch   5,  Average loss: 0.0003, Accuracy: 585/587 (99.6593%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 33, internal_epoch   6,  Average loss: 0.0005, Accuracy: 582/587 (99.1482%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 33, internal_epoch   7,  Average loss: 0.0003, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 33, internal_epoch   8,  Average loss: 0.0001, Accuracy: 586/587 (99.8296%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 33, internal_epoch   9,  Average loss: 0.0004, Accuracy: 583/587 (99.3186%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 33, internal_epoch  10,  Average loss: 0.0003, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Global model norm: 15.502256659849609.
Norm before scaling: 15.927629832773103. Distance: 3.4684428860912715
Total norm for 10 adversaries is: 15.927629832773103. distance: 3.4684428860912715
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.6623, Accuracy: 7282/8968 (81.1998%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 88, internal_epoch   1,  Average loss: 0.0049, Accuracy: 653/734 (88.9646%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 88, internal_epoch   2,  Average loss: 0.0012, Accuracy: 715/734 (97.4114%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 88, internal_epoch   3,  Average loss: 0.0007, Accuracy: 726/734 (98.9101%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 88, internal_epoch   4,  Average loss: 0.0004, Accuracy: 726/734 (98.9101%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 88, internal_epoch   5,  Average loss: 0.0005, Accuracy: 726/734 (98.9101%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 88, internal_epoch   6,  Average loss: 0.0002, Accuracy: 730/734 (99.4550%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 88, internal_epoch   7,  Average loss: 0.0003, Accuracy: 729/734 (99.3188%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 88, internal_epoch   8,  Average loss: 0.0003, Accuracy: 730/734 (99.4550%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 88, internal_epoch   9,  Average loss: 0.0003, Accuracy: 731/734 (99.5913%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 88, internal_epoch  10,  Average loss: 0.0003, Accuracy: 730/734 (99.4550%), train_poison_data_count: 382
Global model norm: 15.502256659849609.
Norm before scaling: 15.75219904973092. Distance: 2.5293361822778198
Total norm for 10 adversaries is: 15.75219904973092. distance: 2.5293361822778198
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0385, Accuracy: 8848/8968 (98.6619%)
___Train Local_Simple,  epoch  53, local model 4, internal_epoch   1,  Average loss: 0.0005, Accuracy: 740/748 (98.9305%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.9422, Accuracy: 5634/10000 (56.3400%)
___Train Local_Simple,  epoch  53, local model 75, internal_epoch   1,  Average loss: 0.0009, Accuracy: 752/763 (98.5583%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.8303, Accuracy: 4570/10000 (45.7000%)
___Train Local_Simple,  epoch  53, local model 43, internal_epoch   1,  Average loss: 0.0007, Accuracy: 427/431 (99.0719%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.8553, Accuracy: 7692/10000 (76.9200%)
___Train Local_Simple,  epoch  53, local model 80, internal_epoch   1,  Average loss: 0.0016, Accuracy: 515/532 (96.8045%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.2736, Accuracy: 4938/10000 (49.3800%)
___Train Local_Simple,  epoch  53, local model 1, internal_epoch   1,  Average loss: 0.0004, Accuracy: 534/536 (99.6269%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.3384, Accuracy: 8940/10000 (89.4000%)
___Train Local_Simple,  epoch  53, local model 31, internal_epoch   1,  Average loss: 0.0007, Accuracy: 585/596 (98.1544%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.3410, Accuracy: 4899/10000 (48.9900%)
___Train Local_Simple,  epoch  53, local model 16, internal_epoch   1,  Average loss: 0.0003, Accuracy: 814/817 (99.6328%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.2677, Accuracy: 7396/10000 (73.9600%)
___Train Local_Simple,  epoch  53, local model 36, internal_epoch   1,  Average loss: 0.0005, Accuracy: 312/315 (99.0476%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.2090, Accuracy: 9322/10000 (93.2200%)
___Train Local_Simple,  epoch  53, local model 94, internal_epoch   1,  Average loss: 0.0004, Accuracy: 665/671 (99.1058%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.9807, Accuracy: 6438/10000 (64.3800%)
___Train Local_Simple,  epoch  53, local model 10, internal_epoch   1,  Average loss: 0.0007, Accuracy: 567/573 (98.9529%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.9019, Accuracy: 7022/10000 (70.2200%)
___Train Local_Simple,  epoch  53, local model 92, internal_epoch   1,  Average loss: 0.0019, Accuracy: 594/611 (97.2177%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.0979, Accuracy: 6813/10000 (68.1300%)
___Train Local_Simple,  epoch  53, local model 67, internal_epoch   1,  Average loss: 0.0012, Accuracy: 435/441 (98.6395%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.4631, Accuracy: 6319/10000 (63.1900%)
___Train Local_Simple,  epoch  53, local model 93, internal_epoch   1,  Average loss: 0.0011, Accuracy: 615/630 (97.6190%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.8794, Accuracy: 6512/10000 (65.1200%)
___Train Local_Simple,  epoch  53, local model 57, internal_epoch   1,  Average loss: 0.0008, Accuracy: 513/523 (98.0880%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.0965, Accuracy: 5219/10000 (52.1900%)
___Train Local_Simple,  epoch  53, local model 98, internal_epoch   1,  Average loss: 0.0010, Accuracy: 538/548 (98.1752%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.9229, Accuracy: 5549/10000 (55.4900%)
___Train Local_Simple,  epoch  53, local model 72, internal_epoch   1,  Average loss: 0.0013, Accuracy: 412/423 (97.3995%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.5352, Accuracy: 4657/10000 (46.5700%)
___Train Local_Simple,  epoch  53, local model 27, internal_epoch   1,  Average loss: 0.0005, Accuracy: 739/745 (99.1946%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.5496, Accuracy: 6295/10000 (62.9500%)
___Train Local_Simple,  epoch  53, local model 97, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1107/1112 (99.5504%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.9399, Accuracy: 5160/10000 (51.6000%)
___Train Local_Simple,  epoch  53, local model 87, internal_epoch   1,  Average loss: 0.0007, Accuracy: 656/663 (98.9442%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.6890, Accuracy: 5459/10000 (54.5900%)
___Train Local_Simple,  epoch  53, local model 15, internal_epoch   1,  Average loss: 0.0007, Accuracy: 280/282 (99.2908%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.2675, Accuracy: 9074/10000 (90.7400%)
___Train Local_Simple,  epoch  53, local model 17, internal_epoch   1,  Average loss: 0.0005, Accuracy: 524/527 (99.4307%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.2004, Accuracy: 7286/10000 (72.8600%)
___Train Local_Simple,  epoch  53, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 534/542 (98.5240%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.5316, Accuracy: 6270/10000 (62.7000%)
___Train Local_Simple,  epoch  53, local model 55, internal_epoch   1,  Average loss: 0.0009, Accuracy: 368/375 (98.1333%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.7621, Accuracy: 7610/10000 (76.1000%)
___Train Local_Simple,  epoch  53, local model 46, internal_epoch   1,  Average loss: 0.0007, Accuracy: 641/650 (98.6154%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.4752, Accuracy: 5853/10000 (58.5300%)
___Train Local_Simple,  epoch  53, local model 54, internal_epoch   1,  Average loss: 0.0004, Accuracy: 828/832 (99.5192%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.6696, Accuracy: 6521/10000 (65.2100%)
___Train Local_Simple,  epoch  53, local model 76, internal_epoch   1,  Average loss: 0.0010, Accuracy: 452/459 (98.4749%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.7002, Accuracy: 8285/10000 (82.8500%)
___Train Local_Simple,  epoch  53, local model 19, internal_epoch   1,  Average loss: 0.0006, Accuracy: 592/598 (98.9967%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.9849, Accuracy: 5978/10000 (59.7800%)
___Train Local_Simple,  epoch  53, local model 20, internal_epoch   1,  Average loss: 0.0009, Accuracy: 594/602 (98.6711%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.5233, Accuracy: 6356/10000 (63.5600%)
___Train Local_Simple,  epoch  53, local model 99, internal_epoch   1,  Average loss: 0.0020, Accuracy: 699/712 (98.1742%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.6186, Accuracy: 4765/10000 (47.6500%)
___Train Local_Simple,  epoch  53, local model 37, internal_epoch   1,  Average loss: 0.0009, Accuracy: 452/456 (99.1228%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.4289, Accuracy: 8527/10000 (85.2700%)
___Train Local_Simple,  epoch  53, local model 96, internal_epoch   1,  Average loss: 0.0007, Accuracy: 525/531 (98.8701%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.3137, Accuracy: 5588/10000 (55.8800%)
___Train Local_Simple,  epoch  53, local model 14, internal_epoch   1,  Average loss: 0.0011, Accuracy: 679/692 (98.1214%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.3483, Accuracy: 6774/10000 (67.7400%)
___Train Local_Simple,  epoch  53, local model 66, internal_epoch   1,  Average loss: 0.0012, Accuracy: 718/733 (97.9536%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 4.0814, Accuracy: 4310/10000 (43.1000%)
___Train Local_Simple,  epoch  53, local model 53, internal_epoch   1,  Average loss: 0.0007, Accuracy: 554/561 (98.7522%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.2090, Accuracy: 6025/10000 (60.2500%)
___Train Local_Simple,  epoch  53, local model 82, internal_epoch   1,  Average loss: 0.0005, Accuracy: 806/815 (98.8957%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.9875, Accuracy: 5196/10000 (51.9600%)
___Train Local_Simple,  epoch  53, local model 25, internal_epoch   1,  Average loss: 0.0003, Accuracy: 588/592 (99.3243%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.6412, Accuracy: 7368/10000 (73.6800%)
___Train Local_Simple,  epoch  53, local model 70, internal_epoch   1,  Average loss: 0.0009, Accuracy: 559/568 (98.4155%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.9915, Accuracy: 5460/10000 (54.6000%)
___Train Local_Simple,  epoch  53, local model 91, internal_epoch   1,  Average loss: 0.0003, Accuracy: 815/819 (99.5116%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.6355, Accuracy: 5714/10000 (57.1400%)
___Train Local_Simple,  epoch  53, local model 50, internal_epoch   1,  Average loss: 0.0008, Accuracy: 470/477 (98.5325%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.1581, Accuracy: 6758/10000 (67.5800%)
___Train Local_Simple,  epoch  53, local model 45, internal_epoch   1,  Average loss: 0.0008, Accuracy: 640/647 (98.9181%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.9450, Accuracy: 4247/10000 (42.4700%)
___Train Local_Simple,  epoch  53, local model 52, internal_epoch   1,  Average loss: 0.0010, Accuracy: 769/789 (97.4651%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.5779, Accuracy: 5203/10000 (52.0300%)
___Train Local_Simple,  epoch  53, local model 79, internal_epoch   1,  Average loss: 0.0010, Accuracy: 652/661 (98.6384%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.0126, Accuracy: 5059/10000 (50.5900%)
___Train Local_Simple,  epoch  53, local model 78, internal_epoch   1,  Average loss: 0.0016, Accuracy: 574/587 (97.7853%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.6684, Accuracy: 5339/10000 (53.3900%)
___Train Local_Simple,  epoch  53, local model 81, internal_epoch   1,  Average loss: 0.0009, Accuracy: 625/636 (98.2704%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.2646, Accuracy: 7241/10000 (72.4100%)
___Train Local_Simple,  epoch  53, local model 11, internal_epoch   1,  Average loss: 0.0005, Accuracy: 549/554 (99.0975%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.4361, Accuracy: 8588/10000 (85.8800%)
___Train Local_Simple,  epoch  53, local model 7, internal_epoch   1,  Average loss: 0.0003, Accuracy: 795/802 (99.1272%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.9432, Accuracy: 7169/10000 (71.6900%)
___Train Local_Simple,  epoch  53, local model 0, internal_epoch   1,  Average loss: 0.0009, Accuracy: 430/435 (98.8506%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.3153, Accuracy: 6960/10000 (69.6000%)
___Train Local_Simple,  epoch  53, local model 63, internal_epoch   1,  Average loss: 0.0014, Accuracy: 296/303 (97.6898%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.1609, Accuracy: 7163/10000 (71.6300%)
___Train Local_Simple,  epoch  53, local model 42, internal_epoch   1,  Average loss: 0.0004, Accuracy: 469/473 (99.1543%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.5519, Accuracy: 8204/10000 (82.0400%)
___Train Local_Simple,  epoch  53, local model 5, internal_epoch   1,  Average loss: 0.0006, Accuracy: 572/578 (98.9619%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.7849, Accuracy: 7822/10000 (78.2200%)
___Train Local_Simple,  epoch  53, local model 68, internal_epoch   1,  Average loss: 0.0013, Accuracy: 538/549 (97.9964%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.5024, Accuracy: 5412/10000 (54.1200%)
___Train Local_Simple,  epoch  53, local model 90, internal_epoch   1,  Average loss: 0.0009, Accuracy: 603/615 (98.0488%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.7781, Accuracy: 6621/10000 (66.2100%)
___Train Local_Simple,  epoch  53, local model 47, internal_epoch   1,  Average loss: 0.0005, Accuracy: 529/534 (99.0637%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.3469, Accuracy: 6319/10000 (63.1900%)
___Train Local_Simple,  epoch  53, local model 30, internal_epoch   1,  Average loss: 0.0005, Accuracy: 440/443 (99.3228%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.0591, Accuracy: 7698/10000 (76.9800%)
___Train Local_Simple,  epoch  53, local model 58, internal_epoch   1,  Average loss: 0.0008, Accuracy: 759/772 (98.3161%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.5296, Accuracy: 6427/10000 (64.2700%)
___Train Local_Simple,  epoch  53, local model 44, internal_epoch   1,  Average loss: 0.0005, Accuracy: 555/561 (98.9305%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.6194, Accuracy: 6666/10000 (66.6600%)
___Train Local_Simple,  epoch  53, local model 64, internal_epoch   1,  Average loss: 0.0003, Accuracy: 607/608 (99.8355%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.7388, Accuracy: 6288/10000 (62.8800%)
___Train Local_Simple,  epoch  53, local model 84, internal_epoch   1,  Average loss: 0.0006, Accuracy: 414/420 (98.5714%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.4588, Accuracy: 8532/10000 (85.3200%)
___Train Local_Simple,  epoch  53, local model 83, internal_epoch   1,  Average loss: 0.0010, Accuracy: 355/360 (98.6111%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.2817, Accuracy: 9103/10000 (91.0300%)
___Train Local_Simple,  epoch  53, local model 9, internal_epoch   1,  Average loss: 0.0007, Accuracy: 503/508 (99.0157%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.7000, Accuracy: 7756/10000 (77.5600%)
___Train Local_Simple,  epoch  53, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 716/725 (98.7586%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.4695, Accuracy: 5677/10000 (56.7700%)
___Train Local_Simple,  epoch  53, local model 59, internal_epoch   1,  Average loss: 0.0006, Accuracy: 637/644 (98.9130%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.5991, Accuracy: 6180/10000 (61.8000%)
___Train Local_Simple,  epoch  53, local model 24, internal_epoch   1,  Average loss: 0.0012, Accuracy: 464/477 (97.2746%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.3887, Accuracy: 6521/10000 (65.2100%)
___Train Local_Simple,  epoch  53, local model 61, internal_epoch   1,  Average loss: 0.0009, Accuracy: 283/287 (98.6063%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.3593, Accuracy: 8939/10000 (89.3900%)
___Train Local_Simple,  epoch  53, local model 40, internal_epoch   1,  Average loss: 0.0003, Accuracy: 495/498 (99.3976%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.1964, Accuracy: 7030/10000 (70.3000%)
___Train Local_Simple,  epoch  53, local model 95, internal_epoch   1,  Average loss: 0.0015, Accuracy: 586/600 (97.6667%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.1153, Accuracy: 6346/10000 (63.4600%)
___Train Local_Simple,  epoch  53, local model 32, internal_epoch   1,  Average loss: 0.0005, Accuracy: 584/590 (98.9831%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.0034, Accuracy: 6490/10000 (64.9000%)
___Train Local_Simple,  epoch  53, local model 26, internal_epoch   1,  Average loss: 0.0007, Accuracy: 511/519 (98.4586%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.6008, Accuracy: 6115/10000 (61.1500%)
___Train Local_Simple,  epoch  53, local model 56, internal_epoch   1,  Average loss: 0.0005, Accuracy: 707/715 (98.8811%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.1128, Accuracy: 6822/10000 (68.2200%)
___Train Local_Simple,  epoch  53, local model 28, internal_epoch   1,  Average loss: 0.0008, Accuracy: 597/611 (97.7087%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.3588, Accuracy: 6084/10000 (60.8400%)
___Train Local_Simple,  epoch  53, local model 65, internal_epoch   1,  Average loss: 0.0013, Accuracy: 606/621 (97.5845%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.7970, Accuracy: 5720/10000 (57.2000%)
___Train Local_Simple,  epoch  53, local model 89, internal_epoch   1,  Average loss: 0.0010, Accuracy: 669/683 (97.9502%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 3.4181, Accuracy: 5474/10000 (54.7400%)
___Train Local_Simple,  epoch  53, local model 49, internal_epoch   1,  Average loss: 0.0008, Accuracy: 349/355 (98.3099%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.7778, Accuracy: 7471/10000 (74.7100%)
___Train Local_Simple,  epoch  53, local model 38, internal_epoch   1,  Average loss: 0.0007, Accuracy: 472/477 (98.9518%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.3115, Accuracy: 9010/10000 (90.1000%)
___Train Local_Simple,  epoch  53, local model 8, internal_epoch   1,  Average loss: 0.0007, Accuracy: 696/706 (98.5836%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.3405, Accuracy: 6267/10000 (62.6700%)
___Train Local_Simple,  epoch  53, local model 35, internal_epoch   1,  Average loss: 0.0010, Accuracy: 622/630 (98.7302%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 3.1848, Accuracy: 5425/10000 (54.2500%)
___Train Local_Simple,  epoch  53, local model 21, internal_epoch   1,  Average loss: 0.0003, Accuracy: 685/687 (99.7089%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.1148, Accuracy: 7148/10000 (71.4800%)
___Train Local_Simple,  epoch  53, local model 60, internal_epoch   1,  Average loss: 0.0009, Accuracy: 559/571 (97.8984%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.2739, Accuracy: 5594/10000 (55.9400%)
___Train Local_Simple,  epoch  53, local model 86, internal_epoch   1,  Average loss: 0.0004, Accuracy: 689/692 (99.5665%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.5803, Accuracy: 5690/10000 (56.9000%)
___Train Local_Simple,  epoch  53, local model 34, internal_epoch   1,  Average loss: 0.0007, Accuracy: 862/871 (98.9667%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 3.6850, Accuracy: 4431/10000 (44.3100%)
___Train Local_Simple,  epoch  53, local model 85, internal_epoch   1,  Average loss: 0.0013, Accuracy: 788/807 (97.6456%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 3.1581, Accuracy: 5467/10000 (54.6700%)
___Train Local_Simple,  epoch  53, local model 22, internal_epoch   1,  Average loss: 0.0008, Accuracy: 257/262 (98.0916%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.0652, Accuracy: 8449/10000 (84.4900%)
___Train Local_Simple,  epoch  53, local model 6, internal_epoch   1,  Average loss: 0.0006, Accuracy: 432/435 (99.3103%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.3815, Accuracy: 7227/10000 (72.2700%)
___Train Local_Simple,  epoch  53, local model 39, internal_epoch   1,  Average loss: 0.0007, Accuracy: 485/493 (98.3773%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.6583, Accuracy: 6784/10000 (67.8400%)
___Train Local_Simple,  epoch  53, local model 2, internal_epoch   1,  Average loss: 0.0006, Accuracy: 560/564 (99.2908%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.6310, Accuracy: 8096/10000 (80.9600%)
___Train Local_Simple,  epoch  53, local model 71, internal_epoch   1,  Average loss: 0.0010, Accuracy: 552/561 (98.3957%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.1396, Accuracy: 6938/10000 (69.3800%)
___Train Local_Simple,  epoch  53, local model 77, internal_epoch   1,  Average loss: 0.0008, Accuracy: 609/618 (98.5437%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.9077, Accuracy: 6137/10000 (61.3700%)
___Train Local_Simple,  epoch  53, local model 48, internal_epoch   1,  Average loss: 0.0009, Accuracy: 359/363 (98.8981%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.3836, Accuracy: 8704/10000 (87.0400%)
___Train Local_Simple,  epoch  53, local model 69, internal_epoch   1,  Average loss: 0.0016, Accuracy: 651/671 (97.0194%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 2.4043, Accuracy: 5799/10000 (57.9900%)
___Train Local_Simple,  epoch  53, local model 13, internal_epoch   1,  Average loss: 0.0006, Accuracy: 702/713 (98.4572%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.9806, Accuracy: 6248/10000 (62.4800%)
time spent on training: 374.4058520793915
___Test Target_Simple poisoned: False, epoch: 53: Average loss: 0.0967, Accuracy: 9729/10000 (97.2900%)
___Test Target_Simple poisoned: True, epoch: 53: Average loss: 2.7438, Accuracy: 3144/8968 (35.0580%)
saving model
Done in 407.9127335548401 sec.
Server Epoch:54 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 47, 10, 66, 70, 20, 76, 98, 48, 84, 37, 24, 16, 25, 60, 87, 83, 58, 90, 44, 81, 55, 99, 14, 77, 49, 38, 43, 42, 35, 28, 79, 36, 21, 72, 19, 91, 63, 17, 0, 15, 68, 46, 92, 11, 78, 96, 23, 85, 40, 86, 39, 34, 12, 32, 97, 67, 8, 59, 4, 75, 2, 65, 69, 94, 1, 89, 53, 95, 50, 27, 30, 93, 71, 13, 56, 6, 80, 31, 26, 5, 64, 61, 54, 9, 82, 45, 22, 52, 7, 57].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   1,  Average loss: 0.0123, Accuracy: 424/569 (74.5167%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   2,  Average loss: 0.0019, Accuracy: 556/569 (97.7153%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   3,  Average loss: 0.0005, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   4,  Average loss: 0.0005, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   5,  Average loss: 0.0005, Accuracy: 564/569 (99.1213%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   6,  Average loss: 0.0004, Accuracy: 565/569 (99.2970%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   7,  Average loss: 0.0004, Accuracy: 565/569 (99.2970%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   8,  Average loss: 0.0002, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch   9,  Average loss: 0.0003, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 41, internal_epoch  10,  Average loss: 0.0002, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Global model norm: 15.511430033040856.
Norm before scaling: 15.900193775843583. Distance: 3.596088477874014
Total norm for 10 adversaries is: 15.900193775843583. distance: 3.596088477874014
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 1.1976, Accuracy: 6253/8968 (69.7257%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   1,  Average loss: 0.0045, Accuracy: 473/522 (90.6130%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   2,  Average loss: 0.0010, Accuracy: 511/522 (97.8927%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   3,  Average loss: 0.0003, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   4,  Average loss: 0.0003, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   5,  Average loss: 0.0003, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   7,  Average loss: 0.0002, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 522/522 (100.0000%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   9,  Average loss: 0.0002, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch  10,  Average loss: 0.0002, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Global model norm: 15.511430033040856.
Norm before scaling: 15.673387965976955. Distance: 1.9340661907052967
Total norm for 10 adversaries is: 15.673387965976955. distance: 1.9340661907052967
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0718, Accuracy: 8771/8968 (97.8033%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   1,  Average loss: 0.0075, Accuracy: 314/385 (81.5584%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   2,  Average loss: 0.0015, Accuracy: 374/385 (97.1429%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   3,  Average loss: 0.0012, Accuracy: 377/385 (97.9221%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   4,  Average loss: 0.0006, Accuracy: 383/385 (99.4805%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   5,  Average loss: 0.0008, Accuracy: 378/385 (98.1818%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   6,  Average loss: 0.0005, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   7,  Average loss: 0.0007, Accuracy: 378/385 (98.1818%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   8,  Average loss: 0.0003, Accuracy: 385/385 (100.0000%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch   9,  Average loss: 0.0003, Accuracy: 384/385 (99.7403%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 51, internal_epoch  10,  Average loss: 0.0003, Accuracy: 383/385 (99.4805%), train_poison_data_count: 193
Global model norm: 15.511430033040856.
Norm before scaling: 15.744836838943773. Distance: 2.2522717769051446
Total norm for 10 adversaries is: 15.744836838943773. distance: 2.2522717769051446
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.1674, Accuracy: 8401/8968 (93.6775%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   1,  Average loss: 0.0051, Accuracy: 559/627 (89.1547%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   2,  Average loss: 0.0014, Accuracy: 609/627 (97.1292%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   3,  Average loss: 0.0007, Accuracy: 615/627 (98.0861%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   4,  Average loss: 0.0008, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   5,  Average loss: 0.0004, Accuracy: 620/627 (98.8836%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   6,  Average loss: 0.0007, Accuracy: 624/627 (99.5215%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   7,  Average loss: 0.0004, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   8,  Average loss: 0.0004, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch   9,  Average loss: 0.0006, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 74, internal_epoch  10,  Average loss: 0.0005, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Global model norm: 15.511430033040856.
Norm before scaling: 15.71359890514448. Distance: 2.3125573228484435
Total norm for 10 adversaries is: 15.71359890514448. distance: 2.3125573228484435
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0076, Accuracy: 8945/8968 (99.7435%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 3, internal_epoch   1,  Average loss: 0.0136, Accuracy: 396/516 (76.7442%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 3, internal_epoch   2,  Average loss: 0.0022, Accuracy: 507/516 (98.2558%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 3, internal_epoch   3,  Average loss: 0.0003, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 3, internal_epoch   4,  Average loss: 0.0003, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 3, internal_epoch   5,  Average loss: 0.0002, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 3, internal_epoch   6,  Average loss: 0.0002, Accuracy: 513/516 (99.4186%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 3, internal_epoch   7,  Average loss: 0.0002, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 3, internal_epoch   8,  Average loss: 0.0002, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 3, internal_epoch   9,  Average loss: 0.0001, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 3, internal_epoch  10,  Average loss: 0.0002, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Global model norm: 15.511430033040856.
Norm before scaling: 15.884449947104567. Distance: 3.4344238388851394
Total norm for 10 adversaries is: 15.884449947104567. distance: 3.4344238388851394
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.6998, Accuracy: 7264/8968 (80.9991%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 18, internal_epoch   1,  Average loss: 0.0053, Accuracy: 685/759 (90.2503%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 18, internal_epoch   2,  Average loss: 0.0007, Accuracy: 748/759 (98.5507%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 18, internal_epoch   3,  Average loss: 0.0003, Accuracy: 754/759 (99.3412%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 18, internal_epoch   4,  Average loss: 0.0003, Accuracy: 754/759 (99.3412%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 18, internal_epoch   5,  Average loss: 0.0002, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 18, internal_epoch   6,  Average loss: 0.0002, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 18, internal_epoch   7,  Average loss: 0.0003, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 18, internal_epoch   8,  Average loss: 0.0002, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 18, internal_epoch   9,  Average loss: 0.0001, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 18, internal_epoch  10,  Average loss: 0.0002, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Global model norm: 15.511430033040856.
Norm before scaling: 15.90804186248067. Distance: 3.1890074213515183
Total norm for 10 adversaries is: 15.90804186248067. distance: 3.1890074213515183
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0409, Accuracy: 8856/8968 (98.7511%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 29, internal_epoch   1,  Average loss: 0.0083, Accuracy: 424/506 (83.7945%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 29, internal_epoch   2,  Average loss: 0.0009, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 29, internal_epoch   3,  Average loss: 0.0007, Accuracy: 500/506 (98.8142%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 29, internal_epoch   4,  Average loss: 0.0005, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 29, internal_epoch   5,  Average loss: 0.0004, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 29, internal_epoch   6,  Average loss: 0.0004, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 29, internal_epoch   7,  Average loss: 0.0002, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 29, internal_epoch   8,  Average loss: 0.0003, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 29, internal_epoch   9,  Average loss: 0.0002, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 29, internal_epoch  10,  Average loss: 0.0003, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Global model norm: 15.511430033040856.
Norm before scaling: 15.809207136141822. Distance: 2.8669258850651413
Total norm for 10 adversaries is: 15.809207136141822. distance: 2.8669258850651413
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.4802, Accuracy: 7471/8968 (83.3073%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 62, internal_epoch   1,  Average loss: 0.0035, Accuracy: 536/580 (92.4138%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 62, internal_epoch   2,  Average loss: 0.0013, Accuracy: 566/580 (97.5862%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 62, internal_epoch   3,  Average loss: 0.0010, Accuracy: 570/580 (98.2759%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 62, internal_epoch   4,  Average loss: 0.0005, Accuracy: 573/580 (98.7931%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 62, internal_epoch   5,  Average loss: 0.0007, Accuracy: 571/580 (98.4483%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 62, internal_epoch   6,  Average loss: 0.0005, Accuracy: 575/580 (99.1379%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 62, internal_epoch   7,  Average loss: 0.0003, Accuracy: 576/580 (99.3103%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 62, internal_epoch   8,  Average loss: 0.0004, Accuracy: 577/580 (99.4828%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 62, internal_epoch   9,  Average loss: 0.0007, Accuracy: 574/580 (98.9655%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 62, internal_epoch  10,  Average loss: 0.0004, Accuracy: 575/580 (99.1379%), train_poison_data_count: 292
Global model norm: 15.511430033040856.
Norm before scaling: 15.611537168819652. Distance: 1.7839496299278605
Total norm for 10 adversaries is: 15.611537168819652. distance: 1.7839496299278605
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0181, Accuracy: 8895/8968 (99.1860%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 33, internal_epoch   1,  Average loss: 0.0111, Accuracy: 462/587 (78.7053%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 33, internal_epoch   2,  Average loss: 0.0024, Accuracy: 563/587 (95.9114%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 33, internal_epoch   3,  Average loss: 0.0011, Accuracy: 577/587 (98.2964%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 33, internal_epoch   4,  Average loss: 0.0007, Accuracy: 582/587 (99.1482%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 33, internal_epoch   5,  Average loss: 0.0006, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 33, internal_epoch   6,  Average loss: 0.0005, Accuracy: 583/587 (99.3186%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 33, internal_epoch   7,  Average loss: 0.0004, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 33, internal_epoch   8,  Average loss: 0.0003, Accuracy: 586/587 (99.8296%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 33, internal_epoch   9,  Average loss: 0.0003, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 33, internal_epoch  10,  Average loss: 0.0004, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Global model norm: 15.511430033040856.
Norm before scaling: 15.966999831470034. Distance: 3.546061418297267
Total norm for 10 adversaries is: 15.966999831470034. distance: 3.546061418297267
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 1.7542, Accuracy: 4578/8968 (51.0482%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 88, internal_epoch   1,  Average loss: 0.0044, Accuracy: 655/734 (89.2371%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 88, internal_epoch   2,  Average loss: 0.0010, Accuracy: 718/734 (97.8202%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 88, internal_epoch   3,  Average loss: 0.0006, Accuracy: 727/734 (99.0463%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 88, internal_epoch   4,  Average loss: 0.0004, Accuracy: 730/734 (99.4550%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 88, internal_epoch   5,  Average loss: 0.0004, Accuracy: 729/734 (99.3188%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 88, internal_epoch   6,  Average loss: 0.0002, Accuracy: 732/734 (99.7275%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 88, internal_epoch   7,  Average loss: 0.0003, Accuracy: 732/734 (99.7275%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 88, internal_epoch   8,  Average loss: 0.0003, Accuracy: 730/734 (99.4550%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 88, internal_epoch   9,  Average loss: 0.0002, Accuracy: 731/734 (99.5913%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 88, internal_epoch  10,  Average loss: 0.0004, Accuracy: 726/734 (98.9101%), train_poison_data_count: 382
Global model norm: 15.511430033040856.
Norm before scaling: 15.810381721072254. Distance: 2.7452506755886734
Total norm for 10 adversaries is: 15.810381721072254. distance: 2.7452506755886734
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0821, Accuracy: 8742/8968 (97.4799%)
___Train Local_Simple,  epoch  54, local model 47, internal_epoch   1,  Average loss: 0.0008, Accuracy: 527/534 (98.6891%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.9736, Accuracy: 5669/10000 (56.6900%)
___Train Local_Simple,  epoch  54, local model 10, internal_epoch   1,  Average loss: 0.0013, Accuracy: 560/573 (97.7312%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.2707, Accuracy: 6614/10000 (66.1400%)
___Train Local_Simple,  epoch  54, local model 66, internal_epoch   1,  Average loss: 0.0014, Accuracy: 717/733 (97.8172%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 3.6401, Accuracy: 3871/10000 (38.7100%)
___Train Local_Simple,  epoch  54, local model 70, internal_epoch   1,  Average loss: 0.0014, Accuracy: 555/568 (97.7113%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.6615, Accuracy: 5410/10000 (54.1000%)
___Train Local_Simple,  epoch  54, local model 20, internal_epoch   1,  Average loss: 0.0007, Accuracy: 592/602 (98.3389%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.6395, Accuracy: 6191/10000 (61.9100%)
___Train Local_Simple,  epoch  54, local model 76, internal_epoch   1,  Average loss: 0.0010, Accuracy: 454/459 (98.9107%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.4002, Accuracy: 8674/10000 (86.7400%)
___Train Local_Simple,  epoch  54, local model 98, internal_epoch   1,  Average loss: 0.0012, Accuracy: 535/548 (97.6277%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 3.9338, Accuracy: 4212/10000 (42.1200%)
___Train Local_Simple,  epoch  54, local model 48, internal_epoch   1,  Average loss: 0.0008, Accuracy: 356/363 (98.0716%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.3028, Accuracy: 8959/10000 (89.5900%)
___Train Local_Simple,  epoch  54, local model 84, internal_epoch   1,  Average loss: 0.0007, Accuracy: 416/420 (99.0476%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.3722, Accuracy: 8799/10000 (87.9900%)
___Train Local_Simple,  epoch  54, local model 37, internal_epoch   1,  Average loss: 0.0014, Accuracy: 446/456 (97.8070%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 2.5705, Accuracy: 6164/10000 (61.6400%)
___Train Local_Simple,  epoch  54, local model 24, internal_epoch   1,  Average loss: 0.0011, Accuracy: 468/477 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.9820, Accuracy: 6822/10000 (68.2200%)
___Train Local_Simple,  epoch  54, local model 16, internal_epoch   1,  Average loss: 0.0003, Accuracy: 812/817 (99.3880%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.4666, Accuracy: 6978/10000 (69.7800%)
___Train Local_Simple,  epoch  54, local model 25, internal_epoch   1,  Average loss: 0.0003, Accuracy: 586/592 (98.9865%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.1426, Accuracy: 7696/10000 (76.9600%)
___Train Local_Simple,  epoch  54, local model 60, internal_epoch   1,  Average loss: 0.0009, Accuracy: 555/571 (97.1979%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 2.5286, Accuracy: 4990/10000 (49.9000%)
___Train Local_Simple,  epoch  54, local model 87, internal_epoch   1,  Average loss: 0.0006, Accuracy: 654/663 (98.6425%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 2.8846, Accuracy: 4367/10000 (43.6700%)
___Train Local_Simple,  epoch  54, local model 83, internal_epoch   1,  Average loss: 0.0013, Accuracy: 352/360 (97.7778%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.2287, Accuracy: 9241/10000 (92.4100%)
___Train Local_Simple,  epoch  54, local model 58, internal_epoch   1,  Average loss: 0.0008, Accuracy: 762/772 (98.7047%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 2.6661, Accuracy: 4944/10000 (49.4400%)
___Train Local_Simple,  epoch  54, local model 90, internal_epoch   1,  Average loss: 0.0021, Accuracy: 591/615 (96.0976%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.7856, Accuracy: 6274/10000 (62.7400%)
___Train Local_Simple,  epoch  54, local model 44, internal_epoch   1,  Average loss: 0.0003, Accuracy: 559/561 (99.6435%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.0385, Accuracy: 7687/10000 (76.8700%)
___Train Local_Simple,  epoch  54, local model 81, internal_epoch   1,  Average loss: 0.0009, Accuracy: 630/636 (99.0566%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 2.0121, Accuracy: 4645/10000 (46.4500%)
___Train Local_Simple,  epoch  54, local model 55, internal_epoch   1,  Average loss: 0.0008, Accuracy: 368/375 (98.1333%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.5666, Accuracy: 8060/10000 (80.6000%)
___Train Local_Simple,  epoch  54, local model 99, internal_epoch   1,  Average loss: 0.0022, Accuracy: 683/712 (95.9270%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.2050, Accuracy: 6502/10000 (65.0200%)
___Train Local_Simple,  epoch  54, local model 14, internal_epoch   1,  Average loss: 0.0009, Accuracy: 678/692 (97.9769%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.9226, Accuracy: 7245/10000 (72.4500%)
___Train Local_Simple,  epoch  54, local model 77, internal_epoch   1,  Average loss: 0.0012, Accuracy: 598/618 (96.7638%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 3.7923, Accuracy: 5005/10000 (50.0500%)
___Train Local_Simple,  epoch  54, local model 49, internal_epoch   1,  Average loss: 0.0013, Accuracy: 346/355 (97.4648%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.3855, Accuracy: 6396/10000 (63.9600%)
___Train Local_Simple,  epoch  54, local model 38, internal_epoch   1,  Average loss: 0.0008, Accuracy: 472/477 (98.9518%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.2565, Accuracy: 9167/10000 (91.6700%)
___Train Local_Simple,  epoch  54, local model 43, internal_epoch   1,  Average loss: 0.0007, Accuracy: 427/431 (99.0719%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.7773, Accuracy: 7528/10000 (75.2800%)
___Train Local_Simple,  epoch  54, local model 42, internal_epoch   1,  Average loss: 0.0003, Accuracy: 471/473 (99.5772%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.4348, Accuracy: 8436/10000 (84.3600%)
___Train Local_Simple,  epoch  54, local model 35, internal_epoch   1,  Average loss: 0.0011, Accuracy: 614/630 (97.4603%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.7804, Accuracy: 6287/10000 (62.8700%)
___Train Local_Simple,  epoch  54, local model 28, internal_epoch   1,  Average loss: 0.0004, Accuracy: 605/611 (99.0180%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.8025, Accuracy: 6730/10000 (67.3000%)
___Train Local_Simple,  epoch  54, local model 79, internal_epoch   1,  Average loss: 0.0008, Accuracy: 655/661 (99.0923%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.4979, Accuracy: 6167/10000 (61.6700%)
___Train Local_Simple,  epoch  54, local model 36, internal_epoch   1,  Average loss: 0.0006, Accuracy: 312/315 (99.0476%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.2187, Accuracy: 9238/10000 (92.3800%)
___Train Local_Simple,  epoch  54, local model 21, internal_epoch   1,  Average loss: 0.0003, Accuracy: 684/687 (99.5633%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.3158, Accuracy: 6723/10000 (67.2300%)
___Train Local_Simple,  epoch  54, local model 72, internal_epoch   1,  Average loss: 0.0016, Accuracy: 409/423 (96.6903%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 2.3825, Accuracy: 4615/10000 (46.1500%)
___Train Local_Simple,  epoch  54, local model 19, internal_epoch   1,  Average loss: 0.0006, Accuracy: 591/598 (98.8294%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.2486, Accuracy: 6707/10000 (67.0700%)
___Train Local_Simple,  epoch  54, local model 91, internal_epoch   1,  Average loss: 0.0005, Accuracy: 810/819 (98.9011%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 2.6717, Accuracy: 4377/10000 (43.7700%)
___Train Local_Simple,  epoch  54, local model 63, internal_epoch   1,  Average loss: 0.0012, Accuracy: 295/303 (97.3597%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.2236, Accuracy: 6604/10000 (66.0400%)
___Train Local_Simple,  epoch  54, local model 17, internal_epoch   1,  Average loss: 0.0006, Accuracy: 521/527 (98.8615%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.3435, Accuracy: 6695/10000 (66.9500%)
___Train Local_Simple,  epoch  54, local model 0, internal_epoch   1,  Average loss: 0.0007, Accuracy: 428/435 (98.3908%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.9207, Accuracy: 6098/10000 (60.9800%)
___Train Local_Simple,  epoch  54, local model 15, internal_epoch   1,  Average loss: 0.0005, Accuracy: 281/282 (99.6454%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.2176, Accuracy: 9244/10000 (92.4400%)
___Train Local_Simple,  epoch  54, local model 68, internal_epoch   1,  Average loss: 0.0012, Accuracy: 539/549 (98.1785%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 2.1491, Accuracy: 5594/10000 (55.9400%)
___Train Local_Simple,  epoch  54, local model 46, internal_epoch   1,  Average loss: 0.0005, Accuracy: 645/650 (99.2308%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 2.0867, Accuracy: 6029/10000 (60.2900%)
___Train Local_Simple,  epoch  54, local model 92, internal_epoch   1,  Average loss: 0.0019, Accuracy: 587/611 (96.0720%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 5.8391, Accuracy: 3051/10000 (30.5100%)
___Train Local_Simple,  epoch  54, local model 11, internal_epoch   1,  Average loss: 0.0005, Accuracy: 550/554 (99.2780%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.6487, Accuracy: 7916/10000 (79.1600%)
___Train Local_Simple,  epoch  54, local model 78, internal_epoch   1,  Average loss: 0.0018, Accuracy: 569/587 (96.9336%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 4.0213, Accuracy: 3902/10000 (39.0200%)
___Train Local_Simple,  epoch  54, local model 96, internal_epoch   1,  Average loss: 0.0008, Accuracy: 524/531 (98.6817%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 3.2513, Accuracy: 4453/10000 (44.5300%)
___Train Local_Simple,  epoch  54, local model 23, internal_epoch   1,  Average loss: 0.0009, Accuracy: 531/542 (97.9705%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.7964, Accuracy: 5769/10000 (57.6900%)
___Train Local_Simple,  epoch  54, local model 85, internal_epoch   1,  Average loss: 0.0012, Accuracy: 787/807 (97.5217%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 2.5506, Accuracy: 6163/10000 (61.6300%)
___Train Local_Simple,  epoch  54, local model 40, internal_epoch   1,  Average loss: 0.0004, Accuracy: 496/498 (99.5984%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 2.4585, Accuracy: 6346/10000 (63.4600%)
___Train Local_Simple,  epoch  54, local model 86, internal_epoch   1,  Average loss: 0.0005, Accuracy: 687/692 (99.2775%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 3.3694, Accuracy: 3848/10000 (38.4800%)
___Train Local_Simple,  epoch  54, local model 39, internal_epoch   1,  Average loss: 0.0005, Accuracy: 488/493 (98.9858%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.9759, Accuracy: 7442/10000 (74.4200%)
___Train Local_Simple,  epoch  54, local model 34, internal_epoch   1,  Average loss: 0.0010, Accuracy: 852/871 (97.8186%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 4.8338, Accuracy: 4435/10000 (44.3500%)
___Train Local_Simple,  epoch  54, local model 12, internal_epoch   1,  Average loss: 0.0004, Accuracy: 718/725 (99.0345%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.5307, Accuracy: 6528/10000 (65.2800%)
___Train Local_Simple,  epoch  54, local model 32, internal_epoch   1,  Average loss: 0.0009, Accuracy: 578/590 (97.9661%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 2.0201, Accuracy: 6000/10000 (60.0000%)
___Train Local_Simple,  epoch  54, local model 97, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1105/1112 (99.3705%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.9543, Accuracy: 5563/10000 (55.6300%)
___Train Local_Simple,  epoch  54, local model 67, internal_epoch   1,  Average loss: 0.0015, Accuracy: 429/441 (97.2789%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 2.4236, Accuracy: 4177/10000 (41.7700%)
___Train Local_Simple,  epoch  54, local model 8, internal_epoch   1,  Average loss: 0.0007, Accuracy: 698/706 (98.8669%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.6827, Accuracy: 5646/10000 (56.4600%)
___Train Local_Simple,  epoch  54, local model 59, internal_epoch   1,  Average loss: 0.0005, Accuracy: 636/644 (98.7578%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.2634, Accuracy: 7015/10000 (70.1500%)
___Train Local_Simple,  epoch  54, local model 4, internal_epoch   1,  Average loss: 0.0004, Accuracy: 743/748 (99.3316%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.0708, Accuracy: 7407/10000 (74.0700%)
___Train Local_Simple,  epoch  54, local model 75, internal_epoch   1,  Average loss: 0.0012, Accuracy: 745/763 (97.6409%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 5.2135, Accuracy: 3245/10000 (32.4500%)
___Train Local_Simple,  epoch  54, local model 2, internal_epoch   1,  Average loss: 0.0007, Accuracy: 555/564 (98.4043%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 2.6221, Accuracy: 4931/10000 (49.3100%)
___Train Local_Simple,  epoch  54, local model 65, internal_epoch   1,  Average loss: 0.0017, Accuracy: 604/621 (97.2625%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.9218, Accuracy: 7158/10000 (71.5800%)
___Train Local_Simple,  epoch  54, local model 69, internal_epoch   1,  Average loss: 0.0009, Accuracy: 659/671 (98.2116%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 3.4843, Accuracy: 3822/10000 (38.2200%)
___Train Local_Simple,  epoch  54, local model 94, internal_epoch   1,  Average loss: 0.0006, Accuracy: 663/671 (98.8077%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 2.7563, Accuracy: 6056/10000 (60.5600%)
___Train Local_Simple,  epoch  54, local model 1, internal_epoch   1,  Average loss: 0.0003, Accuracy: 535/536 (99.8134%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1569, Accuracy: 9459/10000 (94.5900%)
___Train Local_Simple,  epoch  54, local model 89, internal_epoch   1,  Average loss: 0.0014, Accuracy: 667/683 (97.6574%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 2.8731, Accuracy: 5412/10000 (54.1200%)
___Train Local_Simple,  epoch  54, local model 53, internal_epoch   1,  Average loss: 0.0005, Accuracy: 556/561 (99.1087%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.7405, Accuracy: 7891/10000 (78.9100%)
___Train Local_Simple,  epoch  54, local model 95, internal_epoch   1,  Average loss: 0.0017, Accuracy: 577/600 (96.1667%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 4.5901, Accuracy: 4233/10000 (42.3300%)
___Train Local_Simple,  epoch  54, local model 50, internal_epoch   1,  Average loss: 0.0009, Accuracy: 468/477 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.3351, Accuracy: 8876/10000 (88.7600%)
___Train Local_Simple,  epoch  54, local model 27, internal_epoch   1,  Average loss: 0.0009, Accuracy: 735/745 (98.6577%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.6373, Accuracy: 5977/10000 (59.7700%)
___Train Local_Simple,  epoch  54, local model 30, internal_epoch   1,  Average loss: 0.0005, Accuracy: 439/443 (99.0971%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.6794, Accuracy: 7860/10000 (78.6000%)
___Train Local_Simple,  epoch  54, local model 93, internal_epoch   1,  Average loss: 0.0010, Accuracy: 619/630 (98.2540%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 2.4284, Accuracy: 5604/10000 (56.0400%)
___Train Local_Simple,  epoch  54, local model 71, internal_epoch   1,  Average loss: 0.0007, Accuracy: 553/561 (98.5740%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.7602, Accuracy: 7674/10000 (76.7400%)
___Train Local_Simple,  epoch  54, local model 13, internal_epoch   1,  Average loss: 0.0005, Accuracy: 704/713 (98.7377%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.8839, Accuracy: 6340/10000 (63.4000%)
___Train Local_Simple,  epoch  54, local model 56, internal_epoch   1,  Average loss: 0.0004, Accuracy: 713/715 (99.7203%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.9397, Accuracy: 5797/10000 (57.9700%)
___Train Local_Simple,  epoch  54, local model 6, internal_epoch   1,  Average loss: 0.0007, Accuracy: 431/435 (99.0805%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.6806, Accuracy: 8033/10000 (80.3300%)
___Train Local_Simple,  epoch  54, local model 80, internal_epoch   1,  Average loss: 0.0025, Accuracy: 515/532 (96.8045%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 7.5187, Accuracy: 2046/10000 (20.4600%)
___Train Local_Simple,  epoch  54, local model 31, internal_epoch   1,  Average loss: 0.0006, Accuracy: 592/596 (99.3289%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.1918, Accuracy: 6658/10000 (66.5800%)
___Train Local_Simple,  epoch  54, local model 26, internal_epoch   1,  Average loss: 0.0007, Accuracy: 515/519 (99.2293%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 2.0449, Accuracy: 5548/10000 (55.4800%)
___Train Local_Simple,  epoch  54, local model 5, internal_epoch   1,  Average loss: 0.0005, Accuracy: 573/578 (99.1349%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.4526, Accuracy: 8569/10000 (85.6900%)
___Train Local_Simple,  epoch  54, local model 64, internal_epoch   1,  Average loss: 0.0005, Accuracy: 601/608 (98.8487%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 2.5844, Accuracy: 5071/10000 (50.7100%)
___Train Local_Simple,  epoch  54, local model 61, internal_epoch   1,  Average loss: 0.0010, Accuracy: 282/287 (98.2578%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.2478, Accuracy: 9235/10000 (92.3500%)
___Train Local_Simple,  epoch  54, local model 54, internal_epoch   1,  Average loss: 0.0004, Accuracy: 828/832 (99.5192%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 2.0071, Accuracy: 6102/10000 (61.0200%)
___Train Local_Simple,  epoch  54, local model 9, internal_epoch   1,  Average loss: 0.0009, Accuracy: 498/508 (98.0315%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.2762, Accuracy: 6986/10000 (69.8600%)
___Train Local_Simple,  epoch  54, local model 82, internal_epoch   1,  Average loss: 0.0008, Accuracy: 800/815 (98.1595%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 3.8767, Accuracy: 3862/10000 (38.6200%)
___Train Local_Simple,  epoch  54, local model 45, internal_epoch   1,  Average loss: 0.0006, Accuracy: 639/647 (98.7635%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 4.0194, Accuracy: 3994/10000 (39.9400%)
___Train Local_Simple,  epoch  54, local model 22, internal_epoch   1,  Average loss: 0.0003, Accuracy: 260/262 (99.2366%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.3381, Accuracy: 8915/10000 (89.1500%)
___Train Local_Simple,  epoch  54, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 778/789 (98.6058%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.7342, Accuracy: 6475/10000 (64.7500%)
___Train Local_Simple,  epoch  54, local model 7, internal_epoch   1,  Average loss: 0.0005, Accuracy: 797/802 (99.3766%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.6333, Accuracy: 6265/10000 (62.6500%)
___Train Local_Simple,  epoch  54, local model 57, internal_epoch   1,  Average loss: 0.0005, Accuracy: 517/523 (98.8528%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.0941, Accuracy: 6683/10000 (66.8300%)
time spent on training: 373.63172030448914
___Test Target_Simple poisoned: False, epoch: 54: Average loss: 0.0891, Accuracy: 9748/10000 (97.4800%)
___Test Target_Simple poisoned: True, epoch: 54: Average loss: 2.5000, Accuracy: 3654/8968 (40.7449%)
saving model
Done in 407.2769079208374 sec.
Server Epoch:55 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 79, 94, 42, 54, 70, 0, 27, 87, 55, 53, 13, 60, 16, 64, 36, 99, 72, 95, 23, 19, 31, 97, 82, 77, 38, 61, 5, 28, 10, 39, 47, 89, 98, 90, 58, 24, 20, 59, 96, 93, 12, 83, 8, 40, 75, 46, 25, 78, 15, 67, 1, 43, 69, 65, 48, 57, 52, 6, 44, 84, 21, 17, 85, 45, 50, 63, 2, 76, 34, 71, 68, 7, 26, 22, 81, 86, 4, 80, 30, 66, 9, 37, 35, 49, 92, 32, 56, 91, 14, 11].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   1,  Average loss: 0.0106, Accuracy: 454/569 (79.7891%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   2,  Average loss: 0.0018, Accuracy: 554/569 (97.3638%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   3,  Average loss: 0.0006, Accuracy: 565/569 (99.2970%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   4,  Average loss: 0.0003, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   5,  Average loss: 0.0003, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   6,  Average loss: 0.0004, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   8,  Average loss: 0.0002, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 41, internal_epoch  10,  Average loss: 0.0002, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Global model norm: 15.517375436254918.
Norm before scaling: 15.805811255155293. Distance: 3.2257627368856774
Total norm for 10 adversaries is: 15.805811255155293. distance: 3.2257627368856774
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.7968, Accuracy: 7005/8968 (78.1111%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 479/522 (91.7625%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   2,  Average loss: 0.0006, Accuracy: 516/522 (98.8506%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   3,  Average loss: 0.0004, Accuracy: 517/522 (99.0421%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   4,  Average loss: 0.0003, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   5,  Average loss: 0.0002, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   7,  Average loss: 0.0002, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 522/522 (100.0000%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 522/522 (100.0000%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Global model norm: 15.517375436254918.
Norm before scaling: 15.63426580732157. Distance: 1.7357302345404306
Total norm for 10 adversaries is: 15.63426580732157. distance: 1.7357302345404306
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0196, Accuracy: 8915/8968 (99.4090%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   1,  Average loss: 0.0064, Accuracy: 329/385 (85.4545%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   2,  Average loss: 0.0015, Accuracy: 376/385 (97.6623%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   3,  Average loss: 0.0016, Accuracy: 372/385 (96.6234%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   4,  Average loss: 0.0008, Accuracy: 381/385 (98.9610%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   5,  Average loss: 0.0007, Accuracy: 381/385 (98.9610%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   6,  Average loss: 0.0005, Accuracy: 383/385 (99.4805%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   7,  Average loss: 0.0006, Accuracy: 383/385 (99.4805%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   8,  Average loss: 0.0005, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   9,  Average loss: 0.0006, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch  10,  Average loss: 0.0005, Accuracy: 384/385 (99.7403%), train_poison_data_count: 193
Global model norm: 15.517375436254918.
Norm before scaling: 15.718802419768458. Distance: 2.3391838862763006
Total norm for 10 adversaries is: 15.718802419768458. distance: 2.3391838862763006
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0982, Accuracy: 8672/8968 (96.6994%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   1,  Average loss: 0.0031, Accuracy: 584/627 (93.1419%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   2,  Average loss: 0.0010, Accuracy: 614/627 (97.9266%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   3,  Average loss: 0.0007, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   4,  Average loss: 0.0005, Accuracy: 619/627 (98.7241%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   5,  Average loss: 0.0004, Accuracy: 620/627 (98.8836%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   6,  Average loss: 0.0003, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   7,  Average loss: 0.0006, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   8,  Average loss: 0.0003, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch   9,  Average loss: 0.0005, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 74, internal_epoch  10,  Average loss: 0.0004, Accuracy: 625/627 (99.6810%), train_poison_data_count: 320
Global model norm: 15.517375436254918.
Norm before scaling: 15.624188455487156. Distance: 1.843638594542924
Total norm for 10 adversaries is: 15.624188455487156. distance: 1.843638594542924
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0022, Accuracy: 8962/8968 (99.9331%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 3, internal_epoch   1,  Average loss: 0.0122, Accuracy: 398/516 (77.1318%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 3, internal_epoch   2,  Average loss: 0.0015, Accuracy: 509/516 (98.6434%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 3, internal_epoch   3,  Average loss: 0.0004, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 3, internal_epoch   4,  Average loss: 0.0002, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 3, internal_epoch   5,  Average loss: 0.0003, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 3, internal_epoch   6,  Average loss: 0.0002, Accuracy: 513/516 (99.4186%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 3, internal_epoch   7,  Average loss: 0.0002, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 3, internal_epoch   8,  Average loss: 0.0002, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 3, internal_epoch   9,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 3, internal_epoch  10,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 260
Global model norm: 15.517375436254918.
Norm before scaling: 15.846391506563785. Distance: 3.429326831388267
Total norm for 10 adversaries is: 15.846391506563785. distance: 3.429326831388267
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.5814, Accuracy: 7270/8968 (81.0660%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 18, internal_epoch   1,  Average loss: 0.0059, Accuracy: 684/759 (90.1186%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 18, internal_epoch   2,  Average loss: 0.0006, Accuracy: 753/759 (99.2095%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 18, internal_epoch   3,  Average loss: 0.0002, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 18, internal_epoch   4,  Average loss: 0.0002, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 18, internal_epoch   5,  Average loss: 0.0002, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 18, internal_epoch   6,  Average loss: 0.0002, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 18, internal_epoch   7,  Average loss: 0.0002, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 18, internal_epoch   8,  Average loss: 0.0002, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 18, internal_epoch   9,  Average loss: 0.0002, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 18, internal_epoch  10,  Average loss: 0.0001, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Global model norm: 15.517375436254918.
Norm before scaling: 16.07391355648911. Distance: 3.767740755343326
Total norm for 10 adversaries is: 16.07391355648911. distance: 3.767740755343326
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.1629, Accuracy: 8555/8968 (95.3947%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 29, internal_epoch   1,  Average loss: 0.0073, Accuracy: 439/506 (86.7589%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 29, internal_epoch   2,  Average loss: 0.0015, Accuracy: 494/506 (97.6285%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 29, internal_epoch   3,  Average loss: 0.0008, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 29, internal_epoch   4,  Average loss: 0.0005, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 29, internal_epoch   5,  Average loss: 0.0004, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 29, internal_epoch   6,  Average loss: 0.0003, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 29, internal_epoch   7,  Average loss: 0.0003, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 29, internal_epoch   8,  Average loss: 0.0002, Accuracy: 506/506 (100.0000%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 29, internal_epoch   9,  Average loss: 0.0002, Accuracy: 506/506 (100.0000%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 29, internal_epoch  10,  Average loss: 0.0002, Accuracy: 506/506 (100.0000%), train_poison_data_count: 256
Global model norm: 15.517375436254918.
Norm before scaling: 15.878526190869877. Distance: 2.9637109655595517
Total norm for 10 adversaries is: 15.878526190869877. distance: 2.9637109655595517
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.9554, Accuracy: 6817/8968 (76.0147%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 62, internal_epoch   1,  Average loss: 0.0028, Accuracy: 550/580 (94.8276%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 62, internal_epoch   2,  Average loss: 0.0010, Accuracy: 570/580 (98.2759%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 62, internal_epoch   3,  Average loss: 0.0009, Accuracy: 568/580 (97.9310%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 62, internal_epoch   4,  Average loss: 0.0009, Accuracy: 569/580 (98.1034%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 62, internal_epoch   5,  Average loss: 0.0006, Accuracy: 571/580 (98.4483%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 62, internal_epoch   6,  Average loss: 0.0006, Accuracy: 572/580 (98.6207%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 62, internal_epoch   7,  Average loss: 0.0005, Accuracy: 573/580 (98.7931%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 62, internal_epoch   8,  Average loss: 0.0005, Accuracy: 573/580 (98.7931%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 62, internal_epoch   9,  Average loss: 0.0004, Accuracy: 576/580 (99.3103%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 62, internal_epoch  10,  Average loss: 0.0002, Accuracy: 579/580 (99.8276%), train_poison_data_count: 292
Global model norm: 15.517375436254918.
Norm before scaling: 15.580504515954535. Distance: 1.5844980857936266
Total norm for 10 adversaries is: 15.580504515954535. distance: 1.5844980857936266
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0261, Accuracy: 8873/8968 (98.9407%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 33, internal_epoch   1,  Average loss: 0.0074, Accuracy: 485/587 (82.6235%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 33, internal_epoch   2,  Average loss: 0.0014, Accuracy: 569/587 (96.9336%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 33, internal_epoch   3,  Average loss: 0.0005, Accuracy: 581/587 (98.9779%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 33, internal_epoch   4,  Average loss: 0.0004, Accuracy: 582/587 (99.1482%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 33, internal_epoch   5,  Average loss: 0.0004, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 33, internal_epoch   6,  Average loss: 0.0002, Accuracy: 585/587 (99.6593%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 33, internal_epoch   7,  Average loss: 0.0004, Accuracy: 583/587 (99.3186%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 33, internal_epoch   8,  Average loss: 0.0002, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 33, internal_epoch   9,  Average loss: 0.0003, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 33, internal_epoch  10,  Average loss: 0.0003, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Global model norm: 15.517375436254918.
Norm before scaling: 15.898131811403925. Distance: 3.14148969750519
Total norm for 10 adversaries is: 15.898131811403925. distance: 3.14148969750519
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 1.2104, Accuracy: 6257/8968 (69.7703%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 88, internal_epoch   1,  Average loss: 0.0050, Accuracy: 662/734 (90.1907%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 88, internal_epoch   2,  Average loss: 0.0011, Accuracy: 720/734 (98.0926%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 88, internal_epoch   3,  Average loss: 0.0016, Accuracy: 708/734 (96.4578%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 88, internal_epoch   4,  Average loss: 0.0005, Accuracy: 729/734 (99.3188%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 88, internal_epoch   5,  Average loss: 0.0004, Accuracy: 729/734 (99.3188%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 88, internal_epoch   6,  Average loss: 0.0003, Accuracy: 729/734 (99.3188%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 88, internal_epoch   7,  Average loss: 0.0003, Accuracy: 729/734 (99.3188%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 88, internal_epoch   8,  Average loss: 0.0004, Accuracy: 729/734 (99.3188%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 88, internal_epoch   9,  Average loss: 0.0003, Accuracy: 731/734 (99.5913%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 88, internal_epoch  10,  Average loss: 0.0003, Accuracy: 732/734 (99.7275%), train_poison_data_count: 382
Global model norm: 15.517375436254918.
Norm before scaling: 15.79642631580276. Distance: 2.6614622251677504
Total norm for 10 adversaries is: 15.79642631580276. distance: 2.6614622251677504
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0623, Accuracy: 8777/8968 (97.8702%)
___Train Local_Simple,  epoch  55, local model 79, internal_epoch   1,  Average loss: 0.0008, Accuracy: 654/661 (98.9410%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.3739, Accuracy: 6664/10000 (66.6400%)
___Train Local_Simple,  epoch  55, local model 94, internal_epoch   1,  Average loss: 0.0007, Accuracy: 664/671 (98.9568%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 2.0022, Accuracy: 6394/10000 (63.9400%)
___Train Local_Simple,  epoch  55, local model 42, internal_epoch   1,  Average loss: 0.0004, Accuracy: 472/473 (99.7886%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.3714, Accuracy: 8669/10000 (86.6900%)
___Train Local_Simple,  epoch  55, local model 54, internal_epoch   1,  Average loss: 0.0004, Accuracy: 827/832 (99.3990%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.8634, Accuracy: 6294/10000 (62.9400%)
___Train Local_Simple,  epoch  55, local model 70, internal_epoch   1,  Average loss: 0.0008, Accuracy: 561/568 (98.7676%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.1586, Accuracy: 6742/10000 (67.4200%)
___Train Local_Simple,  epoch  55, local model 0, internal_epoch   1,  Average loss: 0.0006, Accuracy: 432/435 (99.3103%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.1507, Accuracy: 7265/10000 (72.6500%)
___Train Local_Simple,  epoch  55, local model 27, internal_epoch   1,  Average loss: 0.0004, Accuracy: 741/745 (99.4631%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.5527, Accuracy: 5939/10000 (59.3900%)
___Train Local_Simple,  epoch  55, local model 87, internal_epoch   1,  Average loss: 0.0007, Accuracy: 654/663 (98.6425%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 2.2269, Accuracy: 5932/10000 (59.3200%)
___Train Local_Simple,  epoch  55, local model 55, internal_epoch   1,  Average loss: 0.0009, Accuracy: 370/375 (98.6667%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.3631, Accuracy: 6689/10000 (66.8900%)
___Train Local_Simple,  epoch  55, local model 53, internal_epoch   1,  Average loss: 0.0009, Accuracy: 552/561 (98.3957%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 2.9153, Accuracy: 5860/10000 (58.6000%)
___Train Local_Simple,  epoch  55, local model 13, internal_epoch   1,  Average loss: 0.0010, Accuracy: 698/713 (97.8962%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 2.6945, Accuracy: 5503/10000 (55.0300%)
___Train Local_Simple,  epoch  55, local model 60, internal_epoch   1,  Average loss: 0.0008, Accuracy: 562/571 (98.4238%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 4.3469, Accuracy: 3595/10000 (35.9500%)
___Train Local_Simple,  epoch  55, local model 16, internal_epoch   1,  Average loss: 0.0003, Accuracy: 812/817 (99.3880%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.4803, Accuracy: 6646/10000 (66.4600%)
___Train Local_Simple,  epoch  55, local model 64, internal_epoch   1,  Average loss: 0.0003, Accuracy: 608/608 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.4419, Accuracy: 6578/10000 (65.7800%)
___Train Local_Simple,  epoch  55, local model 36, internal_epoch   1,  Average loss: 0.0004, Accuracy: 311/315 (98.7302%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1796, Accuracy: 9406/10000 (94.0600%)
___Train Local_Simple,  epoch  55, local model 99, internal_epoch   1,  Average loss: 0.0013, Accuracy: 685/712 (96.2079%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.7553, Accuracy: 6503/10000 (65.0300%)
___Train Local_Simple,  epoch  55, local model 72, internal_epoch   1,  Average loss: 0.0015, Accuracy: 413/423 (97.6359%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 3.0991, Accuracy: 4463/10000 (44.6300%)
___Train Local_Simple,  epoch  55, local model 95, internal_epoch   1,  Average loss: 0.0017, Accuracy: 586/600 (97.6667%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.2014, Accuracy: 6767/10000 (67.6700%)
___Train Local_Simple,  epoch  55, local model 23, internal_epoch   1,  Average loss: 0.0007, Accuracy: 534/542 (98.5240%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 2.3727, Accuracy: 5298/10000 (52.9800%)
___Train Local_Simple,  epoch  55, local model 19, internal_epoch   1,  Average loss: 0.0006, Accuracy: 593/598 (99.1639%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 2.5803, Accuracy: 5361/10000 (53.6100%)
___Train Local_Simple,  epoch  55, local model 31, internal_epoch   1,  Average loss: 0.0006, Accuracy: 588/596 (98.6577%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.3490, Accuracy: 6503/10000 (65.0300%)
___Train Local_Simple,  epoch  55, local model 97, internal_epoch   1,  Average loss: 0.0003, Accuracy: 1105/1112 (99.3705%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 5.9476, Accuracy: 3997/10000 (39.9700%)
___Train Local_Simple,  epoch  55, local model 82, internal_epoch   1,  Average loss: 0.0004, Accuracy: 810/815 (99.3865%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 3.8827, Accuracy: 4844/10000 (48.4400%)
___Train Local_Simple,  epoch  55, local model 77, internal_epoch   1,  Average loss: 0.0010, Accuracy: 606/618 (98.0583%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.9881, Accuracy: 5934/10000 (59.3400%)
___Train Local_Simple,  epoch  55, local model 38, internal_epoch   1,  Average loss: 0.0005, Accuracy: 472/477 (98.9518%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.3184, Accuracy: 9025/10000 (90.2500%)
___Train Local_Simple,  epoch  55, local model 61, internal_epoch   1,  Average loss: 0.0010, Accuracy: 284/287 (98.9547%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.2322, Accuracy: 9285/10000 (92.8500%)
___Train Local_Simple,  epoch  55, local model 5, internal_epoch   1,  Average loss: 0.0007, Accuracy: 569/578 (98.4429%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.5864, Accuracy: 8199/10000 (81.9900%)
___Train Local_Simple,  epoch  55, local model 28, internal_epoch   1,  Average loss: 0.0005, Accuracy: 603/611 (98.6907%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 2.0093, Accuracy: 6354/10000 (63.5400%)
___Train Local_Simple,  epoch  55, local model 10, internal_epoch   1,  Average loss: 0.0008, Accuracy: 567/573 (98.9529%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.6808, Accuracy: 7932/10000 (79.3200%)
___Train Local_Simple,  epoch  55, local model 39, internal_epoch   1,  Average loss: 0.0008, Accuracy: 483/493 (97.9716%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.5815, Accuracy: 6901/10000 (69.0100%)
___Train Local_Simple,  epoch  55, local model 47, internal_epoch   1,  Average loss: 0.0007, Accuracy: 528/534 (98.8764%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.2362, Accuracy: 6589/10000 (65.8900%)
___Train Local_Simple,  epoch  55, local model 89, internal_epoch   1,  Average loss: 0.0010, Accuracy: 669/683 (97.9502%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.5079, Accuracy: 6174/10000 (61.7400%)
___Train Local_Simple,  epoch  55, local model 98, internal_epoch   1,  Average loss: 0.0009, Accuracy: 538/548 (98.1752%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.6428, Accuracy: 6015/10000 (60.1500%)
___Train Local_Simple,  epoch  55, local model 90, internal_epoch   1,  Average loss: 0.0012, Accuracy: 606/615 (98.5366%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 2.2864, Accuracy: 6057/10000 (60.5700%)
___Train Local_Simple,  epoch  55, local model 58, internal_epoch   1,  Average loss: 0.0005, Accuracy: 766/772 (99.2228%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.5834, Accuracy: 6328/10000 (63.2800%)
___Train Local_Simple,  epoch  55, local model 24, internal_epoch   1,  Average loss: 0.0010, Accuracy: 467/477 (97.9036%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.4490, Accuracy: 6255/10000 (62.5500%)
___Train Local_Simple,  epoch  55, local model 20, internal_epoch   1,  Average loss: 0.0012, Accuracy: 592/602 (98.3389%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.5003, Accuracy: 6469/10000 (64.6900%)
___Train Local_Simple,  epoch  55, local model 59, internal_epoch   1,  Average loss: 0.0007, Accuracy: 637/644 (98.9130%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 2.4187, Accuracy: 5514/10000 (55.1400%)
___Train Local_Simple,  epoch  55, local model 96, internal_epoch   1,  Average loss: 0.0013, Accuracy: 517/531 (97.3635%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 2.0366, Accuracy: 6538/10000 (65.3800%)
___Train Local_Simple,  epoch  55, local model 93, internal_epoch   1,  Average loss: 0.0012, Accuracy: 617/630 (97.9365%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 2.5476, Accuracy: 4593/10000 (45.9300%)
___Train Local_Simple,  epoch  55, local model 12, internal_epoch   1,  Average loss: 0.0006, Accuracy: 716/725 (98.7586%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 3.2849, Accuracy: 5208/10000 (52.0800%)
___Train Local_Simple,  epoch  55, local model 83, internal_epoch   1,  Average loss: 0.0010, Accuracy: 353/360 (98.0556%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.3498, Accuracy: 8898/10000 (88.9800%)
___Train Local_Simple,  epoch  55, local model 8, internal_epoch   1,  Average loss: 0.0006, Accuracy: 700/706 (99.1501%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 2.3866, Accuracy: 5650/10000 (56.5000%)
___Train Local_Simple,  epoch  55, local model 40, internal_epoch   1,  Average loss: 0.0005, Accuracy: 493/498 (98.9960%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 2.2615, Accuracy: 6178/10000 (61.7800%)
___Train Local_Simple,  epoch  55, local model 75, internal_epoch   1,  Average loss: 0.0009, Accuracy: 752/763 (98.5583%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.7648, Accuracy: 6365/10000 (63.6500%)
___Train Local_Simple,  epoch  55, local model 46, internal_epoch   1,  Average loss: 0.0006, Accuracy: 644/650 (99.0769%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 3.3443, Accuracy: 5205/10000 (52.0500%)
___Train Local_Simple,  epoch  55, local model 25, internal_epoch   1,  Average loss: 0.0003, Accuracy: 591/592 (99.8311%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.3210, Accuracy: 7900/10000 (79.0000%)
___Train Local_Simple,  epoch  55, local model 78, internal_epoch   1,  Average loss: 0.0015, Accuracy: 572/587 (97.4446%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 3.9678, Accuracy: 3997/10000 (39.9700%)
___Train Local_Simple,  epoch  55, local model 15, internal_epoch   1,  Average loss: 0.0007, Accuracy: 280/282 (99.2908%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.3679, Accuracy: 8785/10000 (87.8500%)
___Train Local_Simple,  epoch  55, local model 67, internal_epoch   1,  Average loss: 0.0011, Accuracy: 432/441 (97.9592%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.9063, Accuracy: 7291/10000 (72.9100%)
___Train Local_Simple,  epoch  55, local model 1, internal_epoch   1,  Average loss: 0.0007, Accuracy: 534/536 (99.6269%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.2601, Accuracy: 9134/10000 (91.3400%)
___Train Local_Simple,  epoch  55, local model 43, internal_epoch   1,  Average loss: 0.0007, Accuracy: 425/431 (98.6079%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.7144, Accuracy: 7908/10000 (79.0800%)
___Train Local_Simple,  epoch  55, local model 69, internal_epoch   1,  Average loss: 0.0009, Accuracy: 659/671 (98.2116%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 3.6172, Accuracy: 4689/10000 (46.8900%)
___Train Local_Simple,  epoch  55, local model 65, internal_epoch   1,  Average loss: 0.0013, Accuracy: 605/621 (97.4235%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 3.4458, Accuracy: 4368/10000 (43.6800%)
___Train Local_Simple,  epoch  55, local model 48, internal_epoch   1,  Average loss: 0.0012, Accuracy: 354/363 (97.5207%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.6049, Accuracy: 8136/10000 (81.3600%)
___Train Local_Simple,  epoch  55, local model 57, internal_epoch   1,  Average loss: 0.0006, Accuracy: 517/523 (98.8528%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.5213, Accuracy: 6219/10000 (62.1900%)
___Train Local_Simple,  epoch  55, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 779/789 (98.7326%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 4.6654, Accuracy: 4593/10000 (45.9300%)
___Train Local_Simple,  epoch  55, local model 6, internal_epoch   1,  Average loss: 0.0006, Accuracy: 432/435 (99.3103%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.0543, Accuracy: 7680/10000 (76.8000%)
___Train Local_Simple,  epoch  55, local model 44, internal_epoch   1,  Average loss: 0.0003, Accuracy: 557/561 (99.2870%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.2497, Accuracy: 7471/10000 (74.7100%)
___Train Local_Simple,  epoch  55, local model 84, internal_epoch   1,  Average loss: 0.0018, Accuracy: 406/420 (96.6667%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.6375, Accuracy: 7922/10000 (79.2200%)
___Train Local_Simple,  epoch  55, local model 21, internal_epoch   1,  Average loss: 0.0004, Accuracy: 683/687 (99.4178%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.1175, Accuracy: 7148/10000 (71.4800%)
___Train Local_Simple,  epoch  55, local model 17, internal_epoch   1,  Average loss: 0.0009, Accuracy: 520/527 (98.6717%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 2.6716, Accuracy: 5141/10000 (51.4100%)
___Train Local_Simple,  epoch  55, local model 85, internal_epoch   1,  Average loss: 0.0012, Accuracy: 785/807 (97.2739%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 4.3749, Accuracy: 4921/10000 (49.2100%)
___Train Local_Simple,  epoch  55, local model 45, internal_epoch   1,  Average loss: 0.0006, Accuracy: 641/647 (99.0726%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.4187, Accuracy: 6257/10000 (62.5700%)
___Train Local_Simple,  epoch  55, local model 50, internal_epoch   1,  Average loss: 0.0007, Accuracy: 468/477 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.0152, Accuracy: 7011/10000 (70.1100%)
___Train Local_Simple,  epoch  55, local model 63, internal_epoch   1,  Average loss: 0.0009, Accuracy: 300/303 (99.0099%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.6223, Accuracy: 8125/10000 (81.2500%)
___Train Local_Simple,  epoch  55, local model 2, internal_epoch   1,  Average loss: 0.0006, Accuracy: 557/564 (98.7589%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.0155, Accuracy: 7491/10000 (74.9100%)
___Train Local_Simple,  epoch  55, local model 76, internal_epoch   1,  Average loss: 0.0009, Accuracy: 456/459 (99.3464%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.7808, Accuracy: 8209/10000 (82.0900%)
___Train Local_Simple,  epoch  55, local model 34, internal_epoch   1,  Average loss: 0.0008, Accuracy: 857/871 (98.3927%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 4.8426, Accuracy: 4076/10000 (40.7600%)
___Train Local_Simple,  epoch  55, local model 71, internal_epoch   1,  Average loss: 0.0008, Accuracy: 554/561 (98.7522%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.6064, Accuracy: 6318/10000 (63.1800%)
___Train Local_Simple,  epoch  55, local model 68, internal_epoch   1,  Average loss: 0.0012, Accuracy: 539/549 (98.1785%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 2.4948, Accuracy: 5279/10000 (52.7900%)
___Train Local_Simple,  epoch  55, local model 7, internal_epoch   1,  Average loss: 0.0003, Accuracy: 795/802 (99.1272%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.3468, Accuracy: 6622/10000 (66.2200%)
___Train Local_Simple,  epoch  55, local model 26, internal_epoch   1,  Average loss: 0.0007, Accuracy: 512/519 (98.6513%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.7216, Accuracy: 5936/10000 (59.3600%)
___Train Local_Simple,  epoch  55, local model 22, internal_epoch   1,  Average loss: 0.0007, Accuracy: 258/262 (98.4733%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.4136, Accuracy: 8743/10000 (87.4300%)
___Train Local_Simple,  epoch  55, local model 81, internal_epoch   1,  Average loss: 0.0007, Accuracy: 630/636 (99.0566%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.4544, Accuracy: 6446/10000 (64.4600%)
___Train Local_Simple,  epoch  55, local model 86, internal_epoch   1,  Average loss: 0.0005, Accuracy: 685/692 (98.9884%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 2.5305, Accuracy: 4807/10000 (48.0700%)
___Train Local_Simple,  epoch  55, local model 4, internal_epoch   1,  Average loss: 0.0007, Accuracy: 742/748 (99.1979%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.5528, Accuracy: 6493/10000 (64.9300%)
___Train Local_Simple,  epoch  55, local model 80, internal_epoch   1,  Average loss: 0.0010, Accuracy: 520/532 (97.7444%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 4.5597, Accuracy: 3448/10000 (34.4800%)
___Train Local_Simple,  epoch  55, local model 30, internal_epoch   1,  Average loss: 0.0007, Accuracy: 438/443 (98.8713%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.2143, Accuracy: 7454/10000 (74.5400%)
___Train Local_Simple,  epoch  55, local model 66, internal_epoch   1,  Average loss: 0.0012, Accuracy: 714/733 (97.4079%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 4.0591, Accuracy: 3861/10000 (38.6100%)
___Train Local_Simple,  epoch  55, local model 9, internal_epoch   1,  Average loss: 0.0007, Accuracy: 501/508 (98.6220%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.5901, Accuracy: 8145/10000 (81.4500%)
___Train Local_Simple,  epoch  55, local model 37, internal_epoch   1,  Average loss: 0.0005, Accuracy: 452/456 (99.1228%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.6888, Accuracy: 7867/10000 (78.6700%)
___Train Local_Simple,  epoch  55, local model 35, internal_epoch   1,  Average loss: 0.0011, Accuracy: 616/630 (97.7778%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 2.0008, Accuracy: 5952/10000 (59.5200%)
___Train Local_Simple,  epoch  55, local model 49, internal_epoch   1,  Average loss: 0.0009, Accuracy: 348/355 (98.0282%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.9484, Accuracy: 6950/10000 (69.5000%)
___Train Local_Simple,  epoch  55, local model 92, internal_epoch   1,  Average loss: 0.0015, Accuracy: 593/611 (97.0540%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 3.7210, Accuracy: 3775/10000 (37.7500%)
___Train Local_Simple,  epoch  55, local model 32, internal_epoch   1,  Average loss: 0.0004, Accuracy: 588/590 (99.6610%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.5143, Accuracy: 6761/10000 (67.6100%)
___Train Local_Simple,  epoch  55, local model 56, internal_epoch   1,  Average loss: 0.0005, Accuracy: 708/715 (99.0210%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.7398, Accuracy: 5854/10000 (58.5400%)
___Train Local_Simple,  epoch  55, local model 91, internal_epoch   1,  Average loss: 0.0004, Accuracy: 813/819 (99.2674%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.3019, Accuracy: 6632/10000 (66.3200%)
___Train Local_Simple,  epoch  55, local model 14, internal_epoch   1,  Average loss: 0.0010, Accuracy: 677/692 (97.8324%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.2083, Accuracy: 7103/10000 (71.0300%)
___Train Local_Simple,  epoch  55, local model 11, internal_epoch   1,  Average loss: 0.0005, Accuracy: 548/554 (98.9170%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.0985, Accuracy: 7361/10000 (73.6100%)
time spent on training: 376.21055340766907
___Test Target_Simple poisoned: False, epoch: 55: Average loss: 0.0896, Accuracy: 9748/10000 (97.4800%)
___Test Target_Simple poisoned: True, epoch: 55: Average loss: 2.4015, Accuracy: 3908/8968 (43.5772%)
saving model
Done in 402.4030337333679 sec.
Server Epoch:56 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 96, 69, 77, 37, 56, 60, 12, 93, 57, 39, 34, 27, 40, 52, 68, 14, 67, 55, 54, 13, 53, 19, 42, 2, 22, 43, 99, 80, 28, 1, 87, 81, 11, 75, 71, 86, 9, 92, 35, 72, 30, 98, 90, 65, 47, 58, 79, 70, 24, 16, 50, 84, 85, 45, 91, 82, 8, 4, 25, 38, 83, 63, 23, 26, 7, 49, 6, 15, 48, 21, 17, 5, 10, 46, 59, 36, 78, 20, 94, 44, 32, 95, 76, 89, 97, 66, 64, 31, 61, 0].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   1,  Average loss: 0.0116, Accuracy: 435/569 (76.4499%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   2,  Average loss: 0.0013, Accuracy: 564/569 (99.1213%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   3,  Average loss: 0.0003, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   4,  Average loss: 0.0003, Accuracy: 565/569 (99.2970%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   5,  Average loss: 0.0002, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   6,  Average loss: 0.0004, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   7,  Average loss: 0.0004, Accuracy: 565/569 (99.2970%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   8,  Average loss: 0.0002, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   9,  Average loss: 0.0002, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch  10,  Average loss: 0.0003, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Global model norm: 15.524087708923057.
Norm before scaling: 15.888888313868467. Distance: 3.4160029224052706
Total norm for 10 adversaries is: 15.888888313868467. distance: 3.4160029224052706
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.8269, Accuracy: 7145/8968 (79.6722%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   1,  Average loss: 0.0024, Accuracy: 498/522 (95.4023%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   2,  Average loss: 0.0005, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   3,  Average loss: 0.0004, Accuracy: 516/522 (98.8506%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   5,  Average loss: 0.0002, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 522/522 (100.0000%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 522/522 (100.0000%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 73, internal_epoch  10,  Average loss: 0.0000, Accuracy: 522/522 (100.0000%), train_poison_data_count: 266
Global model norm: 15.524087708923057.
Norm before scaling: 15.617972540767886. Distance: 1.431904558986437
Total norm for 10 adversaries is: 15.617972540767886. distance: 1.431904558986437
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0377, Accuracy: 8863/8968 (98.8292%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   1,  Average loss: 0.0063, Accuracy: 330/385 (85.7143%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   2,  Average loss: 0.0014, Accuracy: 371/385 (96.3636%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   3,  Average loss: 0.0019, Accuracy: 362/385 (94.0260%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   4,  Average loss: 0.0008, Accuracy: 377/385 (97.9221%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   5,  Average loss: 0.0008, Accuracy: 379/385 (98.4416%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   6,  Average loss: 0.0006, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   7,  Average loss: 0.0004, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   8,  Average loss: 0.0004, Accuracy: 384/385 (99.7403%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch   9,  Average loss: 0.0004, Accuracy: 384/385 (99.7403%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 51, internal_epoch  10,  Average loss: 0.0003, Accuracy: 384/385 (99.7403%), train_poison_data_count: 193
Global model norm: 15.524087708923057.
Norm before scaling: 15.718376261399326. Distance: 2.0760501456258997
Total norm for 10 adversaries is: 15.718376261399326. distance: 2.0760501456258997
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.1847, Accuracy: 8392/8968 (93.5772%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   1,  Average loss: 0.0042, Accuracy: 575/627 (91.7065%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   2,  Average loss: 0.0013, Accuracy: 614/627 (97.9266%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   3,  Average loss: 0.0006, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   4,  Average loss: 0.0008, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   5,  Average loss: 0.0005, Accuracy: 621/627 (99.0431%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   6,  Average loss: 0.0003, Accuracy: 625/627 (99.6810%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   7,  Average loss: 0.0007, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   8,  Average loss: 0.0004, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch   9,  Average loss: 0.0004, Accuracy: 624/627 (99.5215%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 74, internal_epoch  10,  Average loss: 0.0006, Accuracy: 623/627 (99.3620%), train_poison_data_count: 320
Global model norm: 15.524087708923057.
Norm before scaling: 15.744814064379261. Distance: 2.47294646333281
Total norm for 10 adversaries is: 15.744814064379261. distance: 2.47294646333281
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0003, Accuracy: 8967/8968 (99.9888%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 3, internal_epoch   1,  Average loss: 0.0116, Accuracy: 406/516 (78.6822%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 3, internal_epoch   2,  Average loss: 0.0020, Accuracy: 497/516 (96.3178%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 3, internal_epoch   3,  Average loss: 0.0006, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 3, internal_epoch   4,  Average loss: 0.0003, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 3, internal_epoch   5,  Average loss: 0.0004, Accuracy: 513/516 (99.4186%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 3, internal_epoch   6,  Average loss: 0.0002, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 3, internal_epoch   7,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 3, internal_epoch   8,  Average loss: 0.0002, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 3, internal_epoch   9,  Average loss: 0.0002, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 3, internal_epoch  10,  Average loss: 0.0002, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Global model norm: 15.524087708923057.
Norm before scaling: 15.921514654901713. Distance: 3.6087881164334825
Total norm for 10 adversaries is: 15.921514654901713. distance: 3.6087881164334825
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.4150, Accuracy: 8014/8968 (89.3622%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 18, internal_epoch   1,  Average loss: 0.0039, Accuracy: 698/759 (91.9631%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 18, internal_epoch   2,  Average loss: 0.0007, Accuracy: 744/759 (98.0237%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 18, internal_epoch   3,  Average loss: 0.0005, Accuracy: 747/759 (98.4190%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 18, internal_epoch   4,  Average loss: 0.0002, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 18, internal_epoch   5,  Average loss: 0.0002, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 18, internal_epoch   6,  Average loss: 0.0002, Accuracy: 755/759 (99.4730%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 18, internal_epoch   7,  Average loss: 0.0001, Accuracy: 759/759 (100.0000%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 18, internal_epoch   8,  Average loss: 0.0002, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 18, internal_epoch   9,  Average loss: 0.0001, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 18, internal_epoch  10,  Average loss: 0.0001, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Global model norm: 15.524087708923057.
Norm before scaling: 15.921337833645952. Distance: 3.0336984400696063
Total norm for 10 adversaries is: 15.921337833645952. distance: 3.0336984400696063
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0072, Accuracy: 8946/8968 (99.7547%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 29, internal_epoch   1,  Average loss: 0.0051, Accuracy: 450/506 (88.9328%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 29, internal_epoch   2,  Average loss: 0.0015, Accuracy: 495/506 (97.8261%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 29, internal_epoch   3,  Average loss: 0.0005, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 29, internal_epoch   4,  Average loss: 0.0005, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 29, internal_epoch   5,  Average loss: 0.0006, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 29, internal_epoch   6,  Average loss: 0.0004, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 29, internal_epoch   7,  Average loss: 0.0003, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 29, internal_epoch   8,  Average loss: 0.0003, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 29, internal_epoch   9,  Average loss: 0.0002, Accuracy: 506/506 (100.0000%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 29, internal_epoch  10,  Average loss: 0.0002, Accuracy: 506/506 (100.0000%), train_poison_data_count: 256
Global model norm: 15.524087708923057.
Norm before scaling: 15.81861728957691. Distance: 2.532033634155243
Total norm for 10 adversaries is: 15.81861728957691. distance: 2.532033634155243
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.2511, Accuracy: 8190/8968 (91.3247%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 62, internal_epoch   1,  Average loss: 0.0022, Accuracy: 554/580 (95.5172%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 62, internal_epoch   2,  Average loss: 0.0016, Accuracy: 559/580 (96.3793%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 62, internal_epoch   3,  Average loss: 0.0009, Accuracy: 570/580 (98.2759%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 62, internal_epoch   4,  Average loss: 0.0010, Accuracy: 565/580 (97.4138%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 62, internal_epoch   5,  Average loss: 0.0006, Accuracy: 572/580 (98.6207%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 62, internal_epoch   6,  Average loss: 0.0008, Accuracy: 568/580 (97.9310%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 62, internal_epoch   7,  Average loss: 0.0003, Accuracy: 577/580 (99.4828%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 62, internal_epoch   8,  Average loss: 0.0005, Accuracy: 572/580 (98.6207%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 62, internal_epoch   9,  Average loss: 0.0003, Accuracy: 575/580 (99.1379%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 62, internal_epoch  10,  Average loss: 0.0002, Accuracy: 578/580 (99.6552%), train_poison_data_count: 292
Global model norm: 15.524087708923057.
Norm before scaling: 15.563704968725013. Distance: 1.4456512054297952
Total norm for 10 adversaries is: 15.563704968725013. distance: 1.4456512054297952
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0134, Accuracy: 8925/8968 (99.5205%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 33, internal_epoch   1,  Average loss: 0.0073, Accuracy: 487/587 (82.9642%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 33, internal_epoch   2,  Average loss: 0.0008, Accuracy: 578/587 (98.4668%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 33, internal_epoch   3,  Average loss: 0.0005, Accuracy: 582/587 (99.1482%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 33, internal_epoch   4,  Average loss: 0.0002, Accuracy: 586/587 (99.8296%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 33, internal_epoch   5,  Average loss: 0.0004, Accuracy: 583/587 (99.3186%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 33, internal_epoch   6,  Average loss: 0.0002, Accuracy: 586/587 (99.8296%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 33, internal_epoch   7,  Average loss: 0.0002, Accuracy: 585/587 (99.6593%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 33, internal_epoch   8,  Average loss: 0.0003, Accuracy: 583/587 (99.3186%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 33, internal_epoch   9,  Average loss: 0.0002, Accuracy: 585/587 (99.6593%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 33, internal_epoch  10,  Average loss: 0.0003, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Global model norm: 15.524087708923057.
Norm before scaling: 15.88238545832079. Distance: 2.856712727867138
Total norm for 10 adversaries is: 15.88238545832079. distance: 2.856712727867138
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.5785, Accuracy: 7651/8968 (85.3145%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 88, internal_epoch   1,  Average loss: 0.0040, Accuracy: 669/734 (91.1444%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 88, internal_epoch   2,  Average loss: 0.0012, Accuracy: 711/734 (96.8665%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 88, internal_epoch   3,  Average loss: 0.0009, Accuracy: 714/734 (97.2752%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 88, internal_epoch   4,  Average loss: 0.0006, Accuracy: 725/734 (98.7738%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 88, internal_epoch   5,  Average loss: 0.0005, Accuracy: 727/734 (99.0463%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 88, internal_epoch   6,  Average loss: 0.0003, Accuracy: 731/734 (99.5913%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 88, internal_epoch   7,  Average loss: 0.0003, Accuracy: 729/734 (99.3188%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 88, internal_epoch   8,  Average loss: 0.0003, Accuracy: 730/734 (99.4550%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 88, internal_epoch   9,  Average loss: 0.0003, Accuracy: 729/734 (99.3188%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 88, internal_epoch  10,  Average loss: 0.0002, Accuracy: 733/734 (99.8638%), train_poison_data_count: 382
Global model norm: 15.524087708923057.
Norm before scaling: 15.749896821183613. Distance: 2.445235668596298
Total norm for 10 adversaries is: 15.749896821183613. distance: 2.445235668596298
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0548, Accuracy: 8795/8968 (98.0709%)
___Train Local_Simple,  epoch  56, local model 96, internal_epoch   1,  Average loss: 0.0007, Accuracy: 522/531 (98.3051%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 4.2133, Accuracy: 4628/10000 (46.2800%)
___Train Local_Simple,  epoch  56, local model 69, internal_epoch   1,  Average loss: 0.0009, Accuracy: 659/671 (98.2116%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 3.8497, Accuracy: 3908/10000 (39.0800%)
___Train Local_Simple,  epoch  56, local model 77, internal_epoch   1,  Average loss: 0.0013, Accuracy: 599/618 (96.9256%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 2.7310, Accuracy: 5486/10000 (54.8600%)
___Train Local_Simple,  epoch  56, local model 37, internal_epoch   1,  Average loss: 0.0006, Accuracy: 451/456 (98.9035%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.5620, Accuracy: 7152/10000 (71.5200%)
___Train Local_Simple,  epoch  56, local model 56, internal_epoch   1,  Average loss: 0.0003, Accuracy: 711/715 (99.4406%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.7963, Accuracy: 5742/10000 (57.4200%)
___Train Local_Simple,  epoch  56, local model 60, internal_epoch   1,  Average loss: 0.0009, Accuracy: 562/571 (98.4238%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.3311, Accuracy: 6580/10000 (65.8000%)
___Train Local_Simple,  epoch  56, local model 12, internal_epoch   1,  Average loss: 0.0005, Accuracy: 718/725 (99.0345%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.1894, Accuracy: 7049/10000 (70.4900%)
___Train Local_Simple,  epoch  56, local model 93, internal_epoch   1,  Average loss: 0.0011, Accuracy: 612/630 (97.1429%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 2.1907, Accuracy: 5331/10000 (53.3100%)
___Train Local_Simple,  epoch  56, local model 57, internal_epoch   1,  Average loss: 0.0006, Accuracy: 515/523 (98.4704%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.8958, Accuracy: 5420/10000 (54.2000%)
___Train Local_Simple,  epoch  56, local model 39, internal_epoch   1,  Average loss: 0.0005, Accuracy: 487/493 (98.7830%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.4093, Accuracy: 7086/10000 (70.8600%)
___Train Local_Simple,  epoch  56, local model 34, internal_epoch   1,  Average loss: 0.0013, Accuracy: 848/871 (97.3594%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 3.5230, Accuracy: 3892/10000 (38.9200%)
___Train Local_Simple,  epoch  56, local model 27, internal_epoch   1,  Average loss: 0.0005, Accuracy: 738/745 (99.0604%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 2.2751, Accuracy: 5078/10000 (50.7800%)
___Train Local_Simple,  epoch  56, local model 40, internal_epoch   1,  Average loss: 0.0004, Accuracy: 496/498 (99.5984%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.5842, Accuracy: 6686/10000 (66.8600%)
___Train Local_Simple,  epoch  56, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 777/789 (98.4791%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.6011, Accuracy: 6830/10000 (68.3000%)
___Train Local_Simple,  epoch  56, local model 68, internal_epoch   1,  Average loss: 0.0012, Accuracy: 540/549 (98.3607%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 2.2042, Accuracy: 5402/10000 (54.0200%)
___Train Local_Simple,  epoch  56, local model 14, internal_epoch   1,  Average loss: 0.0009, Accuracy: 674/692 (97.3988%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.8873, Accuracy: 7364/10000 (73.6400%)
___Train Local_Simple,  epoch  56, local model 67, internal_epoch   1,  Average loss: 0.0011, Accuracy: 432/441 (97.9592%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.2545, Accuracy: 6374/10000 (63.7400%)
___Train Local_Simple,  epoch  56, local model 55, internal_epoch   1,  Average loss: 0.0012, Accuracy: 365/375 (97.3333%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.3067, Accuracy: 8875/10000 (88.7500%)
___Train Local_Simple,  epoch  56, local model 54, internal_epoch   1,  Average loss: 0.0004, Accuracy: 825/832 (99.1587%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 2.1658, Accuracy: 6597/10000 (65.9700%)
___Train Local_Simple,  epoch  56, local model 13, internal_epoch   1,  Average loss: 0.0005, Accuracy: 706/713 (99.0182%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 2.3593, Accuracy: 5853/10000 (58.5300%)
___Train Local_Simple,  epoch  56, local model 53, internal_epoch   1,  Average loss: 0.0006, Accuracy: 554/561 (98.7522%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.3971, Accuracy: 7193/10000 (71.9300%)
___Train Local_Simple,  epoch  56, local model 19, internal_epoch   1,  Average loss: 0.0006, Accuracy: 592/598 (98.9967%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.3586, Accuracy: 6594/10000 (65.9400%)
___Train Local_Simple,  epoch  56, local model 42, internal_epoch   1,  Average loss: 0.0002, Accuracy: 473/473 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.2737, Accuracy: 8996/10000 (89.9600%)
___Train Local_Simple,  epoch  56, local model 2, internal_epoch   1,  Average loss: 0.0007, Accuracy: 559/564 (99.1135%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.6942, Accuracy: 5675/10000 (56.7500%)
___Train Local_Simple,  epoch  56, local model 22, internal_epoch   1,  Average loss: 0.0005, Accuracy: 260/262 (99.2366%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.3315, Accuracy: 8908/10000 (89.0800%)
___Train Local_Simple,  epoch  56, local model 43, internal_epoch   1,  Average loss: 0.0006, Accuracy: 426/431 (98.8399%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.6235, Accuracy: 8074/10000 (80.7400%)
___Train Local_Simple,  epoch  56, local model 99, internal_epoch   1,  Average loss: 0.0024, Accuracy: 671/712 (94.2416%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.4657, Accuracy: 6347/10000 (63.4700%)
___Train Local_Simple,  epoch  56, local model 80, internal_epoch   1,  Average loss: 0.0013, Accuracy: 520/532 (97.7444%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 4.4183, Accuracy: 3193/10000 (31.9300%)
___Train Local_Simple,  epoch  56, local model 28, internal_epoch   1,  Average loss: 0.0007, Accuracy: 599/611 (98.0360%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 2.0922, Accuracy: 6214/10000 (62.1400%)
___Train Local_Simple,  epoch  56, local model 1, internal_epoch   1,  Average loss: 0.0002, Accuracy: 535/536 (99.8134%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1664, Accuracy: 9445/10000 (94.4500%)
___Train Local_Simple,  epoch  56, local model 87, internal_epoch   1,  Average loss: 0.0008, Accuracy: 653/663 (98.4917%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 3.2375, Accuracy: 4362/10000 (43.6200%)
___Train Local_Simple,  epoch  56, local model 81, internal_epoch   1,  Average loss: 0.0009, Accuracy: 625/636 (98.2704%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 2.0073, Accuracy: 5316/10000 (53.1600%)
___Train Local_Simple,  epoch  56, local model 11, internal_epoch   1,  Average loss: 0.0004, Accuracy: 549/554 (99.0975%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.4232, Accuracy: 8634/10000 (86.3400%)
___Train Local_Simple,  epoch  56, local model 75, internal_epoch   1,  Average loss: 0.0011, Accuracy: 744/763 (97.5098%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 2.6540, Accuracy: 4629/10000 (46.2900%)
___Train Local_Simple,  epoch  56, local model 71, internal_epoch   1,  Average loss: 0.0008, Accuracy: 550/561 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.8282, Accuracy: 7637/10000 (76.3700%)
___Train Local_Simple,  epoch  56, local model 86, internal_epoch   1,  Average loss: 0.0006, Accuracy: 683/692 (98.6994%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 4.1624, Accuracy: 4080/10000 (40.8000%)
___Train Local_Simple,  epoch  56, local model 9, internal_epoch   1,  Average loss: 0.0009, Accuracy: 498/508 (98.0315%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.8700, Accuracy: 7460/10000 (74.6000%)
___Train Local_Simple,  epoch  56, local model 92, internal_epoch   1,  Average loss: 0.0019, Accuracy: 589/611 (96.3993%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 3.7121, Accuracy: 4048/10000 (40.4800%)
___Train Local_Simple,  epoch  56, local model 35, internal_epoch   1,  Average loss: 0.0011, Accuracy: 612/630 (97.1429%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 3.0899, Accuracy: 4933/10000 (49.3300%)
___Train Local_Simple,  epoch  56, local model 72, internal_epoch   1,  Average loss: 0.0012, Accuracy: 412/423 (97.3995%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 3.0842, Accuracy: 3866/10000 (38.6600%)
___Train Local_Simple,  epoch  56, local model 30, internal_epoch   1,  Average loss: 0.0008, Accuracy: 438/443 (98.8713%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.4582, Accuracy: 8450/10000 (84.5000%)
___Train Local_Simple,  epoch  56, local model 98, internal_epoch   1,  Average loss: 0.0013, Accuracy: 538/548 (98.1752%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 3.9233, Accuracy: 3601/10000 (36.0100%)
___Train Local_Simple,  epoch  56, local model 90, internal_epoch   1,  Average loss: 0.0011, Accuracy: 599/615 (97.3984%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 2.2611, Accuracy: 5690/10000 (56.9000%)
___Train Local_Simple,  epoch  56, local model 65, internal_epoch   1,  Average loss: 0.0014, Accuracy: 603/621 (97.1014%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.1483, Accuracy: 6344/10000 (63.4400%)
___Train Local_Simple,  epoch  56, local model 47, internal_epoch   1,  Average loss: 0.0009, Accuracy: 525/534 (98.3146%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 2.7185, Accuracy: 5008/10000 (50.0800%)
___Train Local_Simple,  epoch  56, local model 58, internal_epoch   1,  Average loss: 0.0005, Accuracy: 765/772 (99.0933%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.2115, Accuracy: 7309/10000 (73.0900%)
___Train Local_Simple,  epoch  56, local model 79, internal_epoch   1,  Average loss: 0.0008, Accuracy: 655/661 (99.0923%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.9305, Accuracy: 7321/10000 (73.2100%)
___Train Local_Simple,  epoch  56, local model 70, internal_epoch   1,  Average loss: 0.0010, Accuracy: 557/568 (98.0634%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 2.4847, Accuracy: 5178/10000 (51.7800%)
___Train Local_Simple,  epoch  56, local model 24, internal_epoch   1,  Average loss: 0.0011, Accuracy: 467/477 (97.9036%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.9685, Accuracy: 6846/10000 (68.4600%)
___Train Local_Simple,  epoch  56, local model 16, internal_epoch   1,  Average loss: 0.0002, Accuracy: 815/817 (99.7552%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.1218, Accuracy: 7594/10000 (75.9400%)
___Train Local_Simple,  epoch  56, local model 50, internal_epoch   1,  Average loss: 0.0008, Accuracy: 471/477 (98.7421%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.7249, Accuracy: 7753/10000 (77.5300%)
___Train Local_Simple,  epoch  56, local model 84, internal_epoch   1,  Average loss: 0.0008, Accuracy: 413/420 (98.3333%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.6400, Accuracy: 8168/10000 (81.6800%)
___Train Local_Simple,  epoch  56, local model 85, internal_epoch   1,  Average loss: 0.0009, Accuracy: 790/807 (97.8934%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 2.3938, Accuracy: 5905/10000 (59.0500%)
___Train Local_Simple,  epoch  56, local model 45, internal_epoch   1,  Average loss: 0.0005, Accuracy: 641/647 (99.0726%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.8055, Accuracy: 5944/10000 (59.4400%)
___Train Local_Simple,  epoch  56, local model 91, internal_epoch   1,  Average loss: 0.0003, Accuracy: 814/819 (99.3895%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 2.4896, Accuracy: 5747/10000 (57.4700%)
___Train Local_Simple,  epoch  56, local model 82, internal_epoch   1,  Average loss: 0.0004, Accuracy: 809/815 (99.2638%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 3.2115, Accuracy: 4716/10000 (47.1600%)
___Train Local_Simple,  epoch  56, local model 8, internal_epoch   1,  Average loss: 0.0014, Accuracy: 696/706 (98.5836%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 8.8646, Accuracy: 2215/10000 (22.1500%)
___Train Local_Simple,  epoch  56, local model 4, internal_epoch   1,  Average loss: 0.0004, Accuracy: 743/748 (99.3316%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 2.2412, Accuracy: 5338/10000 (53.3800%)
___Train Local_Simple,  epoch  56, local model 25, internal_epoch   1,  Average loss: 0.0002, Accuracy: 588/592 (99.3243%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.8830, Accuracy: 7834/10000 (78.3400%)
___Train Local_Simple,  epoch  56, local model 38, internal_epoch   1,  Average loss: 0.0007, Accuracy: 472/477 (98.9518%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1878, Accuracy: 9399/10000 (93.9900%)
___Train Local_Simple,  epoch  56, local model 83, internal_epoch   1,  Average loss: 0.0011, Accuracy: 351/360 (97.5000%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1701, Accuracy: 9466/10000 (94.6600%)
___Train Local_Simple,  epoch  56, local model 63, internal_epoch   1,  Average loss: 0.0013, Accuracy: 295/303 (97.3597%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 2.2081, Accuracy: 5246/10000 (52.4600%)
___Train Local_Simple,  epoch  56, local model 23, internal_epoch   1,  Average loss: 0.0012, Accuracy: 533/542 (98.3395%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.0951, Accuracy: 6496/10000 (64.9600%)
___Train Local_Simple,  epoch  56, local model 26, internal_epoch   1,  Average loss: 0.0006, Accuracy: 514/519 (99.0366%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 2.3280, Accuracy: 5640/10000 (56.4000%)
___Train Local_Simple,  epoch  56, local model 7, internal_epoch   1,  Average loss: 0.0005, Accuracy: 794/802 (99.0025%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 2.3247, Accuracy: 5163/10000 (51.6300%)
___Train Local_Simple,  epoch  56, local model 49, internal_epoch   1,  Average loss: 0.0011, Accuracy: 347/355 (97.7465%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 2.5412, Accuracy: 4805/10000 (48.0500%)
___Train Local_Simple,  epoch  56, local model 6, internal_epoch   1,  Average loss: 0.0006, Accuracy: 431/435 (99.0805%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.0097, Accuracy: 7659/10000 (76.5900%)
___Train Local_Simple,  epoch  56, local model 15, internal_epoch   1,  Average loss: 0.0005, Accuracy: 281/282 (99.6454%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1776, Accuracy: 9386/10000 (93.8600%)
___Train Local_Simple,  epoch  56, local model 48, internal_epoch   1,  Average loss: 0.0008, Accuracy: 356/363 (98.0716%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.2974, Accuracy: 8939/10000 (89.3900%)
___Train Local_Simple,  epoch  56, local model 21, internal_epoch   1,  Average loss: 0.0004, Accuracy: 683/687 (99.4178%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.5643, Accuracy: 6052/10000 (60.5200%)
___Train Local_Simple,  epoch  56, local model 17, internal_epoch   1,  Average loss: 0.0005, Accuracy: 522/527 (99.0512%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.5873, Accuracy: 6321/10000 (63.2100%)
___Train Local_Simple,  epoch  56, local model 5, internal_epoch   1,  Average loss: 0.0005, Accuracy: 573/578 (99.1349%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.6800, Accuracy: 8056/10000 (80.5600%)
___Train Local_Simple,  epoch  56, local model 10, internal_epoch   1,  Average loss: 0.0008, Accuracy: 565/573 (98.6038%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 2.7957, Accuracy: 4571/10000 (45.7100%)
___Train Local_Simple,  epoch  56, local model 46, internal_epoch   1,  Average loss: 0.0006, Accuracy: 642/650 (98.7692%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.5122, Accuracy: 6832/10000 (68.3200%)
___Train Local_Simple,  epoch  56, local model 59, internal_epoch   1,  Average loss: 0.0006, Accuracy: 638/644 (99.0683%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.7143, Accuracy: 7853/10000 (78.5300%)
___Train Local_Simple,  epoch  56, local model 36, internal_epoch   1,  Average loss: 0.0005, Accuracy: 311/315 (98.7302%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1509, Accuracy: 9495/10000 (94.9500%)
___Train Local_Simple,  epoch  56, local model 78, internal_epoch   1,  Average loss: 0.0015, Accuracy: 573/587 (97.6150%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 3.8479, Accuracy: 3825/10000 (38.2500%)
___Train Local_Simple,  epoch  56, local model 20, internal_epoch   1,  Average loss: 0.0006, Accuracy: 595/602 (98.8372%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 2.0219, Accuracy: 6178/10000 (61.7800%)
___Train Local_Simple,  epoch  56, local model 94, internal_epoch   1,  Average loss: 0.0006, Accuracy: 665/671 (99.1058%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.9624, Accuracy: 6620/10000 (66.2000%)
___Train Local_Simple,  epoch  56, local model 44, internal_epoch   1,  Average loss: 0.0003, Accuracy: 557/561 (99.2870%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.4999, Accuracy: 8368/10000 (83.6800%)
___Train Local_Simple,  epoch  56, local model 32, internal_epoch   1,  Average loss: 0.0006, Accuracy: 587/590 (99.4915%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.5430, Accuracy: 6731/10000 (67.3100%)
___Train Local_Simple,  epoch  56, local model 95, internal_epoch   1,  Average loss: 0.0018, Accuracy: 586/600 (97.6667%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 3.2456, Accuracy: 4557/10000 (45.5700%)
___Train Local_Simple,  epoch  56, local model 76, internal_epoch   1,  Average loss: 0.0011, Accuracy: 451/459 (98.2571%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.3957, Accuracy: 8723/10000 (87.2300%)
___Train Local_Simple,  epoch  56, local model 89, internal_epoch   1,  Average loss: 0.0011, Accuracy: 667/683 (97.6574%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 2.9315, Accuracy: 5435/10000 (54.3500%)
___Train Local_Simple,  epoch  56, local model 97, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1103/1112 (99.1906%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 2.7695, Accuracy: 4747/10000 (47.4700%)
___Train Local_Simple,  epoch  56, local model 66, internal_epoch   1,  Average loss: 0.0011, Accuracy: 719/733 (98.0900%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 4.6517, Accuracy: 2957/10000 (29.5700%)
___Train Local_Simple,  epoch  56, local model 64, internal_epoch   1,  Average loss: 0.0004, Accuracy: 605/608 (99.5066%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 2.0346, Accuracy: 6129/10000 (61.2900%)
___Train Local_Simple,  epoch  56, local model 31, internal_epoch   1,  Average loss: 0.0005, Accuracy: 590/596 (98.9933%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.7633, Accuracy: 7601/10000 (76.0100%)
___Train Local_Simple,  epoch  56, local model 61, internal_epoch   1,  Average loss: 0.0009, Accuracy: 281/287 (97.9094%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.2151, Accuracy: 9340/10000 (93.4000%)
___Train Local_Simple,  epoch  56, local model 0, internal_epoch   1,  Average loss: 0.0005, Accuracy: 433/435 (99.5402%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.7867, Accuracy: 7035/10000 (70.3500%)
time spent on training: 373.4267911911011
___Test Target_Simple poisoned: False, epoch: 56: Average loss: 0.0819, Accuracy: 9763/10000 (97.6300%)
___Test Target_Simple poisoned: True, epoch: 56: Average loss: 2.1641, Accuracy: 4429/8968 (49.3867%)
saving model
Done in 406.80530834198 sec.
Server Epoch:57 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 22, 8, 14, 76, 27, 25, 81, 35, 2, 42, 99, 44, 46, 80, 66, 64, 43, 94, 53, 65, 47, 86, 4, 98, 17, 85, 30, 77, 97, 13, 36, 1, 69, 5, 48, 84, 19, 56, 32, 49, 23, 55, 92, 11, 39, 16, 63, 72, 21, 96, 45, 0, 60, 70, 37, 89, 67, 59, 9, 79, 34, 40, 91, 93, 90, 54, 78, 26, 15, 58, 57, 82, 50, 87, 83, 12, 71, 10, 31, 52, 68, 38, 20, 61, 95, 28, 6, 24, 7, 75].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   1,  Average loss: 0.0113, Accuracy: 465/569 (81.7223%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   2,  Average loss: 0.0021, Accuracy: 555/569 (97.5395%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   3,  Average loss: 0.0008, Accuracy: 560/569 (98.4183%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   4,  Average loss: 0.0003, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   5,  Average loss: 0.0005, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   6,  Average loss: 0.0004, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   7,  Average loss: 0.0004, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   8,  Average loss: 0.0003, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch   9,  Average loss: 0.0003, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 288
Global model norm: 15.529992895081731.
Norm before scaling: 15.766833316709924. Distance: 3.379377422667013
Total norm for 10 adversaries is: 15.766833316709924. distance: 3.379377422667013
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.6824, Accuracy: 7052/8968 (78.6351%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   1,  Average loss: 0.0013, Accuracy: 508/522 (97.3180%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   2,  Average loss: 0.0003, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   3,  Average loss: 0.0001, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   7,  Average loss: 0.0002, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Global model norm: 15.529992895081731.
Norm before scaling: 15.582849886053868. Distance: 1.1444379748981492
Total norm for 10 adversaries is: 15.582849886053868. distance: 1.1444379748981492
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0114, Accuracy: 8926/8968 (99.5317%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   1,  Average loss: 0.0075, Accuracy: 327/385 (84.9351%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   2,  Average loss: 0.0015, Accuracy: 372/385 (96.6234%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   3,  Average loss: 0.0006, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   4,  Average loss: 0.0006, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   5,  Average loss: 0.0003, Accuracy: 384/385 (99.7403%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   6,  Average loss: 0.0003, Accuracy: 383/385 (99.4805%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   7,  Average loss: 0.0005, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   8,  Average loss: 0.0004, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch   9,  Average loss: 0.0003, Accuracy: 383/385 (99.4805%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 51, internal_epoch  10,  Average loss: 0.0004, Accuracy: 381/385 (98.9610%), train_poison_data_count: 193
Global model norm: 15.529992895081731.
Norm before scaling: 15.683602019767434. Distance: 2.06016165219446
Total norm for 10 adversaries is: 15.683602019767434. distance: 2.06016165219446
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.2482, Accuracy: 8189/8968 (91.3136%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   1,  Average loss: 0.0042, Accuracy: 570/627 (90.9091%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   2,  Average loss: 0.0010, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   3,  Average loss: 0.0004, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   4,  Average loss: 0.0003, Accuracy: 625/627 (99.6810%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   5,  Average loss: 0.0004, Accuracy: 624/627 (99.5215%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   6,  Average loss: 0.0003, Accuracy: 624/627 (99.5215%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 627/627 (100.0000%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   8,  Average loss: 0.0003, Accuracy: 625/627 (99.6810%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch   9,  Average loss: 0.0003, Accuracy: 625/627 (99.6810%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 74, internal_epoch  10,  Average loss: 0.0003, Accuracy: 625/627 (99.6810%), train_poison_data_count: 320
Global model norm: 15.529992895081731.
Norm before scaling: 15.646874336865874. Distance: 2.1037611114154116
Total norm for 10 adversaries is: 15.646874336865874. distance: 2.1037611114154116
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0021, Accuracy: 8962/8968 (99.9331%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 3, internal_epoch   1,  Average loss: 0.0098, Accuracy: 426/516 (82.5581%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 3, internal_epoch   2,  Average loss: 0.0018, Accuracy: 498/516 (96.5116%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 3, internal_epoch   3,  Average loss: 0.0006, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 3, internal_epoch   4,  Average loss: 0.0006, Accuracy: 512/516 (99.2248%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 3, internal_epoch   5,  Average loss: 0.0004, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 3, internal_epoch   6,  Average loss: 0.0002, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 3, internal_epoch   7,  Average loss: 0.0003, Accuracy: 513/516 (99.4186%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 3, internal_epoch   8,  Average loss: 0.0004, Accuracy: 512/516 (99.2248%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 3, internal_epoch   9,  Average loss: 0.0002, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 3, internal_epoch  10,  Average loss: 0.0002, Accuracy: 513/516 (99.4186%), train_poison_data_count: 260
Global model norm: 15.529992895081731.
Norm before scaling: 15.92502815088392. Distance: 3.4441347769174575
Total norm for 10 adversaries is: 15.92502815088392. distance: 3.4441347769174575
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.6194, Accuracy: 7584/8968 (84.5674%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 18, internal_epoch   1,  Average loss: 0.0031, Accuracy: 704/759 (92.7536%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 18, internal_epoch   2,  Average loss: 0.0006, Accuracy: 754/759 (99.3412%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 18, internal_epoch   3,  Average loss: 0.0003, Accuracy: 753/759 (99.2095%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 18, internal_epoch   4,  Average loss: 0.0001, Accuracy: 759/759 (100.0000%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 18, internal_epoch   5,  Average loss: 0.0001, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 18, internal_epoch   6,  Average loss: 0.0002, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 18, internal_epoch   7,  Average loss: 0.0001, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 18, internal_epoch   8,  Average loss: 0.0001, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 18, internal_epoch   9,  Average loss: 0.0001, Accuracy: 756/759 (99.6047%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 18, internal_epoch  10,  Average loss: 0.0001, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Global model norm: 15.529992895081731.
Norm before scaling: 15.95904544738804. Distance: 3.131779602705055
Total norm for 10 adversaries is: 15.95904544738804. distance: 3.131779602705055
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.1134, Accuracy: 8673/8968 (96.7105%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 29, internal_epoch   1,  Average loss: 0.0027, Accuracy: 474/506 (93.6759%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 29, internal_epoch   2,  Average loss: 0.0007, Accuracy: 499/506 (98.6166%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 29, internal_epoch   3,  Average loss: 0.0005, Accuracy: 500/506 (98.8142%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 29, internal_epoch   4,  Average loss: 0.0004, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 29, internal_epoch   5,  Average loss: 0.0003, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 29, internal_epoch   6,  Average loss: 0.0002, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 29, internal_epoch   7,  Average loss: 0.0002, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 29, internal_epoch   8,  Average loss: 0.0002, Accuracy: 506/506 (100.0000%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 506/506 (100.0000%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 29, internal_epoch  10,  Average loss: 0.0001, Accuracy: 506/506 (100.0000%), train_poison_data_count: 256
Global model norm: 15.529992895081731.
Norm before scaling: 15.702439447877447. Distance: 1.8314317320134756
Total norm for 10 adversaries is: 15.702439447877447. distance: 1.8314317320134756
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0283, Accuracy: 8875/8968 (98.9630%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 62, internal_epoch   1,  Average loss: 0.0017, Accuracy: 560/580 (96.5517%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 62, internal_epoch   2,  Average loss: 0.0015, Accuracy: 563/580 (97.0690%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 62, internal_epoch   3,  Average loss: 0.0008, Accuracy: 571/580 (98.4483%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 62, internal_epoch   4,  Average loss: 0.0005, Accuracy: 577/580 (99.4828%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 62, internal_epoch   5,  Average loss: 0.0003, Accuracy: 575/580 (99.1379%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 62, internal_epoch   6,  Average loss: 0.0003, Accuracy: 576/580 (99.3103%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 62, internal_epoch   7,  Average loss: 0.0006, Accuracy: 573/580 (98.7931%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 62, internal_epoch   8,  Average loss: 0.0002, Accuracy: 577/580 (99.4828%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 62, internal_epoch   9,  Average loss: 0.0004, Accuracy: 575/580 (99.1379%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 62, internal_epoch  10,  Average loss: 0.0005, Accuracy: 576/580 (99.3103%), train_poison_data_count: 292
Global model norm: 15.529992895081731.
Norm before scaling: 15.565562732007555. Distance: 1.3854746651041905
Total norm for 10 adversaries is: 15.565562732007555. distance: 1.3854746651041905
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0079, Accuracy: 8943/8968 (99.7212%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 516/587 (87.9046%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 33, internal_epoch   2,  Average loss: 0.0014, Accuracy: 571/587 (97.2743%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 33, internal_epoch   3,  Average loss: 0.0005, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 33, internal_epoch   4,  Average loss: 0.0004, Accuracy: 582/587 (99.1482%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 33, internal_epoch   5,  Average loss: 0.0005, Accuracy: 582/587 (99.1482%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 33, internal_epoch   6,  Average loss: 0.0003, Accuracy: 583/587 (99.3186%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 33, internal_epoch   7,  Average loss: 0.0005, Accuracy: 581/587 (98.9779%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 33, internal_epoch   8,  Average loss: 0.0003, Accuracy: 582/587 (99.1482%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 33, internal_epoch   9,  Average loss: 0.0004, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 33, internal_epoch  10,  Average loss: 0.0002, Accuracy: 585/587 (99.6593%), train_poison_data_count: 299
Global model norm: 15.529992895081731.
Norm before scaling: 15.89831177008024. Distance: 3.0785048197215525
Total norm for 10 adversaries is: 15.89831177008024. distance: 3.0785048197215525
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 1.0800, Accuracy: 6642/8968 (74.0633%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 88, internal_epoch   1,  Average loss: 0.0052, Accuracy: 668/734 (91.0082%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 88, internal_epoch   2,  Average loss: 0.0018, Accuracy: 703/734 (95.7766%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 88, internal_epoch   3,  Average loss: 0.0009, Accuracy: 720/734 (98.0926%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 88, internal_epoch   4,  Average loss: 0.0003, Accuracy: 733/734 (99.8638%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 88, internal_epoch   5,  Average loss: 0.0005, Accuracy: 727/734 (99.0463%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 88, internal_epoch   6,  Average loss: 0.0003, Accuracy: 732/734 (99.7275%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 88, internal_epoch   7,  Average loss: 0.0003, Accuracy: 732/734 (99.7275%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 88, internal_epoch   8,  Average loss: 0.0002, Accuracy: 733/734 (99.8638%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 88, internal_epoch   9,  Average loss: 0.0004, Accuracy: 729/734 (99.3188%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 88, internal_epoch  10,  Average loss: 0.0004, Accuracy: 730/734 (99.4550%), train_poison_data_count: 382
Global model norm: 15.529992895081731.
Norm before scaling: 15.816958074159727. Distance: 2.780390060010146
Total norm for 10 adversaries is: 15.816958074159727. distance: 2.780390060010146
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0846, Accuracy: 8693/8968 (96.9335%)
___Train Local_Simple,  epoch  57, local model 22, internal_epoch   1,  Average loss: 0.0005, Accuracy: 259/262 (98.8550%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.4691, Accuracy: 8704/10000 (87.0400%)
___Train Local_Simple,  epoch  57, local model 8, internal_epoch   1,  Average loss: 0.0005, Accuracy: 702/706 (99.4334%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.5738, Accuracy: 6233/10000 (62.3300%)
___Train Local_Simple,  epoch  57, local model 14, internal_epoch   1,  Average loss: 0.0009, Accuracy: 679/692 (98.1214%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.2624, Accuracy: 6809/10000 (68.0900%)
___Train Local_Simple,  epoch  57, local model 76, internal_epoch   1,  Average loss: 0.0009, Accuracy: 454/459 (98.9107%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.6686, Accuracy: 8487/10000 (84.8700%)
___Train Local_Simple,  epoch  57, local model 27, internal_epoch   1,  Average loss: 0.0003, Accuracy: 742/745 (99.5973%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 2.1640, Accuracy: 5581/10000 (55.8100%)
___Train Local_Simple,  epoch  57, local model 25, internal_epoch   1,  Average loss: 0.0003, Accuracy: 589/592 (99.4932%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.5614, Accuracy: 7528/10000 (75.2800%)
___Train Local_Simple,  epoch  57, local model 81, internal_epoch   1,  Average loss: 0.0009, Accuracy: 629/636 (98.8994%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.4101, Accuracy: 6453/10000 (64.5300%)
___Train Local_Simple,  epoch  57, local model 35, internal_epoch   1,  Average loss: 0.0011, Accuracy: 622/630 (98.7302%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 2.3449, Accuracy: 5393/10000 (53.9300%)
___Train Local_Simple,  epoch  57, local model 2, internal_epoch   1,  Average loss: 0.0006, Accuracy: 558/564 (98.9362%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.7003, Accuracy: 7782/10000 (77.8200%)
___Train Local_Simple,  epoch  57, local model 42, internal_epoch   1,  Average loss: 0.0002, Accuracy: 473/473 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.3556, Accuracy: 8763/10000 (87.6300%)
___Train Local_Simple,  epoch  57, local model 99, internal_epoch   1,  Average loss: 0.0017, Accuracy: 692/712 (97.1910%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 2.2099, Accuracy: 4850/10000 (48.5000%)
___Train Local_Simple,  epoch  57, local model 44, internal_epoch   1,  Average loss: 0.0003, Accuracy: 557/561 (99.2870%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.9687, Accuracy: 6880/10000 (68.8000%)
___Train Local_Simple,  epoch  57, local model 46, internal_epoch   1,  Average loss: 0.0006, Accuracy: 642/650 (98.7692%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.5617, Accuracy: 6738/10000 (67.3800%)
___Train Local_Simple,  epoch  57, local model 80, internal_epoch   1,  Average loss: 0.0011, Accuracy: 522/532 (98.1203%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 3.2142, Accuracy: 4267/10000 (42.6700%)
___Train Local_Simple,  epoch  57, local model 66, internal_epoch   1,  Average loss: 0.0012, Accuracy: 717/733 (97.8172%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 3.6197, Accuracy: 4101/10000 (41.0100%)
___Train Local_Simple,  epoch  57, local model 64, internal_epoch   1,  Average loss: 0.0003, Accuracy: 604/608 (99.3421%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.7625, Accuracy: 6351/10000 (63.5100%)
___Train Local_Simple,  epoch  57, local model 43, internal_epoch   1,  Average loss: 0.0006, Accuracy: 427/431 (99.0719%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.7500, Accuracy: 7865/10000 (78.6500%)
___Train Local_Simple,  epoch  57, local model 94, internal_epoch   1,  Average loss: 0.0005, Accuracy: 662/671 (98.6587%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 3.0441, Accuracy: 5938/10000 (59.3800%)
___Train Local_Simple,  epoch  57, local model 53, internal_epoch   1,  Average loss: 0.0007, Accuracy: 553/561 (98.5740%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.8481, Accuracy: 6640/10000 (66.4000%)
___Train Local_Simple,  epoch  57, local model 65, internal_epoch   1,  Average loss: 0.0012, Accuracy: 605/621 (97.4235%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.3506, Accuracy: 6348/10000 (63.4800%)
___Train Local_Simple,  epoch  57, local model 47, internal_epoch   1,  Average loss: 0.0007, Accuracy: 526/534 (98.5019%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.6022, Accuracy: 6312/10000 (63.1200%)
___Train Local_Simple,  epoch  57, local model 86, internal_epoch   1,  Average loss: 0.0004, Accuracy: 686/692 (99.1329%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 2.4080, Accuracy: 5639/10000 (56.3900%)
___Train Local_Simple,  epoch  57, local model 4, internal_epoch   1,  Average loss: 0.0005, Accuracy: 740/748 (98.9305%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 2.0812, Accuracy: 5992/10000 (59.9200%)
___Train Local_Simple,  epoch  57, local model 98, internal_epoch   1,  Average loss: 0.0009, Accuracy: 536/548 (97.8102%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 2.0626, Accuracy: 5591/10000 (55.9100%)
___Train Local_Simple,  epoch  57, local model 17, internal_epoch   1,  Average loss: 0.0004, Accuracy: 525/527 (99.6205%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.1737, Accuracy: 7257/10000 (72.5700%)
___Train Local_Simple,  epoch  57, local model 85, internal_epoch   1,  Average loss: 0.0016, Accuracy: 781/807 (96.7782%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 3.1276, Accuracy: 5143/10000 (51.4300%)
___Train Local_Simple,  epoch  57, local model 30, internal_epoch   1,  Average loss: 0.0008, Accuracy: 438/443 (98.8713%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.0976, Accuracy: 7998/10000 (79.9800%)
___Train Local_Simple,  epoch  57, local model 77, internal_epoch   1,  Average loss: 0.0009, Accuracy: 605/618 (97.8964%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.8124, Accuracy: 6227/10000 (62.2700%)
___Train Local_Simple,  epoch  57, local model 97, internal_epoch   1,  Average loss: 0.0003, Accuracy: 1106/1112 (99.4604%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 4.4144, Accuracy: 4413/10000 (44.1300%)
___Train Local_Simple,  epoch  57, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 700/713 (98.1767%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 2.1345, Accuracy: 6128/10000 (61.2800%)
___Train Local_Simple,  epoch  57, local model 36, internal_epoch   1,  Average loss: 0.0005, Accuracy: 313/315 (99.3651%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1534, Accuracy: 9485/10000 (94.8500%)
___Train Local_Simple,  epoch  57, local model 1, internal_epoch   1,  Average loss: 0.0003, Accuracy: 534/536 (99.6269%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.2754, Accuracy: 9088/10000 (90.8800%)
___Train Local_Simple,  epoch  57, local model 69, internal_epoch   1,  Average loss: 0.0009, Accuracy: 661/671 (98.5097%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 5.1883, Accuracy: 3729/10000 (37.2900%)
___Train Local_Simple,  epoch  57, local model 5, internal_epoch   1,  Average loss: 0.0007, Accuracy: 568/578 (98.2699%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.0135, Accuracy: 7371/10000 (73.7100%)
___Train Local_Simple,  epoch  57, local model 48, internal_epoch   1,  Average loss: 0.0008, Accuracy: 359/363 (98.8981%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1990, Accuracy: 9318/10000 (93.1800%)
___Train Local_Simple,  epoch  57, local model 84, internal_epoch   1,  Average loss: 0.0008, Accuracy: 414/420 (98.5714%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.7528, Accuracy: 7855/10000 (78.5500%)
___Train Local_Simple,  epoch  57, local model 19, internal_epoch   1,  Average loss: 0.0005, Accuracy: 592/598 (98.9967%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 2.0582, Accuracy: 5871/10000 (58.7100%)
___Train Local_Simple,  epoch  57, local model 56, internal_epoch   1,  Average loss: 0.0003, Accuracy: 712/715 (99.5804%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.3852, Accuracy: 6373/10000 (63.7300%)
___Train Local_Simple,  epoch  57, local model 32, internal_epoch   1,  Average loss: 0.0004, Accuracy: 587/590 (99.4915%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 2.5128, Accuracy: 5761/10000 (57.6100%)
___Train Local_Simple,  epoch  57, local model 49, internal_epoch   1,  Average loss: 0.0008, Accuracy: 348/355 (98.0282%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.7397, Accuracy: 7623/10000 (76.2300%)
___Train Local_Simple,  epoch  57, local model 23, internal_epoch   1,  Average loss: 0.0005, Accuracy: 538/542 (99.2620%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.3018, Accuracy: 6429/10000 (64.2900%)
___Train Local_Simple,  epoch  57, local model 55, internal_epoch   1,  Average loss: 0.0007, Accuracy: 372/375 (99.2000%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.9314, Accuracy: 7504/10000 (75.0400%)
___Train Local_Simple,  epoch  57, local model 92, internal_epoch   1,  Average loss: 0.0015, Accuracy: 590/611 (96.5630%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 3.1474, Accuracy: 4502/10000 (45.0200%)
___Train Local_Simple,  epoch  57, local model 11, internal_epoch   1,  Average loss: 0.0005, Accuracy: 548/554 (98.9170%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.0651, Accuracy: 7624/10000 (76.2400%)
___Train Local_Simple,  epoch  57, local model 39, internal_epoch   1,  Average loss: 0.0005, Accuracy: 486/493 (98.5801%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.3125, Accuracy: 7268/10000 (72.6800%)
___Train Local_Simple,  epoch  57, local model 16, internal_epoch   1,  Average loss: 0.0003, Accuracy: 815/817 (99.7552%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.8859, Accuracy: 7765/10000 (77.6500%)
___Train Local_Simple,  epoch  57, local model 63, internal_epoch   1,  Average loss: 0.0008, Accuracy: 300/303 (99.0099%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.6892, Accuracy: 8081/10000 (80.8100%)
___Train Local_Simple,  epoch  57, local model 72, internal_epoch   1,  Average loss: 0.0014, Accuracy: 413/423 (97.6359%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 2.3742, Accuracy: 4682/10000 (46.8200%)
___Train Local_Simple,  epoch  57, local model 21, internal_epoch   1,  Average loss: 0.0003, Accuracy: 684/687 (99.5633%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.1880, Accuracy: 7225/10000 (72.2500%)
___Train Local_Simple,  epoch  57, local model 96, internal_epoch   1,  Average loss: 0.0007, Accuracy: 522/531 (98.3051%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 4.0021, Accuracy: 4728/10000 (47.2800%)
___Train Local_Simple,  epoch  57, local model 45, internal_epoch   1,  Average loss: 0.0010, Accuracy: 635/647 (98.1453%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 3.8551, Accuracy: 3924/10000 (39.2400%)
___Train Local_Simple,  epoch  57, local model 0, internal_epoch   1,  Average loss: 0.0005, Accuracy: 433/435 (99.5402%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.0385, Accuracy: 7160/10000 (71.6000%)
___Train Local_Simple,  epoch  57, local model 60, internal_epoch   1,  Average loss: 0.0006, Accuracy: 565/571 (98.9492%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 2.5103, Accuracy: 5025/10000 (50.2500%)
___Train Local_Simple,  epoch  57, local model 70, internal_epoch   1,  Average loss: 0.0009, Accuracy: 560/568 (98.5915%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.8018, Accuracy: 5533/10000 (55.3300%)
___Train Local_Simple,  epoch  57, local model 37, internal_epoch   1,  Average loss: 0.0005, Accuracy: 453/456 (99.3421%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.9585, Accuracy: 7532/10000 (75.3200%)
___Train Local_Simple,  epoch  57, local model 89, internal_epoch   1,  Average loss: 0.0013, Accuracy: 664/683 (97.2182%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 2.2300, Accuracy: 6003/10000 (60.0300%)
___Train Local_Simple,  epoch  57, local model 67, internal_epoch   1,  Average loss: 0.0010, Accuracy: 437/441 (99.0930%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.9088, Accuracy: 7314/10000 (73.1400%)
___Train Local_Simple,  epoch  57, local model 59, internal_epoch   1,  Average loss: 0.0006, Accuracy: 637/644 (98.9130%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.1129, Accuracy: 6842/10000 (68.4200%)
___Train Local_Simple,  epoch  57, local model 9, internal_epoch   1,  Average loss: 0.0007, Accuracy: 502/508 (98.8189%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.7659, Accuracy: 7544/10000 (75.4400%)
___Train Local_Simple,  epoch  57, local model 79, internal_epoch   1,  Average loss: 0.0008, Accuracy: 654/661 (98.9410%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.7563, Accuracy: 6070/10000 (60.7000%)
___Train Local_Simple,  epoch  57, local model 34, internal_epoch   1,  Average loss: 0.0014, Accuracy: 851/871 (97.7038%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.2649, Accuracy: 6758/10000 (67.5800%)
___Train Local_Simple,  epoch  57, local model 40, internal_epoch   1,  Average loss: 0.0004, Accuracy: 493/498 (98.9960%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 2.5018, Accuracy: 5768/10000 (57.6800%)
___Train Local_Simple,  epoch  57, local model 91, internal_epoch   1,  Average loss: 0.0003, Accuracy: 815/819 (99.5116%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.3817, Accuracy: 6511/10000 (65.1100%)
___Train Local_Simple,  epoch  57, local model 93, internal_epoch   1,  Average loss: 0.0011, Accuracy: 615/630 (97.6190%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 2.3430, Accuracy: 5418/10000 (54.1800%)
___Train Local_Simple,  epoch  57, local model 90, internal_epoch   1,  Average loss: 0.0010, Accuracy: 601/615 (97.7236%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.7468, Accuracy: 6709/10000 (67.0900%)
___Train Local_Simple,  epoch  57, local model 54, internal_epoch   1,  Average loss: 0.0004, Accuracy: 825/832 (99.1587%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 2.4589, Accuracy: 6121/10000 (61.2100%)
___Train Local_Simple,  epoch  57, local model 78, internal_epoch   1,  Average loss: 0.0013, Accuracy: 571/587 (97.2743%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 4.1149, Accuracy: 3921/10000 (39.2100%)
___Train Local_Simple,  epoch  57, local model 26, internal_epoch   1,  Average loss: 0.0006, Accuracy: 514/519 (99.0366%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.2566, Accuracy: 6780/10000 (67.8000%)
___Train Local_Simple,  epoch  57, local model 15, internal_epoch   1,  Average loss: 0.0006, Accuracy: 280/282 (99.2908%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.3719, Accuracy: 8806/10000 (88.0600%)
___Train Local_Simple,  epoch  57, local model 58, internal_epoch   1,  Average loss: 0.0005, Accuracy: 768/772 (99.4819%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.6635, Accuracy: 8099/10000 (80.9900%)
___Train Local_Simple,  epoch  57, local model 57, internal_epoch   1,  Average loss: 0.0005, Accuracy: 517/523 (98.8528%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.2376, Accuracy: 6394/10000 (63.9400%)
___Train Local_Simple,  epoch  57, local model 82, internal_epoch   1,  Average loss: 0.0004, Accuracy: 811/815 (99.5092%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 3.2453, Accuracy: 4593/10000 (45.9300%)
___Train Local_Simple,  epoch  57, local model 50, internal_epoch   1,  Average loss: 0.0008, Accuracy: 470/477 (98.5325%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.8228, Accuracy: 7396/10000 (73.9600%)
___Train Local_Simple,  epoch  57, local model 87, internal_epoch   1,  Average loss: 0.0006, Accuracy: 654/663 (98.6425%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 2.2515, Accuracy: 6145/10000 (61.4500%)
___Train Local_Simple,  epoch  57, local model 83, internal_epoch   1,  Average loss: 0.0009, Accuracy: 351/360 (97.5000%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.2803, Accuracy: 9120/10000 (91.2000%)
___Train Local_Simple,  epoch  57, local model 12, internal_epoch   1,  Average loss: 0.0008, Accuracy: 714/725 (98.4828%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.3614, Accuracy: 7051/10000 (70.5100%)
___Train Local_Simple,  epoch  57, local model 71, internal_epoch   1,  Average loss: 0.0007, Accuracy: 552/561 (98.3957%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.6613, Accuracy: 8059/10000 (80.5900%)
___Train Local_Simple,  epoch  57, local model 10, internal_epoch   1,  Average loss: 0.0009, Accuracy: 564/573 (98.4293%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.3328, Accuracy: 6343/10000 (63.4300%)
___Train Local_Simple,  epoch  57, local model 31, internal_epoch   1,  Average loss: 0.0007, Accuracy: 590/596 (98.9933%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 2.1168, Accuracy: 5190/10000 (51.9000%)
___Train Local_Simple,  epoch  57, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 773/789 (97.9721%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 2.6790, Accuracy: 5445/10000 (54.4500%)
___Train Local_Simple,  epoch  57, local model 68, internal_epoch   1,  Average loss: 0.0013, Accuracy: 537/549 (97.8142%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 4.4277, Accuracy: 4086/10000 (40.8600%)
___Train Local_Simple,  epoch  57, local model 38, internal_epoch   1,  Average loss: 0.0005, Accuracy: 473/477 (99.1614%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.2788, Accuracy: 9087/10000 (90.8700%)
___Train Local_Simple,  epoch  57, local model 20, internal_epoch   1,  Average loss: 0.0006, Accuracy: 595/602 (98.8372%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.6903, Accuracy: 6897/10000 (68.9700%)
___Train Local_Simple,  epoch  57, local model 61, internal_epoch   1,  Average loss: 0.0008, Accuracy: 285/287 (99.3031%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.2057, Accuracy: 9392/10000 (93.9200%)
___Train Local_Simple,  epoch  57, local model 95, internal_epoch   1,  Average loss: 0.0018, Accuracy: 583/600 (97.1667%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.9535, Accuracy: 6403/10000 (64.0300%)
___Train Local_Simple,  epoch  57, local model 28, internal_epoch   1,  Average loss: 0.0005, Accuracy: 606/611 (99.1817%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.0637, Accuracy: 7302/10000 (73.0200%)
___Train Local_Simple,  epoch  57, local model 6, internal_epoch   1,  Average loss: 0.0009, Accuracy: 429/435 (98.6207%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.3034, Accuracy: 7459/10000 (74.5900%)
___Train Local_Simple,  epoch  57, local model 24, internal_epoch   1,  Average loss: 0.0010, Accuracy: 468/477 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.9765, Accuracy: 7197/10000 (71.9700%)
___Train Local_Simple,  epoch  57, local model 7, internal_epoch   1,  Average loss: 0.0004, Accuracy: 798/802 (99.5012%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.6631, Accuracy: 7691/10000 (76.9100%)
___Train Local_Simple,  epoch  57, local model 75, internal_epoch   1,  Average loss: 0.0006, Accuracy: 756/763 (99.0826%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.9922, Accuracy: 5934/10000 (59.3400%)
time spent on training: 374.92471289634705
___Test Target_Simple poisoned: False, epoch: 57: Average loss: 0.0830, Accuracy: 9750/10000 (97.5000%)
___Test Target_Simple poisoned: True, epoch: 57: Average loss: 2.0647, Accuracy: 4713/8968 (52.5535%)
saving model
Done in 409.7759163379669 sec.
Server Epoch:58 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 53, 79, 1, 37, 71, 82, 28, 50, 44, 25, 24, 57, 9, 75, 39, 92, 65, 11, 8, 48, 61, 19, 15, 84, 7, 81, 21, 66, 4, 90, 98, 35, 95, 27, 54, 6, 5, 52, 63, 87, 30, 32, 36, 42, 22, 47, 0, 78, 67, 89, 46, 91, 10, 34, 45, 83, 23, 99, 2, 38, 58, 69, 85, 70, 56, 76, 20, 86, 16, 77, 68, 80, 31, 14, 60, 26, 43, 97, 40, 17, 93, 12, 64, 13, 72, 49, 96, 55, 94, 59].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   1,  Average loss: 0.0074, Accuracy: 490/569 (86.1160%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   2,  Average loss: 0.0008, Accuracy: 564/569 (99.1213%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   3,  Average loss: 0.0005, Accuracy: 561/569 (98.5940%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 288
Global model norm: 15.533778147952438.
Norm before scaling: 15.794899534924538. Distance: 2.7467920492621296
Total norm for 10 adversaries is: 15.794899534924538. distance: 2.7467920492621296
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.7779, Accuracy: 7295/8968 (81.3448%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   1,  Average loss: 0.0026, Accuracy: 493/522 (94.4444%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   2,  Average loss: 0.0010, Accuracy: 512/522 (98.0843%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   3,  Average loss: 0.0004, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 522/522 (100.0000%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 73, internal_epoch  10,  Average loss: 0.0000, Accuracy: 522/522 (100.0000%), train_poison_data_count: 266
Global model norm: 15.533778147952438.
Norm before scaling: 15.68357818336712. Distance: 1.752517116098447
Total norm for 10 adversaries is: 15.68357818336712. distance: 1.752517116098447
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0093, Accuracy: 8943/8968 (99.7212%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   1,  Average loss: 0.0052, Accuracy: 345/385 (89.6104%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   2,  Average loss: 0.0011, Accuracy: 375/385 (97.4026%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   3,  Average loss: 0.0007, Accuracy: 381/385 (98.9610%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   4,  Average loss: 0.0006, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   5,  Average loss: 0.0004, Accuracy: 382/385 (99.2208%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   6,  Average loss: 0.0005, Accuracy: 381/385 (98.9610%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   7,  Average loss: 0.0003, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   8,  Average loss: 0.0002, Accuracy: 383/385 (99.4805%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch   9,  Average loss: 0.0002, Accuracy: 385/385 (100.0000%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 51, internal_epoch  10,  Average loss: 0.0002, Accuracy: 385/385 (100.0000%), train_poison_data_count: 193
Global model norm: 15.533778147952438.
Norm before scaling: 15.680906817625276. Distance: 1.782703609634899
Total norm for 10 adversaries is: 15.680906817625276. distance: 1.782703609634899
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.2177, Accuracy: 8331/8968 (92.8970%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   1,  Average loss: 0.0023, Accuracy: 600/627 (95.6938%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   2,  Average loss: 0.0011, Accuracy: 615/627 (98.0861%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   3,  Average loss: 0.0003, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   4,  Average loss: 0.0004, Accuracy: 621/627 (99.0431%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   5,  Average loss: 0.0004, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   6,  Average loss: 0.0003, Accuracy: 626/627 (99.8405%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   7,  Average loss: 0.0003, Accuracy: 625/627 (99.6810%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   8,  Average loss: 0.0002, Accuracy: 626/627 (99.8405%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 626/627 (99.8405%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 74, internal_epoch  10,  Average loss: 0.0003, Accuracy: 625/627 (99.6810%), train_poison_data_count: 320
Global model norm: 15.533778147952438.
Norm before scaling: 15.61204492227951. Distance: 1.6725631438510975
Total norm for 10 adversaries is: 15.61204492227951. distance: 1.6725631438510975
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0007, Accuracy: 8967/8968 (99.9888%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 3, internal_epoch   1,  Average loss: 0.0096, Accuracy: 416/516 (80.6202%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 3, internal_epoch   2,  Average loss: 0.0018, Accuracy: 508/516 (98.4496%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 3, internal_epoch   3,  Average loss: 0.0008, Accuracy: 503/516 (97.4806%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 3, internal_epoch   4,  Average loss: 0.0003, Accuracy: 511/516 (99.0310%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 3, internal_epoch   5,  Average loss: 0.0002, Accuracy: 512/516 (99.2248%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 3, internal_epoch   6,  Average loss: 0.0001, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 3, internal_epoch   7,  Average loss: 0.0002, Accuracy: 513/516 (99.4186%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 3, internal_epoch   8,  Average loss: 0.0002, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 3, internal_epoch   9,  Average loss: 0.0001, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 3, internal_epoch  10,  Average loss: 0.0001, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Global model norm: 15.533778147952438.
Norm before scaling: 16.120804588362574. Distance: 4.140088546837999
Total norm for 10 adversaries is: 16.120804588362574. distance: 4.140088546837999
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.1988, Accuracy: 8561/8968 (95.4616%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 18, internal_epoch   1,  Average loss: 0.0023, Accuracy: 720/759 (94.8617%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 18, internal_epoch   2,  Average loss: 0.0005, Accuracy: 750/759 (98.8142%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 18, internal_epoch   3,  Average loss: 0.0001, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 18, internal_epoch   4,  Average loss: 0.0001, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 18, internal_epoch   5,  Average loss: 0.0001, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 18, internal_epoch   6,  Average loss: 0.0001, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 18, internal_epoch   7,  Average loss: 0.0001, Accuracy: 759/759 (100.0000%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 18, internal_epoch   8,  Average loss: 0.0001, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 18, internal_epoch   9,  Average loss: 0.0001, Accuracy: 759/759 (100.0000%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 18, internal_epoch  10,  Average loss: 0.0001, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Global model norm: 15.533778147952438.
Norm before scaling: 15.786120941506903. Distance: 2.2720371403613533
Total norm for 10 adversaries is: 15.786120941506903. distance: 2.2720371403613533
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0921, Accuracy: 8715/8968 (97.1789%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 29, internal_epoch   1,  Average loss: 0.0047, Accuracy: 455/506 (89.9209%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 29, internal_epoch   2,  Average loss: 0.0008, Accuracy: 501/506 (99.0119%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 29, internal_epoch   3,  Average loss: 0.0005, Accuracy: 502/506 (99.2095%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 29, internal_epoch   4,  Average loss: 0.0005, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 29, internal_epoch   5,  Average loss: 0.0004, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 29, internal_epoch   6,  Average loss: 0.0004, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 29, internal_epoch   7,  Average loss: 0.0002, Accuracy: 506/506 (100.0000%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 29, internal_epoch   8,  Average loss: 0.0002, Accuracy: 506/506 (100.0000%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 29, internal_epoch   9,  Average loss: 0.0002, Accuracy: 506/506 (100.0000%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 29, internal_epoch  10,  Average loss: 0.0002, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Global model norm: 15.533778147952438.
Norm before scaling: 15.841357048550115. Distance: 2.546505204952485
Total norm for 10 adversaries is: 15.841357048550115. distance: 2.546505204952485
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.5147, Accuracy: 7680/8968 (85.6378%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 62, internal_epoch   1,  Average loss: 0.0026, Accuracy: 552/580 (95.1724%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 62, internal_epoch   2,  Average loss: 0.0010, Accuracy: 572/580 (98.6207%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 62, internal_epoch   3,  Average loss: 0.0003, Accuracy: 575/580 (99.1379%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 62, internal_epoch   4,  Average loss: 0.0004, Accuracy: 574/580 (98.9655%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 62, internal_epoch   5,  Average loss: 0.0004, Accuracy: 574/580 (98.9655%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 62, internal_epoch   6,  Average loss: 0.0003, Accuracy: 577/580 (99.4828%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 62, internal_epoch   7,  Average loss: 0.0002, Accuracy: 577/580 (99.4828%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 62, internal_epoch   8,  Average loss: 0.0002, Accuracy: 578/580 (99.6552%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 62, internal_epoch   9,  Average loss: 0.0003, Accuracy: 577/580 (99.4828%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 62, internal_epoch  10,  Average loss: 0.0002, Accuracy: 578/580 (99.6552%), train_poison_data_count: 292
Global model norm: 15.533778147952438.
Norm before scaling: 15.559758814337437. Distance: 1.4183281897434037
Total norm for 10 adversaries is: 15.559758814337437. distance: 1.4183281897434037
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0064, Accuracy: 8946/8968 (99.7547%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 524/587 (89.2675%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 33, internal_epoch   2,  Average loss: 0.0006, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 33, internal_epoch   3,  Average loss: 0.0004, Accuracy: 583/587 (99.3186%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 33, internal_epoch   4,  Average loss: 0.0002, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 33, internal_epoch   5,  Average loss: 0.0003, Accuracy: 583/587 (99.3186%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 33, internal_epoch   6,  Average loss: 0.0002, Accuracy: 585/587 (99.6593%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 33, internal_epoch   7,  Average loss: 0.0002, Accuracy: 585/587 (99.6593%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 33, internal_epoch   8,  Average loss: 0.0002, Accuracy: 585/587 (99.6593%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 33, internal_epoch   9,  Average loss: 0.0002, Accuracy: 585/587 (99.6593%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 33, internal_epoch  10,  Average loss: 0.0002, Accuracy: 585/587 (99.6593%), train_poison_data_count: 299
Global model norm: 15.533778147952438.
Norm before scaling: 15.786815908173335. Distance: 2.338767184546586
Total norm for 10 adversaries is: 15.786815908173335. distance: 2.338767184546586
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.6144, Accuracy: 7530/8968 (83.9652%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 88, internal_epoch   1,  Average loss: 0.0020, Accuracy: 705/734 (96.0490%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 88, internal_epoch   2,  Average loss: 0.0009, Accuracy: 720/734 (98.0926%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 88, internal_epoch   3,  Average loss: 0.0003, Accuracy: 727/734 (99.0463%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 88, internal_epoch   4,  Average loss: 0.0003, Accuracy: 730/734 (99.4550%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 88, internal_epoch   5,  Average loss: 0.0004, Accuracy: 730/734 (99.4550%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 88, internal_epoch   6,  Average loss: 0.0002, Accuracy: 732/734 (99.7275%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 88, internal_epoch   7,  Average loss: 0.0002, Accuracy: 732/734 (99.7275%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 88, internal_epoch   8,  Average loss: 0.0002, Accuracy: 732/734 (99.7275%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 88, internal_epoch   9,  Average loss: 0.0002, Accuracy: 732/734 (99.7275%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 88, internal_epoch  10,  Average loss: 0.0003, Accuracy: 730/734 (99.4550%), train_poison_data_count: 382
Global model norm: 15.533778147952438.
Norm before scaling: 15.678156650169868. Distance: 1.745041771418834
Total norm for 10 adversaries is: 15.678156650169868. distance: 1.745041771418834
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0221, Accuracy: 8904/8968 (99.2864%)
___Train Local_Simple,  epoch  58, local model 53, internal_epoch   1,  Average loss: 0.0005, Accuracy: 555/561 (98.9305%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.1063, Accuracy: 7471/10000 (74.7100%)
___Train Local_Simple,  epoch  58, local model 79, internal_epoch   1,  Average loss: 0.0008, Accuracy: 656/661 (99.2436%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.2695, Accuracy: 6835/10000 (68.3500%)
___Train Local_Simple,  epoch  58, local model 1, internal_epoch   1,  Average loss: 0.0003, Accuracy: 535/536 (99.8134%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1288, Accuracy: 9564/10000 (95.6400%)
___Train Local_Simple,  epoch  58, local model 37, internal_epoch   1,  Average loss: 0.0006, Accuracy: 450/456 (98.6842%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.3689, Accuracy: 7086/10000 (70.8600%)
___Train Local_Simple,  epoch  58, local model 71, internal_epoch   1,  Average loss: 0.0008, Accuracy: 553/561 (98.5740%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.8141, Accuracy: 7527/10000 (75.2700%)
___Train Local_Simple,  epoch  58, local model 82, internal_epoch   1,  Average loss: 0.0005, Accuracy: 805/815 (98.7730%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 3.3275, Accuracy: 4524/10000 (45.2400%)
___Train Local_Simple,  epoch  58, local model 28, internal_epoch   1,  Average loss: 0.0007, Accuracy: 600/611 (98.1997%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 2.2634, Accuracy: 6492/10000 (64.9200%)
___Train Local_Simple,  epoch  58, local model 50, internal_epoch   1,  Average loss: 0.0011, Accuracy: 468/477 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.8249, Accuracy: 7413/10000 (74.1300%)
___Train Local_Simple,  epoch  58, local model 44, internal_epoch   1,  Average loss: 0.0002, Accuracy: 559/561 (99.6435%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.2522, Accuracy: 9118/10000 (91.1800%)
___Train Local_Simple,  epoch  58, local model 25, internal_epoch   1,  Average loss: 0.0003, Accuracy: 589/592 (99.4932%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.8824, Accuracy: 8002/10000 (80.0200%)
___Train Local_Simple,  epoch  58, local model 24, internal_epoch   1,  Average loss: 0.0012, Accuracy: 468/477 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.5766, Accuracy: 7985/10000 (79.8500%)
___Train Local_Simple,  epoch  58, local model 57, internal_epoch   1,  Average loss: 0.0005, Accuracy: 518/523 (99.0440%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.7784, Accuracy: 7510/10000 (75.1000%)
___Train Local_Simple,  epoch  58, local model 9, internal_epoch   1,  Average loss: 0.0007, Accuracy: 501/508 (98.6220%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.7292, Accuracy: 7685/10000 (76.8500%)
___Train Local_Simple,  epoch  58, local model 75, internal_epoch   1,  Average loss: 0.0012, Accuracy: 744/763 (97.5098%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 2.5090, Accuracy: 5428/10000 (54.2800%)
___Train Local_Simple,  epoch  58, local model 39, internal_epoch   1,  Average loss: 0.0007, Accuracy: 484/493 (98.1744%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.2819, Accuracy: 7125/10000 (71.2500%)
___Train Local_Simple,  epoch  58, local model 92, internal_epoch   1,  Average loss: 0.0020, Accuracy: 590/611 (96.5630%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 3.6927, Accuracy: 3297/10000 (32.9700%)
___Train Local_Simple,  epoch  58, local model 65, internal_epoch   1,  Average loss: 0.0016, Accuracy: 604/621 (97.2625%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.0831, Accuracy: 7550/10000 (75.5000%)
___Train Local_Simple,  epoch  58, local model 11, internal_epoch   1,  Average loss: 0.0003, Accuracy: 552/554 (99.6390%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.5889, Accuracy: 8207/10000 (82.0700%)
___Train Local_Simple,  epoch  58, local model 8, internal_epoch   1,  Average loss: 0.0009, Accuracy: 691/706 (97.8754%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 3.4272, Accuracy: 3933/10000 (39.3300%)
___Train Local_Simple,  epoch  58, local model 48, internal_epoch   1,  Average loss: 0.0008, Accuracy: 355/363 (97.7961%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.4046, Accuracy: 8705/10000 (87.0500%)
___Train Local_Simple,  epoch  58, local model 61, internal_epoch   1,  Average loss: 0.0009, Accuracy: 286/287 (99.6516%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1462, Accuracy: 9554/10000 (95.5400%)
___Train Local_Simple,  epoch  58, local model 19, internal_epoch   1,  Average loss: 0.0004, Accuracy: 595/598 (99.4983%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.7867, Accuracy: 6422/10000 (64.2200%)
___Train Local_Simple,  epoch  58, local model 15, internal_epoch   1,  Average loss: 0.0005, Accuracy: 281/282 (99.6454%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1959, Accuracy: 9316/10000 (93.1600%)
___Train Local_Simple,  epoch  58, local model 84, internal_epoch   1,  Average loss: 0.0007, Accuracy: 416/420 (99.0476%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.3279, Accuracy: 8905/10000 (89.0500%)
___Train Local_Simple,  epoch  58, local model 7, internal_epoch   1,  Average loss: 0.0003, Accuracy: 797/802 (99.3766%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 2.3539, Accuracy: 5257/10000 (52.5700%)
___Train Local_Simple,  epoch  58, local model 81, internal_epoch   1,  Average loss: 0.0008, Accuracy: 623/636 (97.9560%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 3.1724, Accuracy: 3708/10000 (37.0800%)
___Train Local_Simple,  epoch  58, local model 21, internal_epoch   1,  Average loss: 0.0004, Accuracy: 684/687 (99.5633%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.3578, Accuracy: 6986/10000 (69.8600%)
___Train Local_Simple,  epoch  58, local model 66, internal_epoch   1,  Average loss: 0.0011, Accuracy: 715/733 (97.5443%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 3.9759, Accuracy: 3392/10000 (33.9200%)
___Train Local_Simple,  epoch  58, local model 4, internal_epoch   1,  Average loss: 0.0005, Accuracy: 739/748 (98.7968%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.8312, Accuracy: 5308/10000 (53.0800%)
___Train Local_Simple,  epoch  58, local model 90, internal_epoch   1,  Average loss: 0.0029, Accuracy: 577/615 (93.8211%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.9153, Accuracy: 7539/10000 (75.3900%)
___Train Local_Simple,  epoch  58, local model 98, internal_epoch   1,  Average loss: 0.0010, Accuracy: 537/548 (97.9927%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 3.3973, Accuracy: 4589/10000 (45.8900%)
___Train Local_Simple,  epoch  58, local model 35, internal_epoch   1,  Average loss: 0.0007, Accuracy: 623/630 (98.8889%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 2.3902, Accuracy: 5717/10000 (57.1700%)
___Train Local_Simple,  epoch  58, local model 95, internal_epoch   1,  Average loss: 0.0020, Accuracy: 579/600 (96.5000%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 3.0946, Accuracy: 5608/10000 (56.0800%)
___Train Local_Simple,  epoch  58, local model 27, internal_epoch   1,  Average loss: 0.0005, Accuracy: 738/745 (99.0604%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.9494, Accuracy: 5632/10000 (56.3200%)
___Train Local_Simple,  epoch  58, local model 54, internal_epoch   1,  Average loss: 0.0004, Accuracy: 826/832 (99.2788%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 2.1229, Accuracy: 6207/10000 (62.0700%)
___Train Local_Simple,  epoch  58, local model 6, internal_epoch   1,  Average loss: 0.0006, Accuracy: 429/435 (98.6207%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.6924, Accuracy: 8055/10000 (80.5500%)
___Train Local_Simple,  epoch  58, local model 5, internal_epoch   1,  Average loss: 0.0005, Accuracy: 571/578 (98.7889%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.8627, Accuracy: 7857/10000 (78.5700%)
___Train Local_Simple,  epoch  58, local model 52, internal_epoch   1,  Average loss: 0.0012, Accuracy: 773/789 (97.9721%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 3.5195, Accuracy: 5226/10000 (52.2600%)
___Train Local_Simple,  epoch  58, local model 63, internal_epoch   1,  Average loss: 0.0011, Accuracy: 298/303 (98.3498%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.6287, Accuracy: 6132/10000 (61.3200%)
___Train Local_Simple,  epoch  58, local model 87, internal_epoch   1,  Average loss: 0.0007, Accuracy: 655/663 (98.7934%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 2.5222, Accuracy: 4913/10000 (49.1300%)
___Train Local_Simple,  epoch  58, local model 30, internal_epoch   1,  Average loss: 0.0007, Accuracy: 438/443 (98.8713%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.5053, Accuracy: 8402/10000 (84.0200%)
___Train Local_Simple,  epoch  58, local model 32, internal_epoch   1,  Average loss: 0.0007, Accuracy: 586/590 (99.3220%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.9298, Accuracy: 7276/10000 (72.7600%)
___Train Local_Simple,  epoch  58, local model 36, internal_epoch   1,  Average loss: 0.0004, Accuracy: 313/315 (99.3651%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1726, Accuracy: 9376/10000 (93.7600%)
___Train Local_Simple,  epoch  58, local model 42, internal_epoch   1,  Average loss: 0.0003, Accuracy: 471/473 (99.5772%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.3837, Accuracy: 8607/10000 (86.0700%)
___Train Local_Simple,  epoch  58, local model 22, internal_epoch   1,  Average loss: 0.0004, Accuracy: 260/262 (99.2366%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.5071, Accuracy: 8649/10000 (86.4900%)
___Train Local_Simple,  epoch  58, local model 47, internal_epoch   1,  Average loss: 0.0007, Accuracy: 526/534 (98.5019%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.8949, Accuracy: 5673/10000 (56.7300%)
___Train Local_Simple,  epoch  58, local model 0, internal_epoch   1,  Average loss: 0.0005, Accuracy: 431/435 (99.0805%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.6089, Accuracy: 6866/10000 (68.6600%)
___Train Local_Simple,  epoch  58, local model 78, internal_epoch   1,  Average loss: 0.0019, Accuracy: 565/587 (96.2521%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 4.0896, Accuracy: 3387/10000 (33.8700%)
___Train Local_Simple,  epoch  58, local model 67, internal_epoch   1,  Average loss: 0.0010, Accuracy: 436/441 (98.8662%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.1200, Accuracy: 6860/10000 (68.6000%)
___Train Local_Simple,  epoch  58, local model 89, internal_epoch   1,  Average loss: 0.0012, Accuracy: 668/683 (97.8038%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 2.5217, Accuracy: 5794/10000 (57.9400%)
___Train Local_Simple,  epoch  58, local model 46, internal_epoch   1,  Average loss: 0.0006, Accuracy: 642/650 (98.7692%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 2.0190, Accuracy: 6145/10000 (61.4500%)
___Train Local_Simple,  epoch  58, local model 91, internal_epoch   1,  Average loss: 0.0004, Accuracy: 813/819 (99.2674%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 2.0745, Accuracy: 5421/10000 (54.2100%)
___Train Local_Simple,  epoch  58, local model 10, internal_epoch   1,  Average loss: 0.0007, Accuracy: 568/573 (99.1274%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 2.1105, Accuracy: 6242/10000 (62.4200%)
___Train Local_Simple,  epoch  58, local model 34, internal_epoch   1,  Average loss: 0.0008, Accuracy: 861/871 (98.8519%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 4.6776, Accuracy: 3747/10000 (37.4700%)
___Train Local_Simple,  epoch  58, local model 45, internal_epoch   1,  Average loss: 0.0006, Accuracy: 640/647 (98.9181%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.8394, Accuracy: 5847/10000 (58.4700%)
___Train Local_Simple,  epoch  58, local model 83, internal_epoch   1,  Average loss: 0.0008, Accuracy: 354/360 (98.3333%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.3891, Accuracy: 8837/10000 (88.3700%)
___Train Local_Simple,  epoch  58, local model 23, internal_epoch   1,  Average loss: 0.0011, Accuracy: 527/542 (97.2325%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.2682, Accuracy: 6491/10000 (64.9100%)
___Train Local_Simple,  epoch  58, local model 99, internal_epoch   1,  Average loss: 0.0015, Accuracy: 686/712 (96.3483%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.0543, Accuracy: 7184/10000 (71.8400%)
___Train Local_Simple,  epoch  58, local model 2, internal_epoch   1,  Average loss: 0.0008, Accuracy: 554/564 (98.2270%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.0172, Accuracy: 6755/10000 (67.5500%)
___Train Local_Simple,  epoch  58, local model 38, internal_epoch   1,  Average loss: 0.0009, Accuracy: 469/477 (98.3229%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1916, Accuracy: 9363/10000 (93.6300%)
___Train Local_Simple,  epoch  58, local model 58, internal_epoch   1,  Average loss: 0.0005, Accuracy: 765/772 (99.0933%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.4572, Accuracy: 6628/10000 (66.2800%)
___Train Local_Simple,  epoch  58, local model 69, internal_epoch   1,  Average loss: 0.0008, Accuracy: 661/671 (98.5097%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.8735, Accuracy: 5969/10000 (59.6900%)
___Train Local_Simple,  epoch  58, local model 85, internal_epoch   1,  Average loss: 0.0012, Accuracy: 784/807 (97.1499%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 2.5148, Accuracy: 6086/10000 (60.8600%)
___Train Local_Simple,  epoch  58, local model 70, internal_epoch   1,  Average loss: 0.0010, Accuracy: 559/568 (98.4155%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 2.5281, Accuracy: 4244/10000 (42.4400%)
___Train Local_Simple,  epoch  58, local model 56, internal_epoch   1,  Average loss: 0.0003, Accuracy: 710/715 (99.3007%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 2.3732, Accuracy: 5790/10000 (57.9000%)
___Train Local_Simple,  epoch  58, local model 76, internal_epoch   1,  Average loss: 0.0014, Accuracy: 454/459 (98.9107%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.5350, Accuracy: 8470/10000 (84.7000%)
___Train Local_Simple,  epoch  58, local model 20, internal_epoch   1,  Average loss: 0.0007, Accuracy: 596/602 (99.0033%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.8886, Accuracy: 5907/10000 (59.0700%)
___Train Local_Simple,  epoch  58, local model 86, internal_epoch   1,  Average loss: 0.0004, Accuracy: 687/692 (99.2775%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 3.9259, Accuracy: 3481/10000 (34.8100%)
___Train Local_Simple,  epoch  58, local model 16, internal_epoch   1,  Average loss: 0.0003, Accuracy: 813/817 (99.5104%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.8599, Accuracy: 7715/10000 (77.1500%)
___Train Local_Simple,  epoch  58, local model 77, internal_epoch   1,  Average loss: 0.0013, Accuracy: 598/618 (96.7638%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 4.7148, Accuracy: 4446/10000 (44.4600%)
___Train Local_Simple,  epoch  58, local model 68, internal_epoch   1,  Average loss: 0.0011, Accuracy: 542/549 (98.7250%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.5626, Accuracy: 6202/10000 (62.0200%)
___Train Local_Simple,  epoch  58, local model 80, internal_epoch   1,  Average loss: 0.0022, Accuracy: 513/532 (96.4286%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 2.1037, Accuracy: 4499/10000 (44.9900%)
___Train Local_Simple,  epoch  58, local model 31, internal_epoch   1,  Average loss: 0.0006, Accuracy: 591/596 (99.1611%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.5303, Accuracy: 8236/10000 (82.3600%)
___Train Local_Simple,  epoch  58, local model 14, internal_epoch   1,  Average loss: 0.0013, Accuracy: 673/692 (97.2543%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.2035, Accuracy: 7073/10000 (70.7300%)
___Train Local_Simple,  epoch  58, local model 60, internal_epoch   1,  Average loss: 0.0010, Accuracy: 558/571 (97.7233%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 2.3420, Accuracy: 4533/10000 (45.3300%)
___Train Local_Simple,  epoch  58, local model 26, internal_epoch   1,  Average loss: 0.0008, Accuracy: 509/519 (98.0732%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.4940, Accuracy: 6428/10000 (64.2800%)
___Train Local_Simple,  epoch  58, local model 43, internal_epoch   1,  Average loss: 0.0005, Accuracy: 428/431 (99.3039%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.3092, Accuracy: 8930/10000 (89.3000%)
___Train Local_Simple,  epoch  58, local model 97, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1107/1112 (99.5504%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 2.5451, Accuracy: 4747/10000 (47.4700%)
___Train Local_Simple,  epoch  58, local model 40, internal_epoch   1,  Average loss: 0.0005, Accuracy: 497/498 (99.7992%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.2464, Accuracy: 7059/10000 (70.5900%)
___Train Local_Simple,  epoch  58, local model 17, internal_epoch   1,  Average loss: 0.0004, Accuracy: 523/527 (99.2410%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.9831, Accuracy: 7147/10000 (71.4700%)
___Train Local_Simple,  epoch  58, local model 93, internal_epoch   1,  Average loss: 0.0013, Accuracy: 611/630 (96.9841%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.9411, Accuracy: 5603/10000 (56.0300%)
___Train Local_Simple,  epoch  58, local model 12, internal_epoch   1,  Average loss: 0.0006, Accuracy: 718/725 (99.0345%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.6147, Accuracy: 6808/10000 (68.0800%)
___Train Local_Simple,  epoch  58, local model 64, internal_epoch   1,  Average loss: 0.0004, Accuracy: 602/608 (99.0132%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.8955, Accuracy: 5982/10000 (59.8200%)
___Train Local_Simple,  epoch  58, local model 13, internal_epoch   1,  Average loss: 0.0004, Accuracy: 705/713 (98.8780%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.9328, Accuracy: 6041/10000 (60.4100%)
___Train Local_Simple,  epoch  58, local model 72, internal_epoch   1,  Average loss: 0.0012, Accuracy: 413/423 (97.6359%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.8108, Accuracy: 6098/10000 (60.9800%)
___Train Local_Simple,  epoch  58, local model 49, internal_epoch   1,  Average loss: 0.0009, Accuracy: 350/355 (98.5915%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.2222, Accuracy: 6432/10000 (64.3200%)
___Train Local_Simple,  epoch  58, local model 96, internal_epoch   1,  Average loss: 0.0006, Accuracy: 523/531 (98.4934%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 3.2907, Accuracy: 4715/10000 (47.1500%)
___Train Local_Simple,  epoch  58, local model 55, internal_epoch   1,  Average loss: 0.0008, Accuracy: 370/375 (98.6667%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.5859, Accuracy: 8128/10000 (81.2800%)
___Train Local_Simple,  epoch  58, local model 94, internal_epoch   1,  Average loss: 0.0005, Accuracy: 666/671 (99.2548%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.7554, Accuracy: 6561/10000 (65.6100%)
___Train Local_Simple,  epoch  58, local model 59, internal_epoch   1,  Average loss: 0.0006, Accuracy: 636/644 (98.7578%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.8411, Accuracy: 7507/10000 (75.0700%)
time spent on training: 393.3618221282959
___Test Target_Simple poisoned: False, epoch: 58: Average loss: 0.0781, Accuracy: 9766/10000 (97.6600%)
___Test Target_Simple poisoned: True, epoch: 58: Average loss: 1.8264, Accuracy: 5165/8968 (57.5937%)
saving model
Done in 429.71946454048157 sec.
Server Epoch:59 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 44, 68, 86, 31, 16, 34, 26, 76, 25, 40, 60, 36, 53, 54, 42, 67, 83, 91, 85, 70, 55, 32, 98, 27, 64, 28, 10, 84, 39, 13, 99, 37, 69, 35, 1, 58, 17, 20, 89, 14, 9, 48, 65, 30, 94, 87, 6, 81, 46, 45, 56, 71, 4, 23, 93, 15, 11, 57, 8, 47, 43, 61, 52, 63, 75, 92, 24, 97, 22, 80, 90, 0, 49, 12, 96, 59, 50, 19, 78, 21, 66, 72, 38, 77, 2, 5, 95, 82, 79, 7].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   1,  Average loss: 0.0067, Accuracy: 504/569 (88.5764%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   2,  Average loss: 0.0007, Accuracy: 563/569 (98.9455%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   3,  Average loss: 0.0002, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 288
Global model norm: 15.538342213226981.
Norm before scaling: 15.729099029328223. Distance: 2.6612055609322294
Total norm for 10 adversaries is: 15.729099029328223. distance: 2.6612055609322294
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.7517, Accuracy: 7415/8968 (82.6829%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   1,  Average loss: 0.0012, Accuracy: 510/522 (97.7011%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   2,  Average loss: 0.0004, Accuracy: 516/522 (98.8506%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   3,  Average loss: 0.0003, Accuracy: 520/522 (99.6169%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 522/522 (100.0000%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 522/522 (100.0000%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   7,  Average loss: 0.0000, Accuracy: 522/522 (100.0000%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   8,  Average loss: 0.0000, Accuracy: 522/522 (100.0000%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 522/522 (100.0000%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 73, internal_epoch  10,  Average loss: 0.0000, Accuracy: 522/522 (100.0000%), train_poison_data_count: 266
Global model norm: 15.538342213226981.
Norm before scaling: 15.573424155175129. Distance: 1.079401780565485
Total norm for 10 adversaries is: 15.573424155175129. distance: 1.079401780565485
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0053, Accuracy: 8950/8968 (99.7993%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   1,  Average loss: 0.0039, Accuracy: 356/385 (92.4675%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   2,  Average loss: 0.0006, Accuracy: 380/385 (98.7013%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   3,  Average loss: 0.0003, Accuracy: 385/385 (100.0000%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   4,  Average loss: 0.0003, Accuracy: 384/385 (99.7403%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   5,  Average loss: 0.0004, Accuracy: 381/385 (98.9610%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   6,  Average loss: 0.0002, Accuracy: 385/385 (100.0000%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   7,  Average loss: 0.0003, Accuracy: 384/385 (99.7403%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   8,  Average loss: 0.0003, Accuracy: 383/385 (99.4805%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch   9,  Average loss: 0.0003, Accuracy: 383/385 (99.4805%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 51, internal_epoch  10,  Average loss: 0.0002, Accuracy: 384/385 (99.7403%), train_poison_data_count: 193
Global model norm: 15.538342213226981.
Norm before scaling: 15.634287766940078. Distance: 1.585354401831571
Total norm for 10 adversaries is: 15.634287766940078. distance: 1.585354401831571
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0909, Accuracy: 8684/8968 (96.8332%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   1,  Average loss: 0.0018, Accuracy: 606/627 (96.6507%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   2,  Average loss: 0.0005, Accuracy: 618/627 (98.5646%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   3,  Average loss: 0.0001, Accuracy: 625/627 (99.6810%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   4,  Average loss: 0.0004, Accuracy: 625/627 (99.6810%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   5,  Average loss: 0.0003, Accuracy: 624/627 (99.5215%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 626/627 (99.8405%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   7,  Average loss: 0.0004, Accuracy: 624/627 (99.5215%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   8,  Average loss: 0.0003, Accuracy: 626/627 (99.8405%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 625/627 (99.6810%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 626/627 (99.8405%), train_poison_data_count: 320
Global model norm: 15.538342213226981.
Norm before scaling: 15.577509371455163. Distance: 1.350814568289044
Total norm for 10 adversaries is: 15.577509371455163. distance: 1.350814568289044
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0039, Accuracy: 8950/8968 (99.7993%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 3, internal_epoch   1,  Average loss: 0.0087, Accuracy: 430/516 (83.3333%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 3, internal_epoch   2,  Average loss: 0.0014, Accuracy: 497/516 (96.3178%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 3, internal_epoch   3,  Average loss: 0.0004, Accuracy: 513/516 (99.4186%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 3, internal_epoch   4,  Average loss: 0.0004, Accuracy: 512/516 (99.2248%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 3, internal_epoch   5,  Average loss: 0.0003, Accuracy: 513/516 (99.4186%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 3, internal_epoch   6,  Average loss: 0.0002, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 3, internal_epoch   7,  Average loss: 0.0003, Accuracy: 511/516 (99.0310%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 3, internal_epoch   8,  Average loss: 0.0002, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 3, internal_epoch   9,  Average loss: 0.0002, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 3, internal_epoch  10,  Average loss: 0.0001, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Global model norm: 15.538342213226981.
Norm before scaling: 15.971568596038672. Distance: 3.6185696888014194
Total norm for 10 adversaries is: 15.971568596038672. distance: 3.6185696888014194
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.9518, Accuracy: 6631/8968 (73.9407%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 18, internal_epoch   1,  Average loss: 0.0020, Accuracy: 734/759 (96.7062%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 18, internal_epoch   2,  Average loss: 0.0009, Accuracy: 741/759 (97.6285%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 18, internal_epoch   3,  Average loss: 0.0004, Accuracy: 752/759 (99.0777%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 18, internal_epoch   4,  Average loss: 0.0003, Accuracy: 754/759 (99.3412%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 18, internal_epoch   5,  Average loss: 0.0001, Accuracy: 759/759 (100.0000%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 18, internal_epoch   6,  Average loss: 0.0001, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 18, internal_epoch   7,  Average loss: 0.0002, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 18, internal_epoch   8,  Average loss: 0.0001, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 18, internal_epoch   9,  Average loss: 0.0002, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 18, internal_epoch  10,  Average loss: 0.0001, Accuracy: 759/759 (100.0000%), train_poison_data_count: 384
Global model norm: 15.538342213226981.
Norm before scaling: 15.756184650362794. Distance: 2.1891962286912667
Total norm for 10 adversaries is: 15.756184650362794. distance: 2.1891962286912667
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0173, Accuracy: 8909/8968 (99.3421%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 29, internal_epoch   1,  Average loss: 0.0027, Accuracy: 475/506 (93.8735%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 29, internal_epoch   2,  Average loss: 0.0010, Accuracy: 500/506 (98.8142%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 29, internal_epoch   3,  Average loss: 0.0006, Accuracy: 500/506 (98.8142%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 29, internal_epoch   4,  Average loss: 0.0003, Accuracy: 503/506 (99.4071%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 29, internal_epoch   5,  Average loss: 0.0004, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 29, internal_epoch   6,  Average loss: 0.0003, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 29, internal_epoch   7,  Average loss: 0.0002, Accuracy: 506/506 (100.0000%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 29, internal_epoch   8,  Average loss: 0.0002, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 29, internal_epoch   9,  Average loss: 0.0002, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 29, internal_epoch  10,  Average loss: 0.0002, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Global model norm: 15.538342213226981.
Norm before scaling: 15.748743885147189. Distance: 2.0317418603331547
Total norm for 10 adversaries is: 15.748743885147189. distance: 2.0317418603331547
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.8123, Accuracy: 7268/8968 (81.0437%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 62, internal_epoch   1,  Average loss: 0.0029, Accuracy: 547/580 (94.3103%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 62, internal_epoch   2,  Average loss: 0.0010, Accuracy: 567/580 (97.7586%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 62, internal_epoch   3,  Average loss: 0.0005, Accuracy: 574/580 (98.9655%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 62, internal_epoch   4,  Average loss: 0.0003, Accuracy: 576/580 (99.3103%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 62, internal_epoch   5,  Average loss: 0.0004, Accuracy: 572/580 (98.6207%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 62, internal_epoch   6,  Average loss: 0.0005, Accuracy: 574/580 (98.9655%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 62, internal_epoch   7,  Average loss: 0.0002, Accuracy: 577/580 (99.4828%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 62, internal_epoch   8,  Average loss: 0.0002, Accuracy: 576/580 (99.3103%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 62, internal_epoch   9,  Average loss: 0.0002, Accuracy: 577/580 (99.4828%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 62, internal_epoch  10,  Average loss: 0.0002, Accuracy: 576/580 (99.3103%), train_poison_data_count: 292
Global model norm: 15.538342213226981.
Norm before scaling: 15.606535476682868. Distance: 1.6014460079346902
Total norm for 10 adversaries is: 15.606535476682868. distance: 1.6014460079346902
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0154, Accuracy: 8922/8968 (99.4871%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 33, internal_epoch   1,  Average loss: 0.0042, Accuracy: 544/587 (92.6746%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 33, internal_epoch   2,  Average loss: 0.0006, Accuracy: 582/587 (99.1482%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 33, internal_epoch   3,  Average loss: 0.0006, Accuracy: 581/587 (98.9779%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 33, internal_epoch   4,  Average loss: 0.0003, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 33, internal_epoch   5,  Average loss: 0.0003, Accuracy: 585/587 (99.6593%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 33, internal_epoch   6,  Average loss: 0.0002, Accuracy: 586/587 (99.8296%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 33, internal_epoch   7,  Average loss: 0.0002, Accuracy: 585/587 (99.6593%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 33, internal_epoch   8,  Average loss: 0.0002, Accuracy: 586/587 (99.8296%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 33, internal_epoch   9,  Average loss: 0.0001, Accuracy: 586/587 (99.8296%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 33, internal_epoch  10,  Average loss: 0.0001, Accuracy: 585/587 (99.6593%), train_poison_data_count: 299
Global model norm: 15.538342213226981.
Norm before scaling: 15.747538540761646. Distance: 2.394719426040463
Total norm for 10 adversaries is: 15.747538540761646. distance: 2.394719426040463
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.5725, Accuracy: 7664/8968 (85.4594%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 88, internal_epoch   1,  Average loss: 0.0024, Accuracy: 694/734 (94.5504%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 88, internal_epoch   2,  Average loss: 0.0007, Accuracy: 723/734 (98.5014%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 88, internal_epoch   3,  Average loss: 0.0004, Accuracy: 726/734 (98.9101%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 88, internal_epoch   4,  Average loss: 0.0003, Accuracy: 729/734 (99.3188%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 88, internal_epoch   5,  Average loss: 0.0002, Accuracy: 731/734 (99.5913%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 88, internal_epoch   6,  Average loss: 0.0002, Accuracy: 733/734 (99.8638%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 88, internal_epoch   7,  Average loss: 0.0002, Accuracy: 733/734 (99.8638%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 88, internal_epoch   8,  Average loss: 0.0001, Accuracy: 733/734 (99.8638%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 88, internal_epoch   9,  Average loss: 0.0001, Accuracy: 734/734 (100.0000%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 88, internal_epoch  10,  Average loss: 0.0001, Accuracy: 734/734 (100.0000%), train_poison_data_count: 382
Global model norm: 15.538342213226981.
Norm before scaling: 15.689258978359655. Distance: 1.956999148412021
Total norm for 10 adversaries is: 15.689258978359655. distance: 1.956999148412021
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0187, Accuracy: 8916/8968 (99.4202%)
___Train Local_Simple,  epoch  59, local model 44, internal_epoch   1,  Average loss: 0.0003, Accuracy: 557/561 (99.2870%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.2534, Accuracy: 7456/10000 (74.5600%)
___Train Local_Simple,  epoch  59, local model 68, internal_epoch   1,  Average loss: 0.0011, Accuracy: 538/549 (97.9964%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 2.2164, Accuracy: 5796/10000 (57.9600%)
___Train Local_Simple,  epoch  59, local model 86, internal_epoch   1,  Average loss: 0.0004, Accuracy: 688/692 (99.4220%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 2.9540, Accuracy: 4852/10000 (48.5200%)
___Train Local_Simple,  epoch  59, local model 31, internal_epoch   1,  Average loss: 0.0006, Accuracy: 588/596 (98.6577%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.0756, Accuracy: 6838/10000 (68.3800%)
___Train Local_Simple,  epoch  59, local model 16, internal_epoch   1,  Average loss: 0.0002, Accuracy: 813/817 (99.5104%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.0130, Accuracy: 7621/10000 (76.2100%)
___Train Local_Simple,  epoch  59, local model 34, internal_epoch   1,  Average loss: 0.0009, Accuracy: 857/871 (98.3927%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 2.6919, Accuracy: 5308/10000 (53.0800%)
___Train Local_Simple,  epoch  59, local model 26, internal_epoch   1,  Average loss: 0.0006, Accuracy: 512/519 (98.6513%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.4405, Accuracy: 6545/10000 (65.4500%)
___Train Local_Simple,  epoch  59, local model 76, internal_epoch   1,  Average loss: 0.0010, Accuracy: 453/459 (98.6928%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.6658, Accuracy: 8029/10000 (80.2900%)
___Train Local_Simple,  epoch  59, local model 25, internal_epoch   1,  Average loss: 0.0002, Accuracy: 591/592 (99.8311%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.1512, Accuracy: 7925/10000 (79.2500%)
___Train Local_Simple,  epoch  59, local model 40, internal_epoch   1,  Average loss: 0.0003, Accuracy: 495/498 (99.3976%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.1511, Accuracy: 6812/10000 (68.1200%)
___Train Local_Simple,  epoch  59, local model 60, internal_epoch   1,  Average loss: 0.0008, Accuracy: 564/571 (98.7741%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 2.3947, Accuracy: 5504/10000 (55.0400%)
___Train Local_Simple,  epoch  59, local model 36, internal_epoch   1,  Average loss: 0.0005, Accuracy: 311/315 (98.7302%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1825, Accuracy: 9385/10000 (93.8500%)
___Train Local_Simple,  epoch  59, local model 53, internal_epoch   1,  Average loss: 0.0005, Accuracy: 555/561 (98.9305%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.6727, Accuracy: 6904/10000 (69.0400%)
___Train Local_Simple,  epoch  59, local model 54, internal_epoch   1,  Average loss: 0.0004, Accuracy: 825/832 (99.1587%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 2.0451, Accuracy: 6383/10000 (63.8300%)
___Train Local_Simple,  epoch  59, local model 42, internal_epoch   1,  Average loss: 0.0003, Accuracy: 470/473 (99.3658%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.4858, Accuracy: 8324/10000 (83.2400%)
___Train Local_Simple,  epoch  59, local model 67, internal_epoch   1,  Average loss: 0.0009, Accuracy: 437/441 (99.0930%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.9562, Accuracy: 7143/10000 (71.4300%)
___Train Local_Simple,  epoch  59, local model 83, internal_epoch   1,  Average loss: 0.0011, Accuracy: 352/360 (97.7778%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.4101, Accuracy: 8675/10000 (86.7500%)
___Train Local_Simple,  epoch  59, local model 91, internal_epoch   1,  Average loss: 0.0003, Accuracy: 815/819 (99.5116%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.2216, Accuracy: 6417/10000 (64.1700%)
___Train Local_Simple,  epoch  59, local model 85, internal_epoch   1,  Average loss: 0.0017, Accuracy: 773/807 (95.7869%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 3.4566, Accuracy: 4716/10000 (47.1600%)
___Train Local_Simple,  epoch  59, local model 70, internal_epoch   1,  Average loss: 0.0009, Accuracy: 559/568 (98.4155%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.2049, Accuracy: 6844/10000 (68.4400%)
___Train Local_Simple,  epoch  59, local model 55, internal_epoch   1,  Average loss: 0.0007, Accuracy: 368/375 (98.1333%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.2538, Accuracy: 6882/10000 (68.8200%)
___Train Local_Simple,  epoch  59, local model 32, internal_epoch   1,  Average loss: 0.0007, Accuracy: 582/590 (98.6441%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 2.9765, Accuracy: 5657/10000 (56.5700%)
___Train Local_Simple,  epoch  59, local model 98, internal_epoch   1,  Average loss: 0.0007, Accuracy: 540/548 (98.5401%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 2.4823, Accuracy: 4643/10000 (46.4300%)
___Train Local_Simple,  epoch  59, local model 27, internal_epoch   1,  Average loss: 0.0006, Accuracy: 736/745 (98.7919%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 3.3024, Accuracy: 5111/10000 (51.1100%)
___Train Local_Simple,  epoch  59, local model 64, internal_epoch   1,  Average loss: 0.0003, Accuracy: 607/608 (99.8355%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.5149, Accuracy: 6666/10000 (66.6600%)
___Train Local_Simple,  epoch  59, local model 28, internal_epoch   1,  Average loss: 0.0003, Accuracy: 608/611 (99.5090%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.4558, Accuracy: 7232/10000 (72.3200%)
___Train Local_Simple,  epoch  59, local model 10, internal_epoch   1,  Average loss: 0.0008, Accuracy: 561/573 (97.9058%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.3658, Accuracy: 6770/10000 (67.7000%)
___Train Local_Simple,  epoch  59, local model 84, internal_epoch   1,  Average loss: 0.0009, Accuracy: 411/420 (97.8571%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.7912, Accuracy: 7846/10000 (78.4600%)
___Train Local_Simple,  epoch  59, local model 39, internal_epoch   1,  Average loss: 0.0007, Accuracy: 484/493 (98.1744%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.4065, Accuracy: 6907/10000 (69.0700%)
___Train Local_Simple,  epoch  59, local model 13, internal_epoch   1,  Average loss: 0.0006, Accuracy: 704/713 (98.7377%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.5859, Accuracy: 6703/10000 (67.0300%)
___Train Local_Simple,  epoch  59, local model 99, internal_epoch   1,  Average loss: 0.0013, Accuracy: 693/712 (97.3315%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.4919, Accuracy: 6705/10000 (67.0500%)
___Train Local_Simple,  epoch  59, local model 37, internal_epoch   1,  Average loss: 0.0009, Accuracy: 450/456 (98.6842%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.6431, Accuracy: 6423/10000 (64.2300%)
___Train Local_Simple,  epoch  59, local model 69, internal_epoch   1,  Average loss: 0.0013, Accuracy: 657/671 (97.9136%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 2.3594, Accuracy: 5348/10000 (53.4800%)
___Train Local_Simple,  epoch  59, local model 35, internal_epoch   1,  Average loss: 0.0009, Accuracy: 619/630 (98.2540%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 5.0322, Accuracy: 3881/10000 (38.8100%)
___Train Local_Simple,  epoch  59, local model 1, internal_epoch   1,  Average loss: 0.0003, Accuracy: 534/536 (99.6269%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.3792, Accuracy: 8897/10000 (88.9700%)
___Train Local_Simple,  epoch  59, local model 58, internal_epoch   1,  Average loss: 0.0006, Accuracy: 763/772 (98.8342%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.3732, Accuracy: 6757/10000 (67.5700%)
___Train Local_Simple,  epoch  59, local model 17, internal_epoch   1,  Average loss: 0.0004, Accuracy: 524/527 (99.4307%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.0880, Accuracy: 6816/10000 (68.1600%)
___Train Local_Simple,  epoch  59, local model 20, internal_epoch   1,  Average loss: 0.0004, Accuracy: 599/602 (99.5017%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 2.1145, Accuracy: 6150/10000 (61.5000%)
___Train Local_Simple,  epoch  59, local model 89, internal_epoch   1,  Average loss: 0.0011, Accuracy: 667/683 (97.6574%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.5068, Accuracy: 6335/10000 (63.3500%)
___Train Local_Simple,  epoch  59, local model 14, internal_epoch   1,  Average loss: 0.0008, Accuracy: 679/692 (98.1214%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.1190, Accuracy: 6893/10000 (68.9300%)
___Train Local_Simple,  epoch  59, local model 9, internal_epoch   1,  Average loss: 0.0008, Accuracy: 502/508 (98.8189%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.9465, Accuracy: 7514/10000 (75.1400%)
___Train Local_Simple,  epoch  59, local model 48, internal_epoch   1,  Average loss: 0.0009, Accuracy: 357/363 (98.3471%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.2599, Accuracy: 9083/10000 (90.8300%)
___Train Local_Simple,  epoch  59, local model 65, internal_epoch   1,  Average loss: 0.0011, Accuracy: 609/621 (98.0676%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.2263, Accuracy: 6966/10000 (69.6600%)
___Train Local_Simple,  epoch  59, local model 30, internal_epoch   1,  Average loss: 0.0007, Accuracy: 440/443 (99.3228%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.1030, Accuracy: 7611/10000 (76.1100%)
___Train Local_Simple,  epoch  59, local model 94, internal_epoch   1,  Average loss: 0.0005, Accuracy: 662/671 (98.6587%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.8664, Accuracy: 6892/10000 (68.9200%)
___Train Local_Simple,  epoch  59, local model 87, internal_epoch   1,  Average loss: 0.0005, Accuracy: 657/663 (99.0950%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.4976, Accuracy: 6645/10000 (66.4500%)
___Train Local_Simple,  epoch  59, local model 6, internal_epoch   1,  Average loss: 0.0006, Accuracy: 431/435 (99.0805%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.4065, Accuracy: 7146/10000 (71.4600%)
___Train Local_Simple,  epoch  59, local model 81, internal_epoch   1,  Average loss: 0.0005, Accuracy: 632/636 (99.3711%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.7626, Accuracy: 5920/10000 (59.2000%)
___Train Local_Simple,  epoch  59, local model 46, internal_epoch   1,  Average loss: 0.0006, Accuracy: 641/650 (98.6154%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.4742, Accuracy: 6934/10000 (69.3400%)
___Train Local_Simple,  epoch  59, local model 45, internal_epoch   1,  Average loss: 0.0008, Accuracy: 641/647 (99.0726%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 2.4677, Accuracy: 4981/10000 (49.8100%)
___Train Local_Simple,  epoch  59, local model 56, internal_epoch   1,  Average loss: 0.0003, Accuracy: 712/715 (99.5804%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.2339, Accuracy: 6441/10000 (64.4100%)
___Train Local_Simple,  epoch  59, local model 71, internal_epoch   1,  Average loss: 0.0007, Accuracy: 555/561 (98.9305%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.7030, Accuracy: 7886/10000 (78.8600%)
___Train Local_Simple,  epoch  59, local model 4, internal_epoch   1,  Average loss: 0.0005, Accuracy: 740/748 (98.9305%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.7707, Accuracy: 6249/10000 (62.4900%)
___Train Local_Simple,  epoch  59, local model 23, internal_epoch   1,  Average loss: 0.0010, Accuracy: 534/542 (98.5240%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.9201, Accuracy: 5134/10000 (51.3400%)
___Train Local_Simple,  epoch  59, local model 93, internal_epoch   1,  Average loss: 0.0010, Accuracy: 618/630 (98.0952%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 2.9805, Accuracy: 4853/10000 (48.5300%)
___Train Local_Simple,  epoch  59, local model 15, internal_epoch   1,  Average loss: 0.0005, Accuracy: 281/282 (99.6454%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.2236, Accuracy: 9225/10000 (92.2500%)
___Train Local_Simple,  epoch  59, local model 11, internal_epoch   1,  Average loss: 0.0005, Accuracy: 547/554 (98.7365%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.9549, Accuracy: 7573/10000 (75.7300%)
___Train Local_Simple,  epoch  59, local model 57, internal_epoch   1,  Average loss: 0.0006, Accuracy: 515/523 (98.4704%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.2862, Accuracy: 6114/10000 (61.1400%)
___Train Local_Simple,  epoch  59, local model 8, internal_epoch   1,  Average loss: 0.0008, Accuracy: 696/706 (98.5836%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 2.2096, Accuracy: 4924/10000 (49.2400%)
___Train Local_Simple,  epoch  59, local model 47, internal_epoch   1,  Average loss: 0.0005, Accuracy: 528/534 (98.8764%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.0358, Accuracy: 6790/10000 (67.9000%)
___Train Local_Simple,  epoch  59, local model 43, internal_epoch   1,  Average loss: 0.0006, Accuracy: 428/431 (99.3039%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.5070, Accuracy: 8400/10000 (84.0000%)
___Train Local_Simple,  epoch  59, local model 61, internal_epoch   1,  Average loss: 0.0008, Accuracy: 285/287 (99.3031%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1899, Accuracy: 9428/10000 (94.2800%)
___Train Local_Simple,  epoch  59, local model 52, internal_epoch   1,  Average loss: 0.0006, Accuracy: 779/789 (98.7326%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 2.5482, Accuracy: 5524/10000 (55.2400%)
___Train Local_Simple,  epoch  59, local model 63, internal_epoch   1,  Average loss: 0.0008, Accuracy: 299/303 (98.6799%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.6472, Accuracy: 8228/10000 (82.2800%)
___Train Local_Simple,  epoch  59, local model 75, internal_epoch   1,  Average loss: 0.0009, Accuracy: 751/763 (98.4273%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 2.2167, Accuracy: 4905/10000 (49.0500%)
___Train Local_Simple,  epoch  59, local model 92, internal_epoch   1,  Average loss: 0.0012, Accuracy: 596/611 (97.5450%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 2.8484, Accuracy: 4369/10000 (43.6900%)
___Train Local_Simple,  epoch  59, local model 24, internal_epoch   1,  Average loss: 0.0009, Accuracy: 468/477 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.5246, Accuracy: 8080/10000 (80.8000%)
___Train Local_Simple,  epoch  59, local model 97, internal_epoch   1,  Average loss: 0.0003, Accuracy: 1108/1112 (99.6403%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 2.0599, Accuracy: 5370/10000 (53.7000%)
___Train Local_Simple,  epoch  59, local model 22, internal_epoch   1,  Average loss: 0.0006, Accuracy: 260/262 (99.2366%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.5598, Accuracy: 8627/10000 (86.2700%)
___Train Local_Simple,  epoch  59, local model 80, internal_epoch   1,  Average loss: 0.0019, Accuracy: 517/532 (97.1805%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 5.1723, Accuracy: 3068/10000 (30.6800%)
___Train Local_Simple,  epoch  59, local model 90, internal_epoch   1,  Average loss: 0.0008, Accuracy: 606/615 (98.5366%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.9356, Accuracy: 6359/10000 (63.5900%)
___Train Local_Simple,  epoch  59, local model 0, internal_epoch   1,  Average loss: 0.0004, Accuracy: 432/435 (99.3103%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.9891, Accuracy: 7498/10000 (74.9800%)
___Train Local_Simple,  epoch  59, local model 49, internal_epoch   1,  Average loss: 0.0007, Accuracy: 351/355 (98.8732%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.1636, Accuracy: 6438/10000 (64.3800%)
___Train Local_Simple,  epoch  59, local model 12, internal_epoch   1,  Average loss: 0.0007, Accuracy: 718/725 (99.0345%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.7298, Accuracy: 7166/10000 (71.6600%)
___Train Local_Simple,  epoch  59, local model 96, internal_epoch   1,  Average loss: 0.0006, Accuracy: 523/531 (98.4934%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 2.4892, Accuracy: 5533/10000 (55.3300%)
___Train Local_Simple,  epoch  59, local model 59, internal_epoch   1,  Average loss: 0.0005, Accuracy: 637/644 (98.9130%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.5728, Accuracy: 6252/10000 (62.5200%)
___Train Local_Simple,  epoch  59, local model 50, internal_epoch   1,  Average loss: 0.0007, Accuracy: 469/477 (98.3229%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.6830, Accuracy: 6178/10000 (61.7800%)
___Train Local_Simple,  epoch  59, local model 19, internal_epoch   1,  Average loss: 0.0005, Accuracy: 593/598 (99.1639%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.6789, Accuracy: 6093/10000 (60.9300%)
___Train Local_Simple,  epoch  59, local model 78, internal_epoch   1,  Average loss: 0.0019, Accuracy: 568/587 (96.7632%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 2.3431, Accuracy: 5531/10000 (55.3100%)
___Train Local_Simple,  epoch  59, local model 21, internal_epoch   1,  Average loss: 0.0004, Accuracy: 681/687 (99.1266%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.8556, Accuracy: 5973/10000 (59.7300%)
___Train Local_Simple,  epoch  59, local model 66, internal_epoch   1,  Average loss: 0.0009, Accuracy: 720/733 (98.2265%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 2.9492, Accuracy: 4535/10000 (45.3500%)
___Train Local_Simple,  epoch  59, local model 72, internal_epoch   1,  Average loss: 0.0012, Accuracy: 414/423 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 2.6949, Accuracy: 4668/10000 (46.6800%)
___Train Local_Simple,  epoch  59, local model 38, internal_epoch   1,  Average loss: 0.0005, Accuracy: 471/477 (98.7421%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.2678, Accuracy: 9111/10000 (91.1100%)
___Train Local_Simple,  epoch  59, local model 77, internal_epoch   1,  Average loss: 0.0009, Accuracy: 608/618 (98.3819%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.6042, Accuracy: 6287/10000 (62.8700%)
___Train Local_Simple,  epoch  59, local model 2, internal_epoch   1,  Average loss: 0.0007, Accuracy: 557/564 (98.7589%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.6332, Accuracy: 7988/10000 (79.8800%)
___Train Local_Simple,  epoch  59, local model 5, internal_epoch   1,  Average loss: 0.0005, Accuracy: 569/578 (98.4429%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.9875, Accuracy: 7477/10000 (74.7700%)
___Train Local_Simple,  epoch  59, local model 95, internal_epoch   1,  Average loss: 0.0017, Accuracy: 582/600 (97.0000%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.1791, Accuracy: 6652/10000 (66.5200%)
___Train Local_Simple,  epoch  59, local model 82, internal_epoch   1,  Average loss: 0.0004, Accuracy: 809/815 (99.2638%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 2.4516, Accuracy: 5241/10000 (52.4100%)
___Train Local_Simple,  epoch  59, local model 79, internal_epoch   1,  Average loss: 0.0016, Accuracy: 656/661 (99.2436%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.7878, Accuracy: 7668/10000 (76.6800%)
___Train Local_Simple,  epoch  59, local model 7, internal_epoch   1,  Average loss: 0.0004, Accuracy: 799/802 (99.6259%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.6629, Accuracy: 7656/10000 (76.5600%)
time spent on training: 380.65961265563965
___Test Target_Simple poisoned: False, epoch: 59: Average loss: 0.0757, Accuracy: 9770/10000 (97.7000%)
___Test Target_Simple poisoned: True, epoch: 59: Average loss: 1.7391, Accuracy: 5429/8968 (60.5375%)
saving model
Done in 413.48490262031555 sec.
Server Epoch:60 choose agents : [41, 73, 51, 74, 3, 18, 29, 62, 33, 88, 45, 11, 92, 36, 71, 15, 67, 16, 28, 6, 99, 55, 34, 76, 2, 90, 98, 42, 60, 10, 44, 47, 70, 82, 97, 69, 1, 58, 89, 22, 81, 30, 95, 24, 65, 77, 68, 0, 43, 4, 13, 32, 19, 86, 26, 27, 79, 91, 61, 17, 46, 66, 52, 31, 50, 39, 23, 59, 48, 85, 84, 20, 35, 72, 63, 38, 21, 80, 75, 83, 87, 7, 64, 40, 5, 94, 93, 12, 57, 14, 8, 9, 25, 54, 49, 96, 53, 56, 78, 37].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   1,  Average loss: 0.0080, Accuracy: 490/569 (86.1160%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   2,  Average loss: 0.0011, Accuracy: 561/569 (98.5940%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   3,  Average loss: 0.0003, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   4,  Average loss: 0.0003, Accuracy: 566/569 (99.4728%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   5,  Average loss: 0.0003, Accuracy: 567/569 (99.6485%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 288
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   8,  Average loss: 0.0002, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch   9,  Average loss: 0.0002, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 41, internal_epoch  10,  Average loss: 0.0002, Accuracy: 568/569 (99.8243%), train_poison_data_count: 288
Global model norm: 15.539183771994097.
Norm before scaling: 15.797914314227922. Distance: 3.280032267993281
Total norm for 10 adversaries is: 15.797914314227922. distance: 3.280032267993281
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.7834, Accuracy: 7477/8968 (83.3742%)
poison local model 73 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   1,  Average loss: 0.0014, Accuracy: 509/522 (97.5096%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   2,  Average loss: 0.0004, Accuracy: 519/522 (99.4253%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 522/522 (100.0000%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   6,  Average loss: 0.0000, Accuracy: 522/522 (100.0000%), train_poison_data_count: 266
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   7,  Average loss: 0.0000, Accuracy: 522/522 (100.0000%), train_poison_data_count: 266
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   8,  Average loss: 0.0000, Accuracy: 522/522 (100.0000%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 521/522 (99.8084%), train_poison_data_count: 266
Global model norm: 15.539183771994097.
Norm before scaling: 15.592220009642679. Distance: 1.1142968079867086
Total norm for 10 adversaries is: 15.592220009642679. distance: 1.1142968079867086
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0148, Accuracy: 8922/8968 (99.4871%)
poison local model 51 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   1,  Average loss: 0.0021, Accuracy: 369/385 (95.8442%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   2,  Average loss: 0.0002, Accuracy: 384/385 (99.7403%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 385/385 (100.0000%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   4,  Average loss: 0.0004, Accuracy: 383/385 (99.4805%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 384/385 (99.7403%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   6,  Average loss: 0.0003, Accuracy: 384/385 (99.7403%), train_poison_data_count: 193
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   7,  Average loss: 0.0003, Accuracy: 384/385 (99.7403%), train_poison_data_count: 193
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 384/385 (99.7403%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 385/385 (100.0000%), train_poison_data_count: 193
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 385/385 (100.0000%), train_poison_data_count: 193
Global model norm: 15.539183771994097.
Norm before scaling: 15.598501456250984. Distance: 1.183913234988638
Total norm for 10 adversaries is: 15.598501456250984. distance: 1.183913234988638
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0869, Accuracy: 8690/8968 (96.9001%)
poison local model 74 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   1,  Average loss: 0.0020, Accuracy: 608/627 (96.9697%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   2,  Average loss: 0.0005, Accuracy: 621/627 (99.0431%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   3,  Average loss: 0.0005, Accuracy: 622/627 (99.2026%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   4,  Average loss: 0.0004, Accuracy: 620/627 (98.8836%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   5,  Average loss: 0.0003, Accuracy: 624/627 (99.5215%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 624/627 (99.5215%), train_poison_data_count: 320
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   7,  Average loss: 0.0003, Accuracy: 621/627 (99.0431%), train_poison_data_count: 320
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 627/627 (100.0000%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 626/627 (99.8405%), train_poison_data_count: 320
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 74, internal_epoch  10,  Average loss: 0.0002, Accuracy: 625/627 (99.6810%), train_poison_data_count: 320
Global model norm: 15.539183771994097.
Norm before scaling: 15.580344391176219. Distance: 1.4500280213114851
Total norm for 10 adversaries is: 15.580344391176219. distance: 1.4500280213114851
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0002, Accuracy: 8968/8968 (100.0000%)
poison local model 3 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 3, internal_epoch   1,  Average loss: 0.0098, Accuracy: 417/516 (80.8140%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 3, internal_epoch   2,  Average loss: 0.0010, Accuracy: 505/516 (97.8682%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 3, internal_epoch   3,  Average loss: 0.0002, Accuracy: 514/516 (99.6124%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 3, internal_epoch   4,  Average loss: 0.0003, Accuracy: 512/516 (99.2248%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 3, internal_epoch   5,  Average loss: 0.0001, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 3, internal_epoch   6,  Average loss: 0.0001, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 3, internal_epoch   7,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 260
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 3, internal_epoch   8,  Average loss: 0.0002, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 3, internal_epoch   9,  Average loss: 0.0002, Accuracy: 515/516 (99.8062%), train_poison_data_count: 260
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 3, internal_epoch  10,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 260
Global model norm: 15.539183771994097.
Norm before scaling: 16.06028928275276. Distance: 3.7962473911832877
Total norm for 10 adversaries is: 16.06028928275276. distance: 3.7962473911832877
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 1.4700, Accuracy: 6262/8968 (69.8260%)
poison local model 18 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 18, internal_epoch   1,  Average loss: 0.0012, Accuracy: 741/759 (97.6285%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 18, internal_epoch   2,  Average loss: 0.0002, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 18, internal_epoch   3,  Average loss: 0.0001, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 18, internal_epoch   4,  Average loss: 0.0001, Accuracy: 757/759 (99.7365%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 18, internal_epoch   5,  Average loss: 0.0001, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 18, internal_epoch   6,  Average loss: 0.0001, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 18, internal_epoch   7,  Average loss: 0.0001, Accuracy: 758/759 (99.8682%), train_poison_data_count: 384
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 18, internal_epoch   8,  Average loss: 0.0001, Accuracy: 759/759 (100.0000%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 18, internal_epoch   9,  Average loss: 0.0001, Accuracy: 759/759 (100.0000%), train_poison_data_count: 384
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 18, internal_epoch  10,  Average loss: 0.0001, Accuracy: 759/759 (100.0000%), train_poison_data_count: 384
Global model norm: 15.539183771994097.
Norm before scaling: 15.600881287550463. Distance: 1.4527431519569662
Total norm for 10 adversaries is: 15.600881287550463. distance: 1.4527431519569662
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0745, Accuracy: 8746/8968 (97.5245%)
poison local model 29 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 29, internal_epoch   1,  Average loss: 0.0029, Accuracy: 469/506 (92.6877%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 29, internal_epoch   2,  Average loss: 0.0012, Accuracy: 496/506 (98.0237%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 29, internal_epoch   3,  Average loss: 0.0007, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 29, internal_epoch   4,  Average loss: 0.0005, Accuracy: 504/506 (99.6047%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 29, internal_epoch   5,  Average loss: 0.0004, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 29, internal_epoch   6,  Average loss: 0.0003, Accuracy: 506/506 (100.0000%), train_poison_data_count: 256
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 29, internal_epoch   7,  Average loss: 0.0003, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 29, internal_epoch   8,  Average loss: 0.0003, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 29, internal_epoch   9,  Average loss: 0.0003, Accuracy: 505/506 (99.8024%), train_poison_data_count: 256
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 29, internal_epoch  10,  Average loss: 0.0002, Accuracy: 506/506 (100.0000%), train_poison_data_count: 256
Global model norm: 15.539183771994097.
Norm before scaling: 15.755639413868412. Distance: 2.1307693028840635
Total norm for 10 adversaries is: 15.755639413868412. distance: 2.1307693028840635
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.2726, Accuracy: 8168/8968 (91.0794%)
poison local model 62 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 62, internal_epoch   1,  Average loss: 0.0043, Accuracy: 538/580 (92.7586%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 62, internal_epoch   2,  Average loss: 0.0035, Accuracy: 547/580 (94.3103%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 62, internal_epoch   3,  Average loss: 0.0037, Accuracy: 521/580 (89.8276%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 62, internal_epoch   4,  Average loss: 0.0016, Accuracy: 567/580 (97.7586%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 62, internal_epoch   5,  Average loss: 0.0011, Accuracy: 572/580 (98.6207%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 62, internal_epoch   6,  Average loss: 0.0006, Accuracy: 574/580 (98.9655%), train_poison_data_count: 292
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 62, internal_epoch   7,  Average loss: 0.0007, Accuracy: 571/580 (98.4483%), train_poison_data_count: 292
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 62, internal_epoch   8,  Average loss: 0.0006, Accuracy: 574/580 (98.9655%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 62, internal_epoch   9,  Average loss: 0.0005, Accuracy: 575/580 (99.1379%), train_poison_data_count: 292
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 62, internal_epoch  10,  Average loss: 0.0004, Accuracy: 577/580 (99.4828%), train_poison_data_count: 292
Global model norm: 15.539183771994097.
Norm before scaling: 15.804598194724207. Distance: 2.93102329573131
Total norm for 10 adversaries is: 15.804598194724207. distance: 2.93102329573131
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0444, Accuracy: 8812/8968 (98.2605%)
poison local model 33 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 543/587 (92.5043%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 33, internal_epoch   2,  Average loss: 0.0006, Accuracy: 580/587 (98.8075%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 33, internal_epoch   3,  Average loss: 0.0003, Accuracy: 586/587 (99.8296%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 33, internal_epoch   4,  Average loss: 0.0003, Accuracy: 585/587 (99.6593%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 33, internal_epoch   5,  Average loss: 0.0002, Accuracy: 585/587 (99.6593%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 33, internal_epoch   6,  Average loss: 0.0001, Accuracy: 586/587 (99.8296%), train_poison_data_count: 299
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 33, internal_epoch   7,  Average loss: 0.0002, Accuracy: 585/587 (99.6593%), train_poison_data_count: 299
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 33, internal_epoch   8,  Average loss: 0.0002, Accuracy: 584/587 (99.4889%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 33, internal_epoch   9,  Average loss: 0.0002, Accuracy: 583/587 (99.3186%), train_poison_data_count: 299
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 33, internal_epoch  10,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 299
Global model norm: 15.539183771994097.
Norm before scaling: 15.735131405602004. Distance: 2.1861014118596076
Total norm for 10 adversaries is: 15.735131405602004. distance: 2.1861014118596076
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.8728, Accuracy: 7125/8968 (79.4492%)
poison local model 88 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 88, internal_epoch   1,  Average loss: 0.0038, Accuracy: 668/734 (91.0082%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 88, internal_epoch   2,  Average loss: 0.0007, Accuracy: 720/734 (98.0926%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 88, internal_epoch   3,  Average loss: 0.0008, Accuracy: 720/734 (98.0926%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 88, internal_epoch   4,  Average loss: 0.0004, Accuracy: 728/734 (99.1826%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 88, internal_epoch   5,  Average loss: 0.0002, Accuracy: 732/734 (99.7275%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 88, internal_epoch   6,  Average loss: 0.0003, Accuracy: 730/734 (99.4550%), train_poison_data_count: 382
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 88, internal_epoch   7,  Average loss: 0.0002, Accuracy: 731/734 (99.5913%), train_poison_data_count: 382
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 88, internal_epoch   8,  Average loss: 0.0003, Accuracy: 732/734 (99.7275%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 88, internal_epoch   9,  Average loss: 0.0002, Accuracy: 732/734 (99.7275%), train_poison_data_count: 382
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 88, internal_epoch  10,  Average loss: 0.0002, Accuracy: 731/734 (99.5913%), train_poison_data_count: 382
Global model norm: 15.539183771994097.
Norm before scaling: 15.861630073663614. Distance: 2.6860604089972493
Total norm for 10 adversaries is: 15.861630073663614. distance: 2.6860604089972493
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0747, Accuracy: 8772/8968 (97.8145%)
___Train Local_Simple,  epoch  60, local model 45, internal_epoch   1,  Average loss: 0.0008, Accuracy: 636/647 (98.2998%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 4.7426, Accuracy: 3466/10000 (34.6600%)
___Train Local_Simple,  epoch  60, local model 11, internal_epoch   1,  Average loss: 0.0004, Accuracy: 549/554 (99.0975%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.6528, Accuracy: 8183/10000 (81.8300%)
___Train Local_Simple,  epoch  60, local model 92, internal_epoch   1,  Average loss: 0.0023, Accuracy: 578/611 (94.5990%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 2.6999, Accuracy: 3649/10000 (36.4900%)
___Train Local_Simple,  epoch  60, local model 36, internal_epoch   1,  Average loss: 0.0006, Accuracy: 310/315 (98.4127%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1741, Accuracy: 9368/10000 (93.6800%)
___Train Local_Simple,  epoch  60, local model 71, internal_epoch   1,  Average loss: 0.0006, Accuracy: 554/561 (98.7522%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.7591, Accuracy: 7999/10000 (79.9900%)
___Train Local_Simple,  epoch  60, local model 15, internal_epoch   1,  Average loss: 0.0004, Accuracy: 281/282 (99.6454%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1813, Accuracy: 9382/10000 (93.8200%)
___Train Local_Simple,  epoch  60, local model 67, internal_epoch   1,  Average loss: 0.0010, Accuracy: 435/441 (98.6395%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.1792, Accuracy: 6634/10000 (66.3400%)
___Train Local_Simple,  epoch  60, local model 16, internal_epoch   1,  Average loss: 0.0003, Accuracy: 813/817 (99.5104%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.7610, Accuracy: 6741/10000 (67.4100%)
___Train Local_Simple,  epoch  60, local model 28, internal_epoch   1,  Average loss: 0.0006, Accuracy: 601/611 (98.3633%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 2.5255, Accuracy: 6155/10000 (61.5500%)
___Train Local_Simple,  epoch  60, local model 6, internal_epoch   1,  Average loss: 0.0005, Accuracy: 430/435 (98.8506%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.0238, Accuracy: 7734/10000 (77.3400%)
___Train Local_Simple,  epoch  60, local model 99, internal_epoch   1,  Average loss: 0.0016, Accuracy: 696/712 (97.7528%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 3.9659, Accuracy: 3685/10000 (36.8500%)
___Train Local_Simple,  epoch  60, local model 55, internal_epoch   1,  Average loss: 0.0011, Accuracy: 364/375 (97.0667%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.7751, Accuracy: 7538/10000 (75.3800%)
___Train Local_Simple,  epoch  60, local model 34, internal_epoch   1,  Average loss: 0.0009, Accuracy: 853/871 (97.9334%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 2.9268, Accuracy: 4665/10000 (46.6500%)
___Train Local_Simple,  epoch  60, local model 76, internal_epoch   1,  Average loss: 0.0009, Accuracy: 454/459 (98.9107%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.4228, Accuracy: 8657/10000 (86.5700%)
___Train Local_Simple,  epoch  60, local model 2, internal_epoch   1,  Average loss: 0.0005, Accuracy: 560/564 (99.2908%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.5089, Accuracy: 8326/10000 (83.2600%)
___Train Local_Simple,  epoch  60, local model 90, internal_epoch   1,  Average loss: 0.0015, Accuracy: 594/615 (96.5854%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 2.0574, Accuracy: 5927/10000 (59.2700%)
___Train Local_Simple,  epoch  60, local model 98, internal_epoch   1,  Average loss: 0.0010, Accuracy: 538/548 (98.1752%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 3.0810, Accuracy: 4554/10000 (45.5400%)
___Train Local_Simple,  epoch  60, local model 42, internal_epoch   1,  Average loss: 0.0002, Accuracy: 471/473 (99.5772%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.3117, Accuracy: 8875/10000 (88.7500%)
___Train Local_Simple,  epoch  60, local model 60, internal_epoch   1,  Average loss: 0.0007, Accuracy: 565/571 (98.9492%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 2.0611, Accuracy: 5906/10000 (59.0600%)
___Train Local_Simple,  epoch  60, local model 10, internal_epoch   1,  Average loss: 0.0013, Accuracy: 559/573 (97.5567%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.3653, Accuracy: 8809/10000 (88.0900%)
___Train Local_Simple,  epoch  60, local model 44, internal_epoch   1,  Average loss: 0.0002, Accuracy: 557/561 (99.2870%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.7929, Accuracy: 8074/10000 (80.7400%)
___Train Local_Simple,  epoch  60, local model 47, internal_epoch   1,  Average loss: 0.0006, Accuracy: 528/534 (98.8764%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 2.7555, Accuracy: 5510/10000 (55.1000%)
___Train Local_Simple,  epoch  60, local model 70, internal_epoch   1,  Average loss: 0.0008, Accuracy: 556/568 (97.8873%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 2.3841, Accuracy: 4734/10000 (47.3400%)
___Train Local_Simple,  epoch  60, local model 82, internal_epoch   1,  Average loss: 0.0005, Accuracy: 809/815 (99.2638%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 3.6371, Accuracy: 5407/10000 (54.0700%)
___Train Local_Simple,  epoch  60, local model 97, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1102/1112 (99.1007%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 3.7893, Accuracy: 4447/10000 (44.4700%)
___Train Local_Simple,  epoch  60, local model 69, internal_epoch   1,  Average loss: 0.0009, Accuracy: 662/671 (98.6587%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 3.3505, Accuracy: 4347/10000 (43.4700%)
___Train Local_Simple,  epoch  60, local model 1, internal_epoch   1,  Average loss: 0.0002, Accuracy: 535/536 (99.8134%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1706, Accuracy: 9467/10000 (94.6700%)
___Train Local_Simple,  epoch  60, local model 58, internal_epoch   1,  Average loss: 0.0007, Accuracy: 761/772 (98.5751%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.8270, Accuracy: 7768/10000 (77.6800%)
___Train Local_Simple,  epoch  60, local model 89, internal_epoch   1,  Average loss: 0.0010, Accuracy: 670/683 (98.0966%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 2.6766, Accuracy: 5664/10000 (56.6400%)
___Train Local_Simple,  epoch  60, local model 22, internal_epoch   1,  Average loss: 0.0004, Accuracy: 261/262 (99.6183%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.3158, Accuracy: 8981/10000 (89.8100%)
___Train Local_Simple,  epoch  60, local model 81, internal_epoch   1,  Average loss: 0.0008, Accuracy: 622/636 (97.7987%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 3.2063, Accuracy: 3704/10000 (37.0400%)
___Train Local_Simple,  epoch  60, local model 30, internal_epoch   1,  Average loss: 0.0005, Accuracy: 439/443 (99.0971%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.7245, Accuracy: 8099/10000 (80.9900%)
___Train Local_Simple,  epoch  60, local model 95, internal_epoch   1,  Average loss: 0.0016, Accuracy: 578/600 (96.3333%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 2.5986, Accuracy: 5793/10000 (57.9300%)
___Train Local_Simple,  epoch  60, local model 24, internal_epoch   1,  Average loss: 0.0009, Accuracy: 468/477 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.4738, Accuracy: 8316/10000 (83.1600%)
___Train Local_Simple,  epoch  60, local model 65, internal_epoch   1,  Average loss: 0.0011, Accuracy: 607/621 (97.7456%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.7963, Accuracy: 7268/10000 (72.6800%)
___Train Local_Simple,  epoch  60, local model 77, internal_epoch   1,  Average loss: 0.0009, Accuracy: 604/618 (97.7346%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 3.6267, Accuracy: 5083/10000 (50.8300%)
___Train Local_Simple,  epoch  60, local model 68, internal_epoch   1,  Average loss: 0.0007, Accuracy: 543/549 (98.9071%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 2.5962, Accuracy: 4825/10000 (48.2500%)
___Train Local_Simple,  epoch  60, local model 0, internal_epoch   1,  Average loss: 0.0008, Accuracy: 430/435 (98.8506%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.8257, Accuracy: 7037/10000 (70.3700%)
___Train Local_Simple,  epoch  60, local model 43, internal_epoch   1,  Average loss: 0.0006, Accuracy: 427/431 (99.0719%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.6203, Accuracy: 8026/10000 (80.2600%)
___Train Local_Simple,  epoch  60, local model 4, internal_epoch   1,  Average loss: 0.0004, Accuracy: 741/748 (99.0642%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.4203, Accuracy: 5731/10000 (57.3100%)
___Train Local_Simple,  epoch  60, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 697/713 (97.7560%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.2285, Accuracy: 7420/10000 (74.2000%)
___Train Local_Simple,  epoch  60, local model 32, internal_epoch   1,  Average loss: 0.0004, Accuracy: 587/590 (99.4915%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.6486, Accuracy: 6256/10000 (62.5600%)
___Train Local_Simple,  epoch  60, local model 19, internal_epoch   1,  Average loss: 0.0006, Accuracy: 593/598 (99.1639%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.9939, Accuracy: 7230/10000 (72.3000%)
___Train Local_Simple,  epoch  60, local model 86, internal_epoch   1,  Average loss: 0.0004, Accuracy: 687/692 (99.2775%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 3.6466, Accuracy: 4956/10000 (49.5600%)
___Train Local_Simple,  epoch  60, local model 26, internal_epoch   1,  Average loss: 0.0008, Accuracy: 510/519 (98.2659%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.8263, Accuracy: 6231/10000 (62.3100%)
___Train Local_Simple,  epoch  60, local model 27, internal_epoch   1,  Average loss: 0.0004, Accuracy: 742/745 (99.5973%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.9445, Accuracy: 5621/10000 (56.2100%)
___Train Local_Simple,  epoch  60, local model 79, internal_epoch   1,  Average loss: 0.0007, Accuracy: 658/661 (99.5461%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.6943, Accuracy: 7956/10000 (79.5600%)
___Train Local_Simple,  epoch  60, local model 91, internal_epoch   1,  Average loss: 0.0003, Accuracy: 814/819 (99.3895%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.8325, Accuracy: 5434/10000 (54.3400%)
___Train Local_Simple,  epoch  60, local model 61, internal_epoch   1,  Average loss: 0.0008, Accuracy: 283/287 (98.6063%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.2036, Accuracy: 9386/10000 (93.8600%)
___Train Local_Simple,  epoch  60, local model 17, internal_epoch   1,  Average loss: 0.0004, Accuracy: 522/527 (99.0512%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.1370, Accuracy: 6794/10000 (67.9400%)
___Train Local_Simple,  epoch  60, local model 46, internal_epoch   1,  Average loss: 0.0004, Accuracy: 643/650 (98.9231%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.2221, Accuracy: 6812/10000 (68.1200%)
___Train Local_Simple,  epoch  60, local model 66, internal_epoch   1,  Average loss: 0.0009, Accuracy: 721/733 (98.3629%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 3.2677, Accuracy: 3880/10000 (38.8000%)
___Train Local_Simple,  epoch  60, local model 52, internal_epoch   1,  Average loss: 0.0009, Accuracy: 769/789 (97.4651%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 3.9637, Accuracy: 4971/10000 (49.7100%)
___Train Local_Simple,  epoch  60, local model 31, internal_epoch   1,  Average loss: 0.0007, Accuracy: 587/596 (98.4899%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.6672, Accuracy: 7823/10000 (78.2300%)
___Train Local_Simple,  epoch  60, local model 50, internal_epoch   1,  Average loss: 0.0007, Accuracy: 467/477 (97.9036%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.8342, Accuracy: 7386/10000 (73.8600%)
___Train Local_Simple,  epoch  60, local model 39, internal_epoch   1,  Average loss: 0.0006, Accuracy: 486/493 (98.5801%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.3944, Accuracy: 7287/10000 (72.8700%)
___Train Local_Simple,  epoch  60, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 533/542 (98.3395%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.7188, Accuracy: 7823/10000 (78.2300%)
___Train Local_Simple,  epoch  60, local model 59, internal_epoch   1,  Average loss: 0.0009, Accuracy: 633/644 (98.2919%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.7873, Accuracy: 7521/10000 (75.2100%)
___Train Local_Simple,  epoch  60, local model 48, internal_epoch   1,  Average loss: 0.0008, Accuracy: 357/363 (98.3471%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1688, Accuracy: 9404/10000 (94.0400%)
___Train Local_Simple,  epoch  60, local model 85, internal_epoch   1,  Average loss: 0.0010, Accuracy: 792/807 (98.1413%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 3.5272, Accuracy: 4898/10000 (48.9800%)
___Train Local_Simple,  epoch  60, local model 84, internal_epoch   1,  Average loss: 0.0008, Accuracy: 417/420 (99.2857%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.2368, Accuracy: 9200/10000 (92.0000%)
___Train Local_Simple,  epoch  60, local model 20, internal_epoch   1,  Average loss: 0.0005, Accuracy: 597/602 (99.1694%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 2.0116, Accuracy: 6226/10000 (62.2600%)
___Train Local_Simple,  epoch  60, local model 35, internal_epoch   1,  Average loss: 0.0008, Accuracy: 619/630 (98.2540%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 2.3421, Accuracy: 5847/10000 (58.4700%)
___Train Local_Simple,  epoch  60, local model 72, internal_epoch   1,  Average loss: 0.0009, Accuracy: 416/423 (98.3452%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 2.9308, Accuracy: 4063/10000 (40.6300%)
___Train Local_Simple,  epoch  60, local model 63, internal_epoch   1,  Average loss: 0.0008, Accuracy: 298/303 (98.3498%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.8032, Accuracy: 7819/10000 (78.1900%)
___Train Local_Simple,  epoch  60, local model 38, internal_epoch   1,  Average loss: 0.0007, Accuracy: 471/477 (98.7421%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1926, Accuracy: 9381/10000 (93.8100%)
___Train Local_Simple,  epoch  60, local model 21, internal_epoch   1,  Average loss: 0.0003, Accuracy: 684/687 (99.5633%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.8759, Accuracy: 7296/10000 (72.9600%)
___Train Local_Simple,  epoch  60, local model 80, internal_epoch   1,  Average loss: 0.0015, Accuracy: 515/532 (96.8045%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 4.9620, Accuracy: 3519/10000 (35.1900%)
___Train Local_Simple,  epoch  60, local model 75, internal_epoch   1,  Average loss: 0.0007, Accuracy: 754/763 (98.8204%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 2.1200, Accuracy: 5059/10000 (50.5900%)
___Train Local_Simple,  epoch  60, local model 83, internal_epoch   1,  Average loss: 0.0009, Accuracy: 352/360 (97.7778%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.2434, Accuracy: 9239/10000 (92.3900%)
___Train Local_Simple,  epoch  60, local model 87, internal_epoch   1,  Average loss: 0.0008, Accuracy: 653/663 (98.4917%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 2.6827, Accuracy: 5178/10000 (51.7800%)
___Train Local_Simple,  epoch  60, local model 7, internal_epoch   1,  Average loss: 0.0004, Accuracy: 797/802 (99.3766%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.1867, Accuracy: 6286/10000 (62.8600%)
___Train Local_Simple,  epoch  60, local model 64, internal_epoch   1,  Average loss: 0.0002, Accuracy: 608/608 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.7384, Accuracy: 8008/10000 (80.0800%)
___Train Local_Simple,  epoch  60, local model 40, internal_epoch   1,  Average loss: 0.0005, Accuracy: 495/498 (99.3976%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 2.1299, Accuracy: 6304/10000 (63.0400%)
___Train Local_Simple,  epoch  60, local model 5, internal_epoch   1,  Average loss: 0.0010, Accuracy: 567/578 (98.0969%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.9129, Accuracy: 7563/10000 (75.6300%)
___Train Local_Simple,  epoch  60, local model 94, internal_epoch   1,  Average loss: 0.0005, Accuracy: 663/671 (98.8077%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.8648, Accuracy: 6803/10000 (68.0300%)
___Train Local_Simple,  epoch  60, local model 93, internal_epoch   1,  Average loss: 0.0008, Accuracy: 620/630 (98.4127%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.2920, Accuracy: 6281/10000 (62.8100%)
___Train Local_Simple,  epoch  60, local model 12, internal_epoch   1,  Average loss: 0.0004, Accuracy: 718/725 (99.0345%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.2941, Accuracy: 7013/10000 (70.1300%)
___Train Local_Simple,  epoch  60, local model 57, internal_epoch   1,  Average loss: 0.0004, Accuracy: 518/523 (99.0440%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 2.0996, Accuracy: 5248/10000 (52.4800%)
___Train Local_Simple,  epoch  60, local model 14, internal_epoch   1,  Average loss: 0.0007, Accuracy: 683/692 (98.6994%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.8339, Accuracy: 7906/10000 (79.0600%)
___Train Local_Simple,  epoch  60, local model 8, internal_epoch   1,  Average loss: 0.0006, Accuracy: 699/706 (99.0085%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 3.1967, Accuracy: 3840/10000 (38.4000%)
___Train Local_Simple,  epoch  60, local model 9, internal_epoch   1,  Average loss: 0.0007, Accuracy: 501/508 (98.6220%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.6915, Accuracy: 7699/10000 (76.9900%)
___Train Local_Simple,  epoch  60, local model 25, internal_epoch   1,  Average loss: 0.0002, Accuracy: 590/592 (99.6622%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.1112, Accuracy: 7631/10000 (76.3100%)
___Train Local_Simple,  epoch  60, local model 54, internal_epoch   1,  Average loss: 0.0003, Accuracy: 828/832 (99.5192%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.4063, Accuracy: 6702/10000 (67.0200%)
___Train Local_Simple,  epoch  60, local model 49, internal_epoch   1,  Average loss: 0.0010, Accuracy: 347/355 (97.7465%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.5939, Accuracy: 5817/10000 (58.1700%)
___Train Local_Simple,  epoch  60, local model 96, internal_epoch   1,  Average loss: 0.0007, Accuracy: 524/531 (98.6817%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 3.0108, Accuracy: 4807/10000 (48.0700%)
___Train Local_Simple,  epoch  60, local model 53, internal_epoch   1,  Average loss: 0.0005, Accuracy: 556/561 (99.1087%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.1518, Accuracy: 7409/10000 (74.0900%)
___Train Local_Simple,  epoch  60, local model 56, internal_epoch   1,  Average loss: 0.0002, Accuracy: 712/715 (99.5804%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.8553, Accuracy: 5831/10000 (58.3100%)
___Train Local_Simple,  epoch  60, local model 78, internal_epoch   1,  Average loss: 0.0014, Accuracy: 575/587 (97.9557%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 5.8178, Accuracy: 2908/10000 (29.0800%)
___Train Local_Simple,  epoch  60, local model 37, internal_epoch   1,  Average loss: 0.0007, Accuracy: 447/456 (98.0263%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 2.1394, Accuracy: 6124/10000 (61.2400%)
time spent on training: 373.83702301979065
___Test Target_Simple poisoned: False, epoch: 60: Average loss: 0.0743, Accuracy: 9773/10000 (97.7300%)
___Test Target_Simple poisoned: True, epoch: 60: Average loss: 1.6351, Accuracy: 5639/8968 (62.8791%)
saving model
Done in 406.9134473800659 sec.
Saving all the graphs.
This run has a label: Jan.30_22.14.11. Visdom environment: mnist_shard_hetero_mean_attack
